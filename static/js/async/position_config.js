(window.webpackJsonp=window.webpackJsonp||[]).push([["position_config"],{"923e":function(t,e,i){},9806:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"joblist"}},[i("section",{staticClass:"top"},[i("section",{staticClass:"fl"},[i("selectBtn",{staticClass:"select-btn",attrs:{sorts:t.options,name:t.selectedName},on:{emit:t.selectType}})],1),t._v(" "),i("section",{staticClass:"fl top_input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.positionName,expression:"positionName"}],staticClass:"searchgoods",attrs:{type:"text",placeholder:"请输入职位名称"},domProps:{value:t.positionName},on:{input:function(e){e.target.composing||(t.positionName=e.target.value)}}})]),t._v(" "),i("a",{staticClass:"blue btn",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.searchPosition()}}},[t._v("筛选")]),t._v(" "),i("a",{staticClass:"gray btn",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.resetSearch()}}},[t._v("重置")])]),t._v(" "),i("comTable",{attrs:{listName:"职位管理列表",titleData:t.titleData,introData:t.currentList,allTotal:t.newrecordList.length,bannerStyle:t.bannerStyle,contentStyle:t.contentStyle,titleHeight:50,listHeight:50},scopedSlots:t._u([{key:"con-0",fn:function(e){return i("span",{staticStyle:{cursor:"pointer"}},[i("span",{staticStyle:{color:"#FE8D2C","font-size":"16px"},on:{click:function(i){t.toEdit(e.data,e.index)}}},[t._v("编辑")]),t._v(" "),i("span",{staticStyle:{padding:"0 20px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),i("span",{staticStyle:{color:"#FD3F1F","font-size":"16px"},on:{click:function(i){t.delJob(e.data,e.index)}}},[t._v("删除")])])}},{key:"con-1",fn:function(e){return i("span",{},[t._v(t._s(e.index+1))])}},{key:"con-3",fn:function(e){return i("span",{},[t._v(t._s(0==e.data.type?"门店":"品牌"))])}}])}),t._v(" "),i("section",{staticStyle:{"margin-top":"10px"}},[i("pageElement",{attrs:{page:Number(t.page),total:Number(t.total),isNoJump:!0,numArr:[10,20,30]},on:{pageNum:t.pageChange}})],1),t._v(" "),t.isOpenWin?i("positionWin",{attrs:{item:t.item,isAdd:t.isAdd,isShop:t.isShop,userData:t.userData,list:t.list,jobIndex:t.jobIndex,currentList:t.currentList,newrecordList:t.newrecordList},on:{throwWinResult:t.doThrowWinResult}}):t._e()],1)};n._withStripped=!0;var s=i("81a2"),o=i("f6ce"),r=i("bbb9");function a(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(s,o){try{var r=e[s](o),a=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(a).then(function(t){n("next",t)},function(t){n("throw",t)});t(a)}("next")})}}var c={data:function(){return{list:[],newrecordList:[],currentList:[],userData:Object,isShop:!1,isAdd:!1,isOpenWin:!1,item:Object,jobIndex:"",options:["全部","门店职位","品牌职位"],selectedType:0,selectedName:"请选择职位类型",positionName:"",num:10,count:0,total:0,page:1,titleData:[],bannerStyle:null,contentStyle:null}},created:function(){this.titleData=[{titleName:"操作"},{titleName:"序号"},{titleName:"职位名称",dataName:"name"},{titleName:"职位类型"},{titleName:"权限数量",dataName:"nodeNum"},{titleName:"职位人数",dataName:"personNum"}],this.bannerStyle={backgroundColor:"#F2F2F2",color:"#434149",fontSize:"16px"},this.contentStyle={color:"#666666",fontSize:"14px"}},mounted:function(){this.userData=o.a.session("userShop"),this.init(),this.getList()},watch:{currentList:{handler:function(t){0==t.length&&this.page>1&&(this.page=this.page-1,this.paging(1))}}},methods:{init:function(){var t=this,e={openShopPosition:function(){t.openShop()},openBrandPosition:function(){t.openBrand()}};this.$store.commit("setPageTools",e)},selectType:function(t){this.selectedType=t},openShop:function(){this.item={},this.isAdd=!0,this.isShop=!0,this.isOpenWin=!0},openBrand:function(){this.item={},this.isAdd=!0,this.isShop=!1,this.isOpenWin=!0},getList:function(){var t=this;return a(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.RoleGetList({data:{}});case 2:(i=e.sent)&&(i=i.map(function(t){return t.personNum=t.personNum+"",t}),t.list=i,t.newrecordList=i,t.sortList(),t.paging());case 4:case"end":return e.stop()}},e,t)}))()},toEdit:function(t,e){this.item=t,this.jobIndex=(this.page-1)*this.num+e,this.isOpenWin=!0,this.isAdd=!1},deleteJob:function(t,e){var i=this;return a(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.deletePosition({data:{id:t.id}});case 2:n.sent&&(i.newrecordList.splice((i.page-1)*i.num+e,1),i.sortList(),i.paging(1),i.list=i.newrecordList,i.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"删除成功"}));case 4:case"end":return n.stop()}},n,i)}))()},delJob:function(t,e){var i=this;Number(t.personNum)>0?this.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"有"+t.personNum+"位员工绑定该职位，请解除帮定后再进行删除操作！"}):this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:"确定删除该职位信息?",callback:function(n){"ok"==n&&i.deleteJob(t,e)}})},doThrowWinResult:function(t){"ok"==t?(this.sortList(),this.isOpenWin=!1,this.paging(1),this.list=this.newrecordList,this.isAdd?this.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"添加成功"}):this.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"修改成功"})):"cancel"==t?this.isOpenWin=!1:"close"==t&&(this.isOpenWin=!1)},searchPosition:function(){var t=[];if(""==this.positionName&&0==this.selectedType)return this.getList(),!1;if(""!=this.positionName&&0==this.selectedType)for(var e=0;e<this.list.length;e++)-1!=this.list[e].name.indexOf(this.positionName)&&t.push(this.list[e]);else if(0!=this.selectedType&&""==this.positionName)for(var i=0;i<this.list.length;i++)Number(this.list[i].type)+1==this.selectedType&&t.push(this.list[i]);else for(var n=0;n<this.list.length;n++)-1!=this.list[n].name.indexOf(this.positionName)&&Number(this.list[n].type)+1==this.selectedType&&t.push(this.list[n]);this.newrecordList=t,this.paging()},resetSearch:function(){this.positionName="",this.selectedType=0,this.selectedName="全部",this.options=["全部","门店职位","品牌职位"],this.getList()},pageChange:function(t){this.page=t.page,this.num=t.num,this.total=Math.ceil(this.newrecordList.length/this.num),this.currentList=this.newrecordList.slice((this.page-1)*this.num,(this.page-1)*this.num+this.num)},paging:function(t){this.total=Math.ceil(this.newrecordList.length/this.num),this.count=this.newrecordList.length,1!=t&&(this.page=1),this.currentList=this.newrecordList.slice((this.page-1)*this.num,(this.page-1)*this.num+this.num)},sortList:function(){this.newrecordList=r.a.sortByAll(this.newrecordList,["sort","id"],!0)}},components:{positionWin:function(){return i.e("position_config_one_win").then(i.bind(null,"40f0"))},selectBtn:function(){return i.e("select_btn").then(i.bind(null,"3d41"))},pageElement:function(){return i.e("page_element").then(i.bind(null,"5921"))},comTable:function(){return i.e("table").then(i.bind(null,"4360"))}}},l=(i("b4b7"),i("7610")),h=Object(l.a)(c,n,[],!1,null,"06868110",null);h.options.__file="src\\module\\brand_configuration\\position_config.vue";e.default=h.exports},b4b7:function(t,e,i){"use strict";var n=i("923e");i.n(n).a}}]);