(window.webpackJsonp=window.webpackJsonp||[]).push([["supplier_configure"],{"2c9b":function(t,i,n){},"37f5":function(t,i,n){"use strict";var e=n("2c9b");n.n(e).a},41029:function(t,i,n){"use strict";n.r(i);var e=n("81a2"),r=n("f6ce"),a=function(){return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,i){var n=[],e=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(e=(s=o.next()).done)&&(n.push(s.value),!i||n.length!==i);e=!0);}catch(t){r=!0,a=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw a}}return n}(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function s(t){return function(){var i=t.apply(this,arguments);return new Promise(function(t,n){return function e(r,a){try{var s=i[r](a),o=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(o).then(function(t){e("next",t)},function(t){e("throw",t)});t(o)}("next")})}}var o={data:function(){return{configList:[{name:"物料单位修改",status:0,attr:"updateUnit"},{name:"物料单位新建",status:0,attr:"createUnit"},{name:"物料分类修改",status:0,attr:"updateCategory"},{name:"物料分类新建",status:0,attr:"createCategory"},{name:"商品品牌修改",status:0,attr:"updateBrand"},{name:"商品品牌新建",status:0,attr:"createBrand"},{name:"物料修改",status:0,attr:"updateMaterial"},{name:"物料新建",status:0,attr:"createMaterial"},{name:"供应商修改",status:0,attr:"updateSupplier"},{name:"供应商新建",status:0,attr:"createSupplier"},{name:"BOM单修改",status:0,attr:"updateBom"},{name:"BOM单新建",status:0,attr:"createBom"}],config:[{name:"商品",id:0,attr:"isGoods"},{name:"物料",id:1,attr:"isMaterial"}],saleSwitch:!1,distribution:[],isBrand:!1}},methods:{chooseList:function(t,i){t.isSelect=!t.isSelect,this.config.splice(i,1,t)},getOnOff:function(t){this.saleSwitch=t},getSelectConfig:function(t){var i={},n=!0,e=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;i[o.attr]=Number(o.isSelect)}}catch(t){e=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(e)throw r}}return i},getDistribution:function(){var t=[],i=!0,n=!1,e=void 0;try{for(var r,a=this.distribution[Symbol.iterator]();!(i=(r=a.next()).done);i=!0){var s=r.value;s.name=s.name.trim(),s.name&&t.push({id:s.id,name:s.name})}}catch(t){n=!0,e=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw e}}return t},checkDistribution:function(){var t=!0;return this.distribution=this.distribution.map(function(i){return i.name=i.name.trim(),Number(i.id)>0&&!i.name?(i.errorFlag=!0,t=!1):i.errorFlag=!1,i}),t},checkDistributionSameName:function(){for(var t=!0,i=0;i<this.distribution.length;i++)for(var n=i+1;n<this.distribution.length;n++)if(this.distribution[i].name==this.distribution[n].name){t=!1;break}return t},clickBtn:function(t){var i=this;return s(regeneratorRuntime.mark(function n(){var e,a,s,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e={},[],a={},"ok"!=t){n.next=23;break}if(i.checkDistribution()){n.next=5;break}return i.alert("请填写需要修改的分销价格名称!"),n.abrupt("return");case 5:if(i.checkDistributionSameName()){n.next=8;break}return i.alert("分销价格名称不能相同!"),n.abrupt("return");case 8:return(e=i.getSelectConfig(i.config)).isShelveMinus=Number(i.saleSwitch),e.distribution=i.getDistribution(),n.next=13,i.getHttp("invociUpdateSupplier",e);case 13:a=n.sent,i.alert("保存成功!"),Array.isArray(a.distribution)&&(i.distribution=a.distribution),s=0,o=[],1==a.isGoods&&1!=a.isMaterial?(s=1,o=["领料管理","BOM单管理","单位配置","物料分类"]):1!=a.isGoods&&1==a.isMaterial&&(s=2,o=["称重商品配置","货架管理"]),i.$store.commit("setasideDel",o),r.a.session("inventConfigure",s),n.next=24;break;case 23:"cancel"==t&&i.$router.go(-1);case 24:case"end":return n.stop()}},n,i)}))()},delDistribution:function(t,i){var n=this;return s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0,!(Number(t.id)>0)){e.next=7;break}return e.next=4,n.getHttp("invoicingDelDistributionConfig",{id:t.id});case 4:r=e.sent,e.next=8;break;case 7:r=!0;case 8:r&&n.distribution.splice(i,1),0==n.distribution.length&&n.distribution.push({id:0,name:""});case 10:case"end":return e.stop()}},e,n)}))()},delAdd:function(t,i,n){var e=this;if("add"==t)this.distribution.length<=9?this.distribution.push({id:0,name:""}):this.alert("最多可设置10个分销价格!");else{if(1==this.distribution.length&&0==this.distribution[0].id)return void this.alert("所有分销价已经删除!");this.alert("确认删除该分销价?",function(t){"ok"==t&&e.delDistribution(i,n)})}},alert:function(t,i){var n={title:"温馨提示",content:t,winType:"alert"};"function"==typeof i&&(n.winType="confirm",n.callback=i),this.$store.commit("setWin",n)},getHttp:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(regeneratorRuntime.mark(function r(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.a[t]({data:n});case 2:return a=i.sent,i.abrupt("return",a);case 4:case"end":return i.stop()}},r,i)}))()},initList:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var e=a(i,4),r=e[0],s=void 0===r?[]:r,o=e[1],c=void 0===o?{}:o,u=e[2],l=void 0===u?"attr":u,d=e[3],f=void 0===d?"status":d;return s=s.map(function(t){for(var i in c)if(t[l]==i){t[f]=1==c[i];break}return t})},initData:function(){var t=r.a.session("userShop").currentShop;this.isBrand=3==t.ischain}},mounted:function(){var t=this;return s(regeneratorRuntime.mark(function i(){var n,e,r,a,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t.initData(),i.next=3,t.getHttp("invociGetSupplier");case 3:return n=i.sent,e=n.isGoods,r=n.isMaterial,a=n.isShelveMinus,s=[],t.configList=t.initList(t.configList,n,"attr","status"),t.config=t.initList(t.config,{isGoods:e,isMaterial:r},"attr","isSelect"),t.saleSwitch=1==a,i.next=11,t.getHttp("invoicingGetDistributionConfig");case 11:s=i.sent,Array.isArray(s)&&(t.distribution=s),0==t.distribution.length&&t.distribution.push({id:0,name:""});case 14:case"end":return i.stop()}},i,t)}))()},components:{onOff:function(){return n.e("on_off").then(n.bind(null,"034b"))},mulSel:function(){return n.e("mul_select").then(n.bind(null,"7d09"))}}},c=(n("37f5"),n("d801")),u=Object(c.a)(o,function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{attrs:{id:"invo-config"}},[n("div",{staticClass:"head"},[t._v("进销存权限")]),t._v(" "),n("div",{staticClass:"content"},[t._m(0),t._v(" "),n("ul",{staticClass:"config-list"},t._l(t.configList,function(i,e){return n("li",{key:e},[n("span",[t._v(t._s(i.name)+" : "+t._s(0==i.status?"关":"开"))])])}))]),t._v(" "),n("div",{staticClass:"head-short"},[t._v("是否启用配置")]),t._v(" "),n("div",{staticClass:"config-switch"},[n("span",{staticClass:"label"},[t._v("商品 , 物料应用")]),t._v(" "),n("div",{staticClass:"mul-sel"},t._l(t.config,function(i,e){return n("span",{key:e,staticClass:"list",class:{checkbox:i.isSelect},on:{click:function(n){t.chooseList(i,e)}}},[t._v(t._s(i.name))])}))]),t._v(" "),n("div",{staticClass:"head-short"},[t._v("是否可以售卖")]),t._v(" "),n("div",{staticClass:"sale-switch"},[t._v("\n\t\t货架商品不足时\n\t\t"),n("span",{staticClass:"on-off"},[n("on-off",{attrs:{status:t.saleSwitch},on:{statusChange:t.getOnOff}})],1),t._v(" "),t._m(1)]),t._v(" "),t.isBrand?n("div",{staticClass:"head-short"},[t._v("分销价格名称")]):t._e(),t._v(" "),t.isBrand?n("div",{staticClass:"sale-switch",staticStyle:{"padding-left":"0",height:"auto","padding-bottom":"30px"}},t._l(t.distribution,function(i,e){return n("li",{key:e,staticClass:"list"},[n("div",{staticClass:"label"},[n("span",{staticClass:"index"},[t._v(t._s(e>8?e+1:"0"+(e+1)))]),t._v(" "),n("span",[t._v("分销价格名称")])]),t._v(" "),n("div",{staticClass:"label-tag"},[n("input",{directives:[{name:"model",rawName:"v-model",value:i.name,expression:"item.name"}],staticClass:"price",class:{"error-flag":i.errorFlag},attrs:{type:"text",placeholder:"请输入分销价格名称",maxlength:"10"},domProps:{value:i.name},on:{input:function(n){n.target.composing||t.$set(i,"name",n.target.value)}}}),t._v(" "),n("span",{staticClass:"icon-container",on:{click:function(n){t.delAdd("del",i,e)}}},[n("i",{staticClass:"del-icon"})]),t._v(" "),t.distribution.length-1==e?n("span",{staticClass:"icon-container",on:{click:function(n){t.delAdd("add",i,e)}}},[n("i",{staticClass:"add-icon"})]):t._e()])])})):t._e(),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"gray btn-com",on:{click:function(i){t.clickBtn("cancel")}}},[t._v("取消")]),t._v(" "),n("div",{staticClass:"yellow btn-com",on:{click:function(i){t.clickBtn("ok")}}},[t._v("确定")])])])},[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"assign-tips"},[i("span",{staticClass:"tips-icon"}),this._v("\n\t\t\t进销存权限统一由品牌指派,如有权限需求请联系品牌权限管理人员\n\t\t")])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"sale"},[i("span",{staticClass:"tips-icon"}),this._v(" "),i("span",{staticClass:"tips-word"},[this._v("开关开启时,销售后货架商品数量可以为负数,下次上架后补充完整")])])}],!1,null,"865d5ee0",null);i.default=u.exports}}]);