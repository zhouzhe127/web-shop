(window.webpackJsonp=window.webpackJsonp||[]).push([["attr_manager"],{"0c60":function(t,n,e){"use strict";var r=e("ccbb");e.n(r).a},4980:function(t,n,e){"use strict";e.r(n);var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"attr_manager"}},[e("section",[e("el-table",{ref:"multipleTable",staticStyle:{width:"90%"},attrs:{stripe:"","header-cell-style":{"background-color":"#f5f7fa"},data:t.showTaste,border:""}},[e("el-table-column",{attrs:{fixed:"","min-width":"100",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("span",{staticStyle:{color:"#FE8D2C",cursor:"pointer"},on:{click:function(e){t.openAttrWin(n.row)}}},[t._v("编辑")]),t._v(" "),e("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),e("span",{staticStyle:{color:"#FD3F1F",cursor:"pointer"},on:{click:function(e){t.del(n.row)}}},[t._v("删除")])]}}])}),t._v(" "),e("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"50",align:"center",prop:"sort",label:"排序"}}),t._v(" "),e("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"name",label:"口味分组"}}),t._v(" "),e("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"50",align:"center",prop:"optionsNum",label:"口味属性（个）"}}),t._v(" "),e("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"50",align:"center",prop:"goodsNum",label:"关联菜品（个）"}}),t._v(" "),1==t.ischain||2==t.ischain?e("el-table-column",{attrs:{"min-width":"50",align:"center",label:"来源"},scopedSlots:t._u([{key:"default",fn:function(n){return[n.row.id<1e5?e("span",[t._v("品牌")]):e("span",[t._v("门店")])]}}])}):t._e()],1)],1),t._v(" "),e("section",{staticStyle:{"margin-top":"10px"}},[e("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.num,layout:"sizes, prev, pager, next","page-count":t.total,"page-sizes":[10,20,30]},on:{"size-change":t.numChange,"current-change":t.pageClick}})],1),t._v(" "),e(t.showCom,{tag:"component",attrs:{pObj:t.comObj},on:{throwAddAttrWin:t.closeGetAddAttrWin,throwSyncAttr:t.funGetSyncAttr}})],1)};r._withStripped=!0;var i=e("f6ce"),s=e("81a2");function a(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){return function r(i,s){try{var a=n[i](s),o=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(o).then(function(t){r("next",t)},function(t){r("throw",t)});t(o)}("next")})}}var o={data:function(){return{showTaste:[],taste:[],isBrand:null,ischain:null,shopId:null,showCom:null,comObj:{title:null,editTasteId:null,taste:null},num:10,total:0,page:1,userData:{}}},created:function(){var t=this;this.userData=i.a.session("userShop"),this.shopId=this.userData.currentShop.id,this.ischain=this.userData.currentShop.ischain,this.isBrand="1"==this.userData.currentShop.ischain||"2"==this.userData.currentShop.ischain;var n=[{name:"新建口味",className:"pick",fn:function(){t.openAttrWin()}}];this.isBrand&&(n[1]={name:"同步",className:"pick",fn:function(){t.showCom="attrAsync"}}),this.$store.commit("setPageTools",n)},mounted:function(){this.funGetAttr()},methods:{del:function(t){var n=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:"确认删除该口味？",callback:function(e){"ok"==e&&n.delAttr(t)}})},delAttr:function(t){var n=this;return a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.delAttr({data:{shopId:n.userData.currentShop.id,brandId:n.userData.currentShop.brandId,id:t.id}});case 2:e.sent&&(n.taste=n.taste.filter(function(n){return n.id!=t.id}),n.paging());case 4:case"end":return e.stop()}},e,n)}))()},paging:function(){this.total=Math.ceil(this.taste.length/this.num),this.showTaste=this.taste.slice((this.page-1)*this.num,(this.page-1)*this.num+this.num)},numChange:function(t){this.num=t,this.paging(),console.log(t)},pageClick:function(t){this.page=t,this.paging(),console.log(t)},closeGetAddAttrWin:function(t,n){switch(t){case"edit":this.taste=this.taste.map(function(t){return t.id==n.id?n:t}),this.taste=this.sortAttr(this.taste);break;case"add":this.taste.push(n),this.taste=this.sortAttr(this.taste);break;case"delete":this.taste=this.taste.filter(function(t){return t.id!=n})}this.paging(),this.showCom=""},funGetSyncAttr:function(t){this.showCom="","update"==t&&this.funGetAttr()},openAttrWin:function(t){console.log(t),this.showCom="attrAdd";var n=null,e=null;t?(n=t.id,e="编辑口味"):(e="添加口味",n=null),this.comObj={title:e,editId:n,taste:this.taste}},sortAttr:function(t){return t.sort(function(t,n){return t.sort==n.sort?t.id-n.id:Number(t.sort)-Number(n.sort)})},funGetAttr:function(){var t=this;return a(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.getAttr({data:{shopId:t.shopId}});case 2:e=n.sent,console.log(e),t.taste=e,t.taste=t.sortAttr(t.taste),t.paging();case 7:case"end":return n.stop()}},n,t)}))()}},components:{attrAdd:function(){return e.e("attr_add_win").then(e.bind(null,"2593"))},attrAsync:function(){return e.e("attr_sync_win").then(e.bind(null,"c67b"))}},filters:{divide:function(t){return t.length<7?t:t.substr(0,7)+"..."}}},c=(e("0c60"),e("6ceb")),u=Object(c.a)(o,r,[],!1,null,"79f11534",null);u.options.__file="src\\module\\goods_config\\attr_manager.vue";n.default=u.exports},ccbb:function(t,n,e){}}]);