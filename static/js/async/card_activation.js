(window.webpackJsonp=window.webpackJsonp||[]).push([["card_activation"],{"809e":function(t,e,a){},"9f0c":function(t,e,a){t.exports=a.p+"images/cardActive.8c752b3f.png"},c1be:function(t,e,a){"use strict";var s=a("809e");a.n(s).a},f388:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"card-activation"}},[a("div",{staticClass:"containter"},[a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("卡属门店")]),t._v(" "),"0"==t.ischain?a("span",{staticClass:"fl belongshop"},[t._v(t._s(t.currentShop.name))]):t._e(),t._v(" "),"3"==t.ischain?a("a",{staticClass:"fl choicebtn",attrs:{href:"javascript:void(0)"},on:{click:t.choseShop}},[t._v("选择门店")]):t._e(),t._v(" "),-1!=t.shopIndex?a("span",{staticClass:"fl choice"},[t._v("已选择"+t._s(t.shopList[t.shopIndex].shopName))]):t._e()]),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("激活方式")]),t._v(" "),t._l(t.goodlist,function(e,s){return[e.type?a("span",{staticClass:"way",class:{signa:t.type==s},on:{click:function(e){t.tabTypes(s,1)}}},[t._v(t._s(e.name))]):t._e()]})],2),t._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"0"==t.type,expression:"type == '0'"}]},[t._m(0),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("选择卡类型")]),t._v(" "),a("a",{staticClass:"fl choicebtn",attrs:{href:"javascript:void(0)"},on:{click:t.choseCardType}},[t._v("选择卡类型")]),t._v(" "),-1!=t.virtualCard.cradTypeIndex?a("span",{staticClass:"fl choice"},[t._v("已选择"+t._s(t.cradTypeList[t.virtualCard.cradTypeIndex].name))]):t._e()]),t._v(" "),""!=t.virtualCard.selectCardType?a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub"}),t._v(" "),a("div",{staticClass:"fl show"},[a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡类型")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v(t._s(t.virtualCard.selectCardType.name))])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("购卡金额")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v("￥"+t._s(t.virtualCard.selectCardType.price))])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡内金额")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v("￥"+t._s(t.virtualCard.selectCardType.cardAmount))])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡内积分")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v(t._s(t.virtualCard.selectCardType.cardPoint)+"分")])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡包内容")]),t._v(" "),a("div",{staticClass:"fl show-r"},[""==t.virtualCard.selectCardType.cardCoupon?a("p",[t._v("无")]):t._l(t.virtualCard.selectCardType.cardCoupon,function(e,s){return a("p",{key:s},[t._v(t._s(s+1+".赠送优惠卷: "+e.name+" "+e.num+"张"))])})],2)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.virtualCard.selectCardType.discount+""!="100",expression:"virtualCard.selectCardType.discount+'' !== '100'"}],staticClass:"show-box"},[a("p",{staticClass:"enjoy"},[t._v("享受【"+t._s(t.virtualCard.selectCardType.name)+"】专属折扣 "+t._s(~~t.virtualCard.selectCardType.discount/10)+" 折")])])])]):t._e(),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("填写卡编号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.virtualCard.cardNo,expression:"virtualCard.cardNo"}],staticClass:"fl",attrs:{type:"text",placeholder:"请输入实体卡号",maxlength:"8"},domProps:{value:t.virtualCard.cardNo},on:{change:t.validateNumber,input:function(e){e.target.composing||t.$set(t.virtualCard,"cardNo",e.target.value)}}}),t._v(" "),a("a",{staticClass:"operation fl",attrs:{href:"javascript:void(0)"},on:{click:t.getCardNo}},[t._v("自动补填")]),t._v(" "),a("span",{staticClass:"Correct",class:{complete:1==t.virtualCard.validateNoLog,err:2==t.virtualCard.validateNoLog}})]),t._v(" "),t._m(1),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("手机")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.virtualCard.consumerPhone,expression:"virtualCard.consumerPhone"}],staticClass:"fl",attrs:{type:"text",placeholder:"请输入手机号码"},domProps:{value:t.virtualCard.consumerPhone},on:{input:function(e){e.target.composing||t.$set(t.virtualCard,"consumerPhone",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("姓名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.virtualCard.consumerName,expression:"virtualCard.consumerName"}],staticClass:"fl",attrs:{type:"text",placeholder:"请输入姓名"},domProps:{value:t.virtualCard.consumerName},on:{input:function(e){e.target.composing||t.$set(t.virtualCard,"consumerName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("性别")]),t._v(" "),t._l(t.genderList,function(e,s){return[e.type?a("span",{staticClass:"way",class:{signa:t.virtualCard.genderType==s},on:{click:function(e){t.tabTypes(s,2)}}},[t._v(t._s(e.name))]):t._e()]})],2),t._v(" "),a("div",{staticClass:"online-box clearfix "},[a("span",{staticClass:"fl online-sub required"},[t._v("生日")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.virtualCard.consumerBirthday,expression:"virtualCard.consumerBirthday"}],staticClass:"fl",attrs:{type:"text",placeholder:"如:19940412",maxlength:"8"},domProps:{value:t.virtualCard.consumerBirthday},on:{input:function(e){e.target.composing||t.$set(t.virtualCard,"consumerBirthday",e.target.value)}}})]),t._v(" "),t._m(2),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub "}),t._v(" "),a("a",{staticClass:"delete",attrs:{href:"javascript:void(0)"}},[t._v("删除")]),t._v(" "),a("a",{staticClass:"save",attrs:{href:"javascript:void(0)"},on:{click:t.activationCard}},[t._v("保存")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"readCard"==t.entityCard.pageMode&&"1"==t.type,expression:"entityCard.pageMode == 'readCard' && type == '1'"}],staticClass:"readCard"},[t._m(3)]),t._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:("acticeCard"==t.entityCard.pageMode||"noCardActive"==t.entityCard.pageMode)&&"1"==t.type,expression:"(entityCard.pageMode == 'acticeCard' || entityCard.pageMode== 'noCardActive') && type == '1'"}]},[t._m(4),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("选择卡类型")]),t._v(" "),a("a",{staticClass:"fl choicebtn",attrs:{href:"javascript:void(0)"},on:{click:t.choseCardType}},[t._v("选择卡类型")]),t._v(" "),-1!=t.entityCard.cradTypeIndex?a("span",{staticClass:"fl choice"},[t._v("已选择"+t._s(t.cradTypeList[t.entityCard.cradTypeIndex].name))]):t._e()]),t._v(" "),""!=t.entityCard.selectCardType?a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub"}),t._v(" "),a("div",{staticClass:"fl show"},[a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡类型")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v(t._s(t.entityCard.selectCardType.name))])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("购卡金额")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v("￥"+t._s(t.entityCard.selectCardType.price))])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡内金额")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v("￥"+t._s(t.entityCard.selectCardType.cardAmount))])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡内积分")]),t._v(" "),a("div",{staticClass:"fl show-r"},[a("p",[t._v(t._s(t.entityCard.selectCardType.cardPoint)+"分")])])]),t._v(" "),a("div",{staticClass:"show-box"},[a("span",{staticClass:"fl"},[t._v("卡包内容")]),t._v(" "),a("div",{staticClass:"fl show-r"},[""==t.entityCard.selectCardType.cardCoupon?a("p",[t._v("无")]):t._l(t.entityCard.selectCardType.cardCoupon,function(e,s){return a("p",{key:s},[t._v(t._s(s+1+".赠送优惠卷: "+e.name+" "+e.num+"张"))])})],2)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.entityCard.selectCardType.discount+""!="100",expression:"entityCard.selectCardType.discount+'' !== '100'"}],staticClass:"show-box"},[a("p",{staticClass:"enjoy"},[t._v("享受【"+t._s(t.entityCard.selectCardType.name)+"】专属折扣 "+t._s(~~t.entityCard.selectCardType.discount/10)+" 折")])])])]):t._e(),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub required"},[t._v("填写卡编号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.entityCard.cardNo,expression:"entityCard.cardNo"}],staticClass:"fl",attrs:{type:"text",placeholder:"请输入实体卡号",maxlength:"8"},domProps:{value:t.entityCard.cardNo},on:{change:t.validateNumber,input:function(e){e.target.composing||t.$set(t.entityCard,"cardNo",e.target.value)}}}),t._v(" "),a("a",{staticClass:"operation fl",attrs:{href:"javascript:void(0)"},on:{click:t.getCardNo}},[t._v("自动补填")]),t._v(" "),a("span",{staticClass:"Correct",class:{complete:1==t.entityCard.validateNoLog,err:2==t.entityCard.validateNoLog}})]),t._v(" "),t._m(5),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub"},[t._v("手机")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.entityCard.consumerPhone,expression:"entityCard.consumerPhone"}],staticClass:"fl",attrs:{type:"text",placeholder:"请输入手机号码"},domProps:{value:t.entityCard.consumerPhone},on:{input:function(e){e.target.composing||t.$set(t.entityCard,"consumerPhone",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub"},[t._v("姓名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.entityCard.consumerName,expression:"entityCard.consumerName"}],staticClass:"fl",attrs:{type:"text",placeholder:"请输入姓名"},domProps:{value:t.entityCard.consumerName},on:{input:function(e){e.target.composing||t.$set(t.entityCard,"consumerName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub"},[t._v("性别")]),t._v(" "),t._l(t.genderList,function(e,s){return[e.type?a("span",{staticClass:"way",class:t.entityCard.genderType==s?"signa":"",on:{click:function(e){t.tabTypes(s,2)}}},[t._v(t._s(e.name))]):t._e()]})],2),t._v(" "),a("div",{staticClass:"online-box clearfix "},[a("span",{staticClass:"fl online-sub ",class:"0"==t.type?"required":""},[t._v("生日")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.entityCard.consumerBirthday,expression:"entityCard.consumerBirthday"}],staticClass:"fl",attrs:{type:"text",placeholder:"如:19940412",maxlength:"8"},domProps:{value:t.entityCard.consumerBirthday},on:{input:function(e){e.target.composing||t.$set(t.entityCard,"consumerBirthday",e.target.value)}}})]),t._v(" "),t._m(6),t._v(" "),a("div",{staticClass:"online-box clearfix"},[a("span",{staticClass:"fl online-sub "}),t._v(" "),a("a",{staticClass:"delete",attrs:{href:"javascript:void(0)"}},[t._v("删除")]),t._v(" "),a("a",{staticClass:"save",attrs:{href:"javascript:void(0)"},on:{click:t.activationCard}},[t._v("保存")])])])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[a(t.showCom,{tag:"component",attrs:{postObj:t.comObj},on:{toClick:t.getReturnInfo}})],1)],1)},i=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"titles"},[this._v("会员卡信息")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"titles"},[this._v("会员卡补充")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"online-box clearfix"},[e("span",{staticClass:"fl online-sub "}),this._v(" "),e("div",{staticClass:"fl handle-tips"},[e("i"),this._v(" "),e("p",[this._v("1、激活卡时无需进行支付,由品牌核发,计入门店实体卡统计,购卡金额0元")]),this._v(" "),e("p",[this._v("2、虚拟卡激活必须填写会员基本信息否则不予激活")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"readBox"},[e("img",{attrs:{width:"260",src:a("9f0c"),alt:""}}),this._v(" "),e("p",{staticClass:"readInfo"},[this._v("请放置实体卡保持与读卡机器接触")]),this._v(" "),e("p",{staticClass:"readInfo"},[this._v("在读卡完成前请不要拿走或移动卡")]),this._v(" "),e("p",{staticClass:"readInfo"},[this._v("识别成功后将自动跳转到新的页面")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"titles"},[this._v("会员卡信息")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"titles"},[this._v("会员卡补充")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"online-box clearfix"},[e("span",{staticClass:"fl online-sub "}),this._v(" "),e("div",{staticClass:"fl handle-tips"},[e("i"),this._v(" "),e("p",[this._v("1、激活卡时无需进行支付,由品牌核发,计入门店实体卡统计,购卡金额0元")]),this._v(" "),e("p",[this._v("2、虚拟卡激活必须填写会员基本信息否则不予激活")])])])}];s._withStripped=!0;var r=a("81a2"),n=a("f6ce");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function s(i,r){try{var n=e[i](r),o=n.value}catch(t){return void a(t)}if(!n.done)return Promise.resolve(o).then(function(t){s("next",t)},function(t){s("throw",t)});t(o)}("next")})}}var d={data:function(){return{ischain:"",currentShop:{},shopList:{},shopInfoIndex:0,shopInfo:"",selectShop:"",shopIndex:-1,goodlist:[{type:"0",name:"虚拟卡激活"},{type:"1",name:"实体卡激活"}],genderList:[{type:"0",name:"女"},{type:"1",name:"男"}],type:"0",cradTypeList:[],virtualCard:{selectCardType:"",cradTypeIndex:-1,cardNo:"",validateNoLog:0,memberCardId:"",cardKey:"",consumerPhone:"",consumerName:"",consumerBirthday:"",genderType:"0"},entityCard:{pageMode:"noCardActive",selectCardType:"",cradTypeIndex:-1,cardNo:"",validateNoLog:0,memberCardId:"",cardKey:"",consumerPhone:"",consumerName:"",consumerBirthday:"",genderType:"0"},napaStoresOn:[],directSaletOn:[],showCom:"",comObj:{}}},methods:{tabTypes:function(t,e){if(1==e){if("3"==this.ischain&&""==this.selectShop)return this.$store.commit("setWin",{title:"提示",content:"请先选择卡属门店"}),!1;this.type=t,"1"==this.type?(this.entityCard.pageMode="readCard",this.markCard()):this.entityCard.pageMode="noCardActive"}else 2==e&&("0"==this.type?this.virtualCard.genderType=t:this.entityCard.genderType=t)},markCard:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("3"!=t.ischain||""!=t.selectShop){e.next=3;break}return t.$store.commit("setWin",{title:"提示信息",content:"请选择卡属门店"}),e.abrupt("return",!1);case 3:return e.next=5,a.e("entity_card_ws").then(a.bind(null,"b52e"));case 5:s=(s=e.sent).default,(i=new s("openCard",t.selectShop.id?t.selectShop.id:t.currentShop.shopId,function(e,a){e&&a?(t.entityCard.memberCardId=e,t.entityCard.cardKey=a,i.disconnect(),t.entityCard.pageMode="acticeCard"):t.$store.commit("setWin",{title:"温馨提示",content:"不可能出现的错误"})},function(e){if("dataError"==e)t.$store.commit("setWin",{title:"温馨提示",content:"数据格式错误"});else{var a=e&&e.message||"当前IC卡有问题或者网络连接错误,读卡失败";t.$store.commit("setWin",{title:"温馨提示",content:a})}i.disconnect(),i.start()})).start();case 9:case"end":return e.stop()}},e,t)}))()},choseCardType:function(){return"3"==this.ischain&&""==this.selectShop?(this.$store.commit("setWin",{title:"操作提示",content:"请选择卡属门店"}),!1):0==this.cradTypeList.length?(this.$store.commit("setWin",{title:"操作提示",content:"暂无卡类型,请去新建卡类型吧"}),!1):(this.showCom="chooseCardType",void(this.comObj={cradTypeList:this.cradTypeList,type:this.type,virtualCradTypeIndex:this.virtualCard.cradTypeIndex,virtualSelectCardType:this.virtualCard.selectCardType,entityCradTypeIndex:this.entityCard.cradTypeIndex,entitySelectCardType:this.entityCard.selectCardType,virtualCardNo:this.virtualCard.cardNo,virtualValidateNoLog:this.virtualCard.validateNoLog}))},choseShop:function(){if(0==this.shopList.length)return this.$store.commit("setWin",{title:"操作提示",content:"暂无门店"}),!1;this.showCom="chooseStores",this.comObj={shopList:this.shopList,shopIndex:this.shopIndex,selectShop:this.selectShop}},getReturnInfo:function(t){t.res&&("ok"==t.res&&("chooseCardType"==this.showCom?"0"==this.type?(console.log(this.virtualCard.cradTypeIndex),this.virtualCard.cradTypeIndex=t.postIndex,this.virtualCard.selectCardType=t.postSelectCardType):(this.entityCard.cradTypeIndex=t.postIndex,this.entityCard.selectCardType=t.postSelectCardType):"chooseStores"==this.showCom&&(this.shopIndex=t.postIndex,this.selectShop=t.postSelectShop,this.openCard(),this.getCardType(),this.virtualCard.cradTypeIndex=-1,this.virtualCard.selectCardType="",this.entityCard.cradTypeIndex=-1,this.entityCard.selectCardType="")),this.showCom="")},validateNumber:function(){var t="";if("3"==this.ischain&&""==this.selectShop)return this.$store.commit("setWin",{title:"提示",content:"请先选择卡属门店"}),!1;if(!("0"!=this.type||this.virtualCard.selectCardType&&this.virtualCard.selectCardType.cardId))return this.$store.commit("setWin",{title:"提示",content:"请先选择卡的类型"}),!1;if(!("1"!=this.type||this.entityCard.selectCardType&&this.entityCard.selectCardType.cardId))return this.$store.commit("setWin",{title:"提示",content:"请先选择卡的类型"}),!1;if("0"==this.type){if(!/^\d{8}$/.test(this.virtualCard.cardNo))return void(this.virtualCard.validateNoLog=2);t={cardId:this.virtualCard.selectCardType.cardId,memberCardId:this.virtualCard.memberCardId,number:this.virtualCard.cardNo,subShopId:this.selectShop.id?this.selectShop.id:this.currentShop.shopId}}else{if(!/^\d{8}$/.test(this.entityCard.cardNo))return void(this.entityCard.validateNoLog=2);t={cardId:this.entityCard.selectCardType.cardId,memberCardId:this.entityCard.memberCardId,number:this.entityCard.cardNo,subShopId:this.selectShop.id?this.selectShop.id:this.currentShop.shopId}}this.getAutoCardNumber(t)},getCardType:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.entitycardGetCardList({data:{subShopId:t.selectShop.id?t.selectShop.id:t.currentShop.shopId}});case 2:a=e.sent,t.cradTypeList=a;case 4:case"end":return e.stop()}},e,t)}))()},getCardNo:function(){var t="";return"3"==this.ischain&&""==this.selectShop?(this.$store.commit("setWin",{title:"提示",content:"请先选择卡属门店"}),!1):("0"!=this.type||this.virtualCard.selectCardType&&this.virtualCard.selectCardType.cardId)&&("1"!=this.type||this.entityCard.selectCardType&&this.entityCard.selectCardType.cardId)?(t="0"==this.type?{cardId:this.virtualCard.selectCardType.cardId,memberCardId:this.virtualCard.memberCardId,subShopId:this.selectShop.id?this.selectShop.id:this.currentShop.shopId}:{cardId:this.entityCard.selectCardType.cardId,memberCardId:this.entityCard.memberCardId,subShopId:this.selectShop.id?this.selectShop.id:this.currentShop.shopId},void this.getAutoCardNumber(t)):(this.$store.commit("setWin",{title:"提示",content:"请先选择卡的类型"}),!1)},validataData:function(){if("1"==this.type){if(1!=this.entityCard.validateNoLog)return this.$store.commit("setWin",{title:"温馨提示",content:"请先输入正确的卡编号"}),!1;if(null===this.entityCard.selectCardType)return this.$store.commit("setWin",{title:"温馨提示",content:"请选择实体卡的类型"}),!1;if(this.entityCard.consumerPhone&&!/^1[3456789]\d{9}$/.test(this.entityCard.consumerPhone))return this.$store.commit("setWin",{title:"温馨提示",content:"手机号码格式有误"}),!1;if(8==this.entityCard.consumerBirthday.length){if(!this.formatBirthday)return this.$store.commit("setWin",{title:"温馨提示",content:"请输入正确的生日格式，正确的格式应该为4位的年份+2位的月份+2位的日期的连续八位数字"}),!1;if(+new Date<this.formatBirthday)return this.$store.commit("setWin",{title:"温馨提示",content:"输入的生日不能大于当前时间,请不要调皮:D"}),!1}else if(this.entityCard.consumerBirthday.length>0)return this.$store.commit("setWin",{title:"温馨提示",content:"请输入正确的生日格式，正确的格式应该为4位的年份+2位的月份+2位的日期的连续八位数字"}),!1;if(this.entityCard.consumerName&&!/^([\u4E00-\u9FA5A-Za-z]+\s?)*$/.test(this.entityCard.consumerName))return this.$store.commit("setWin",{title:"温馨提示",content:"姓名只能是中文和英文组成"}),!1}else if("0"==this.type){if(1!=this.virtualCard.validateNoLog)return this.$store.commit("setWin",{title:"温馨提示",content:"请先输入正确的卡编号"}),!1;if(null===this.virtualCard.selectCardType)return this.$store.commit("setWin",{title:"温馨提示",content:"请选择实体卡的类型"}),!1;if(0==this.virtualCard.consumerPhone.length)return this.$store.commit("setWin",{title:"温馨提示",content:"虚拟卡激活必须填写手机号码"}),!1;if(!/^1[3456789]\d{9}$/.test(this.virtualCard.consumerPhone))return this.$store.commit("setWin",{title:"温馨提示",content:"手机号码格式有误"}),!1;if(!this.virtualCard.consumerName)return this.$store.commit("setWin",{title:"温馨提示",content:"虚拟卡激活必须输入姓名"}),!1;if(!/^([\u4E00-\u9FA5A-Za-z]+\s?)*$/.test(this.virtualCard.consumerName))return this.$store.commit("setWin",{title:"温馨提示",content:"姓名只能是中文和英文组成"}),!1;if(!this.formatBirthday)return this.$store.commit("setWin",{title:"温馨提示",content:"请输入正确的生日格式，正确的格式应该为4位的年份+2位的月份+2位的日期的连续八位数字"}),!1;if(+new Date<this.formatBirthday)return this.$store.commit("setWin",{title:"温馨提示",content:"输入的生日不能大于当前时间,请不要调皮:D"}),!1}return!0},activationCard:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.validataData()){e.next=2;break}return e.abrupt("return");case 2:return a="",a="0"==t.type?{subShopId:t.selectShop.id?t.selectShop.id:t.currentShop.shopId,memberCardId:t.virtualCard.memberCardId,cardKey:t.virtualCard.cardKey,cardId:t.virtualCard.selectCardType.cardId,number:parseInt(t.virtualCard.cardNo),mobile:t.virtualCard.consumerPhone,name:t.virtualCard.consumerName,gender:Number(t.virtualCard.genderType),birthday:t.formatBirthday/1e3>>0}:{subShopId:t.selectShop.id?t.selectShop.id:t.currentShop.shopId,memberCardId:t.entityCard.memberCardId,cardKey:t.entityCard.cardKey,cardId:t.entityCard.selectCardType.cardId,number:parseInt(t.entityCard.cardNo),mobile:t.entityCard.consumerPhone,name:t.entityCard.consumerName,gender:Number(t.entityCard.genderType),birthday:t.formatBirthday/1e3>>0},e.next=6,r.a.activateEntityCard({data:a});case 6:1==e.sent&&t.$store.commit("setWin",{title:"操作提示",content:"激活成功"}),window.location.reload();case 9:case"end":return e.stop()}},e,t)}))()},openCard:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.entitycardOpenCard({data:{memberCardId:"",cardKey:"",subShopId:t.selectShop.id?t.selectShop.id:t.currentShop.shopId}});case 2:(a=e.sent).memberCardId&&a.cardKey&&(t.virtualCard.memberCardId=a.memberCardId,t.virtualCard.cardKey=a.cardKey);case 4:case"end":return e.stop()}},e,t)}))()},getAutoCardNumber:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.getAutoCardNumber({data:t});case 2:s=a.sent,"0"==e.type?(e.virtualCard.cardNo=s,e.virtualCard.validateNoLog=1):(e.entityCard.cardNo=s,e.entityCard.validateNoLog=1);case 4:case"end":return a.stop()}},a,e)}))()}},mounted:function(){var t=n.a.session("userShop"),e={shopId:t.currentShop.id,name:t.currentShop.name,shopNumber:t.currentShop.shopNumber,initCardNumber:0,num:0};[].push(e),this.ischain=t.currentShop.ischain,this.currentShop="0"==t.currentShop.ischain?e:{},this.shopList=n.a.session("shopList"),"0"==this.ischain&&(this.getCardType(),this.openCard())},computed:{formatBirthday:function(){if("0"==this.type){if(8==this.virtualCard.consumerBirthday.length){if(-1!=this.virtualCard.consumerBirthday.toString().indexOf("."))return void this.$store.commit("setWin",{title:"操作提示",content:"请输入正确的生日格式，正确的格式应该为4位的年份+2位的月份+2位的日期的连续八位数字"});var t=this.virtualCard.consumerBirthday.split(""),e=t[0]+t[1]+t[2]+t[3]+"/"+t[4]+t[5]+"/"+t[6]+t[7];return Date.parse(e)?(console.log("生日"+e+":"+Date.parse(e)),Date.parse(e)):0}return 0}if(8==this.entityCard.consumerBirthday.length){if(-1!=this.entityCard.consumerBirthday.toString().indexOf("."))return void this.$store.commit("setWin",{title:"操作提示",content:"请输入正确的生日格式，正确的格式应该为4位的年份+2位的月份+2位的日期的连续八位数字"});var a=this.entityCard.consumerBirthday.split(""),s=a[0]+a[1]+a[2]+a[3]+"/"+a[4]+a[5]+"/"+a[6]+a[7];return Date.parse(s)?(console.log("生日"+s+":"+Date.parse(s)),Date.parse(s)):0}return 0}},components:{chooseCardType:function(){return a.e("choose_cardType_win").then(a.bind(null,"71287"))},chooseStores:function(){return a.e("card_stores_win").then(a.bind(null,"3587"))}}},c=(a("c1be"),a("6ceb")),l=Object(c.a)(d,s,i,!1,null,"4a01b5d3",null);l.options.__file="src\\module\\member_system\\card_activation.vue";e.default=l.exports}}]);