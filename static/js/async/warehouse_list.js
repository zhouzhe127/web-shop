(window.webpackJsonp=window.webpackJsonp||[]).push([["warehouse_list"],{"1a14":function(e,t,n){"use strict";n.r(t);var i=n("f6ce"),r=n("bbb9"),s=n("81a2");function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function i(r,s){try{var a=t[r](s),o=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)});e(o)}("next")})}}var o=null,l={data:function(){return{allList:[],filterList:[],list:[],listLength:0,page:1,showNum:10,pageTotal:1,province:"",city:"",town:"",provinceName:"",cityName:"",townName:"",place:"",isShare:"",owner:"",ownerName:"",ownerSel:[],ownerArr:[],visible:!1,dropName:"请选择所属",code:"",name:"",filterObj:"",userData:"",brandId:"",toggleCom:0}},components:{pageBtn:function(){return n.e("page_element").then(n.bind(null,"5921"))},addressLinkage:function(){return n.e("address_linkage").then(n.bind(null,"4867"))},selectStore:function(){return n.e("select_store").then(n.bind(null,"60ff"))},operationCom:function(){return n.e("operation").then(n.bind(null,"6c7a"))}},created:function(){this.userData=i.a.session("userShop")},mounted:function(){"3"==this.userData.currentShop.ischain&&(this.brandId=this.userData.currentShop.id),this.initBtn(),this.getRequest(),this.getList();var e=i.a.session("warehouseManagerTab");1==e&&(this.toggleCom=e,i.a.session("warehouseManagerTab",null))},methods:{initBtn:function(){var e=this,t=[{name:"查看全部",className:"primary",type:5,fn:function(){i.a.session("warehouseListsRequest",e.filterObj),e.$router.push({path:"warehouseList/searchGoods",query:e.$route.query})}},{name:"新建仓库",className:"primary",type:4,fn:function(){e.$router.push({path:"warehouseList/create",query:e.$route.query})}}];this.$store.commit("setPageTools",t)},listHandle:function(e){i.a.session("warehouseListsRequest",this.filterObj),this.$route.query.id=e.id,this.$router.push({path:"warehouseList/warehouseDetail",query:this.$route.query})},getOwners:function(){var e=this;return a(regeneratorRuntime.mark(function t(){var n,i,r,a,o,l,c,u,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.invoicing_getOwners();case 2:if(n=t.sent,i=[],!n){t.next=24;break}for(r=!0,a=!1,o=void 0,t.prev=8,l=n[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)u=c.value,h={selected:!0},3==u.ischain?(h.id=u.brandId+",0",h.name=u.brandName):u.brandId?(h.id=u.brandId+","+u.shopId,h.name=u.brandName+"-"+u.shopName):(h.id="0,"+u.shopId,h.name=u.shopName),i.push(h);t.next=16;break;case 12:t.prev=12,t.t0=t.catch(8),a=!0,o=t.t0;case 16:t.prev=16,t.prev=17,!r&&l.return&&l.return();case 19:if(t.prev=19,!a){t.next=22;break}throw o;case 22:return t.finish(19);case 23:return t.finish(16);case 24:e.owner=i,e.ownerSel=e.owner.map(function(e){return e.id}),e.ownerArr=e.ownerSel;case 27:case"end":return t.stop()}},t,e,[[8,12,16,24],[17,,19,23]])}))()},ownerClose:function(){this.visible=!1,this.ownerSel=this.ownerArr},selOwnerAll:function(e){this.ownerSel=1===e?this.owner.map(function(e){return e.id}):[]},ownerHandle:function(e){var t=this;this.visible=!1,1===e?(this.ownerArr=this.ownerSel,this.page=1,this.filter(),this.ownerSel.length>1?this.ownerName=" 已选中"+this.ownerSel.length+"个":1==this.ownerSel.length?this.ownerName=this.owner.filter(function(e){return t.ownerSel[0]==e.id})[0].name:this.ownerName=""):this.ownerSel=this.ownerArr},getList:function(){var e=this;return a(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.warehouseWarehouseList();case 2:n=t.sent,e.allList=n,e.listLength=n.length,e.filter();case 6:case"end":return t.stop()}},t,e)}))()},getRequest:function(){var e=i.a.session("warehouseListsDestroy"),t=i.a.session("warehouseListsRequest");if(e){if(t)for(var n in t)this[n]=t[n]}else this.getOwners();i.a.session("warehouseListsDestroy",null),i.a.session("warehouseListsRequest",null)},filterClick:function(){this.page=1,this.filter()},filter:function(){var e={code:this.code,name:this.name,owner:this.ownerArr,province:this.province,city:this.city,town:this.town,place:this.place,isShared:this.isShare};this.filterObj=e,this.condition(e),this.paging()},reset:function(){for(var e in this.filterObj)if("owner"==e){var t=r.a.deepCopy(this.owner),n=!0,i=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){a.value.selected=!0}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}this.owner=t}else this[e]="";this.filter()},paging:function(){this.pageTotal=Math.ceil(this.filterList.length/this.showNum);var e=(this.page-1)*this.showNum,t=this.page*this.showNum;t>this.filterList.length&&(t=this.filterList.length),this.list=this.filterList.slice(e,t),this.getAreaCn()},condition:function(e){var t=r.a.deepCopy(this.allList);for(var n in e){var i=[];if(""!=e[n]){if("owner"==n){var s=!0,a=!1,o=void 0;try{for(var l,c=e.owner[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var u=l.value,h=!0,d=!1,p=void 0;try{for(var v,f=t[Symbol.iterator]();!(h=(v=f.next()).done);h=!0){var w=v.value;w.owner==u&&i.push(w)}}catch(e){d=!0,p=e}finally{try{!h&&f.return&&f.return()}finally{if(d)throw p}}}}catch(e){a=!0,o=e}finally{try{!s&&c.return&&c.return()}finally{if(a)throw o}}}else{var m=!0,b=!1,g=void 0;try{for(var y,_=t[Symbol.iterator]();!(m=(y=_.next()).done);m=!0){var k=y.value;k[n].includes(e[n])&&i.push(k)}}catch(e){b=!0,g=e}finally{try{!m&&_.return&&_.return()}finally{if(b)throw g}}}t=i}}this.filterList=t},setShared:function(e){return 0==e?"非共享":1==e?"共享":void 0},clickCheck:function(){"0"===this.isShare?this.isShare="":this.isShare="0",this.page=1,this.filter()},pageChange:function(e,t){t?this.page=e:this.showNum=e,this.filter()},getAreaCn:function(){var e=this;return a(regeneratorRuntime.mark(function t(){var i,s,a,l,c,u,h,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e("area_cn").then(n.bind(null,"f529"));case 2:for(i=t.sent,o=i.default,s=r.a.deepCopy(e.list),a=!0,l=!1,c=void 0,t.prev=8,u=s[Symbol.iterator]();!(a=(h=u.next()).done);a=!0)(d=h.value).provinceName=o.getNameByCode(d.province),d.cityName=o.getNameByCode(d.city),d.townName=o.getNameByCode(d.town);t.next=16;break;case 12:t.prev=12,t.t0=t.catch(8),l=!0,c=t.t0;case 16:t.prev=16,t.prev=17,!a&&u.return&&u.return();case 19:if(t.prev=19,!l){t.next=22;break}throw c;case 22:return t.finish(19);case 23:return t.finish(16);case 24:e.list=s;case 25:case"end":return t.stop()}},t,e,[[8,12,16,24],[17,,19,23]])}))()},getAddress:function(e){this.province=e.province,this.city=e.city,this.town=e.area,this.page=1,this.filter()}}},c=(n("9a4e"),n("d801")),u=Object(c.a)(l,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"warehouse-lists"},[n("div",{staticClass:"choose-btn"},[n("el-radio-group",{model:{value:e.toggleCom,callback:function(t){e.toggleCom=t},expression:"toggleCom"}},[n("el-radio-button",{attrs:{label:"0"}},[e._v("仓库列表")]),e._v(" "),n("el-radio-button",{attrs:{label:"1"}},[e._v("操作记录")])],1)],1),e._v(" "),0==e.toggleCom?n("div",[n("div",{staticClass:"filter"},[n("div",{staticClass:"block"},[n("div",{staticClass:"inline-box"},[n("el-input",{staticClass:"el-input",attrs:{placeholder:"请输入仓库编号"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),e._v(" "),n("div",{staticClass:"inline-box"},[n("el-input",{staticClass:"el-input",attrs:{placeholder:"请输入仓库名称"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),n("div",{staticClass:"inline-box"},[n("span",{staticClass:"inline-span"},[e._v("仓库所属：")]),e._v(" "),n("el-popover",{attrs:{placement:"bottom",width:"500",trigger:"click"},on:{hide:e.ownerClose},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("div",{staticClass:"btn-box"},[n("el-checkbox-group",{model:{value:e.ownerSel,callback:function(t){e.ownerSel=t},expression:"ownerSel"}},e._l(e.owner,function(t,i){return n("div",{key:i,staticClass:"btn-cell"},[n("el-checkbox",{attrs:{label:t.id,border:""}},[e._v(e._s(t.name))])],1)}))],1),e._v(" "),n("div",{staticClass:"sel-all"},[n("el-button",{attrs:{type:"info",size:"mini"},on:{click:e.selOwnerAll}},[e._v("取消全部")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.selOwnerAll(1)}}},[e._v("选择全部")])],1),e._v(" "),n("div",{staticClass:"handle"},[n("el-button",{attrs:{type:"text"},on:{click:e.ownerHandle}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.ownerHandle(1)}}},[e._v("确认")])],1),e._v(" "),n("el-input",{staticClass:"el-input",attrs:{slot:"reference","suffix-icon":"el-icon-arrow-down",placeholder:"请选择所属"},slot:"reference",model:{value:e.ownerName,callback:function(t){e.ownerName=t},expression:"ownerName"}})],1)],1)]),e._v(" "),n("div",{staticClass:"block"},[n("div",{staticClass:"inline-box"},[e._v("\n\t\t\t\t\t\t仓库地址：\n\t\t\t\t\t\t"),n("addressLinkage",{attrs:{province:e.province,city:e.city,area:e.town},on:{emit:e.getAddress}})],1),e._v(" "),n("div",{staticClass:"inline-box"},[n("el-input",{staticClass:"el-input",attrs:{placeholder:"请输入详细地址"},model:{value:e.place,callback:function(t){e.place=t},expression:"place"}})],1),e._v(" "),n("div",{staticClass:"inline-box input-check select-ban"},[n("i",{class:{active:"0"===this.isShare},on:{click:e.clickCheck}}),e._v("\n\t\t\t\t\t\t非共享\n\t\t\t\t\t")]),e._v(" "),n("div",{staticClass:"inline-box button-box"},[n("el-button",{attrs:{type:"primary"},on:{click:e.filterClick}},[e._v("筛选")]),e._v(" "),n("el-button",{attrs:{type:"info"},on:{click:e.reset}},[e._v("重置")])],1)])]),e._v(" "),n("div",{staticClass:"main"},[n("div",{staticClass:"list"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,stripe:"",border:""}},[n("el-table-column",{attrs:{prop:"name",label:"仓库名称"}}),e._v(" "),n("el-table-column",{attrs:{label:"共享状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t        \t"+e._s(e.setShared(t.row.isShared))+"\n\t\t\t\t\t      \t")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"code",label:"仓库编号"}}),e._v(" "),n("el-table-column",{attrs:{prop:"ownerName",label:"仓库所属"}}),e._v(" "),n("el-table-column",{attrs:{prop:"area.length",label:"区域总数"}}),e._v(" "),n("el-table-column",{attrs:{label:"商品种类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t        \t"+e._s(Number(t.row.KindWeightKg||t.row.kindWeightKg)+Number(t.row.kindGoods)+Number(t.row.kindWeightG))+"\n\t\t\t\t\t      \t")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"kindMaterial",label:"物料种类"}}),e._v(" "),n("el-table-column",{attrs:{label:"仓库地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t        \t"+e._s(t.row.provinceName)+" "+e._s(t.row.cityName)+" "+e._s(t.row.townName)+" "+e._s(t.row.place)+"\n\t\t\t\t\t      \t")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.listHandle(t.row)}}},[e._v("查看详情")])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"page-box"},[n("el-pagination",{attrs:{"current-page":e.page,background:"",layout:"sizes,total,prev, pager, next","page-sizes":[10,20,50],total:e.listLength},on:{"current-change":function(t){e.pageChange(t,1)},"size-change":e.pageChange}})],1)])]):e._e(),e._v(" "),1==e.toggleCom?n("operation-com"):e._e()],1)},[],!1,null,"0e04710b",null);t.default=u.exports},"56e8":function(e,t,n){},"9a4e":function(e,t,n){"use strict";var i=n("56e8");n.n(i).a}}]);