(window.webpackJsonp=window.webpackJsonp||[]).push([["shop_notice_win"],{"571a":function(t,e,n){},"5dd3":function(t,e,n){"use strict";var i=n("571a");n.n(i).a},"5ede":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"noticeWin"}},[n("el-form",{ref:"redDetial",attrs:{model:t.redDetial,rules:t.rules,"label-width":"140px"}},[n("el-form-item",{attrs:{label:"通知标题",prop:"title"}},[n("el-input",{staticStyle:{width:"250px"},attrs:{maxlength:"20",placeholder:"请输入通知标题"},model:{value:t.redDetial.title,callback:function(e){t.$set(t.redDetial,"title",e)},expression:"redDetial.title"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"通知时间"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期"},model:{value:t.redDetial.time,callback:function(e){t.$set(t.redDetial,"time",e)},expression:"redDetial.time"}})],1)],1),t._v(" "),n("div",{staticClass:"noticeWin",staticStyle:{height:"380px"}},[n("h2",{staticClass:"tag"},[t._v("正文")]),t._v(" "),n("div",{staticClass:"mes"},[n("div",{ref:"editor",staticClass:" toolbar",staticStyle:{"text-align":"left","max-width":"800px","padding-top":"30px"},attrs:{id:"div1"}})])]),t._v(" "),n("div",{staticClass:"noticeWin"},[n("h2",{staticClass:"tag"}),t._v(" "),n("el-button",{staticStyle:{width:"100px",float:"left"},attrs:{type:"primary"},on:{click:function(e){t.addNotice(!1)}}},[t._v("提交")]),t._v(" "),n("a",{staticClass:"wearhouse",staticStyle:{margin:"0px 10px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.addNotice(!0)}}},[t._v("保存草稿")]),t._v(" "),n("a",{staticClass:"wearhouse create",staticStyle:{color:"#b3b3b3","border-color":"#b3b3b3"},attrs:{href:"javascript:void(0);"},on:{click:t.back}},[t._v("返回")])],1)],1)};i._withStripped=!0;var r=n("81a2"),a=n("05dd"),o=n("f6ce");function s(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(r,a){try{var o=e[r](a),s=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});t(s)}("next")})}}var c={data:function(){return{type:0,ischain:"",rules:{title:[{required:!0,message:"请输入通知标题",trigger:"blur"}],time:[{required:!0,message:"请选择时间",trigger:"blur"}]}}},props:{isAdd:Boolean,redDetial:Object},mounted:function(){var t=this;return s(regeneratorRuntime.mark(function e(){var i,r,s,c,l,u,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.a.session("userShop"),t.ischain=i.currentShop.ischain,t.redDetial.time=1e3*t.redDetial.time,t.$store.commit("setPageTools",[]),r=o.a.session("token"),s=o.a.session("shopId"),c=t.random(1,100).toString(),l=o.a.session("userShop").uploadUrl,e.next=10,n.e("wang_editor").then(function(){var t=n("00e8");return"object"==typeof t&&t&&t.__esModule?t:Object.assign({},"object"==typeof t&&t,{default:t})});case 10:u=e.sent,(d=new u.default("#div1")).customConfig.uploadImgServer=a.a.host.shop+"image/uploadImage?oid="+c+"&format=script&token="+r+"&type=8&shopId="+s,d.customConfig.uploadFileName="image",d.customConfig.onchange=function(e){t.redDetial.content=e},d.customConfig.uploadImgHooks={customInsert:function(t,e){t(l+e.data)}},d.create(),!t.isAdd&&t.redDetial.content&&d.txt.html(t.redDetial.content);case 18:case"end":return e.stop()}},e,t)}))()},methods:{clickResult:function(t){this.$emit("openTwo",t)},random:function(t,e){return Math.floor(Math.random()*(e-t))+t},addNotice:function(t){var e=this;return s(regeneratorRuntime.mark(function n(){var i,a,o,s,c,l,u,d;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=function(t){return t.replace(/<[^>img]+>/g,"")},(i={}).time=e.redDetial.time/1e3,i.title=e.redDetial.title,i.content=e.redDetial.content,0!=i.title.length){n.next=8;break}return e.$store.commit("setWin",{winType:"alert",content:"请输入通知标题！"}),n.abrupt("return",!1);case 8:if(0!=i.time){n.next=11;break}return e.$store.commit("setWin",{winType:"alert",content:"请选择通知时间"}),n.abrupt("return",!1);case 11:for(o=i.content,s=a(o),c=s.split("&nbsp;"),l=!1,u=0;u<c.length;u++)c[u].replace(/\s+/g,"").length>0&&(l=!0);if(l||(i.content=""),!e.isAdd){n.next=30;break}return i.type=Number(t),n.next=21,r.a.addNotice({data:i});case 21:if(!(d=n.sent)||!t){n.next=27;break}return e.$store.commit("setWin",{winType:"alert",content:"已保存至草稿箱"}),n.abrupt("return");case 27:d&&!t&&e.$store.commit("setWin",{winType:"alert",content:"添加成功"});case 28:n.next=37;break;case 30:return i.type=Number(t),i.newType=Number(t),i.id=e.redDetial.id,n.next=35,r.a.editNoticeOne({data:i});case 35:n.sent&&e.$store.commit("setWin",{winType:"alert",content:"修改成功"});case 37:e.$emit("openTwo","add");case 38:case"end":return n.stop()}},n,e)}))()},back:function(){this.$emit("openTwo","back")},isOk:function(t){return 0!=t.title.length||(this.$store.commit("setWin",{winType:"alert",content:"请输入通知标题！"}),!1)}}},l=(n("5dd3"),n("6ceb")),u=Object(l.a)(c,i,[],!1,null,"26995c7a",null);u.options.__file="src\\module\\shop_config\\shop_notice_win.vue";e.default=u.exports}}]);