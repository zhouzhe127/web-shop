(window.webpackJsonp=window.webpackJsonp||[]).push([["shop_notice_win"],{"5dd3":function(t,e,n){"use strict";var i=n("9ca8");n.n(i).a},"5ede":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"noticeWin"}},[n("div",{staticClass:"noticeWin"},[n("h2",{staticClass:"required tag"},[t._v("通知标题")]),t._v(" "),n("div",{staticClass:"mes"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.redDetial.title,expression:"redDetial.title"}],staticClass:"input",staticStyle:{width:"350px",border:"1px solid #ccc"},attrs:{type:"text",maxlength:"20",placeholder:"请输入通知标题"},domProps:{value:t.redDetial.title},on:{input:function(e){e.target.composing||t.$set(t.redDetial,"title",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"noticeWin"},[n("h2",{staticClass:"required tag"},[t._v("通知时间")]),t._v(" "),n("div",{staticClass:"mes"},[n("calendar",{staticStyle:{width:"245px",height:"41px",float:"left"},attrs:{pObj:t.startObj},on:{throwTime:t.getStartTime}})],1)]),t._v(" "),n("div",{staticClass:"noticeWin",staticStyle:{height:"380px"}},[n("h2",{staticClass:"required tag"},[t._v("正文")]),t._v(" "),n("div",{staticClass:"mes"},[n("div",{ref:"editor",staticClass:" toolbar",staticStyle:{"text-align":"left","max-width":"800px","padding-top":"30px"},attrs:{id:"div1"}})])]),t._v(" "),n("div",{staticClass:"noticeWin"},[n("h2",{staticClass:"tag"}),t._v(" "),n("a",{staticClass:"blue",staticStyle:{width:"100px",height:"40px","line-height":"40px",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.addNotice(!1)}}},[t._v("提交")]),t._v(" "),n("a",{staticClass:"wearhouse",staticStyle:{margin:"0px 10px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.addNotice(!0)}}},[t._v("保存草稿")]),t._v(" "),n("a",{staticClass:"wearhouse create",staticStyle:{color:"#b3b3b3","border-color":"#b3b3b3"},attrs:{href:"javascript:void(0);"},on:{click:t.back}},[t._v("返回")])])])};i._withStripped=!0;var a=n("81a2"),r=n("05dd"),o=n("f6ce");function s(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,r){try{var o=e[a](r),s=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});t(s)}("next")})}}var c={data:function(){return{startTime:"",startObj:{},type:0}},props:{isAdd:Boolean,redDetial:Object},components:{calendar:function(){return n.e("calendar_result").then(n.bind(null,"9265"))}},mounted:function(){var t=this;return s(regeneratorRuntime.mark(function e(){var i,a,s,c,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.startTime=1e3*t.redDetial.time,t.startObj={time:t.startTime},t.$store.commit("setPageTools",[]),i=o.a.session("token"),a=o.a.session("shopId"),s=t.random(1,100).toString(),c=o.a.session("userShop").uploadUrl,e.next=9,n.e("wang_editor").then(function(){var t=n("00e8");return"object"==typeof t&&t&&t.__esModule?t:Object.assign({},"object"==typeof t&&t,{default:t})});case 9:l=e.sent,(d=new l.default("#div1")).customConfig.uploadImgServer=r.a.host.shop+"image/uploadImage?oid="+s+"&format=script&token="+i+"&type=8&shopId="+a,d.customConfig.uploadFileName="image",d.customConfig.onchange=function(e){t.redDetial.content=e},d.customConfig.uploadImgHooks={customInsert:function(t,e){t(c+e.data)}},d.create(),!t.isAdd&&t.redDetial.content&&d.txt.html(t.redDetial.content);case 17:case"end":return e.stop()}},e,t)}))()},methods:{clickResult:function(t){this.$emit("openTwo",t)},getStartTime:function(t){this.startTime=t},random:function(t,e){return Math.floor(Math.random()*(e-t))+t},addNotice:function(t){var e=this;return s(regeneratorRuntime.mark(function n(){var i,r,o,s,c,l,d;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=function(t){return t.replace(/<[^>img]+>/g,"")},(i={}).time=e.startTime/1e3,i.title=e.redDetial.title,i.content=e.redDetial.content,i.type=Number(t),0!=i.title.length){n.next=9;break}return e.$store.commit("setWin",{winType:"alert",content:"请输入通知标题！"}),n.abrupt("return",!1);case 9:for(o=i.content,s=r(o),c=s.split("&nbsp;"),l=!1,d=0;d<c.length;d++)c[d].replace(/\s+/g,"").length>0&&(l=!0);if(l){n.next=17;break}return e.$store.commit("setWin",{winType:"alert",content:"请输入通知内容！"}),n.abrupt("return",!1);case 17:if(1!=i.type||"0"!=e.redDetial.type){n.next=20;break}return e.$store.commit("setWin",{winType:"alert",content:"已经发布不能变更为草稿"}),n.abrupt("return",!1);case 20:if(!e.isAdd){n.next=27;break}return n.next=23,a.a.addNotice({data:i});case 23:n.sent&&e.$store.commit("setWin",{winType:"alert",content:"添加成功"}),n.next=32;break;case 27:return i.id=e.redDetial.id,n.next=30,a.a.editNoticeOne({data:i});case 30:n.sent&&e.$store.commit("setWin",{winType:"alert",content:"修改成功"});case 32:e.$emit("openTwo","add");case 33:case"end":return n.stop()}},n,e)}))()},back:function(){this.$emit("openTwo","back")},isOk:function(t){return 0!=t.title.length||(this.$store.commit("setWin",{winType:"alert",content:"请输入通知标题！"}),!1)}}},l=(n("5dd3"),n("7610")),d=Object(l.a)(c,i,[],!1,null,"26995c7a",null);d.options.__file="src\\module\\shop_config\\shop_notice_win.vue";e.default=d.exports},"9ca8":function(t,e,n){}}]);