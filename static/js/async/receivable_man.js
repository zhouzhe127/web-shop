(window.webpackJsonp=window.webpackJsonp||[]).push([["receivable_man"],{"470e":function(t,e,n){},c0c8:function(t,e,n){"use strict";var i=n("470e");n.n(i).a},fc57:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"receivableMan"}},[t.showClearing?t._e():n("section",{staticClass:"seac_top",staticStyle:{height:"50px"}},[n("selectBtn",{attrs:{sorts:t.accountType.map(function(t){return t.name}),width:160,name:t.typeName},on:{emit:t.selectType}}),t._v(" "),n("span",[t._v("-")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.seachValue,expression:"seachValue"}],staticClass:"input",staticStyle:{border:"1px solid #ccc",width:"200px"},attrs:{type:"text",maxlength:"11",placeholder:"请输入账户名称/联系人/电话"},domProps:{value:t.seachValue},on:{input:function(e){e.target.composing||(t.seachValue=e.target.value)}}}),t._v(" "),n("a",{staticClass:"blue",staticStyle:{width:"110px",height:"40px","line-height":"40px"},attrs:{href:"javascript:;"},on:{click:t.seachFn}},[t._v("筛选")]),t._v(" "),n("a",{staticClass:"gray",staticStyle:{width:"110px",height:"40px","line-height":"40px"},attrs:{href:"javascript:;"},on:{click:t.resetFn}},[t._v("重置")])],1),t._v(" "),t.showClearing?t._e():n("section",{staticClass:"allList"},[n("com-table",{attrs:{listHeight:50,listName:"挂账账户列表",fixed:1,listWidth:1e3,showTitle:1,introData:t.list,titleData:t.titleList,allTotal:t.recList.length},scopedSlots:t._u([{key:"con-0",fn:function(e){return n("div",{},["3"==t.ischain?n("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:function(n){t.toShop(e.data)}}},[t._v("指派")]):t._e(),t._v(" "),"3"==t.ischain?n("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]):t._e(),t._v(" "),n("span",{staticStyle:{color:"#FE8D2C",cursor:"pointer"},on:{click:function(n){t.clearing(e.data)}}},[t._v("结算")]),t._v(" "),n("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),n("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:function(n){t.getDetial(e.data)}}},[t._v("详情")]),t._v(" "),n("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),n("span",{staticStyle:{color:"#FD950E",cursor:"pointer"},on:{click:function(n){t.edit(e.data)}}},[t._v("编辑")]),t._v(" "),n("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),"0"==e.data.status?n("span",{staticStyle:{color:"#FD3F03",cursor:"pointer"},on:{click:function(n){t.stopman(e.data,e.index)}}},[t._v("停用")]):t._e(),t._v(" "),1==e.data.status?n("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:function(n){t.stopman(e.data,e.index)}}},[t._v("启用")]):t._e(),t._v(" "),n("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),n("span",{staticStyle:{color:"#FE3D06",cursor:"pointer"},on:{click:function(n){t.delman(e.data,e.index)}}},[t._v("删除")])])}},{key:"con-1",fn:function(e){return n("div",{},[2==e.data.type?n("span",[t._v("企业用户")]):t._e(),t._v(" "),1==e.data.type?n("span",[t._v("个人用户")]):t._e()])}},{key:"con-2",fn:function(e){return n("div",{},[1==e.data.isAppoint?n("span",{staticStyle:{color:"#fe9200"}},[t._v(t._s(e.data.name))]):t._e(),t._v(" "),0==e.data.isAppoint?n("span",{style:{color:"1"==t.ischain||"2"==t.ischain?"#29abe2":"#333"}},[t._v(t._s(e.data.name))]):t._e()])}},{key:"con-5",fn:function(e){return n("div",{},[2==e.data.type?n("span",[t._v(t._s(e.data.personNum)+"人")]):t._e(),t._v(" "),1==e.data.type?n("span",[t._v(t._s(e.data.contactMan))]):t._e()])}},{key:"con-6",fn:function(e){return n("div",{},[1*e.data.singlePrice==0?n("span",[t._v("无上限")]):t._e(),t._v(" "),1*e.data.singlePrice>0?n("span",[t._v(t._s(e.data.singlePrice))]):t._e()])}},{key:"con-7",fn:function(e){return n("div",{},[1*e.data.allPrice==0?n("span",[t._v("无上限")]):t._e(),t._v(" "),1*e.data.allPrice>0?n("span",[t._v(t._s(e.data.allPrice))]):t._e()])}}])},["1"==t.ischain||"2"==t.ischain?n("div",{attrs:{slot:"title"},slot:"title"},[n("span",{staticStyle:{"font-size":"16px","margin-right":"20px"}},[t._v("挂账账户列表 · 共"+t._s(t.recList.length)+"个条目")]),t._v(" "),n("span",{staticClass:"aSpan"},[n("i",{staticClass:"aI"}),t._v("品牌指派\n\t\t\t\t")]),t._v(" "),n("span",{staticClass:"aSpan",staticStyle:{color:"#2ea7e0"}},[n("i",{staticClass:"aI",staticStyle:{background:"#2ea7e0"}}),t._v("门店自建\n\t\t\t\t")])]):t._e()])],1),t._v(" "),t.showClearing?t._e():n("div",{staticStyle:{"margin-top":"10px"}},[n("pageElement",{attrs:{page:t.currentPage,total:t.totalNum,num:t.num,isNoJump:!0},on:{pageNum:t.pageClick}})],1),t._v(" "),t.showMan?n("add-receivable-man",{attrs:{manDetial:t.manDetial,isAdd:t.isAdd},on:{winResult:t.doResult}}):t._e(),t._v(" "),t.showShop?n("shopsSelect",{attrs:{shopIds:""},on:{shopsSelect:t.shopResult}}):t._e(),t._v(" "),t.showClearing?n("clearingReceivable",{attrs:{manDetial:t.manDetial,isAClearing:t.isAClearing},on:{clearResult:t.clearingResult}}):t._e()],1)};i._withStripped=!0;var a=n("81a2"),s=n("f6ce"),r=n("bbb9");function c(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,s){try{var r=e[a](s),c=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(c).then(function(t){i("next",t)},function(t){i("throw",t)});t(c)}("next")})}}var o={data:function(){return{shopId:"",ischain:"",accountType:[{name:"全部",id:0},{name:"个人用户",id:1},{name:"企业用户",id:2}],recType:0,typeName:"请选择账户类型",seachValue:"",manDetial:{},showMan:!1,showClearing:!1,showShop:!1,recList:[],copyRecList:[],titleList:[{titleName:"操作",titleStyle:{width:"30%"}},{titleName:"账户类型",titleStyle:{width:"10%"},dataName:"type"},{titleName:"账户名称",titleStyle:{width:"10%"},dataName:"name"},{titleName:"联系人",titleStyle:{width:"10%"},dataName:"contactMan"},{titleName:"电话",titleStyle:{width:"10%"},dataName:"mobile"},{titleName:"挂账人",titleStyle:{width:"10%"},dataName:"contactMan"},{titleName:"挂账额度(单笔)",titleStyle:{width:"10%"},dataName:"singlePrice"},{titleName:"挂账额度(总额)",titleStyle:{width:"10%"},dataName:"allPrice"}],isAClearing:!1,currentPage:1,num:10}},mounted:function(){this.isTatle()},computed:{totalNum:function(){return Math.ceil(this.recList.length/this.num)},list:function(){var t=(this.currentPage-1)*this.num,e=this.currentPage*this.num;return this.recList.slice(t,e)}},components:{selectBtn:function(){return n.e("select_btn").then(n.bind(null,"3d41"))},AddReceivableMan:function(){return n.e("add_receivable_man").then(n.bind(null,"8fc5"))},clearingReceivable:function(){return n.e("clearing_receivable").then(n.bind(null,"db5e"))},comTable:function(){return n.e("table").then(n.bind(null,"4360"))},pageElement:function(){return n.e("page_element").then(n.bind(null,"5921"))},shopsSelect:function(){return n.e("shops_select").then(n.bind(null,"a997"))}},created:function(){var t=s.a.session("userShop");this.shopId=t.currentShop.id,this.ischain=t.currentShop.ischain,this.init()},methods:{pageClick:function(t){this.currentPage=t.page,this.num=t.num},isTatle:function(){var t=[{name:"添加挂账账户",className:["addStaff","export-btn"],fn:this.add,type:2}];this.$store.commit("setPageTools",t)},init:function(){var t=this;return c(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getBillList();case 2:n=e.sent,t.recList=n,t.copyRecList=n;case 5:case"end":return e.stop()}},e,t)}))()},selectType:function(t){console.log(t),this.recType=t,this.typeName=this.accountType[t].name},seachFn:function(){var t=[];this.currentPage=1;for(var e=this.copyRecList,n=0;n<e.length;n++){var i=e[n].name,a=e[n].mobile,s=e[n].contactMan;this.seachValue.trim().length>0&&-1==i.indexOf(this.seachValue)&&-1==a.indexOf(this.seachValue)&&-1==s.indexOf(this.seachValue)||(0!=this.recType&&this.recType!=e[n].type||t.push(e[n]))}this.recList=t,0==this.seachValue.trim().length&&0==this.recType&&(this.recList=this.copyRecList)},resetFn:function(){this.seachValue="",this.recType=0,this.typeName="请选择账户类型",this.recList=this.copyRecList},add:function(){this.showMan=!0,this.isAdd=!0,this.manDetial={name:"",type:"1",contactMan:"",mobile:"",singlePrice:"",allPrice:"",billPerson:[]}},edit:function(t){var e=this;return c(regeneratorRuntime.mark(function n(){var i,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.showMan=!0,e.isAdd=!1,t.billPerson=[],e.manDetial=t,n.next=6,a.a.getOneBill({data:{billId:t.id}});case 6:for(i=n.sent,s=0;s<i.billPerson.length;s++)i.billPerson[s].isEdit=!1;e.manDetial=i;case 9:case"end":return n.stop()}},n,e)}))()},delman:function(t,e){var n=this;this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确定删除帐号名称为“"+t.name+"”的帐号吗?",callback:function(i){"ok"==i&&n.deleteBill(t,e)}})},clearing:function(t){var e=this;return c(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.getOneBill({data:{billId:t.id}});case 2:e.manDetial=n.sent,e.showClearing=!0,e.isAClearing=!0;case 5:case"end":return n.stop()}},n,e)}))()},getDetial:function(t){var e=this;return c(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.getOneBill({data:{billId:t.id}});case 2:e.manDetial=n.sent,e.showClearing=!0,e.isAClearing=!1;case 5:case"end":return n.stop()}},n,e)}))()},stopman:function(t,e){var n=this;this.manDetial=t,this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确定停用帐号名称为“"+t.name+"”的帐号吗?",callback:function(i){"ok"==i&&n.isStopman(t,e)}})},isStopman:function(t,e){var n=this;return c(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.a.changeBillStatus({data:{billId:t.id,status:"0"==t.status?"1":"0"}});case 2:i.sent&&(n.recList[e].status=1==n.recList[e].status?0:1);case 4:case"end":return i.stop()}},i,n)}))()},deleteBill:function(t,e){var n=this;return c(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.a.deleteBill({data:{billId:t.id}});case 2:i.sent&&n.recList.splice(e,1);case 4:case"end":return i.stop()}},i,n)}))()},toShop:function(t){this.showShop=!0,this.manDetial=t},doResult:function(t,e){var n=this;return c(regeneratorRuntime.mark(function i(){var s,c,o,l,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if("ok"!=t){i.next=26;break}if(!n.isOk(e)){i.next=23;break}for(s=[],c=r.a.deepCopy(e),o=e.billPerson,l=0;l<o.length;l++)u="",u=o[l].name+","+o[l].mobile,s.push(u);if(c.billPerson=s,n.manDetial=e,!n.isAdd){i.next=15;break}return i.next=11,a.a.createBill({data:c});case 11:i.sent&&(n.recList.push(e),n.$store.commit("setWin",{winType:"alert",content:"添加成功！"}),n.init(),n.showMan=!1),i.next=21;break;case 15:return c.billId=c.id,i.next=18,a.a.editBill({data:c});case 18:i.sent&&(n.$store.commit("setWin",{winType:"alert",content:"修改成功！"}),n.showMan=!1,n.init()),console.log(n.manDetial);case 21:i.next=24;break;case 23:n.showMan=!0;case 24:i.next=27;break;case 26:n.showMan=!1;case 27:case"end":return i.stop()}},i,n)}))()},shopResult:function(t,e){if("ok"==t){if(""==e)return this.$store.commit("setWin",{winType:"alert",content:"请选择要指派的店铺！"}),!1;var n={};n.billId=this.manDetial.id,n.shopIds=e,console.log(n),this.selectShop(n)}this.showShop=!1},selectShop:function(t){var e=this;return c(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.billAppoint({data:t});case 2:n.sent&&e.$store.commit("setWin",{winType:"alert",content:"指派成功！"});case 4:case"end":return n.stop()}},n,e)}))()},clearingResult:function(){var t=[{name:"添加挂账账户",className:["addStaff","export-btn"],fn:this.add,type:2}];this.$store.commit("setPageTools",t),this.showClearing=!1},isOk:function(t){var e=/^1[\d]{10,10}$/;if(0==t.name.trim().length)return this.$store.commit("setWin",{winType:"alert",content:"账户名称不能为空"}),!1;if(0==t.contactMan.trim().length)return this.$store.commit("setWin",{winType:"alert",content:"联系人不能为空"}),!1;if(0==t.mobile.trim().length)return this.$store.commit("setWin",{winType:"alert",content:"手机号不能为空"}),!1;if(""!==t.mobile&&!e.test(t.mobile)||11!=t.mobile.length)return this.$store.commit("setWin",{winType:"alert",content:"手机号格式错误。"}),!1;if(2==t.type){if(t.billPerson.length<1)return this.$store.commit("setWin",{winType:"alert",content:"企业账户则必须添加一个挂账人"}),!1;for(var n=0;n<t.billPerson.length;n++){if(0==t.billPerson[n].name.trim().length)return this.$store.commit("setWin",{winType:"alert",content:"挂账人姓名不能为空"}),!1;if(0==t.billPerson[n].mobile.trim().length)return this.$store.commit("setWin",{winType:"alert",content:"挂账人手机号不能为空"}),!1;if(""!==t.billPerson[n].mobile&&!e.test(t.billPerson[n].mobile||11!=t.billPerson[n].mobile.length))return this.$store.commit("setWin",{winType:"alert",content:"手机号格式错误。"}),!1}}var i=/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/;return t.singlePrice.trim().length>0&&!i.test(t.singlePrice)?(this.$store.commit("setWin",{content:"单笔额度请输入正确的数字!"}),!1):t.allPrice.trim().length>0&&!i.test(t.allPrice)?(this.$store.commit("setWin",{content:"总额度请输入正确的数字!"}),!1):!(""!==t.singlePrice&&""!==t.allPrice&&1*t.singlePrice>1*t.allPrice)||(this.$store.commit("setWin",{winType:"alert",content:"单笔额度不能大于总额"}),!1)}}},l=(n("c0c8"),n("7610")),u=Object(l.a)(o,i,[],!1,null,"47863ee2",null);u.options.__file="src\\module\\shop_config\\receivable_man.vue";e.default=u.exports}}]);