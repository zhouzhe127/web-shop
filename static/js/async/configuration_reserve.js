(window.webpackJsonp=window.webpackJsonp||[]).push([["configuration_reserve"],{2884:function(t,e,a){"use strict";a.r(e);var i=a("f6ce"),s=a("81a2"),n=a("05dd");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(s,n){try{var r=e[s](n),c=r.value}catch(t){return void a(t)}if(!r.done)return Promise.resolve(c).then(function(t){i("next",t)},function(t){i("throw",t)});t(c)}("next")})}}var c={data:function(){return{shopId:null,timeWarn:["关闭提醒","10分钟","20分钟","30分钟"],reserveTime:["10分钟","20分钟","30分钟"],payWays:[{id:5,name:"定金支付"},{id:1,name:"全额支付"}],delays:[{id:0,name:"不延长"},{id:1,name:"延长"}],permit:[{id:0,name:"不允许"},{id:1,name:"允许"}],order:{status:"",payType:5,payAttr:"",red:!1},table:{tableRemindTime:"关闭提醒",show:0},wei:{wechatRemindTime:"关闭提醒",show:0},delay:{show:0,isExtendSeat:"10分钟",red:!1},cancel:{show:0,isCancel:"",arr:[{time:"",value:"",red:!1}],other:""},returnBack:{show:0,isReturn:"",red:!1}}},methods:{changeRadio:function(t,e){var a=t.id;switch(e){case"pay":this.order.payType=a;break;case"order":this.cancel.show=a;break;case"delay":this.delay.show=a;break;case"refund":this.returnBack.show=a}},funGetOnOff:function(t){this.order.status=t?1:0},funAddDelTag:function(t){t?this.cancel.arr.pop():this.cancel.arr.push({time:"",value:"",red:!1})},getDeskTimeRemind:function(t){this.table.tableRemindTime=this.timeWarn[t]},getWeiTimeRemind:function(t){this.wei.wechatRemindTime=this.timeWarn[t]},getReserve:function(t){this.delay.isExtendSeat=this.reserveTime[t]},editSave:function(){var t=this;if(1!=this.order.status||this.checkData()){var e=this.formatData();this.updateReserveConfig(e).then(function(){t.$store.commit("setWin",{title:"温馨提示",content:"保存成功!"})})}},getRemind:function(t){var e=null;switch(""+t){case"-1":case"0":case"":e="关闭提醒";break;default:e=t+"分钟"}return e},formatRemind:function(t){var e=null;switch(""+t){case"关闭提醒":e="-1";break;default:e=t.slice(0,-2)}return e},checkData:function(){var t=this;if(5==this.order.payType){if(!n.a.checkData({payAttr:{reg:/^[1-9]\d{0,1}$/,pro:"请输入请输入正确的定金支付折扣率 1-99!"}},this.order))return this.order.red=!0,!1;this.order.red=!1}if(this.cancel.show){if(this.cancel.arr.some(function(e,a){var i=/^[1-9]\d{0,1}$/,s="请输入1-2位的数字百分比!";return/^[1-9]\d{0,2}$/.test(e.time)?(0==a&&(i=/^((?!0)\d{1,2}|100)$/,s="请输入1-3位的数字百分比!"),i.test(e.value)?void(e.red=!1):(t.$store.commit("setWin",{title:"温馨提示",content:s}),e.red=!0,!0)):(t.$store.commit("setWin",{title:"温馨提示",content:"请输入1-3位的数字时间!"}),e.red=!0,!0)}))return!1}if(this.returnBack.show){if(!n.a.checkData({isReturn:{reg:/^[1-9]\d{0,1}$/,pro:"请输入请输入1-2位的整数订单折扣率!"}},this.returnBack))return this.returnBack.red=!0,!1;this.returnBack.red=!1}return!0},formatData:function(){var t={};if(t.shopId=this.shopId,0==this.order.status)t.status=0;else{if(t.status=1,t.payType=this.order.payType,t.payAttr=5==this.order.payType?this.order.payAttr:"",t.tableRemindTime=this.formatRemind(this.table.tableRemindTime),t.wechatRemindTime=this.formatRemind(this.wei.wechatRemindTime),this.cancel.show){var e=[];e[0]=0;var a;this.cancel.arr.forEach(function(t){e.push("_"+t.value+","),e.push(t.time)}),e.push("_"+this.cancel.other),a=e.join(""),t.isCancel=a}else t.isCancel="";t.isExtendSeat=1==this.delay.show?this.delay.isExtendSeat:0,t.isReturn=1==this.returnBack.show?this.returnBack.isReturn:0}return t},initData:function(){var t=i.a.session("userShop");this.shopId=t.currentShop.id},getReserveConfig:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getReserveConfig({data:{shopId:t.shopId}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,t)}))()},updateReserveConfig:function(t){var e=this;return r(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.updateReserveConfig({data:t});case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}},a,e)}))()}},mounted:function(){var t=this;this.initData(),this.getReserveConfig().then(function(e){if(t.order.status=1==e.status?1:0,t.order.payType=e.payType,t.order.payAttr=5==e.payType?e.payAttr:"",0==t.order.payType&&(t.order.payType=1),t.cancel.show=e.isCancel?1:0,t.cancel.show){t.cancel.isCancel=e.isCancel;var a=e.isCancel.split(",");a.length>1&&t.funAddDelTag(!1);var i=[];a.forEach(function(t){var e=t.split("_");i.push.apply(i,function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}(e))}),t.cancel.other=i.pop(),i.shift(),i.forEach(function(e,a){var i=Math.floor(a/2);a%2?t.cancel.arr[i].time=e:t.cancel.arr[i].value=e,t.cancel.arr[i].red=!1})}t.delay.show=0==e.isExtendSeat?0:1,t.delay.show&&(t.delay.isExtendSeat=e.isExtendSeat+"分钟"),t.returnBack.show=0==e.isReturn?0:1,t.returnBack.show&&(t.returnBack.isReturn=e.isReturn),t.table.tableRemindTime=t.getRemind(e.tableRemindTime),t.wei.wechatRemindTime=t.getRemind(e.wechatRemindTime)})},components:{onOff:function(){return a.e("on_off").then(a.bind(null,"034b"))},radio:function(){return a.e("radio").then(a.bind(null,"4dfe"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))}}},l=(a("503c"),a("d801")),o=Object(l.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"configuration-reserve"}},[a("div",{staticClass:"re-title",staticStyle:{position:"relative"}},[t._m(0),t._v(" "),a("on-off",{attrs:{status:1==t.order.status},on:{statusChange:t.funGetOnOff}}),t._v(" "),0==t.order.status?a("a",{staticClass:"yellow head-save",attrs:{href:"javascript:void(0);"},on:{click:t.editSave}},[t._v("保存")]):t._e()],1),t._v(" "),1==t.order.status?a("div",{attrs:{id:"con-hide"}},[a("div",{staticClass:"re-content"},[a("div",{staticClass:"way",staticStyle:{height:"100px"}},[t._m(1),t._v(" "),a("div",{staticClass:"pagWay",staticStyle:{float:"left"}},t._l(t.payWays,function(e,i){return a("span",{key:i,class:{sign:t.order.payType==e.id},on:{click:function(a){t.changeRadio(e,"pay")}}},[t._v(t._s(e.name))])})),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),5==t.order.payType?a("div",{staticClass:"way-con"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.order.payAttr,expression:"order.payAttr"}],class:{redi:t.order.red},staticStyle:{width:"178px"},attrs:{type:"text",maxlength:"2"},domProps:{value:t.order.payAttr},on:{input:function(e){e.target.composing||t.$set(t.order,"payAttr",e.target.value)}}}),t._v(" "),a("div",{staticClass:"wc-p"},[t._v("\n\t\t\t\t\t\t%\n\t\t\t\t\t")])]):t._e()]),t._v(" "),a("div",{staticClass:"way"},[t._m(2),t._v(" "),a("div",{staticClass:"al-con"},[a("div",{staticClass:"al-l"},[a("div",{staticClass:"ac-text"},[t._v("\n\t\t\t\t\t\t\t桌台提醒:\n\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"wc-list",staticStyle:{"margin-left":"10px","margin-top":"10px",display:"inline-block"}},[a("select-btn",{attrs:{sorts:t.timeWarn,name:t.table.tableRemindTime},on:{selOn:t.getDeskTimeRemind}})],1)]),t._v(" "),a("div",{staticClass:"al-l"},[a("div",{staticClass:"ac-text"},[t._v("\n\t\t\t\t\t\t\t微信提醒:\n\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"wc-list",staticStyle:{"margin-left":"10px",float:"left","margin-top":"10px",display:"inline-block"}},[a("select-btn",{attrs:{sorts:t.timeWarn,name:t.wei.wechatRemindTime},on:{selOn:t.getWeiTimeRemind}})],1),t._v(" "),a("div",{staticClass:"ac-text",staticStyle:{width:"120px","margin-left":"18px"}},[t._v("\n\t\t\t\t\t\t\t提醒顾客到店\n\t\t\t\t\t\t")])])])]),t._v(" "),a("div",{staticClass:"way"},[t._m(3),t._v(" "),a("div",{staticClass:"al-con"},[a("div",{staticClass:"al-l"},[a("div",{staticClass:"ac-text"},[t._v("\n\t\t\t\t\t\t\t是否允许取消订单:\n\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"way-con",staticStyle:{"margin-left":"10px"}},[a("div",{staticClass:"pagWay",staticStyle:{float:"left"}},t._l(t.permit,function(e,i){return a("span",{key:i,class:{sign:t.cancel.show==e.id},on:{click:function(a){t.changeRadio(e,"order")}}},[t._v(t._s(e.name))])}))])]),t._v(" "),a("div",{staticClass:"al-l",staticStyle:{height:"auto"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.cancel.show,expression:"cancel.show==1"}],staticClass:"ac-text"},[t._v("\n\t\t\t\t\t\t\t到店前取消规则:\n\t\t\t\t\t\t")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.cancel.show,expression:"cancel.show==1"}],staticClass:"ac-bordr"},[t._l(t.cancel.arr,function(e,i){return[a("div",{key:i,staticClass:"ac-options"},[0==i?a("div",{staticClass:"ac-text",staticStyle:{width:"80px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t提前\n\t\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),0!=i&&t.cancel.arr.length>1?a("div",{staticClass:"ac-text",staticStyle:{width:"80px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(t.cancel.arr[i-1].time)+"分钟 --\n\t\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),a("div",{staticClass:"way-con",staticStyle:{"margin-left":"10px",width:"92px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.time,expression:"item.time"}],class:{redi:e.red},staticStyle:{width:"94px",height:"36px"},attrs:{type:"text",maxlength:"3"},domProps:{value:e.time},on:{input:function(a){a.target.composing||t.$set(e,"time",a.target.value)}}}),t._v(" "),a("div",{staticClass:"wc-p"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t分钟内\n\t\t\t\t\t\t\t\t\t\t")])]),t._v(" "),a("div",{staticClass:"ac-text",staticStyle:{width:"30px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t退\n\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"way-con",staticStyle:{"margin-left":"10px",width:"94px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],class:{redi:e.red},staticStyle:{width:"84px",height:"36px"},attrs:{type:"text",maxlength:"3"},domProps:{value:e.value},on:{input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}}}),t._v(" "),a("div",{staticClass:"wc-p",staticStyle:{right:"16px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t%\n\t\t\t\t\t\t\t\t\t\t")])]),t._v(" "),t.cancel.arr.length<2?a("div",{staticClass:"ac-icon ac-add",on:{click:function(e){t.funAddDelTag(!1)}}}):t._e(),t._v(" "),t.cancel.arr.length>1&&0!=i?a("div",{staticClass:"ac-icon ac-del",on:{click:function(e){t.funAddDelTag(!0)}}}):t._e()])]}),t._v(" "),a("div",{staticClass:"ac-bottom"},[a("div",{staticClass:"ac-text",staticStyle:{width:"102px","margin-top":"10px","margin-left":"80px","text-align":"center"}},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(t.cancel.arr[t.cancel.arr.length-1].time)+"分钟外\n\t\t\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"ac-text",staticStyle:{width:"30px"}},[t._v("\n\t\t\t\t\t\t\t\t\t退\n\t\t\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"way-con",staticStyle:{"margin-left":"10px",width:"94px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cancel.other,expression:"cancel.other"}],staticStyle:{width:"84px",height:"36px"},attrs:{type:"text",maxlength:"3"},domProps:{value:t.cancel.other},on:{input:function(e){e.target.composing||t.$set(t.cancel,"other",e.target.value)}}}),t._v(" "),a("div",{staticClass:"wc-p",staticStyle:{right:"16px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t%\n\t\t\t\t\t\t\t\t\t")])])])],2)]),t._v(" "),a("div",{staticClass:"al-l",staticStyle:{"margin-left":"0px"}},[a("div",{staticClass:"ac-text"},[t._v("\n\t\t\t\t\t\t\t是否延长桌位预留:\n\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"way-con",staticStyle:{"margin-left":"10px"}},[a("div",{staticClass:"pagWay",staticStyle:{float:"left"}},t._l(t.delays,function(e,i){return a("span",{key:i,class:{sign:t.delay.show==e.id},on:{click:function(a){t.changeRadio(e,"delay")}}},[t._v(t._s(e.name))])}))]),t._v(" "),1==t.delay.show?[a("div",{staticClass:"ac-text",staticStyle:{width:"50px","margin-left":"-10px"}},[t._v("\n\t\t\t\t\t\t\t\t预留:\n\t\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"wc-list",staticStyle:{"margin-left":"10px","margin-top":"10px",display:"inline-block"}},[a("select-btn",{attrs:{sorts:t.reserveTime,name:t.delay.isExtendSeat},on:{selOn:t.getReserve}})],1)]:t._e()],2),t._v(" "),a("div",{staticClass:"al-l",staticStyle:{"margin-left":"0px"}},[a("div",{staticClass:"ac-text"},[t._v("\n\t\t\t\t\t\t\t超出预留时间是否允许退款:\n\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"way-con",staticStyle:{"margin-left":"1px","margin-top":"0"}},[a("div",{staticClass:"way-con",staticStyle:{"margin-left":"10px"}},[a("div",{staticClass:"pagWay",staticStyle:{float:"left"}},t._l(t.permit,function(e,i){return a("span",{key:i,class:{sign:t.returnBack.show==e.id},on:{click:function(a){t.changeRadio(e,"refund")}}},[t._v(t._s(e.name))])}))])]),t._v(" "),1==t.returnBack.show?[a("div",{staticClass:"ac-text",staticStyle:{width:"50px"}},[t._v("\n\t\t\t\t\t\t\t\t过期退:\n\t\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"way-con",staticStyle:{"margin-left":"10px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.returnBack.isReturn,expression:"returnBack.isReturn"}],class:{redi:t.returnBack.red},staticStyle:{width:"184px"},attrs:{type:"text",maxlength:"2"},domProps:{value:t.returnBack.isReturn},on:{input:function(e){e.target.composing||t.$set(t.returnBack,"isReturn",e.target.value)}}}),t._v(" "),a("div",{staticClass:"wc-p"},[t._v("\n\t\t\t\t\t\t\t\t\t%\n\t\t\t\t\t\t\t\t")])])]:t._e()],2)])])]),t._v(" "),1==t.order.status?a("a",{staticClass:"yellow bottom-save",attrs:{href:"javascript:void(0);"},on:{click:t.editSave}},[t._v("保存")]):t._e()]):t._e()])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"t-text"},[e("div",{staticClass:"pl"}),this._v("\n\t\t\t是否预约点餐功能\n\t\t")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"t-text required",staticStyle:{width:"100px"}},[e("div",{staticClass:"pl",staticStyle:{width:"2px"}}),this._v("\n\t\t\t\t\t支付方式:\n\t\t\t\t")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"t-text",staticStyle:{width:"100px"}},[e("div",{staticClass:"pl",staticStyle:{width:"2px"}}),this._v("\n\t\t\t\t\t提醒:\n\t\t\t\t")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"t-text",staticStyle:{width:"100px"}},[e("div",{staticClass:"pl",staticStyle:{width:"2px"}}),this._v("\n\t\t\t\t\t预约规则:\n\t\t\t\t")])}],!1,null,"4c5e2102",null);e.default=o.exports},"503c":function(t,e,a){"use strict";var i=a("80f3");a.n(i).a},"80f3":function(t,e,a){}}]);