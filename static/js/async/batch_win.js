(window.webpackJsonp=window.webpackJsonp||[]).push([["batch_win"],{"259c":function(t,e,i){"use strict";var a=i("d7ca");i.n(a).a},c3ef:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("win",{attrs:{align:"center",width:1e3,height:600,ok:t.okstyle},on:{winEvent:t.getData}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{attrs:{slot:"content",id:"tan"},slot:"content"},[i("section",{staticClass:"title"},[i("div",[i("span",{staticClass:"hide",attrs:{title:t.info.materialName}},[t._v("物料名称："+t._s(t.info.materialName))]),t._v(" "),i("span",[t._v("保质期："+t._s(t.info.validity)+t._s(t.validityType[t.info.validityType]))])]),t._v(" "),i("div",{staticStyle:{"vertical-align":"top"}},[i("span",{staticClass:"hide",attrs:{title:t.info.unitName}},[t._v("物料单位："+t._s(t.info.unitName))]),t._v(" "),i("span",{staticClass:"hide",attrs:{title:t.info.materialCategoryName}},[t._v("分类："+t._s(t.info.materialCategoryName))])]),t._v(" "),i("div",[i("span",[t._v("默认单位："+t._s(t.name))]),t._v(" "),i("span",[t._v("最小单位："+t._s(t.info.minName))])])]),t._v(" "),i("section",{staticClass:"menu"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.batchNum,expression:"batchNum"}],attrs:{type:"text",placeholder:"请输入批次编号"},domProps:{value:t.batchNum},on:{input:function(e){e.target.composing||(t.batchNum=e.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.supplyer,expression:"supplyer"}],attrs:{type:"text",placeholder:"请输入供应商"},domProps:{value:t.supplyer},on:{input:function(e){e.target.composing||(t.supplyer=e.target.value)}}}),t._v(" "),i("div",{staticClass:"canMulti"},[i("calendar",{staticClass:"fl",attrs:{pObj:t.startObj},on:{throwTime:t.getStartTime}}),t._v(" "),i("div",{staticClass:"time",staticStyle:{width:"25px"}},[t._v("---")]),t._v(" "),i("calendar",{staticClass:"fl",attrs:{pObj:t.endObj},on:{throwTime:t.getEndTime}})],1),t._v(" "),i("span",{staticClass:"blue btn",on:{click:t.search}},[t._v("筛选")]),t._v(" "),i("span",{staticClass:"gray btn",on:{click:t.reset}},[t._v("重置")]),t._v(" "),i("selectbtn",{staticStyle:{background:"#fff","margin-top":"5px"},attrs:{sorts:t.info.unitList,width:180,name:t.unitName},on:{selOn:t.selOn}})],1),t._v(" "),i("section",{staticClass:"content"},[i("div",{staticClass:"top"},[i("ul",[i("li",[t._v("序号")]),t._v(" "),i("li",[t._v("批次编号")]),t._v(" "),i("li",[t._v("生产日期")]),t._v(" "),i("li",[t._v("供应商")]),t._v(" "),i("li",[t._v("所属仓库")]),t._v(" "),i("li",[t._v("当前批次数量/重量")]),t._v(" "),i("li",[t.winType?i("span",[t._v("出库")]):i("span",[t._v("领料")]),t._v("数量/重量")])])]),t._v(" "),t.backData&&t.backData.length>0?i("section",t._l(t.backData,function(e,a){return i("div",{key:a,staticClass:"list"},[i("ul",[i("li",[t._v(t._s(t.index+1))]),t._v(" "),i("li",{attrs:{title:e.batchCode}},[t._v(t._s(e.batchCode))]),t._v(" "),i("li",[t._v(t._s(t.transFormDate(1e3*e.productionTime)))]),t._v(" "),i("li",{attrs:{title:e.supplier}},[t._v(t._s(e.supplier))]),t._v(" "),i("li",{attrs:{title:e.wName}},[t._v(t._s(e.wName))]),t._v(" "),i("li",{attrs:{title:t.comUnit(Number(e.surplus),t.info.defaultValue,t.info.defaultName,t.info.minName)}},[t._v(t._s(t.comUnit(Number(e.surplus),t.info.defaultValue,t.info.defaultName,t.info.minName)))]),t._v(" "),i("li",[t.info.defaultName!=t.info.minName?[i("input",{directives:[{name:"model",rawName:"v-model",value:e.oneNum,expression:"item.oneNum"}],attrs:{type:"text",placeholder:"输入数字",onkeyup:t.getmin(e,a)},domProps:{value:e.oneNum},on:{input:function(i){i.target.composing||t.$set(e,"oneNum",i.target.value)}}}),i("i",{attrs:{title:t.info.defaultName}},[t._v(t._s(t.info.defaultName))]),t._v("\n\t\t\t\t\t\t\t\t\t+\n\t\t\t\t\t\t\t\t")]:t._e(),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.twoNum,expression:"item.twoNum"}],attrs:{type:"text",placeholder:"输入数字",onkeyup:t.getmin(e,a)},domProps:{value:e.twoNum},on:{input:function(i){i.target.composing||t.$set(e,"twoNum",i.target.value)}}}),i("i",{attrs:{title:t.info.minName}},[t._v(t._s(t.info.minName))])],2)])])})):i("section",{attrs:{id:"emptyData"}},[t._v("\n\t\t\t\t\t暂无数据\n\t\t\t\t")])])])])],1)};a._withStripped=!0;var n=i("bbb9"),s=i("81a2"),o=i("05dd"),r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],a=!0,n=!1,s=void 0;try{for(var o,r=t[Symbol.iterator]();!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){n=!0,s=t}finally{try{!a&&r.return&&r.return()}finally{if(n)throw s}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var l={data:function(){return{title:"",okstyle:{style:{background:"#F7931E"},content:"确定"},isShowCa:!1,startObj:{time:n.a.getTime({time:new Date}).start,show:!1,detail:!1,width:150},endObj:{time:n.a.getTime({time:new Date}).end,show:!1,detail:!1,width:150},unitName:"单位切换",info:"",backData:[],index:0,showName:"",supplyer:"",batchNum:"",validityType:{0:"月",1:"日",2:"年"},name:""}},props:["batchInfo","winIndex","wid","winType"],mounted:function(){this.title="批次选择",this.info=n.a.deepCopy(this.batchInfo),this.name=n.a.deepCopy(this.info.defaultName),this.info.unitName="";for(var t=0;t<this.info.unitData.length;t++)this.info.unitName+=this.info.unitData[t].name+",";this.info.unitName=this.info.unitName.slice(0,this.info.unitName.length-1),this.getMaterialBatch()},components:{win:function(){return i.e("win").then(i.bind(null,"f60a"))},calendar:function(){return i.e("calendar_result").then(i.bind(null,"9265"))},selectbtn:function(){return i.e("select_btn").then(i.bind(null,"3d41"))}},methods:{getStartTime:function(t){this.startObj.time=t},getEndTime:function(t){this.endObj.time=t},getMaterialBatch:function(){var t,e=this;return(t=regeneratorRuntime.mark(function t(){var i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.getMaterialBatch({data:{mid:e.batchInfo.materialId,wid:e.wid||""}});case 2:for(i=t.sent,a=0;a<i.list.length;a++)for(i.list[a].oneNum="",i.list[a].twoNum="",i.list[a].minNumber="",o=0;o<e.info.batch.length;o++)i.list[a].batchId==e.info.batch[o].batchId&&(i.list[a].oneNum=e.info.batch[o].oneNum,i.list[a].twoNum=e.info.batch[o].twoNum,i.list[a].minNumber=e.info.batch[o].minNumber,e.backItem(e.batchInfo.index));e.list=n.a.deepCopy(i.list),e.backData=i.list,e.index=e.batchInfo.index;case 7:case"end":return t.stop()}},t,e)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(n,s){try{var o=e[n](s),r=o.value}catch(t){return void i(t)}if(!o.done)return Promise.resolve(r).then(function(t){a("next",t)},function(t){a("throw",t)});t(r)}("next")})})()},getData:function(t){if("ok"==t)for(var e=0;e<this.backData.length;e++)if(this.backData[e].minNumber>this.backData[e].surplus&&this.backData[e].surplus>0)return this.$store.commit("setWin",{winType:"alert",content:"批次编号"+this.backData[e].batchCode+"领料数量不能大于当前数量"}),!1;this.$emit("getWin",t,this.backData,this.index)},getTime:function(t){this.startTime=t.startTime,this.endTime=t.endTime,this.isShowCa=!1},showCalendar:function(){this.isShowCa=!this.isShowCa},transFormDate:function(t){return n.a.format(new Date(t),"yyyy-MM-dd")},saveNum:function(t,e){for(var i=0;i<this.backData.length;i++)i==e&&(this.backData[e].minNumber=t)},selOn:function(t){this.index=t,this.backItem(t)},getmin:function(t,e){""!=t.oneNum?t.oneNum=(t.oneNum+"").replace(/[^\d.]/g,""):t.oneNum="",""!=t.twoNum?t.twoNum=(t.twoNum+"").replace(/[^\d.]/g,""):t.twoNum="";var i=Number(t.oneNum)*Number(this.info.defaultValue)+Number(t.twoNum);t.minNumber=i,this.saveNum(i,e)},backItem:function(t){var e=this.info.unitList[t];this.info.defaultName=e;for(var i=0;i<this.info.unitData.length;i++)this.info.unitData[i].name==e&&(this.info.defaultValue=this.info.unitData[i].value);for(var a=0;a<this.backData.length;a++)if(Number(this.backData[a].minNumber)){var n=o.a.comUnit(Number(this.backData[a].minNumber),this.info.defaultValue,e,this.info.minName,!0);this.backData[a].oneNum=n.oNull,this.backData[a].twoNum=n.tNull}},comUnit:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var a=r(e,5),n=a[0],s=a[1],l=a[2],u=a[3],m=a[4];return o.a.comUnit(n,s,l,u,m)},search:function(){if(this.backData=[],this.startObj.time>this.endObj.time)return this.$store.commit("setWin",{winType:"alert",content:"开始时间不能大于结束时间"}),!1;for(var t=0;t<this.list.length;t++)1e3*this.list[t].productionTime<=this.endObj.time&&1e3*this.list[t].productionTime>=this.startObj.time&&this.backData.push(this.list[t]);for(var e=0;e<this.backData.length;e++)-1==this.backData[e].supplier.indexOf(this.supplyer)&&(this.backData.splice(e,1),e--);for(var i=0;i<this.backData.length;i++)-1==this.backData[i].batchCode.indexOf(this.batchNum)&&(this.backData.splice(i,1),i--)},reset:function(){this.batchNum="",this.supplyer="",this.startObj.time=n.a.getTime({time:new Date}).start,this.endObj.time=n.a.getTime({time:new Date}).end,this.getMaterialBatch()}}},u=(i("259c"),i("6ceb")),m=Object(u.a)(l,a,[],!1,null,"384a8d05",null);m.options.__file="src\\module\\invoicing_system\\picking_list\\batch_win.vue";e.default=m.exports},d7ca:function(t,e,i){}}]);