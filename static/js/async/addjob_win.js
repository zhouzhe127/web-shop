(window.webpackJsonp=window.webpackJsonp||[]).push([["addjob_win"],{"10f5":function(t,i,e){"use strict";var o=e("5c87");e.n(o).a},"5c87":function(t,i,e){},f431:function(t,i,e){"use strict";e.r(i);var o=e("81a2");function s(t){return function(){var i=t.apply(this,arguments);return new Promise(function(t,e){return function o(s,n){try{var h=i[s](n),r=h.value}catch(t){return void e(t)}if(!h.done)return Promise.resolve(r).then(function(t){o("next",t)},function(t){o("throw",t)});t(r)}("next")})}}var n={data:function(){return{title:"",list:[],index:-1,okStyle:{content:"下一步",style:{backgroundColor:"#F79337",color:"#fff"}},isJob:!0,isBrand:!0,shopType:-1,jobType:1,jobList:[],allJobList:[],shopList:[],showShopList:[],selectNum:0,jobInfo:{roleId:"",name:"",shopIds:[]},onIndex:-1}},props:["type","editJob","batch"],mounted:function(){console.log(this.editJob),"brand"==this.type?(this.editJob?this.title="修改品牌职位":this.title="选择品牌职位",this.isBrand=!0):"shop"==this.type?(this.editJob?this.title="修改门店职位":this.title="选择门店职位",this.isBrand=!1):this.batch&&(this.title="批量管理员工职位"),this.newGetJobInfoList()},methods:{getShopList:function(){var t=this;return s(regeneratorRuntime.mark(function i(){var e,s,n,h,r,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log(t.editJob),i.next=3,o.a.getShopList();case 3:for(e=i.sent,s=0;s<e.length;s++)e[s].selected=!1;if(t.shopList=e,t.showShopList=e,t.editJob){for(n=t.editJob.shopIds,h=0;h<t.shopList.length;h++)for(r=0;r<n.length;r++)n[r]==t.shopList[h].id&&(t.shopList[h].selected=!0);for(t.selectNum=0,a=0;a<t.shopList.length;a++)t.shopList[a].selected&&t.selectNum++}case 8:case"end":return i.stop()}},i,t)}))()},newGetJobInfoList:function(){var t=this;return s(regeneratorRuntime.mark(function i(){var e,s,n,h,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t.jobList=[],i.next=3,o.a.getUserRoleList();case 3:if(e=i.sent,s={roleId:0,name:"超级管理员",shopIds:[]},t.batch)for(t.allJobList=e,n=0;n<t.allJobList.length;n++)"1"===t.allJobList[n].type&&t.jobList.push(t.allJobList[n]);else for(h=0;h<e.length;h++)t.isBrand&&"1"===e[h].type?t.jobList.push(e[h]):!t.isBrand&&"0"===e[h].type&&e[h].id>=1e5&&t.jobList.push(e[h]);if(t.jobList.unshift(s),t.editJob){for(t.jobInfo=t.editJob,r=0;r<t.jobList.length;r++)t.jobInfo.roleId==t.jobList[r].id&&(t.index=r);0==t.jobInfo.roleId&&(t.index=0)}case 8:case"end":return i.stop()}},i,t)}))()},getWin:function(t){if(this.isJob){if("ok"==t){if(""==this.jobInfo.roleId)return this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"请选择职位"}),!1;0!==this.index||0===this.index&&"shop"==this.type?(this.batch,this.title=this.title+"（"+this.jobInfo.name+"）适用门店",this.getShopList(),this.isJob=!1,this.okStyle.content="确定"):this.$emit("addJob",t,"admin",this.jobType)}this.$emit("addJob",t)}},backShopId:function(t,i){if(console.log(i),"ok"==t){if(this.jobInfo.shopIds=i,0==this.jobInfo.shopIds.length)return this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"请选择门店"}),!1;0===this.index&&"shop"==this.type&&(this.jobInfo.roleId="0")}var e={jobInfo:this.jobInfo,shopList:this.shopList};this.$emit("addJob",t,e,this.jobType)},selectJobType:function(t){this.jobType=t,this.jobList=[],this.index=-1;for(var i=0;i<this.allJobList.length;i++)t==this.allJobList[i].type&&(1===t?this.jobList.push(this.allJobList[i]):0===t&&this.allJobList[i].id>=1e5&&this.jobList.push(this.allJobList[i]));this.jobList.unshift({roleId:0,name:"超级管理员",shopIds:[]})},isSelected:function(t){return t==this.onIndex},getRadio:function(t){this.index=t,-1!=t&&(this.jobInfo.roleId=this.jobList[t].id,this.jobInfo.name=this.jobList[t].name,this.okStyle.content="下一步"),0===t&&1===this.jobType&&(this.okStyle.content="确定")}},components:{win:function(){return e.e("win").then(e.bind(null,"f60a"))},radio:function(){return e.e("radio_btn").then(e.bind(null,"4dfe"))},elShopListWin:function(){return e.e("el_shopList_win").then(e.bind(null,"6c2c"))}}},h=(e("10f5"),e("d801")),r=Object(h.a)(n,function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("win",{attrs:{align:"center",width:700,height:400,ok:t.okStyle},on:{winEvent:t.getWin}},[e("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),e("div",{attrs:{slot:"content",id:"tan"},slot:"content"},[t.isJob?e("div",{staticClass:"job"},[t.batch?e("div",{staticStyle:{width:"100%",height:"50px",overflow:"hidden","margin-top":"20px","margin-bottom":"20px"}},[e("a",{staticClass:"raduobtn",class:{selectbtn:1===t.jobType},attrs:{href:"javascript:void(0);"},on:{click:function(i){t.selectJobType(1)}}},[t._v("品牌职位")]),t._v(" "),e("a",{staticClass:"raduobtn",class:{selectbtn:0===t.jobType},attrs:{href:"javascript:void(0);"},on:{click:function(i){t.selectJobType(0)}}},[t._v("门店职位")])]):t._e(),t._v(" "),e("radio",{attrs:{list:t.jobList,index:t.index,name:"name"},on:{selOn:t.getRadio}}),t._v(" "),t.jobList[t.index]?e("h3",{staticClass:"selJobName"},[t._v("已选择:"+t._s(t.jobList[t.index].name))]):t._e()],1):e("div",[e("elShopListWin",{attrs:{shopIds:t.editJob?t.editJob.shopIds:[]},on:{chooseShop:t.backShopId}})],1)])])],1)},[],!1,null,"1775d2bb",null);i.default=r.exports}}]);