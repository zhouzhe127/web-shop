(window.webpackJsonp=window.webpackJsonp||[]).push([["handover"],{"77db":function(t,e,i){"use strict";var a=i("bc62");i.n(a).a},"8a9c":function(t,e,i){"use strict";i.r(e);var a=i("81a2"),s=i("f6ce"),n=i("bbb9");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(s,n){try{var o=e[s](n),r=o.value}catch(t){return void i(t)}if(!o.done)return Promise.resolve(r).then(function(t){a("next",t)},function(t){a("throw",t)});t(r)}("next")})}}var r={data:function(){return{startT:(new Date).setHours(0,0,0,0),endT:(new Date).setHours(0,0,0,0),isOpenTime:!0,handoverList:[],num:10,total:0,page:1,showDetails:!1,openWin:!1,detailsOne:[],detailsTwo:[],payTypeList:[],modifyList:[],dataWin:{},totalIncome:""}},props:["obj"],created:function(){var t=this;if(this.userdata=s.a.session("userShop"),this.obj){var e=[{name:"返回",className:"huiC",fn:function(){t.$emit("chooseShop")}}];this.$store.commit("setPageTools",e),this.isOpenTime=this.obj.open,this.shopTime=n.a.format(new Date(this.obj.startTime),"yyyy年MM月dd日")+"-"+n.a.format(new Date(this.obj.endTime),"yyyy年MM月dd日")}this.dataWin.trueShopId=this.obj?this.obj.shopId:this.userdata.currentShop.id,this.getChangeShiftsList()},methods:{getChangeShiftsList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i,s,o,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t.obj?t.obj.endTime-t.obj.startTime:t.endT-t.startT)>80352e5)){e.next=5;break}return t.$store.commit("setWin",{title:"操作提示",content:"最大只能查询三个月时间"}),e.abrupt("return",!1);case 5:return i={startTime:t.obj?t.obj.startTime/1e3:t.startT/1e3,endTime:86400+(t.obj?t.obj.endTime/1e3:t.endT/1e3)-1,page:t.page,num:t.num,isOpenTime:Number(t.isOpenTime)},t.obj&&(i.trueShopId=t.obj.shopId),e.next=9,a.a.getChangeShiftsList({data:i});case 9:if(s=e.sent){for(o=s.list,r=0;r<o.length;r++)o[r].getTime=n.a.format(new Date(1e3*o[r].getTime),"yyyy.MM.dd/hh:mm"),o[r].giveTime=n.a.format(new Date(1e3*o[r].giveTime),"yyyy.MM.dd/hh:mm"),Number(o[r].differPrice)>0&&(o[r].differPrice="+"+o[r].differPrice);t.handoverList=o,t.total=s.total}console.log(t.handoverList);case 12:case"end":return e.stop()}},e,t)}))()},getDetailList:function(t){var e=this;return o(regeneratorRuntime.mark(function i(){var s,n,o,r,l;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return s={id:t.id},e.obj&&(s.trueShopId=e.obj.shopId),i.next=4,a.a.getShiftsDetail({data:s});case 4:for(n=i.sent,o={num:0},e.detailsTwo=[],r=0;r<n.shiftsPay.length;r++)"现金"==n.shiftsPay[r].name?(o.num=n.shiftsPay[r].price,n.shiftsPay.splice(r,1),r--):(n.shiftsPay[r].propName="name"+r,o["name"+r]=n.shiftsPay[r].price);for(e.payTypeList=n.shiftsPay,e.detailsTwo.push(o),l=0;l<n.differPrice.length;l++)Number(n.differPrice[l].differPrice)>0&&(n.differPrice[l].differPrice="+"+n.differPrice[l].differPrice);e.modifyList=n.differPrice;case 12:case"end":return i.stop()}},i,e)}))()},selectBusinessHours:function(){this.isOpenTime=!this.isOpenTime},search:function(){this.getChangeShiftsList()},numChange:function(t){this.num=t,this.getChangeShiftsList()},pageClick:function(t){this.page=t,this.getChangeShiftsList()},see:function(t){var e=this;console.log(t),this.dataWin.id=t.id,this.dataWin.cash=t.cash,this.totalIncome=t.totalIncome,this.detailsOne=[],this.detailsOne.push(t),this.getDetailList(t),this.showDetails=!0;var i=[{name:"返回",className:"huiC",fn:function(){e.huiC()}}];this.$store.commit("setPageTools",i)},huiC:function(){var t=this;if(this.showDetails=!1,this.obj){var e=[{name:"返回",className:"huiC",fn:function(){t.$emit("chooseShop")}}];this.$store.commit("setPageTools",e)}else{this.$store.commit("setPageTools",[])}},edit:function(t){t&&(this.dataWin.id=t.id,this.dataWin.cash=t.cash),this.openWin=!0},backWin:function(t,e){"ok"==t&&(this.modifyList.unshift({differPrice:Number(e)>0?"+"+e:e,userName:this.userdata.user.name}),this.getChangeShiftsList()),this.openWin=!1}},destroyed:function(){this.$store.commit("setPageTools",[])},components:{handoverWin:function(){return i.e("handover_win").then(i.bind(null,"8777"))}}},l=(i("77db"),i("d801")),c=Object(l.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{attrs:{id:"handover"}},[t.showDetails?i("section",[t._m(0),t._v(" "),i("section",{staticStyle:{"margin-bottom":"20px"}},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{stripe:"","header-cell-style":{"background-color":"#f5f7fa"},data:t.detailsOne,border:""}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"userName",label:"交班人"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"130",align:"center",prop:"getTime",label:"开班时间"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"130",align:"center",prop:"giveTime",label:"交班时间"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"roleName",label:"交班人职位"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"shifts",label:"班次"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"pettyCash",label:"备用金"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"allNum",label:"开台次数"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"havePayNum",label:"订单总数"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"chargeIncome",label:"服务费"}})],1)],1),t._v(" "),t._m(1),t._v(" "),i("section",{staticStyle:{width:"100%",border:"1px solid #ebeef5","border-bottom":"none",height:"40px"}},[i("div",{staticStyle:{"line-height":"40px","margin-left":"20px"}},[i("span",[t._v("总收入："+t._s(t.totalIncome))])])]),t._v(" "),i("section",[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{stripe:"","header-cell-style":{"background-color":"#f5f7fa"},data:t.detailsTwo,border:""}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"250",align:"center",label:"现金支付","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{"margin-left":"8px"}},[t._v("\n                            "+t._s(e.row.num)+"\n                        ")]),t._v(" "),i("span",{staticClass:"button_d",on:{click:function(e){t.edit()}}},[t._v("差额调整")])]}}])}),t._v(" "),t._l(t.payTypeList,function(t,e){return[i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:t.propName,label:t.name}})]})],2)],1),t._v(" "),i("section",{staticStyle:{width:"100%",border:"1px solid #ebeef5","border-top":"none"}},[i("div",{staticClass:"li_top"},[i("ul",t._l(t.modifyList,function(e,a){return i("li",[i("span",[t._v("第"+t._s(t.modifyList.length-a)+"次校对差额:")]),t._v(" "),i("span",{staticClass:"second"},[t._v(t._s(e.differPrice))]),t._v(" "),i("span",[t._v(t._s(e.userName))])])}))])])]):i("section",[t.obj?i("div",{staticClass:"formBrand"},[i("span",[t._v("选择店铺："+t._s(t.obj.shopName))]),t._v(" "),i("span",[t._v("|")]),t._v(" "),i("span",[t._v("选择时间："+t._s(t.shopTime))])]):i("div",{staticClass:"top"},[i("section",{staticClass:"timeS"},[i("el-date-picker",{staticStyle:{width:"150px",cursor:"pointer"},attrs:{clearable:!1,type:"date",format:"yyyy-MM-dd","value-format":"timestamp"},model:{value:t.startT,callback:function(e){t.startT=e},expression:"startT"}}),t._v(" "),i("span",{staticStyle:{width:"25px","line-height":"40px","text-align":"center"}},[t._v("-")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"150px",cursor:"pointer"},attrs:{clearable:!1,type:"date",format:"yyyy-MM-dd","value-format":"timestamp"},model:{value:t.endT,callback:function(e){t.endT=e},expression:"endT"}}),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){t.search()}}})],1),t._v(" "),i("section",{staticClass:"block-div"},[i("div",{class:[{active:t.isOpenTime},"pickBlu"],on:{click:t.selectBusinessHours}}),t._v(" "),i("span",{staticStyle:{"font-size":"16px"}},[t._v("按营业时间")])])]),t._v(" "),i("div",{staticClass:"clear"}),t._v(" "),i("div",{staticClass:"list"},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{stripe:"","header-cell-style":{"background-color":"#f5f7fa"},data:t.handoverList,border:""}},[i("el-table-column",{attrs:{fixed:"","min-width":"180",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("em",{staticClass:"under-line edit",on:{click:function(i){t.see(e.row)}}},[t._v("查看详情")]),t._v(" "),i("em",{staticClass:"line"}),t._v(" "),i("em",{staticClass:"under-line del",on:{click:function(i){t.edit(e.row)}}},[t._v("差额调整")])]}}])}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"130",align:"center",prop:"getTime",label:"开班时间"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"130",align:"center",prop:"giveTime",label:"交班时间"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"userName",label:"交班人"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"80",align:"center",prop:"shifts",label:"班次"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"roleName",label:"交班人职位"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"totalIncome",label:"实收金额"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"differPrice",label:"现金差额"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"allNum",label:"开台次数"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"pettyCash",label:"备用金"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"chargeIncome",label:"服务费"}})],1)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[i("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.num,layout:"sizes, prev, pager, next","page-count":t.total,"page-sizes":[10,20,30]},on:{"size-change":t.numChange,"current-change":t.pageClick}})],1)]),t._v(" "),t.openWin?i("handoverWin",{attrs:{dataWin:t.dataWin},on:{interNum:t.backWin}}):t._e()],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"all"},[e("div",{staticClass:"text"},[this._v("基本信息")]),this._v(" "),e("div",{staticClass:"dash"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"all"},[e("div",{staticClass:"text"},[this._v("收入明细")]),this._v(" "),e("div",{staticClass:"dash"})])}],!1,null,"74c531f9",null);e.default=c.exports},bc62:function(t,e,i){}}]);