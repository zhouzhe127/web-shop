(window.webpackJsonp=window.webpackJsonp||[]).push([["base"],{"0a5b":function(e,t,a){"use strict";var i=a("31df");a.n(i).a},"31df":function(e,t,a){},"6cc5":function(e,t,a){"use strict";a.r(t);var i=a("81a2"),n=a("f6ce"),s=a("05dd");function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function i(n,s){try{var o=t[n](s),r=o.value}catch(e){return void a(e)}if(!o.done)return Promise.resolve(r).then(function(e){i("next",e)},function(e){i("throw",e)});e(r)}("next")})}}var r={data:function(){return{baseDetial:{},imgHost:"",logoImage:"",startslot:{hour:"00",minute:"00"},endSlot:{hour:"23",minute:"59"},selnext:!1,start:"",end:"",onoff:!1,isShared:!1,shopNumber:"",loaded:!1,userData:null,pointLng:116.404,pointLat:39.915,optionW:13,shiftList:[],showShift:!1}},created:function(){var e=this;return o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.getBaiduMapApi();case 2:e.userData=n.a.session("userShop"),e.shopId=e.userData.currentShop.id,e.imgHost=e.userData.uploadUrl,e.getChangeShifts();case 6:case"end":return t.stop()}},t,e)}))()},components:{onOff:function(){return a.e("radio_btn").then(a.bind(null,"034b"))},atime:function(){return a.e("time").then(a.bind(null,"4712"))}},methods:{seach:function(e){var t=this,a=new AMap.Map("mapBox",{resizeEnable:!0,zoom:11,center:[t.pointLng,t.pointLat]});AMap.service(["AMap.PlaceSearch"],function(){var i=new AMap.PlaceSearch({pageSize:5,pageIndex:1,city:"010",map:a,panel:"mapBoxDet"});if(i.on("listElementClick",function(e){t.pointLng=e.data.location.lng,t.pointLat=e.data.location.lat}),e){var n=t.baseDetial.address;i.search(n)}});var i=void 0,n=void 0;AMap.plugin(["AMap.ToolBar","AMap.Scale"],function(){a.addControl(new AMap.ToolBar),a.addControl(new AMap.Scale),n=new AMap.Marker({map:a,bubble:!0})}),AMap.service("AMap.Geocoder",function(){i=new AMap.Geocoder({city:"全国"})});var s=void 0,o=void 0;a.on("click",function(e){t.pointLng=e.lnglat.lng,t.pointLat=e.lnglat.lat;var r=[e.lnglat.lng,e.lnglat.lat];i.getAddress(r,function(e,t){"complete"===e&&"OK"===t.info&&(s=t.regeocode.formattedAddress,o=t.regeocode.addressComponent.adcode,function(e){n&&(n.setMap(null),n=null);(n=new AMap.Marker({position:e,map:a,bubble:!0})).setMap(a),t=[],t.push("邮编 : "+o),t.push("地址 :"+s),new AMap.InfoWindow({content:t.join("<br/>"),autoMove:!0,offset:new AMap.Pixel(0,-23),size:new AMap.Size(200,0)}).open(a,n.getPosition());var t}(r))})})},getTime:function(e){this.startslot.hour=e.start.hour,this.startslot.minute=e.start.minute,this.endSlot.hour=e.end.hour,this.endSlot.minute=e.end.minute},getChangeShifts:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.getChangeShifts({data:{}});case 2:a=t.sent,e.shiftList=a.map(function(e){return e.selected=!1,e}),e.baseGet();case 5:case"end":return t.stop()}},t,e)}))()},baseGet:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a,n,s,o,r,l,p,c,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.baseGet({data:{shopId:e.shopId}});case 2:if(e.baseDetial=t.sent,e.showShift=Boolean(Number(e.baseDetial.isShifts)),(a=e.baseDetial.changeShifts.split(",")).length>0)for(n=0;n<e.shiftList.length;n++)a.includes(e.shiftList[n].id)&&(e.shiftList[n].selected=!0);e.onoff=0==e.baseDetial.isWarrant,e.isShared=0==e.baseDetial.isShared,e.shopNumber=e.baseDetial.shopNumber?e.baseDetial.shopNumber:"",e.baseDetial.position&&""!==e.baseDetial.position?(e.pointLng=e.baseDetial.position.split(",")[0],e.pointLat=e.baseDetial.position.split(",")[1]):(e.pointLat=39.915,e.pointLng=116.404),s=e.baseDetial.openTime.split(","),o=parseInt(s[0]),(r=parseInt(s[1]))>=1440&&(r-=1440,e.selnext=!0),p=o%60+"",c=(r-r%60)/60+"",h=r%60+"",1==(l=(o-o%60)/60+"").length&&(l="0"+l),1==p.length&&(p="0"+p),1==c.length&&(c="0"+c),1==h.length&&(h="0"+h),e.startslot.hour=l,e.startslot.minute=p,e.endSlot.hour=c,e.endSlot.minute=h,e.loaded=!0,e.seach();case 28:case"end":return t.stop()}},t,e)}))()},baseUpdate:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a,s,o,r,l,p,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.baseUpdate({data:{shopId:e.shopId,openTime:e.start,closeTime:e.end,shopName:e.baseDetial.shopName,contactMan:e.baseDetial.contactMan,telephone:e.baseDetial.telephone,address:e.baseDetial.address,description:e.baseDetial.description,logoImage:e.baseDetial.logoImage,healthLicense:e.baseDetial.healthLicense,isWarrant:e.onoff?0:1,isShared:e.isShared?0:1,shopNumber:e.shopNumber,position:e.pointLng+","+e.pointLat,changeShifts:e.shiftList.filter(function(e){return e.selected}).map(function(e){return e.id}).toString(),isShifts:Number(e.showShift)}});case 2:if(t.sent){if(a=e.$store.state.logoName,s="",o=e.userData.shopList,"0"==e.baseDetial.ischain)for(s=e.baseDetial.shopName,r=0;r<o.noBrand.length;r++)e.baseDetial.id==o.noBrand[r].id&&(o.noBrand[r]=e.baseDetial,o.noBrand[r].name=e.baseDetial.shopName);else for(s=a.split("--")[0]+"--"+e.baseDetial.shopName,l=0;l<o.brand.length;l++)if(e.baseDetial.brandId==o.brand[l].id)if("1"==e.baseDetial.ischain)for(p=0;p<o.brand[l].direct.length;p++)e.baseDetial.id==o.brand[l].direct[p].id&&(o.brand[l].direct[p]=e.baseDetial);else if("2"==e.baseDetial.ischain)for(c=0;c<o.brand[l].franchise.length;c++)e.baseDetial.id==o.brand[l].franchise[c].id&&(o.brand[l].franchise[c]=e.baseDetial);e.userData.currentShop=e.baseDetial,e.userData.currentShop.name=e.baseDetial.shopName,e.userData.currentShop.newName=s,n.a.session("userShop",e.userData),e.$store.commit("setlogoName",s),e.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"店铺信息修改成功"})}case 4:case"end":return t.stop()}},t,e)}))()},changeOnOff:function(e){this.isShared=e},changeAuth:function(e){this.onoff=e},nextDay:function(){this.selnext=!this.selnext},send:function(){if(""==this.baseDetial.shopName)return this.$store.commit("setWin",{title:"错误提示",winType:"alert",content:"店铺名称不能为空"}),!1;if(""!=this.shopNumber&&this.shopNumber.length<4)return this.$store.commit("setWin",{title:"错误提示",winType:"alert",content:"店铺编号必须为4位数"}),!1;if(""==this.baseDetial.telephone)return this.$store.commit("setWin",{title:"错误提示",winType:"alert",content:"联系方式不能为空"}),!1;if(""==this.baseDetial.address)return this.$store.commit("setWin",{title:"错误提示",winType:"alert",content:"店铺地址不能为空"}),!1;if(this.showShift&&0===this.shiftList.filter(function(e){return e.selected}).length)return this.$store.commit("setWin",{title:"错误提示",winType:"alert",content:"请至少选择一个交接班次"}),!1;this.start=parseInt(60*this.startslot.hour)+parseInt(this.startslot.minute),this.end=parseInt(60*this.endSlot.hour)+parseInt(this.endSlot.minute),this.selnext&&(this.end=this.end+1440),this.baseUpdate()},fileNameChange:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.uploadImg({formId:"imageUpForm",data:{type:8,shopId:e.shopId}});case 2:a=t.sent,e.baseDetial.logoImage=a;case 4:case"end":return t.stop()}},t,e)}))()},fileNameChange2:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.uploadImg({formId:"imageUpForm2",data:{type:8,shopId:e.shopId}});case 2:a=t.sent,e.baseDetial.healthLicense=a;case 4:case"end":return t.stop()}},t,e)}))()}}},l=(a("0a5b"),a("d801")),p=Object(l.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticStyle:{"text-align":"left",width:"900px","min-height":"1280px"},attrs:{id:"bstime"}},[i("el-form",{ref:"baseDetial",attrs:{model:e.baseDetial,"label-width":"120px"}},[i("el-form-item",{attrs:{required:"",label:"店铺名称"}},[i("el-input",{staticStyle:{width:"250px"},attrs:{maxlength:"20",placeholder:"请输入店铺名称"},model:{value:e.baseDetial.shopName,callback:function(t){e.$set(e.baseDetial,"shopName",t)},expression:"baseDetial.shopName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"店铺编号"}},[""!==e.baseDetial.shopNumber&&e.baseDetial.shopNumber?i("span",[e._v(e._s(e.shopNumber))]):i("span",[i("el-input",{staticStyle:{width:"250px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')",maxlength:"4",placeholder:"请输入店铺编号（必须为4位数）"},model:{value:e.shopNumber,callback:function(t){e.shopNumber=t},expression:"shopNumber"}}),e._v(" "),i("span",{staticClass:"el-icon-warning",staticStyle:{"margin-left":"10px",color:"#EA3B44"}},[e._v(" 店铺编号一旦提交，不可修改！")])],1)]),e._v(" "),i("el-form-item",{attrs:{label:"店铺类型"}},[i("span",[e._v(e._s(0==e.baseDetial.industry?"餐饮":"零售"))])]),e._v(" "),i("el-form-item",{attrs:{label:"店铺LOGO"}},[i("div",{staticStyle:{position:"relative",height:"150px"}},[i("form",{attrs:{id:"imageUpForm",enctype:"multipart/form-data"}},[i("input",{staticStyle:{width:"150px",height:"150px",position:"absolute","z-index":"5",opacity:"0",cursor:"pointer"},attrs:{type:"file",accept:"image/jpeg,image/png,image/image/tiff",id:"file_upload",name:"image"},on:{change:e.fileNameChange}})]),e._v(" "),i("section",{staticStyle:{width:"150px",height:"150px",border:"1px solid #C0C0C0",position:"absolute","z-index":"0"}},[i("img",{staticStyle:{width:"47px",height:"47px","margin-left":"50px","margin-top":"25px"},attrs:{src:a("f518")}}),e._v(" "),""==e.baseDetial.logoImage?i("section",{staticStyle:{width:"100%",height:"60px","line-height":"60px","text-align":"center","font-size":"18px",color:"#D6D6D6"}},[e._v("添加店铺LOGO")]):i("section",{staticStyle:{width:"100%",height:"60px","line-height":"60px","text-align":"center","font-size":"18px",color:"#D6D6D6"}},[e._v("更改店铺LOGO")])]),e._v(" "),i("section",{staticStyle:{width:"150px",height:"150px",position:"absolute",left:"170px","z-index":"0"}},[""!=e.baseDetial.logoImage?i("img",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"imgs",src:e.imgHost+e.baseDetial.logoImage}}):e._e()])])]),e._v(" "),i("el-form-item",{attrs:{label:"卫生许可证"}},[i("div",{staticStyle:{position:"relative",height:"150px"}},[i("form",{attrs:{id:"imageUpForm2",enctype:"multipart/form-data"}},[i("input",{staticStyle:{width:"150px",height:"150px",position:"absolute","z-index":"5",opacity:"0",cursor:"pointer"},attrs:{type:"file",accept:"image/jpeg,image/png,image/image/tiff",id:"file_upload",name:"image"},on:{change:e.fileNameChange2}})]),e._v(" "),i("section",{staticStyle:{width:"150px",height:"150px",border:"1px solid #C0C0C0",position:"absolute","z-index":"0"}},[i("img",{staticStyle:{width:"47px",height:"47px","margin-left":"50px","margin-top":"25px"},attrs:{src:a("f518")}}),e._v(" "),e.baseDetial.healthLicense&&""!=e.baseDetial.healthLicense?i("section",{staticStyle:{width:"100%",height:"60px","line-height":"60px","text-align":"center","font-size":"18px",color:"#D6D6D6"}},[e._v("更改卫生许可证")]):i("section",{staticStyle:{width:"100%",height:"60px","line-height":"60px","text-align":"center","font-size":"18px",color:"#D6D6D6"}},[e._v("添加卫生许可证")])]),e._v(" "),i("section",{staticStyle:{width:"150px",height:"150px",position:"absolute",left:"170px","z-index":"0"}},[""!=e.baseDetial.healthLicense?i("img",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"imgs",src:e.imgHost+e.baseDetial.healthLicense}}):e._e()])])]),e._v(" "),i("el-form-item",{attrs:{label:"负责人"}},[i("el-input",{staticStyle:{width:"250px"},attrs:{maxlength:"15",placeholder:"请输入负责人"},model:{value:e.baseDetial.contactMan,callback:function(t){e.$set(e.baseDetial,"contactMan",t)},expression:"baseDetial.contactMan"}})],1),e._v(" "),i("el-form-item",{attrs:{required:"",label:"联系方式 "}},[i("el-input",{staticStyle:{width:"250px"},attrs:{maxlength:"20",placeholder:"请输入手机号码"},model:{value:e.baseDetial.telephone,callback:function(t){e.$set(e.baseDetial,"telephone",t)},expression:"baseDetial.telephone"}})],1),e._v(" "),i("el-form-item",{attrs:{required:"",label:"店铺地址 "}},[i("el-input",{staticStyle:{width:"320px"},attrs:{maxlength:"20",placeholder:"请输店铺地址"},model:{value:e.baseDetial.address,callback:function(t){e.$set(e.baseDetial,"address",t)},expression:"baseDetial.address"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(t){e.seach(!0)}},slot:"append"},[e._v("搜索")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:" "}},[i("div",{staticStyle:{height:"350px",width:"900px"}},[i("section",{staticStyle:{width:"400px",height:"350px",float:"left"},attrs:{id:"mapBox"}}),e._v(" "),i("section",{staticStyle:{width:"300px",height:"350px",float:"left","margin-left":"20px"},attrs:{id:"mapBoxDet"}})]),e._v(" "),i("div",{staticClass:"line"},[i("span",{},[e._v("经度:")]),e._v(" "),i("span",{staticStyle:{"line-height":"40px","padding-right":"30px"}},[e._v(e._s(e.pointLng))]),e._v(" "),i("span",{},[e._v("纬度:")]),e._v(" "),i("span",{staticStyle:{"line-height":"40px","padding-right":"30px"}},[e._v(e._s(e.pointLat))])])]),e._v(" "),i("el-form-item",{attrs:{label:"详细介绍 "}},[i("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",maxlength:"50",autosize:{minRows:3,maxRows:5},placeholder:"请输入详细介绍"},model:{value:e.baseDetial.description,callback:function(t){e.$set(e.baseDetial,"description",t)},expression:"baseDetial.description"}})],1),e._v(" "),i("el-form-item",{attrs:{required:"",label:"营业时间 "}},[e.loaded?i("div",{staticStyle:{float:"left"}},[i("atime",{attrs:{start:e.startslot,end:e.endSlot},on:{timeChoose:e.getTime}})],1):e._e(),e._v(" "),i("div",{staticStyle:{position:"absolute",left:"260px",top:"0px"}},[i("div",{staticClass:"circle",class:{active:e.selnext},on:{click:e.nextDay}}),e._v(" "),i("span",[e._v("隔天")])])]),e._v(" "),i("el-form-item",{attrs:{label:"启用交接班班次 "}},[i("el-switch",{staticStyle:{float:"left","margin-top":"10px","margin-right":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.showShift,callback:function(t){e.showShift=t},expression:"showShift"}}),e._v(" "),e._l(e.shiftList,function(t,a){return e.showShift?i("el-checkbox",{key:a,attrs:{label:t.name,border:"",size:"medium"},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"item.selected"}}):e._e()})],2),e._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{staticStyle:{width:"290px"},attrs:{type:"primary"},on:{click:e.send}},[e._v("修改店铺信息")])],1)],1)],1)},[],!1,null,"964b9d02",null);t.default=p.exports},f518:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAvCAYAAABzJ5OsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKxJREFUeNrs2LENgzAQhWE7ygAZgQ2yApsk9S1hGMJeB7ERGzhHh+w0EXdF0P8ky9IV8BVH8Yi11mCdUsqg1/s4E5HJ+j334JMdn5qZOf4W/jjgwYMHDx48ePDgwYMHD/7XxJxzV5aNOuyrmc0eBfxbWfZIYm2ugt/XZtOzGj/3oefZzFbzD9bpj9mo13KciUhkbcCDBw8ePHjw4MGDBw8e/MkC7hGPUt/lI8AAt9oYPL6CVYkAAAAASUVORK5CYII="}}]);