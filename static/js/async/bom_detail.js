(window.webpackJsonp=window.webpackJsonp||[]).push([["bom_detail"],{"00b0":function(t,e,n){},"5bc2":function(t,e,n){"use strict";var i=n("00b0");n.n(i).a},e298:function(t,e,n){"use strict";n.r(e);var i=n("81a2"),a=n("05dd"),s=n("f6ce");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,s){try{var o=e[a](s),l=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(l).then(function(t){i("next",t)},function(t){i("throw",t)});t(l)}("next")})}}var l={data:function(){return{bomId:"",bom:{},bomDetail:[],showDetail:!1}},methods:{deleteBom:function(){var t=this;this.$store.commit("setWin",{content:"确认删除该BOM单?",winType:"confirm",callback:function(e){"ok"==e&&t.BillmaterialDelBom(t.bomId).then(function(e){if(e){var n=t.$route.query;s.a.session("bomListDestroy",!0),t.$router.push({path:"/admin/bomList",query:n})}else t.$store.commit("setWin",{content:"删除BOM失败!"})})}})},arrestClickEvent:function(t,e,n){n.cancelBubble=!0,this.bomDetail=this.bomDetail.map(function(e){return t.id==e.id?(e.toggleUnit=!e.toggleUnit,e):(e.toggleUnit=!1,e)})},changeUnit:function(t,e,n){for(var i={},s=0;s<e.unit.length;s++){var o=e.unit[s];o.muId==t&&(i=o)}e.showConsumeNum=a.a.comUnit(e.consumeMinVal,Number(i.value),i.name,e.minUnitName),e.showNetMaterial=a.a.comUnit(e.netMaterialMinVal,Number(i.value),i.name,e.minUnitName),e.consumeUnitName=i.name,e.newConsumeNum=Number(e.consumeMinVal)/Number(i.value),e.unitShowId=i.muId,this.bomDetail.splice(n,1,e)},BillmaterialGetBomDetail:function(t){var e=this;return o(regeneratorRuntime.mark(function n(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.BillmaterialGetBomDetail({data:{bid:t}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},n,e)}))()},BillmaterialDelBom:function(t){var e=this;return o(regeneratorRuntime.mark(function n(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.BillmaterialDelBom({data:{id:t}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},n,e)}))()},initData:function(){this.bomId=this.$route.query.id},initBtn:function(){var t=this;this.$store.commit("setPageTools",[{name:"返回",className:"info",type:4,fn:function(){s.a.session("bomListDestroy",!0),delete t.$route.query.id,t.$router.push({path:"/admin/bomList",query:t.$route.query})}}])},turnToEdit:function(){var t=this.$route.query;t.id=this.bomId,this.$router.push({path:"bomChange",query:t})},domClick:function(){this.bomDetail=this.bomDetail.map(function(t){return t.toggleUnit=!1,t})}},mounted:function(){var t=this;this.initData(),this.initBtn(),this.BillmaterialGetBomDetail(this.bomId).then(function(e){e instanceof Array&&0==e.length||!e?e=[]:(t.bom=e,e.detail=e.detail.map(function(t){t.toggleUnit=!1,t.wids=t.wids.split(","),t.host=t.warehouseName.map(function(t){return t.name});var e=null,n=null,i=null;t.unit.forEach(function(t){1==t.isMin&&(e=t.muId,i=t.name),1==t.isDefault&&(n=t.muId)}),t.minUnitId=e,t.minUnitName=i,t.defaultUnitId=n,t.unitShowId=n;var s=null,o=null,l=null,r=null;return t.unit.some(function(e){if(e.muId==t.consumeUnit)return s=Number(t.consumeNum),r=Number(t.netMaterial),o=e.name,l=e.value,!0}),t.consumeMinVal=s,t.netMaterialMinVal=r,t.newConsumeNum=t.consumeNum,t.consumeUnitName=o,t.showConsumeNum=a.a.comUnit(t.consumeMinVal,l,o,i),t.showNetMaterial=a.a.comUnit(t.netMaterialMinVal,l,o,i),t}),t.bomDetail=e.detail)}),document.addEventListener("click",this.domClick,!1)},components:{},beforeDestroy:function(){document.removeEventListener("click",this.domClick)}},r=(n("5bc2"),n("d801")),u=Object(r.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"bom-detail"}},[n("div",{staticClass:"headBox"},[n("div",{staticClass:"headTitle"},[t._v("BOM单信息")]),t._v(" "),n("div",{staticClass:"innerBox"},[n("ul",[n("li",[n("span",[t._v("商品名称 : "+t._s(t.bom.gName))])]),t._v(" "),n("li",[n("span",[t._v("BOM单编号 : ")]),t._v(" "),n("span",[t._v(t._s(t.bom.bomNum))])]),t._v(" "),n("li",[n("span",[t._v("BOM单类型 : ")]),t._v(" "),n("span",[t._v(t._s(1==t.bom.isPublic?"公开":"保密"))])])]),t._v(" "),n("ul",[n("li",[n("span",[t._v("创建人 : ")]),t._v(" "),n("span",[t._v(t._s(t.bom.createName))])]),t._v(" "),n("li",[n("span",[t._v("自动消耗 : ")]),t._v(" "),n("span",[t._v(t._s(1==t.bom.isAuto?"开":"关"))])]),t._v(" "),n("li",[n("span",[t._v("库存可以为负数 : ")]),t._v(" "),n("span",[t._v(t._s(1==t.bom.isOversold?"是":"否"))])])]),t._v(" "),n("ul",[n("li",[n("span",[t._v("备注 : "+t._s(t.bom.remark))])])])]),t._v(" "),n("div",{staticClass:"search"},[n("el-button",{attrs:{type:"success"},on:{click:t.turnToEdit}},[t._v("修改")]),t._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:t.deleteBom}},[t._v("删除")])],1)]),t._v(" "),n("div",{staticClass:"table"},[n("div",{staticClass:"table-title"},[t._v("\n\t\t\t批次列表\n\t\t\t"),n("span",{staticClass:"circle"}),t._v("共\n\t\t\t"),n("span",{staticClass:"tips-num"},[t._v(t._s(t.bomDetail.length))]),t._v("个条目\n\t\t\t"),n("a",{staticClass:"showDetail",on:{click:function(e){t.showDetail=!t.showDetail}}},[t._v(t._s(t.showDetail?"简洁":"详细"))])]),t._v(" "),n("div",{staticClass:"scroll-box"},[t._m(0),t._v(" "),n("div",{staticClass:"table-body"},[t._l(t.bomDetail,function(e,i){return n("div",{key:i,staticClass:"table-row"},[n("div",{staticClass:"cell"},[t._v(t._s(i+1))]),t._v(" "),n("div",{staticClass:"cell"},[t._v(t._s(e.mName))]),t._v(" "),n("div",{staticClass:"cell cell-sel"},[n("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择bom单类型"},on:{change:function(n){t.changeUnit(n,e,i)}},model:{value:e.unitShowId,callback:function(n){t.$set(e,"unitShowId",n)},expression:"item.unitShowId"}},t._l(e.unit,function(t){return n("el-option",{key:t.muId,attrs:{label:t.name,value:t.muId}})}))],1),t._v(" "),n("div",{staticClass:"cell"},[t._v(t._s(e.showConsumeNum))]),t._v(" "),n("div",{staticClass:"cell"},[t._v(t._s(parseInt(100*e.yield))+"%")]),t._v(" "),n("div",{staticClass:"cell"},[t._v(t._s(e.showNetMaterial))]),t._v(" "),n("div",{staticClass:"cell"},[t._v(t._s(e.wids?e.wids.length:""))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}],staticClass:"area-detail"},t._l(e.host,function(e,i){return n("div",{key:i,staticClass:"area-cell"},[n("span",[t._v(t._s(i+1))]),t._v(" "),n("i",[t._v(t._s(e))])])}))])}),t._v(" "),0==t.bomDetail.length?n("div",{staticClass:"bom-tips"},[t._v("\n\t\t\t\t\t无条目信息\n\t\t\t\t")]):t._e()],2)])])])},[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"table-head"},[n("span",[t._v("序号")]),t._v(" "),n("span",[t._v("物料名称")]),t._v(" "),n("span",[t._v("消耗单位")]),t._v(" "),n("span",[t._v("毛料")]),t._v(" "),n("span",[t._v("出成率")]),t._v(" "),n("span",[t._v("净料")]),t._v(" "),n("span",[t._v("已选仓库数")])])}],!1,null,"122675e2",null);e.default=u.exports}}]);