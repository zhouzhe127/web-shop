(window.webpackJsonp=window.webpackJsonp||[]).push([["bom_detail"],{3629:function(t,e,i){"use strict";var n=i("3b5a");i.n(n).a},"3b5a":function(t,e,i){},e298:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"bom-detail"}},[i("div",{staticClass:"headBox"},[i("div",{staticClass:"headTitle"},[t._v("BOM单信息")]),t._v(" "),i("div",{staticClass:"innerBox"},[i("ul",[i("li",[i("span",[t._v("商品名称 : "+t._s(t.bom.gName))])]),t._v(" "),i("li",[i("span",[t._v("BOM单编号 : ")]),t._v(" "),i("span",[t._v(t._s(t.bom.bomNum))])]),t._v(" "),i("li",[i("span",[t._v("BOM单类型 : ")]),t._v(" "),i("span",[t._v(t._s(1==t.bom.isPublic?"公开":"保密"))])])]),t._v(" "),i("ul",[i("li",[i("span",[t._v("创建人 : ")]),t._v(" "),i("span",[t._v(t._s(t.bom.createName))])]),t._v(" "),i("li",[i("span",[t._v("自动消耗 : ")]),t._v(" "),i("span",[t._v(t._s(1==t.bom.isAuto?"开":"关"))])]),t._v(" "),i("li",[i("span",[t._v("库存可以为负数 : ")]),t._v(" "),i("span",[t._v(t._s(1==t.bom.isOversold?"是":"否"))])])]),t._v(" "),i("ul",[i("li",[i("span",[t._v("备注 : "+t._s(t.bom.remark))])])])]),t._v(" "),i("div",{staticClass:"search"},[i("div",{staticClass:"blue filter",on:{click:t.turnToEdit}},[t._v("修改")]),t._v(" "),i("div",{staticClass:"gray reset",on:{click:t.deleteBom}},[t._v("删除")])])]),t._v(" "),i("div",{staticClass:"table"},[i("div",{staticClass:"table-title"},[t._v("\n\t\t\t批次列表\n\t\t\t"),i("span",{staticClass:"circle"}),t._v("共\n\t\t\t"),i("span",{staticClass:"tips-num"},[t._v(t._s(t.bomDetail.length))]),t._v("个条目\n\t\t\t"),i("a",{staticClass:"showDetail",on:{click:function(e){t.showDetail=!t.showDetail}}},[t._v(t._s(t.showDetail?"简洁":"详细"))])]),t._v(" "),i("div",{staticClass:"scroll-box"},[t._m(0),t._v(" "),i("div",{staticClass:"table-body"},[t._l(t.bomDetail,function(e,n){return i("div",{key:n,staticClass:"table-row"},[i("div",{staticClass:"cell"},[t._v(t._s(n+1))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(e.mName))]),t._v(" "),i("div",{staticClass:"cell"},[i("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择bom单类型"},on:{change:function(i){t.changeUnit(i,e,n)}},model:{value:e.unitShowId,callback:function(i){t.$set(e,"unitShowId",i)},expression:"item.unitShowId"}},t._l(e.unit,function(t){return i("el-option",{key:t.muId,attrs:{label:t.name,value:t.muId}})}))],1),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(e.showConsumeNum))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(parseInt(100*e.yield))+"%")]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(e.showNetMaterial))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(e.wids?e.wids.length:""))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}],staticClass:"area-detail"},t._l(e.host,function(e,n){return i("div",{key:n,staticClass:"area-cell"},[i("span",[t._v(t._s(n+1))]),t._v(" "),i("i",[t._v(t._s(e))])])}))])}),t._v(" "),0==t.bomDetail.length?i("div",{staticClass:"bom-tips"},[t._v("\n\t\t\t\t\t无条目信息\n\t\t\t\t")]):t._e()],2)])])])};n._withStripped=!0;var a=i("81a2"),s=i("05dd"),o=i("f6ce");function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(a,s){try{var o=e[a](s),l=o.value}catch(t){return void i(t)}if(!o.done)return Promise.resolve(l).then(function(t){n("next",t)},function(t){n("throw",t)});t(l)}("next")})}}var r={data:function(){return{bomId:"",bom:{},bomDetail:[],showDetail:!1}},methods:{deleteBom:function(){var t=this;this.$store.commit("setWin",{content:"确认删除该BOM单?",winType:"confirm",callback:function(e){"ok"==e&&t.BillmaterialDelBom(t.bomId).then(function(e){if(e){var i=t.$route.query;o.a.session("bomListDestroy",!0),t.$router.push({path:"/admin/bomList",query:i})}else t.$store.commit("setWin",{content:"删除BOM失败!"})})}})},arrestClickEvent:function(t,e,i){i.cancelBubble=!0,this.bomDetail=this.bomDetail.map(function(e){return t.id==e.id?(e.toggleUnit=!e.toggleUnit,e):(e.toggleUnit=!1,e)})},changeUnit:function(t,e,i){for(var n={},a=0;a<e.unit.length;a++){var o=e.unit[a];o.muId==t&&(n=o)}e.showConsumeNum=s.a.comUnit(e.consumeMinVal,Number(n.value),n.name,e.minUnitName),e.showNetMaterial=s.a.comUnit(e.netMaterialMinVal,Number(n.value),n.name,e.minUnitName),e.consumeUnitName=n.name,e.newConsumeNum=Number(e.consumeMinVal)/Number(n.value),e.unitShowId=n.muId,this.bomDetail.splice(i,1,e)},BillmaterialGetBomDetail:function(t){var e=this;return l(regeneratorRuntime.mark(function i(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.BillmaterialGetBomDetail({data:{bid:t}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},i,e)}))()},BillmaterialDelBom:function(t){var e=this;return l(regeneratorRuntime.mark(function i(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.BillmaterialDelBom({data:{id:t}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},i,e)}))()},initData:function(){this.bomId=this.$route.query.id},initBtn:function(){var t=this;this.$store.commit("setPageTools",[{name:"返回",className:["back"],fn:function(){o.a.session("bomListDestroy",!0),delete t.$route.query.id,t.$router.push({path:"/admin/bomList",query:t.$route.query})}}])},turnToEdit:function(){var t=this.$route.query;t.id=this.bomId,this.$router.push({path:"bomChange",query:t})},domClick:function(){this.bomDetail=this.bomDetail.map(function(t){return t.toggleUnit=!1,t})}},mounted:function(){var t=this;this.initData(),this.initBtn(),this.BillmaterialGetBomDetail(this.bomId).then(function(e){e instanceof Array&&0==e.length||!e?e=[]:(t.bom=e,e.detail=e.detail.map(function(t){t.toggleUnit=!1,t.wids=t.wids.split(","),t.host=t.warehouseName.map(function(t){return t.name});var e=null,i=null,n=null;t.unit.forEach(function(t){1==t.isMin&&(e=t.muId,n=t.name),1==t.isDefault&&(i=t.muId)}),t.minUnitId=e,t.minUnitName=n,t.defaultUnitId=i,t.unitShowId=i;var a=null,o=null,l=null,r=null;return t.unit.some(function(e){if(e.muId==t.consumeUnit)return a=Number(t.consumeNum),r=Number(t.netMaterial),o=e.name,l=e.value,!0}),t.consumeMinVal=a,t.netMaterialMinVal=r,t.newConsumeNum=t.consumeNum,t.consumeUnitName=o,t.showConsumeNum=s.a.comUnit(t.consumeMinVal,l,o,n),t.showNetMaterial=s.a.comUnit(t.netMaterialMinVal,l,o,n),t}),t.bomDetail=e.detail)}),document.addEventListener("click",this.domClick,!1)},components:{},beforeDestroy:function(){document.removeEventListener("click",this.domClick)}},u=(i("3629"),i("6ceb")),c=Object(u.a)(r,n,[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table-head"},[i("span",[t._v("序号")]),t._v(" "),i("span",[t._v("物料名称")]),t._v(" "),i("span",[t._v("消耗单位")]),t._v(" "),i("span",[t._v("毛料")]),t._v(" "),i("span",[t._v("出成率")]),t._v(" "),i("span",[t._v("净料")]),t._v(" "),i("span",[t._v("已选仓库数")])])}],!1,null,"f5eee8a0",null);c.options.__file="src\\module\\invoicing_system\\invoicing\\bom_detail.vue";e.default=c.exports}}]);