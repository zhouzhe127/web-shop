(window.webpackJsonp=window.webpackJsonp||[]).push([["bom_list"],{"5d21":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bom-order"},[a("div",{staticClass:"filter"},[a("span",{staticClass:"inline-span"},[e._v("创建时间：")]),e._v(" "),a("div",{staticClass:"inline-box"},[a("calendar",{attrs:{time:e.startTime,type:e.selectedType,format:"yyyy年MM月dd日"},on:{emit:e.startTimeChange}})],1),e._v(" "),a("span",{staticClass:"inline-span"},[e._v("-")]),e._v(" "),a("div",{staticClass:"inline-box date-box"},[a("calendar",{attrs:{time:e.endTime,type:e.selectedType,format:"yyyy年MM月dd日"},on:{emit:e.endTimeChange}}),e._v(" "),a("em",{staticClass:"search-btn",on:{click:e.filter}})],1),e._v(" "),a("div",{staticClass:"block"},[a("div",{staticClass:"inline-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.createName,expression:"createName"}],attrs:{type:"text",placeholder:"请输入创建人"},domProps:{value:e.createName},on:{input:function(t){t.target.composing||(e.createName=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"inline-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.gName,expression:"gName"}],attrs:{type:"text",placeholder:"请输入商品名称/编码"},domProps:{value:e.gName},on:{input:function(t){t.target.composing||(e.gName=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"inline-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.bomNum,expression:"bomNum"}],attrs:{type:"text",placeholder:"请输入bom单编号"},domProps:{value:e.bomNum},on:{input:function(t){t.target.composing||(e.bomNum=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"inline-box setspeen"},[a("selectBtn",{attrs:{sorts:e.options,index:e.bomTypeIndex},on:{emit:e.dropBomType}}),e._v(" "),a("div",{staticClass:"inline-box button-box"},[a("span",{staticClass:"blue",on:{click:e.filter}},[e._v("筛选")]),e._v(" "),a("span",{staticClass:"gray",on:{click:e.reset}},[e._v("重置")])])],1)])]),e._v(" "),a("com-table",{attrs:{listName:"BOM单列表",titleData:e.titleList,allTotal:e.listLength,introData:e.list},scopedSlots:e._u([{key:"con-0",fn:function(t){return a("span",{staticClass:"detail",on:{click:function(a){e.listHandle(t.data.id)}}},[e._v("查看详情")])}},{key:"con-1",fn:function(t){return a("span",{},[e._v(e._s((e.page-1)*e.pageShow+t.index>=9?(e.page-1)*e.pageShow+t.index+1:"0"+((e.page-1)*e.pageShow+t.index+1)))])}},{key:"con-4",fn:function(t){return a("span",{},[e._v(e._s(e.formatTime(t.data.createTime)))])}},{key:"con-6",fn:function(t){return a("span",{},[e._v(e._s(e.setBomType(t.data.isPublic)))])}}])}),e._v(" "),a("div",{staticClass:"page-box"},[a("pageBtn",{attrs:{total:e.pageTotal,page:e.page,isNoJump:!0},on:{pageNum:e.pageChange}})],1)],1)};i._withStripped=!0;var n=a("f6ce"),s=a("bbb9"),o=a("81a2");var r={data:function(){return{startTime:(new Date).setHours(0,0,0,0),endTime:(new Date).setHours(0,0,0,0),cid:"",isBrand:0,selectedType:0,options:["全部BOM单类型","公开","私密"],bomTypeList:[0,1,-1],isPublic:0,bomTypeIndex:0,prevIndex:0,page:1,pageShow:10,pageTotal:1,list:[],listLength:0,userData:"",createName:"",shopType:"",bomNum:"",gName:"",titleList:[{titleName:"操作"},{titleName:"序号"},{titleName:"商品名称",dataName:"itemName"},{titleName:"创建人",dataName:"createName"},{titleName:"创建时间"},{titleName:"BOM单编号",dataName:"bomNum"},{titleName:"BOM类型"}],requestObj:{},isInit:!0}},components:{pageBtn:function(){return a.e("page_element").then(a.bind(null,"5921"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},calendar:function(){return a.e("calendar_type").then(a.bind(null,"f2dd"))},comTable:function(){return a.e("table").then(a.bind(null,"4360"))}},created:function(){this.userData=n.a.session("userShop"),this.cid=this.userData.user.id,this.isBrand="3"==this.userData.currentShop.ischain?1:0},mounted:function(){var e=this;this.$store.commit("setPageTools",{bomCreate:function(){e.$router.push({path:"bomList/bomCreate",query:e.$route.query})}}),this.initData(),this.getData()},methods:{initData:function(){this.shopType=this.isBrand;var e=n.a.session("bomListCache");if(n.a.session("bomListDestroy")&&e){for(var t in e)this[t]=e[t];n.a.session("bomListCache",null),n.a.session("bomListDestroy",null)}},startTimeChange:function(e){this.startTime=e},endTimeChange:function(e){this.endTime=e},dropBomType:function(e){this.isPublic=this.bomTypeList[e],this.bomTypeIndex=e,this.filter()},setBomType:function(e){return"1"==e?"公开":"-1"==e?"私密":void 0},formatTime:function(e){return s.a.format(new Date(1e3*e),"yyyy-MM-dd hh:mm:ss")},filter:function(){this.page=1,this.isInit=!1,this.getData()},getData:function(){var e,t=this;return(e=regeneratorRuntime.mark(function e(){var a,i,s,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.validate()){e.next=2;break}return e.abrupt("return");case 2:return a="",i="",s=new Date(t.endTime).setHours(23,59,59,0),t.isInit?(a="",i=""):(a=parseInt(t.startTime/1e3),i=parseInt(s/1e3)),e.next=7,o.a.bomBillmaterialGetBomList({data:{createUid:t.cid,startTime:a,endTime:i,page:t.page,num:t.pageShow,createName:t.createName,shopType:t.shopType,isPublic:t.isPublic,bomNum:t.bomNum,gName:t.gName}});case 7:if(r=e.sent){e.next=11;break}return t.$store.commit("setWin",{title:"温馨提示",content:"您没有权限查看私密bom单！"}),e.abrupt("return");case 11:t.list=r.list,t.listLength=r.totalCount,t.pageTotal=r.totalPage,t.requestObj={startTime:t.startTime,endTime:s,page:t.page,pageShow:t.pageShow,createName:t.createName,shopType:t.shopType,isPublic:t.isPublic,bomNum:t.bomNum,gName:t.gName,bomTypeIndex:t.bomTypeIndex,pageTotal:t.pageTotal},n.a.session("bomListCache",t.requestObj);case 16:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function i(n,s){try{var o=t[n](s),r=o.value}catch(e){return void a(e)}if(!o.done)return Promise.resolve(r).then(function(e){i("next",e)},function(e){i("throw",e)});e(r)}("next")})})()},reset:function(){for(var e in this.requestObj)"startTime"==e||"endTime"==e?this[e]=(new Date).setHours(0,0,0,0):"page"==e?this[e]=1:"bomTypeIndex"==e?this[e]=0:"pageShow"==e?this[e]=10:"pageTotal"!=e&&(this[e]="");this.isInit=!0,this.getData()},validate:function(){return!(parseInt(this.startTime/1e3/3600/24)>parseInt(this.endTime/1e3/3600/24))||(this.$store.commit("setWin",{title:"提示信息",content:"开始时间不能大于结束时间"}),!1)},pageChange:function(e){this.page=e.page,this.pageShow=e.num,this.getData()},listHandle:function(e){var t=this.$route.query;t.id=e,this.$router.push({path:"bomList/bomDetail",query:t})}}},m=(a("ddec"),a("6ceb")),c=Object(m.a)(r,i,[],!1,null,"59b84986",null);c.options.__file="src\\module\\invoicing_system\\invoicing\\bom_list.vue";t.default=c.exports},"5d6c":function(e,t,a){},ddec:function(e,t,a){"use strict";var i=a("5d6c");a.n(i).a}}]);