(window.webpackJsonp=window.webpackJsonp||[]).push([["menu_set"],{1224:function(t,e,n){"use strict";var i=n("bdad");n.n(i).a},3645:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mall-menu",staticStyle:{width:"1517px"},attrs:{id:"menu"}},[n("header",{staticClass:"menu_header"},[n("ul",[n("li",[n("button",{staticClass:"btns",class:0==t.menuIndex?"btn_blue":"",on:{click:function(e){t.selectMenu("default",0)}}},[t._v("默认菜单")])]),t._v(" "),t._l(t.menuName,function(e,i){return n("li",{key:i},[n("button",{staticClass:"btns",class:i+1==t.menuIndex?"btn_blue":"",on:{click:function(n){t.selectMenu(e,i+1)}}},[t._v(t._s(e.name))])])})],2)]),t._v(" "),n("div",{staticClass:"menu-reveal fl"},[n("div",{staticClass:"menu-title"},[t._v("闪店商家")]),t._v(" "),n("div",{staticClass:"menu-content"},[n("ul",{staticClass:"menu-list",attrs:{id:"js-menuList"}},[t._l(t.menuList,function(e,i){return t.menuList.length>=1?n("li",{key:i,class:{"Parent ParentOn":"1"==e.status,Parent:"1"!=e.status}},[n("span",{on:{click:function(e){t.getDetailParent(i,e)}}},[t._v(t._s(e.name))]),t._v(" "),t.parentIndex==i?n("div",{staticClass:"menu-child"},[n("ul",[t._l(e.sub_button,function(e,s){return n("li",{key:s,class:{ParentOn:"1"==e.status},on:{click:function(e){t.getDetailChild(i,s)}}},[t._v(t._s(e.name))])}),t._v(" "),n("li",{on:{click:function(e){t.addChildMenu(e)}}},[t._m(0,!0)])],2)]):t._e()]):t._e()}),t._v(" "),n("li",{staticClass:"menu-list-add",on:{click:t.addParentMenu}},[t._m(1)])],2)])]),t._v(" "),1==t.addParent||1==t.addChild?n("div",{staticClass:"menu-config fl"},[n("div",{staticClass:"menu-config-title",staticStyle:{position:"relative"}},[n("span",{staticClass:"required fl"},[t._v("菜单配置")]),t._v(" "),1==t.addParent?n("input",{directives:[{name:"model",rawName:"v-model",value:t.parentTitle,expression:"parentTitle"}],attrs:{type:"text",placeholder:"请输入菜单名称"},domProps:{value:t.parentTitle},on:{blur:t.selectType,input:function(e){e.target.composing||(t.parentTitle=e.target.value)}}}):t._e(),t._v(" "),1==t.addChild?n("input",{directives:[{name:"model",rawName:"v-model",value:t.childTitle,expression:"childTitle"}],attrs:{type:"text",placeholder:"请输入菜单名称"},domProps:{value:t.childTitle},on:{blur:t.selectType,input:function(e){e.target.composing||(t.childTitle=e.target.value)}}}):t._e(),t._v(" "),1==t.addParent?n("a",{staticClass:"fr menu-del",attrs:{href:"javascript:void(0)"},on:{click:t.delParent}},[t._v("删除菜单")]):t._e(),t._v(" "),1==t.addChild?n("a",{staticClass:"fr menu-del",attrs:{href:"javascript:void(0)"},on:{click:t.delChild}},[t._v("删除子菜单")]):t._e(),t._v(" "),1==t.addParent?n("p",{staticStyle:{position:"absolute",left:"100px",color:"#ccc"}},[t._v("字数不超过4个汉字或8个字母")]):t._e(),t._v(" "),1==t.addChild?n("p",{staticStyle:{position:"absolute",left:"100px",color:"#ccc"}},[t._v("字数不超过8个汉字或16个字母")]):t._e()]),t._v(" "),n("div",{staticClass:"menu-config-content"},[0==t.parentHide?n("div",{staticClass:"fl"},[n("span",{staticClass:"fl caiDan"},[t._v("菜单内容")]),t._v(" "),n("radioBtn",{attrs:{list:t.typeList,index:t.typeIndex,name:"name"},on:{selOn:t.doThrowWinResult}})],1):t._e(),t._v(" "),n("div",{staticClass:"menu-message fl"},["1"==t.type&&0==t.parentHide?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{placeholder:"请输入发送消息内容...",maxlength:"150"},domProps:{value:t.message},on:{blur:t.selectType,input:function(e){e.target.composing||(t.message=e.target.value)}}}):t._e(),t._v(" "),"2"==t.type&&0==t.parentHide?n("div",{staticClass:"fl"},[n("span",{staticClass:"fl spanUrl"},[t._v("请输入url：")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.urls,expression:"urls"}],staticClass:"fl",attrs:{type:"text",placeholder:"请输入url地址"},domProps:{value:t.urls},on:{blur:t.selectType,input:function(e){e.target.composing||(t.urls=e.target.value)}}})]):t._e()])])]):n("div",{staticClass:"menu-config",staticStyle:{"line-height":"580px","text-align":"center","background-color":"transparent"}},[t._v("点击左侧菜单进行编辑操作")]),t._v(" "),n("div",{staticClass:"menu-setMenu fl"},[n("a",{staticClass:"setMenu-config",staticStyle:{"line-height":"51px",width:"200px",height:"51px","margin-left":"329px",background:"RGB(179,179,179)"},attrs:{href:"javascript:void(0)"},on:{click:t.delMenu}},[t._v("删除")]),t._v(" "),n("a",{staticClass:"yellow setMenu-config",staticStyle:{width:"200px",height:"51px","margin-left":"15px"},attrs:{href:"javascript:void(0)"},on:{click:t.saveMenu}},[t._v("保存并发布")])]),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.isShowMenuWin?n("win",{attrs:{width:591,height:248},on:{winEvent:t.winEvent}},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("新建分组菜单")]),t._v(" "),n("div",{staticClass:"menu_win",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"menu_content_group"},[n("span",[t._v("关联用户组")]),t._v(" "),n("mul-select",{attrs:{styles:{border:"1px solid RGB(210,210,210)",margin:"9px 10px 0 0"},list:t.menuselName,selects:t.selects,name:"name",keys:"id",isradio:!0}})],1)])]):t._e()],1)],1)};i._withStripped=!0;var s=n("81a2"),a=n("f6ce"),u=n("bbb9");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(s,a){try{var u=e[s](a),r=u.value}catch(t){return void n(t)}if(!u.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var l={data:function(){return{menuList:[],addParent:!1,addChild:!1,parentIndex:null,childIndex:null,parentTitle:"菜单名称",childTitle:"子菜单名称",index:null,message:String,type:"1",urls:String,typeList:[],typeIndex:0,parentHide:!1,userData:Object,menuName:[],isShowMenuWin:!1,menuselName:[],selects:[],allMenu:[],menuIndex:0,menuId:"default",saveStatus:!0}},mounted:function(){var t=this;this.$store.commit("setPageTools",[{name:"新建分组菜单",fn:function(){t.createNewMenu()},className:"userLabel"}]),this.userData=a.a.session("userShop"),this.getMenu(),this.getSelfMenu(),this.getUserGroups()},methods:{winEvent:function(t){if("ok"==t){var e=!0,n=!1,i=void 0;try{for(var s,a=this.menuName[Symbol.iterator]();!(e=(s=a.next()).done);e=!0){if(s.value.matchRule==this.selects[0])return this.valiData("不能重复创建分组菜单"),!1}}catch(t){n=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw i}}this.isShowMenuWin=!1,this.createMenuGroup()}else this.isShowMenuWin=!1},createMenuGroup:function(){var t=!0,e=!1,n=void 0;try{for(var i,s=this.menuselName[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value;if(this.selects[0]==a.id){this.menuName.push({id:a.id,name:a.name,menuId:"newType"});break}}}catch(t){e=!0,n=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw n}}this.menuIndex=this.menuName.length,this.menuList=[],this.menuId="newType",this.matchRule=this.selects[0]},valiData:function(t){this.$store.commit("setWin",{title:"操作提示",content:t,winType:"alert"})},delMenu:function(){var t=this;return r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("default"!=t.menuId){e.next=3;break}return t.valiData("默认菜单无法删除"),e.abrupt("return",!1);case 3:if("newType"!=t.menuId){e.next=9;break}return t.menuName.pop(),t.valiData("删除成功"),t.menuIndex=0,t.menuList=t.allMenu.menu,e.abrupt("return",!1);case 9:return e.next=11,s.a.delMenuGroup({data:{menuId:t.menuId}});case 11:t.valiData("删除成功"),t.allMenu.conditionalmenu.splice(t.menuIndex-1,1),t.menuName.splice(t.menuIndex-1,1),t.menuIndex=0,t.menuList=t.allMenu.menu,t.menuId="default";case 17:case"end":return e.stop()}},e,t)}))()},selectMenu:function(t,e){this.menuIndex=e,"default"==t?(this.menuId="default",this.menuList=this.allMenu.menu):"newType"==t.menuId?(this.menuId=t.menuId,this.menuList=[],this.matchRule=this.selects[0]):(this.menuId=t.menuId,this.menuList=this.allMenu.conditionalmenu[e-1].menu,this.matchRule=t.matchRule)},getUserGroups:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getUserGroups({data:{}});case 2:(n=e.sent)&&(t.menuselName=Object.values(n));case 4:case"end":return e.stop()}},e,t)}))()},createNewMenu:function(){var t=!0,e=!1,n=void 0;try{for(var i,s=this.menuName[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){if("newType"==i.value.menuId)return this.$store.commit("setWin",{title:"操作提示",content:"请保存菜单后再创建",winType:"alert"}),!1}}catch(t){e=!0,n=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw n}}this.isShowMenuWin=!0,this.selects=[]},doThrowWinResult:function(t){this.typeIndex=t,this.selectType()},isURL:function(t){return!/^((https|http|ftp|rtsp|mms)?:\/\/)+[A-Za-z0-9]+\.[A-Za-z0-9]+[/=?%\-&_~`@[\]':+!]*([^<>"''])*$/.test(t)},fucCheckLength:function(t){var e=void 0,n=0;for(e=0;e<t.length;e++)t.charCodeAt(e)>=0&&t.charCodeAt(e)<=255?n+=1:n+=2;return n},getMenu:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n,i,a,u,r,l,o,d,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getWeChatMenu({data:{}});case 2:if(!(n=e.sent)||""==n){e.next=28;break}for(t.allMenu=n,i=n.conditionalmenu.reverse(),a=[],u=!0,r=!1,l=void 0,e.prev=10,o=i[Symbol.iterator]();!(u=(d=o.next()).done);u=!0)c=d.value,a.push({name:c.groupInfo.menuName,menuId:c.groupInfo.menuId,matchRule:c.groupInfo.matchRule.group_id});e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),r=!0,l=e.t0;case 18:e.prev=18,e.prev=19,!u&&o.return&&o.return();case 21:if(e.prev=21,!r){e.next=24;break}throw l;case 24:return e.finish(21);case 25:return e.finish(18);case 26:t.menuName=a,"default"==t.menuId?t.menuList=n.menu:(t.menuList=i[t.menuIndex-1].menu,t.menuId=i[t.menuIndex-1].groupInfo.menuId);case 28:case"end":return e.stop()}},e,t,[[10,14,18,26],[19,,21,25]])}))()},getSelfMenu:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getSelfMenu({data:{shopId:t.userData.currentShop.id}});case 2:(n=e.sent)&&(t.typeList=n);case 4:case"end":return e.stop()}},e,t)}))()},saveMenu:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n,i,a,r,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.saveStatus){e.next=3;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请勿重复保存"}),e.abrupt("return",!1);case 3:n=t.menuList,i=void 0,a=void 0,i=0;case 6:if(!(i<n.length)){e.next=51;break}if(void 0==n[i].sub_button){e.next=30;break}a=0;case 9:if(!(a<n[i].sub_button.length)){e.next=30;break}if("1"!=n[i].sub_button[a].type){e.next=19;break}if(void 0!=n[i].sub_button[a].message&&""!=u.a.trim(n[i].sub_button[a].message)){e.next=19;break}return t.$store.commit("setWin",{title:"操作提示",winType:"alter",content:n[i].sub_button[a].name+"请填写消息内容！"}),t.addChild=!0,t.addParent=!1,t.childTitle=n[i].sub_button[a].name,t.type=n[i].sub_button[a].type,t.getTypeIndex(),e.abrupt("return",!1);case 19:if("2"!=n[i].sub_button[a].type){e.next=27;break}if(void 0!=n[i].sub_button[a].url&&""!=u.a.trim(n[i].sub_button[a].url)){e.next=27;break}return t.$store.commit("setWin",{title:"操作提示",winType:"alter",content:n[i].sub_button[a].name+"请填写url地址！"}),t.addChild=!0,t.addParent=!1,t.childTitle=n[i].sub_button[a].name,t.type=n[i].sub_button[a].type,e.abrupt("return",!1);case 27:a++,e.next=9;break;case 30:if("1"!=n[i].type||void 0!=n[i].sub_button){e.next=39;break}if(void 0!=n[i].message&&""!=u.a.trim(n[i].message)){e.next=39;break}return t.$store.commit("setWin",{title:"操作提示",winType:"alter",content:n[i].name+"请填写消息内容！"}),t.addParent=!0,t.addChild=!1,t.parentTitle=n[i].name,t.type=n[i].type,t.getTypeIndex(),e.abrupt("return",!1);case 39:if("2"!=n[i].type||void 0!=n[i].sub_button){e.next=48;break}if(void 0!=n[i].url&&""!=u.a.trim(n[i].url)){e.next=48;break}return t.$store.commit("setWin",{title:"操作提示",winType:"alter",content:n[i].name+"请填写url地址！"}),t.addParent=!0,t.addChild=!1,t.parentTitle=n[i].name,t.type=n[i].type,t.getTypeIndex(),e.abrupt("return",!1);case 48:i++,e.next=6;break;case 51:if(r="","default"!=t.menuId){e.next=58;break}return e.next=55,s.a.saveWeChateMenu({data:{menuData:JSON.stringify(n)}});case 55:r=e.sent,e.next=71;break;case 58:if(l="",!isNaN(t.menuId)){e.next=63;break}l=!0,e.next=66;break;case 63:return e.next=65,s.a.delMenuGroup({data:{menuId:t.menuId}});case 65:l=e.sent;case 66:if(!l){e.next=71;break}return t.saveStatus=!1,e.next=70,s.a.saveIndividuation({data:{menuData:JSON.stringify(n),matchRule:{tag_id:t.matchRule}}});case 70:r=e.sent;case 71:r&&(t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"保存成功！"}),t.getMenu(!0),t.saveStatus=!0,t.addParent=!1,t.addChild=!1);case 72:case"end":return e.stop()}},e,t)}))()},getDetailParent:function(t){if(this.addParent=!0,this.addChild=!1,this.Highlight(),this.parentIndex=t,void 0!=this.menuList[t].sub_button?"{}"!=JSON.stringify(this.menuList[t].sub_button)&&(this.parentHide=!0):this.parentHide=!1,void 0!=t){this.parentTitle=this.menuList[t].name,this.type=void 0==this.menuList[t].type?"1":this.menuList[t].type,this.message=void 0==this.menuList[t].message?"":this.menuList[t].message,this.urls=void 0==this.menuList[t].url?"":this.menuList[t].url;var e=this.menuList[t];e.status="1",this.menuList.splice(t,1,e),this.menuList=u.a.deepCopy(this.menuList),void 0!=this.menuList[t].type?this.getTypeIndex():this.typeIndex=0}else this.parentTitle="菜单名称"},getDetailChild:function(t,e){if(this.index=t,this.childIndex=e,this.Highlight(),void 0!=this.menuList[t].sub_button?this.parentHide=!1:this.parentHide=!0,void 0!=e){this.childTitle=this.menuList[this.index].sub_button[e].name,this.message=void 0==this.menuList[this.index].sub_button[e].message?"":this.menuList[this.index].sub_button[e].message,this.urls=void 0==this.menuList[this.index].sub_button[e].url?"":this.menuList[this.index].sub_button[e].url,this.type=this.menuList[this.index].sub_button[e].type;var n=this.menuList[t].sub_button[e];n.status="1",this.menuList[t].sub_button.splice(e,1,n),this.menuList=u.a.deepCopy(this.menuList),this.getTypeIndex()}else this.childTitle="子菜单名称",this.typeIndex=0;this.addChild=!0,this.addParent=!1},selectType:function(){if(this.type=this.typeList[this.typeIndex].type,"2"==this.type&&""!=u.a.trim(this.urls)&&this.isURL(this.urls))return this.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"url地址格式错误！"}),!1;this.Highlight();var t={},e=[];if(this.addParent){if(this.fucCheckLength(u.a.trim(this.parentTitle))>8)return this.$store.commit("setWin",{title:"错误提示",winType:"alter",content:"菜单名称长度超出！"}),!1;e=u.a.deepCopy(this.menuList[this.parentIndex].sub_button),this.menuList[this.parentIndex]={},t.name=this.parentTitle,t.type=this.type,t.status="1","1"==this.type&&""!=u.a.trim(this.message)?t.message=this.message:"2"==this.type&&""!=u.a.trim(this.urls)&&(t.url=this.urls),t.sub_button=e,this.menuList.splice(this.parentIndex,1,t)}else{if(this.fucCheckLength(u.a.trim(this.childTitle))>16)return this.$store.commit("setWin",{title:"错误提示",winType:"alter",content:"菜单名称长度超出！"}),!1;this.menuList[this.parentIndex].sub_button[this.childIndex]={},t.name=this.childTitle,t.type=this.type,t.status="1","1"==this.type&&""!=u.a.trim(this.message)?t.message=this.message:"2"==this.type&&""!=u.a.trim(this.urls)&&(t.url=this.urls),this.menuList[this.parentIndex].sub_button.splice(this.childIndex,1,t)}},getTypeIndex:function(){var t=void 0;for(t=0;t<this.typeList.length;t++)this.typeList[t].type==this.type&&(this.typeIndex=t)},addParentMenu:function(){this.parentTitle="菜单名称",this.message="",this.urls="",this.addParent=!0,this.addChild=!1,this.type="1",this.Highlight(),this.menuList.push({name:this.parentTitle,type:"1",status:"1"}),this.typeIndex=0,this.parentIndex=this.menuList.length-1<0?0:this.menuList.length-1},addChildMenu:function(){if(void 0==this.menuList[this.parentIndex].sub_button&&(this.menuList[this.parentIndex].sub_button=[]),5==this.menuList[this.parentIndex].sub_button.length)return this.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"最多添加5个子菜单！"}),!1;this.childTitle="子菜单名称",this.message="",this.urls="",this.addChild=!0,this.addParent=!1,this.type="1",this.Highlight(),this.menuList[this.parentIndex].sub_button.push({name:this.childTitle,type:"1",status:"1"}),this.menuList=u.a.deepCopy(this.menuList),this.typeIndex=0,this.childIndex=this.menuList[this.parentIndex].sub_button.length-1},delParent:function(){var t=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:"确认删除菜单？",callback:function(e){"ok"==e&&(t.menuList.splice(t.parentIndex,1),t.addChild=!1,t.addParent=!1,t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"删除成功！"}))}})},delChild:function(){var t=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:"确认删除子菜单？",callback:function(e){"ok"==e&&(1==t.menuList[t.parentIndex].sub_button.length?(t.menuList[t.parentIndex].sub_button.splice(t.childIndex,1),delete t.menuList[t.parentIndex].sub_button):t.menuList[t.parentIndex].sub_button.splice(t.childIndex,1),t.addChild=!1,t.addParent=!1,t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"删除成功！"}))}})},Highlight:function(){var t=void 0,e=void 0;for(t=0;t<this.menuList.length;t++)if(this.menuList[t].status="0",void 0!=this.menuList[t].sub_button)for(e=0;e<this.menuList[t].sub_button.length;e++)this.menuList[t].sub_button[e].status="0"}},components:{radioBtn:function(){return n.e("radio_btn").then(n.bind(null,"4dfe"))},"mul-select":function(){return n.e("mul_select").then(n.bind(null,"7d09"))},win:function(){return n.e("win").then(n.bind(null,"f60a"))}}},o=(n("1224"),n("7610")),d=Object(o.a)(l,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"addChild",staticStyle:{width:"100%",height:"100%"},attrs:{href:"javascript:void(0);",title:"最多添加5个子菜单",draggable:"false"}},[e("i",{staticClass:"icon-menu-add"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"pre_menu_link",staticStyle:{width:"100%",height:"100%"},attrs:{href:"javascript:void(0);",title:"最多添加3个菜单",draggable:"false"}},[e("i",{staticClass:"icon-menu-add"})])}],!1,null,"5b55a862",null);d.options.__file="src\\module\\public_number_configuration\\menu_set.vue";e.default=d.exports},bdad:function(t,e,n){}}]);