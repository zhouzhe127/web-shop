(window.webpackJsonp=window.webpackJsonp||[]).push([["brand_order_bill"],{"15e2":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"brandBill"},[t.brand?i("div",{staticClass:"brand"},[i("div",{staticClass:"filter"},[i("div",{staticClass:"block"},[i("selectBtn",{attrs:{sorts:t.timeTypeList,width:150},on:{emit:t.getTimeType}})],1),t._v(" "),i("div",{staticClass:"block"},[i("calendar",{attrs:{time:t.startTime,format:"yyyy年MM月dd日"},on:{emit:t.startTimeChange}}),t._v(" "),i("span",{staticClass:"input-word"},[t._v("--")]),t._v(" "),i("calendar",{attrs:{time:t.endTime,format:"yyyy年MM月dd日"},on:{emit:t.endTimeChange}})],1),t._v(" "),i("div",{staticClass:"block time"},[i("i",{class:{active:1==this.isOpenTime},on:{click:t.timeCheck}}),t._v(" "),i("span",[t._v("按营业时间")])]),t._v(" "),i("div",{staticClass:"block"},[i("selectStore",{attrs:{sorts:t.shopList,tipName:t.dropName},on:{emit:t.getDrop}})],1),t._v(" "),i("div",{staticClass:"search-box block"},[i("span",{staticClass:"search-btn yellow",on:{click:t.search}},[t._v("搜索")]),t._v(" "),i("span",{staticClass:"reset-btn gray",on:{click:t.reset}},[t._v("重置")])]),t._v(" "),i("div",{staticClass:"shops"},[i("i",[t._v("已选择店铺：")]),t._v(" "),t._l(t.shopList,function(e,s){return e.selected?i("span",{key:s},[t._v(t._s(e.name)+"，")]):t._e()})],2)]),t._v(" "),t.loadShow?i("div",{staticClass:"loading"},[i("img",{attrs:{src:s("b8bc")}})]):i("div",{staticClass:"main"},[i("div",{staticClass:"total"},[t._m(0),t._v(" "),i("div",{staticClass:"total-data"},[i("span",[t._v(t._s(t.orderTotal.totalDay))]),t._v(" "),i("span",[t._v(t._s(t.orderTotal.orderNum))]),t._v(" "),i("span",[t._v(t._s(t.orderTotal.originalPrice))]),t._v(" "),i("span",[t._v(t._s(t.orderTotal.billPrice))])])]),t._v(" "),i("div",{staticClass:"store-list"},[i("div",{staticClass:"length"},[t._v("\n\t\t\t\t\t挂账统计统计 · 共\n\t\t\t\t\t"),i("span",[t._v(" "+t._s(t.orderStoreList.length)+" ")]),t._v("条记录\n\t\t\t\t")]),t._v(" "),t._m(1),t._v(" "),i("ul",[t._l(t.orderStoreList,function(e,s){return i("li",{key:s},[i("span",{staticClass:"light",on:{click:function(s){t.toDay(e)}}},[t._v(t._s(e.shopName))]),t._v(" "),i("span",[t._v(t._s(e.originalPrice))]),t._v(" "),i("span",[t._v(t._s(e.billPrice))])])}),t._v(" "),t.orderStoreList.length?t._e():i("li",{staticClass:"list-empty"},[t._v("暂时没有挂账")])],2)])])]):i("orderBill",{attrs:{sId:t.sId,shopName:t.shopName,sTime:t.startTime,eTime:t.endTime,isOpen:t.isOpenTime,gType:t.operateTime},on:{return:t.getReturn}})],1)};i._withStripped=!0;var n=s("f6ce"),r=s("bbb9"),a=s("81a2");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,s){return function i(n,r){try{var a=e[n](r),o=a.value}catch(t){return void s(t)}if(!a.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var c={data:function(){return{startTime:"",endTime:"",isOpenTime:1,shopList:[],dropName:"请选择品牌门店",orderStoreList:[],userShopList:[],timeTypeList:["挂账时间","结算时间"],loadShow:!1,orderTotal:{totalDay:1,orderNum:0,originalPrice:0,billPrice:0},brand:!0,operateTime:0,billType:0,timer:null,shopName:"",sId:""}},components:{calendar:function(){return s.e("calendar_type").then(s.bind(null,"f2dd"))},selectStore:function(){return s.e("win").then(s.bind(null,"cb83"))},selectBtn:function(){return s.e("select_btn").then(s.bind(null,"3d41"))},orderBill:function(){return s.e("order_bill_list").then(s.bind(null,"0da2"))}},created:function(){this.userData=n.a.session("userShop"),3!=this.userData.currentShop.ischain&&(this.brand=!1);var t=[],e=[];"3"==this.userData.currentShop.ischain&&(this.userShopList=n.a.session("shopList"),this.userShopList.forEach(function(s,i){t[i]=s.id;var n={id:s.id,name:s.shopName};e.push(n)}),this.userShopIdStr=t.join(","),this.userShopList=e)},mounted:function(){for(var t in this.shopIds=this.userShopIdStr,this.userShopList)this.userShopList[t].selected=!0;this.shopList=this.userShopList,this.storeName=this.userShopList.length>0?this.userShopList[0].name:"选择店铺"},methods:{startTimeChange:function(t){this.startTime=t},endTimeChange:function(t){this.endTime=t},timeCheck:function(){1==this.isOpenTime?this.isOpenTime=0:this.isOpenTime=1},getDrop:function(t){this.shopList=t;var e=[];t.forEach(function(t){t.selected&&e.push(t.id)}),this.shopIds=e.join(",")},getTimeType:function(t){this.operateTime=t},toDay:function(t){this.sId=t.shopId,this.shopName=t.shopName,this.brand=!1,n.a.session("brandBillList",this.orderStoreList)},search:function(){this.billOrderReport()},reset:function(){this.timeTypeList=["挂账时间","结算时间"],this.startTime="",this.endTime="";var t=r.a.deepCopy(this.shopList),e=[];t.forEach(function(t){t.selected=!0,e.push(t.id)}),this.shopList=t,this.shopIds=e.join(",")},getReturn:function(){this.brand=!0,this.orderStoreList=n.a.session("brandBillList")},billOrderReport:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.shopIds){e.next=3;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"请选择店铺"}),e.abrupt("return",!1);case 3:t.loadShow=!0,a.a.billOrderReport({data:{startTime:t.startTime/1e3,endTime:t.endTime/1e3,isOpenTime:t.isOpenTime,operateTime:t.operateTime,billType:t.billType,shopIds:t.shopIds,type:21}}).then(function(e){t.timer&&clearInterval(t.timer),t.taskInfo(e.taskId),t.timer=setInterval(function(){t.taskInfo(e.taskId)},2e3)});case 5:case"end":return e.stop()}},e,t)}))()},taskInfo:function(t){var e=this;return o(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a.a.taskInfo({data:{taskId:t}}).then(function(s){3==s.status?(clearInterval(e.timer),e.ReportGet(t)):2==s.status&&(clearInterval(e.timer),e.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请求失败，请重试"}),e.loadShow=!1)});case 1:case"end":return s.stop()}},s,e)}))()},ReportGet:function(t){var e=this;return o(regeneratorRuntime.mark(function s(){var i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,a.a.ReportGet({data:{taskId:t}});case 2:i=s.sent,e.loadShow=!1,i.total&&(e.orderStoreList=i.shops,e.orderTotal=i.total);case 5:case"end":return s.stop()}},s,e)}))()}},destroyed:function(){clearInterval(this.timer)}},l=(s("787f"),s("7610")),h=Object(l.a)(c,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("天数")]),this._v(" "),e("span",[this._v("订单数")]),this._v(" "),e("span",[this._v("消费总额")]),this._v(" "),e("span",[this._v("挂账总额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("店铺名称")]),this._v(" "),e("span",[this._v("消费金额")]),this._v(" "),e("span",[this._v("挂账金额")])])}],!1,null,"88e9d482",null);h.options.__file="src\\module\\statistics\\brand_order_bill.vue";e.default=h.exports},"578a":function(t,e,s){},"787f":function(t,e,s){"use strict";var i=s("578a");s.n(i).a},b8bc:function(t,e,s){t.exports=s.p+"images/preloader.3e54c692.gif"}}]);