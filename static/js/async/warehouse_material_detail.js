(window.webpackJsonp=window.webpackJsonp||[]).push([["warehouse_material_detail"],{"6cc1":function(t,e,n){"use strict";n.r(e);var a=n("f6ce"),i=n("bbb9"),s=n("81a2"),r=n("05dd"),o=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],a=!0,i=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(a=(r=o.next()).done)&&(n.push(r.value),!e||n.length!==e);a=!0);}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(i,s){try{var r=e[i](s),o=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var u={data:function(){return{tabactive:0,mid:"",wid:"",goodsDetail:{unit:[]},dataUnit:["月","日","年"],goodsData:{},goodsUnit:[],goodsCate:[],selUnit:0,unitIndex:0,minName:"",unitArr:[],page:1,pageTotal:1,count:0,showNum:10,relation:[],batchList:[],selList:[],shopId:"",dataObj:{}}},components:{pageBtn:function(){return n.e("page_element").then(n.bind(null,"5921"))},selectBtn:function(){return n.e("select_btn").then(n.bind(null,"3d41"))}},destroyed:function(){a.a.session("materialDetailShopId",null)},mounted:function(){this.mid=this.$route.query.id,this.wid=this.$route.query.wid||"",this.shopId=a.a.session("materialDetailShopId")||"",this.dataObj={mid:this.mid,wid:this.wid},this.shopId&&(this.dataObj.shopId=this.shopId),this.$store.commit("setPageTools",[{name:"返回",className:"info",type:4,fn:function(){a.a.session("warehouseDetailDestroy",!0),window.history.go(-1)}}]),this.init(),this.getDetail()},methods:{init:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var n,a,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.invoic_getMaterialBatch({data:t.dataObj});case 2:for(i in n=e.sent,t.relation=n.relation,t.batchList=n.list,t.count=n.list.length,a=[],t.relation)1==(r=t.relation[i]).isDefault&&(t.selUnit=i,t.unitIndex=r.muId),1==r.isMin&&(t.minName=r.name),a.push({value:r.muId,label:r.name});t.goodsUnit=a,t.paging();case 10:case"end":return e.stop()}},e,t)}))()},getDetail:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var n,a,i,r,o,l,u,c,d,v,h,p,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.invoic_getMaterialDetail({data:t.dataObj});case 2:for(n=e.sent,t.goodsDetail=n,a=!0,i=!1,r=void 0,e.prev=7,o=t.goodsDetail.cate[Symbol.iterator]();!(a=(l=o.next()).done);a=!0)u=l.value,t.goodsCate.push(u.name);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,r=e.t0;case 15:e.prev=15,e.prev=16,!a&&o.return&&o.return();case 18:if(e.prev=18,!i){e.next=21;break}throw r;case 21:return e.finish(18);case 22:return e.finish(15);case 23:for(c=!0,d=!1,v=void 0,e.prev=26,h=t.goodsDetail.unit[Symbol.iterator]();!(c=(p=h.next()).done);c=!0)f=p.value,t.unitArr.push(f.name);e.next=34;break;case 30:e.prev=30,e.t1=e.catch(26),d=!0,v=e.t1;case 34:e.prev=34,e.prev=35,!c&&h.return&&h.return();case 37:if(e.prev=37,!d){e.next=40;break}throw v;case 40:return e.finish(37);case 41:return e.finish(34);case 42:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22],[26,30,34,42],[35,,37,41]])}))()},indexMethod:function(t){return 10*(this.page-1)+t+1},paging:function(){this.pageTotal=Math.ceil(this.batchList.length/this.showNum);var t=(this.page-1)*this.showNum,e=this.page*this.showNum;e>this.batchList.length&&(e=this.batchList.length);for(var n=t;n<e;n++){var a=n<9?"0"+(n+1):n+1;this.batchList[n].indexNum=a}this.selList=this.batchList.slice(t,e)},timeFormat:function(t){return i.a.format(1e3*parseInt(t),"yyyy年MM月dd日")},pageChange:function(t){this.page=t.page,this.showNum=t.num,this.paging()},comUnit:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var a=o(e,4),i=a[0],s=a[1],l=a[2],u=a[3];return r.a.comUnit(i,s,l,u)},selectList:function(t){this.unitIndex=t;for(var e=0;e<this.relation.length;e++)if(t==this.relation[e].muId){this.selUnit=e;break}},computeUnit:function(t){var e="",n=this.getdefUnit(t,2);for(var a in t)a>0&&(e+="|"),e+=" 1"+t[a].name+"="+t[a].value+n+" ";return e},getdefUnit:function(t,e){var n=1==e?"isDefault":"isMin",a=!0,i=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var l=r.value;if(1==l[n])return l.name}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}}}},c=(n("a275"),n("d801")),d=Object(c.a)(u,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"warehouse-lists"},[n("div",{staticClass:"heander"},[t._m(0),t._v(" "),n("div",{staticClass:"innerBox"},[n("ul",[n("li",[n("span",[t._v("物料名称：")]),n("span",[t._v(t._s(t.goodsDetail.name))])]),t._v(" "),n("li",[n("span",[t._v("物料简码：")]),n("span",[t._v(t._s(t.goodsDetail.BC))])]),t._v(" "),n("li",[n("span",[t._v("品牌：")]),n("span",[t._v(t._s(t.goodsDetail.brandName||"无"))])]),t._v(" "),n("li",[n("span",[t._v("批次数：")]),n("span",[t._v(t._s(t.goodsDetail.batchNum))])])]),t._v(" "),n("ul",[n("li",[n("span",[t._v("物料单位：")]),n("span",[t._v(t._s(t.unitArr.join(",")))])]),t._v(" "),n("li",[n("span",[t._v("默认单位：")]),t.goodsDetail.unit?n("span",[t._v(t._s(t.getdefUnit(t.goodsDetail.unit,1)))]):t._e()]),t._v(" "),n("li",[n("span",[t._v("最小单位：")]),t.goodsDetail.unit?n("span",[t._v(t._s(t.getdefUnit(t.goodsDetail.unit,2)))]):t._e()]),t._v(" "),n("li",[n("span",[t._v("保质期：")]),n("span",[t._v(t._s(t.goodsDetail.validity)+t._s(t.dataUnit[t.goodsDetail.validityType]))])])]),t._v(" "),n("ul",[n("li",[n("span",[t._v("单位换算：")]),t.goodsDetail.unit?n("span",[t._v(t._s(t.computeUnit(t.goodsDetail.unit)))]):t._e()]),t._v(" "),n("li",[n("span",[t._v("分类：")]),n("span",[t._v(t._s(t.goodsCate.join(",")))])]),t._v(" "),n("li",[n("span",[t._v("库存总量：")]),n("span",[t._v(t._s(t.goodsDetail.num)+t._s(t.getdefUnit(t.goodsDetail.unit,2)))])])])])]),t._v(" "),n("div",{staticClass:"main"},[n("div",{staticClass:"unit-box"},[n("el-select",{staticClass:"el-size",attrs:{placeholder:"请选择单位"},on:{change:t.selectList},model:{value:t.unitIndex,callback:function(e){t.unitIndex=e},expression:"unitIndex"}},t._l(t.goodsUnit,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),n("div",{staticClass:"list"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.batchList,stripe:"",border:""}},[n("el-table-column",{attrs:{type:"index",index:t.indexMethod,label:"序号",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"batchCode",label:"批次编号"}}),t._v(" "),n("el-table-column",{attrs:{label:"生产日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t        \t"+t._s(t.timeFormat(e.row.productionTime))+"\n\t\t\t\t      \t")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"supplier",label:"供应商"}}),t._v(" "),n("el-table-column",{attrs:{label:"数量/重量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t        \t"+t._s(t.comUnit(e.row.surplus,t.relation[t.selUnit].value,t.relation[t.selUnit].name,t.minName))+"\n\t\t\t\t      \t")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"进价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t    \t\t"+t._s(e.row.purchasePrice)+"元/"+t._s(e.row.purchaseUnit.name)+"\n\t\t\t\t    \t")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"所属仓库"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t    \t\t"+t._s(e.row.wName)+"\n\t\t\t\t    \t\t"),e.row.wName&&e.row.aName?[t._v("-")]:t._e(),t._v("\n\t\t\t\t    \t\t"+t._s(e.row.aName)+"\n\t\t\t\t    \t")]}}])})],1)],1),t._v(" "),n("div",{staticClass:"page-box"},[n("el-pagination",{attrs:{"current-page":t.page,background:"",layout:"total,prev, pager, next",total:t.count},on:{"current-change":t.pageChange}})],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("库存详情")])])}],!1,null,"281db6b2",null);e.default=d.exports},a275:function(t,e,n){"use strict";var a=n("e6dc");n.n(a).a},e6dc:function(t,e,n){}}]);