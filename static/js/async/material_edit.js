(window.webpackJsonp=window.webpackJsonp||[]).push([["material_edit"],{"81e3":function(t,e,i){},8417:function(t,e,i){"use strict";var a=i("81e3");i.n(a).a},"8e35":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAyRTk3N0U3NjkwOTExRTY4MzI2OEU1NkY3Qjg2QTA3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAyRTk3N0U4NjkwOTExRTY4MzI2OEU1NkY3Qjg2QTA3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDJFOTc3RTU2OTA5MTFFNjgzMjY4RTU2RjdCODZBMDciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDJFOTc3RTY2OTA5MTFFNjgzMjY4RTU2RjdCODZBMDciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7A3duJAAAANElEQVR42mL6//8/Ax6MDPCpY2BioBIYNYiOBrEA8X8i1f4fel5jJNI7jKPpaNQgHAAgwAAuLjvvigxAWAAAAABJRU5ErkJggg=="},ccae:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"material-edit"}},[a("div",{staticClass:"split-title"},[t._v("\n\t\t\t修改物料\n\t\t")]),t._v(" "),a("div",[a("div",{staticClass:"label-content"},[a("label",{staticClass:"required label"},[t._v("物料名称")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.materialName,expression:"materialName"}],staticClass:"input",attrs:{type:"text",maxlength:"20",placeholder:"请输入物料名称"},domProps:{value:t.materialName},on:{input:function(e){e.target.composing||(t.materialName=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"label-content"},[a("label",{staticClass:"require label"},[t._v("物料简码")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.materialCode,expression:"materialCode"}],staticClass:"input",attrs:{type:"text",maxlength:"20",placeholder:"请输入物料简码"},domProps:{value:t.materialCode},on:{input:function(e){e.target.composing||(t.materialCode=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"label-content"},[a("label",{staticClass:"required label"},[t._v("物料分类")]),t._v(" "),a("div",{staticClass:"img-div",on:{click:function(e){t.openCategoryWin("category")}}},[a("img",{attrs:{src:i("8e35"),alt:"添加"}}),t._v("添加分类\n\t\t\t\t")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.selectCategory.length>0,expression:"selectCategory.length>0"}],staticClass:"tips"},[t._v("\n                    (已选择:\n                        "),t._l(t.selectCategory,function(e,i){return a("i",{key:i},[t._v(t._s(e.name)+"\n                            "),i!=t.selectCategory.length-1?[t._v("\n                                ,\n                            ")]:t._e()],2)}),t._v("\n                    )\n                ")],2)]),t._v(" "),a("div",{staticClass:"label-content"},[a("label",{staticClass:"label"},[t._v("品牌")]),t._v(" "),a("div",{staticClass:"img-div",on:{click:function(e){t.openAddBrand("brand")}}},[a("img",{attrs:{src:i("8e35"),alt:"添加"}}),t._v("添加品牌\n\t\t\t\t")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.selectBrand.length>0,expression:"selectBrand.length>0"}],staticClass:"tips"},[t._v("\n                    (已选择:\n                        "),t._l(t.selectBrand,function(e,i){return a("i",{key:i},[t._v(t._s(e.name))])}),t._v("\n                    )\n                ")],2)]),t._v(" "),a("div",{staticClass:"label-content"},[a("label",{staticClass:"required label"},[t._v("保质期")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.validityObj.time,expression:"validityObj.time"}],staticClass:"input validity-input",attrs:{type:"text",maxlength:"3"},domProps:{value:t.validityObj.time},on:{input:function(e){e.target.composing||t.$set(t.validityObj,"time",e.target.value)}}}),t._v(" "),a("div",{staticClass:"validity",on:{click:t.hideUnitSelect}},[a("span",{staticClass:"validity-num"},[t._v(t._s(t.validityObj.type))]),t._v(" "),a("span",{staticClass:"validity-trangle"}),t._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:t.validityObj.show,expression:"validityObj.show"}],staticClass:"validity-ul"},t._l(t.validityTypeArr,function(e,i){return a("li",{key:i,on:{click:function(i){t.getValidity(e)}}},[t._v(t._s(e.name))])}))])])]),t._v(" "),a("div",{staticClass:"bottom"},[a("div",{staticClass:"gray-btn gray",on:{click:function(e){t.clickBtn("cancel")}}},[t._v("取消")]),t._v(" "),a("div",{staticClass:"yellow-btn yellow",on:{click:function(e){t.clickBtn("ok")}}},[t._v("确定")])]),t._v(" "),a(t.showCom,{tag:"component",attrs:{pObj:t.comObj,list:t.comObj.category,selectList:t.comObj.selectCategory,title:t.comObj.title,radio:t.comObj.radio,tips:t.comObj.tips,showTips:!1},on:{throwCommonWin:t.closeCommonWin}})],1)};a._withStripped=!0;var n=i("81a2"),r=i("05dd"),s=i("f6ce");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(n,r){try{var s=e[n](r),o=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var c={data:function(){return{validityTypeArr:[{id:0,name:"月"},{id:1,name:"日"},{id:2,name:"年"}],validityObj:{time:"",type:"日",id:"",show:!1},isBrand:"",flag:"",materialName:"",materialCode:"",materialId:"",category:[],selectCategory:[],selectBrand:[],brandList:[],showCom:"",comObj:""}},methods:{clickBtn:function(t){var e=this;switch(t){case"ok":if(!this.checkform())return;var i=this.formatData();this.MaterialEditMaterial(i).then(function(t){t&&(e.$store.commit("setWin",{title:"温馨提示",content:"修改物料成功!"}),e.$router.go(-1))});break;case"cancel":this.$router.go(-1)}},closeCommonWin:function(t,e){if("cancel"!=e&&"close"!=e){switch(this.flag){case"category":this.selectCategory=t;break;case"brand":this.selectBrand=t}this.flag="",this.showCom=""}else this.showCom=""},openCategoryWin:function(t){this.showCom="addCategory",this.flag=t,this.comObj={category:this.category,title:"选择分类",selectCategory:this.selectCategory,radio:!0,tips:"请先配置分类!"}},openAddBrand:function(t){this.showCom="unitBrand",this.flag=t,this.comObj={title:"添加品牌",list:this.brandList,selectlist:this.selectBrand,radio:!0,tips:"请先配置品牌"}},organizeCategory:function(t){var e=t,i=[];return t.forEach(function(t){if(t.child=[],t.showAdd=!1,0==t.pid){for(var a=0,n=e.length;a<n;a++)t.id==e[a].pid&&t.id!=e[a].id&&t.child.push(e[a]);i.push(t)}}),i},getValidity:function(t){this.validityObj.type=t.name,this.validityObj.id=t.id},hideUnitSelect:function(t){this.validityObj.show=!this.validityObj.show,t.cancelBubble=!0},checkform:function(){if(r.a.checkData({materialName:{cond:"$$.length>0 && $$.length<=20",pro:"请输入20字以内的名称!"},materialCode:{reg:/[0-9A-Za-z]{0,20}/,pro:"简码由英文,数字组成!"}},this)&&r.a.checkData({time:{reg:/[1-9]\d{0,2}/,pro:"保质期由1-3位数字组成!"}},this.validityObj)){if(0!=this.selectCategory.length)return!0;this.$store.commit("setWin",{content:"请选择分类!",title:"温馨提示"})}},formatData:function(){var t=null;this.selectBrand[0]&&(t=this.selectBrand[0].id);var e=[];return this.selectCategory.forEach(function(t){e.push(t.id)}),{mid:this.materialId,name:this.materialName,BC:this.materialCode,brandId:t,validity:this.validityObj.time,validityType:this.validityObj.id,cids:e.join(",")}},domEvent:function(){this.validityObj.show=!1},MaterialGetCategoryList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.MaterialGetCategoryList({data:{}});case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}},e,t)}))()},InvoicingBrandList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.InvoicingBrandList({data:{}});case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}},e,t)}))()},MaterialEditMaterial:function(t){var e=this;return o(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.MaterialEditMaterial({data:t});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},i,e)}))()},MaterialGetMaterialDetail:function(t){var e=this;return o(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.MaterialGetMaterialDetail({data:{mid:t}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},i,e)}))()},syncRequest:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i,a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.MaterialGetMaterialDetail(t.materialId);case 2:return i=e.sent,t.materialName=i.name,t.materialCode=i.BC,a=null,t.validityTypeArr.some(function(t){if(t.id==i.validityType)return a=t.name,!0}),t.validityObj={time:i.validity,show:!1,id:i.validityType,type:a},e.next=10,t.MaterialGetCategoryList();case 10:return n=e.sent,t.category=t.organizeCategory(n),i.cate||(i.cate=[]),t.selectCategory=i.cate.map(function(t){for(var e=0,i=n.length;e<i;e++)if(t.cid==n[e].id)return n[e]}),e.next=16,t.InvoicingBrandList();case 16:t.brandList=e.sent,t.brandList.some(function(e){if(e.id==i.brandId)return t.selectBrand.push(e),!0});case 18:case"end":return e.stop()}},e,t)}))()},initData:function(){this.materialId=this.$route.query.id;var t=s.a.session("userShop");this.isBrand="1"==t.currentShop.ischain||"2"==t.currentShop.ischain}},mounted:function(){this.initData(),this.syncRequest(),document.addEventListener("click",this.domEvent)},components:{unitBrand:function(){return i.e("unit_brand_win").then(i.bind(null,"86b8"))},addCategory:function(){return i.e("add_category_com").then(i.bind(null,"16ef"))}},beforeDestroy:function(){document.removeEventListener("click",this.domEvent)}},l=(i("8417"),i("7610")),d=Object(l.a)(c,a,[],!1,null,"10a12775",null);d.options.__file="src\\module\\invoicing_system\\warehouse_manage\\material_edit.vue";e.default=d.exports}}]);