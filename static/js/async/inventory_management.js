(window.webpackJsonp=window.webpackJsonp||[]).push([["inventory_management"],{"27b9":function(t,e,a){},"2d3a":function(t,e,a){"use strict";a.r(e);var n=a("81a2"),i=a("f6ce"),s=a("bbb9");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function n(i,s){try{var o=e[i](s),r=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(r).then(function(t){n("next",t)},function(t){n("throw",t)});t(r)}("next")})}}var r=0,c=1,u=1,l={data:function(){return{goodsdetail:"",newgoodsdetail:"",checkGoods:"",shopId:"",searchName:"",searchCode:"",secBarCode:"",allGoods:"全部类型",goodsList:["全部类型","普通商品","称重商品"],listType:-1,total:1,page:1,num:10,win:{goodsDel:"",list:""},winshow:!1,detailId:"",tebData:["商品","物料"],tabactive:0,totalList:0,count:0,ischain:i.a.session("userShop").currentShop.ischain,inventConfigure:0,titleList:[{titleName:"操作",titleStyle:{width:"200px"}},{titleName:"序号",titleStyle:{width:"75px"}},{titleName:"商品名",dataName:"goodsName",titleStyle:{width:"15%"}},{titleName:"条形码",dataName:"barCode",titleStyle:{width:"15%"}},{titleName:"售价",dataName:"price"},{titleName:"商品类型"},{titleName:"仓库数量/重量"},{titleName:"批次数量",titleStyle:{width:"5%"}},{titleName:"货架数量/重量"},{titleName:"总量"}],conshow:!0,page2:1}},beforeRouteLeave:function(t,e,a){var n=this;["detail","suppliesDetail","materialsPutinStorage","putStroage","picking","warehouseCount","materialCreate"].map(function(e){var a="/admin/inventoryManagement/"+e;t.path!=a&&"picking"!=e||(n.check=!1)}),this.check&&(c=1,r=0,u=1),a()},methods:{init:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a,i,o,r,c,u,l,d,h,p,v,f,g,m,b,w;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.inventoryGoodsList({data:{page:t.page,num:t.num,type:t.listType,goodsName:t.searchName,barCode:t.searchCode,secBarCode:t.secBarCode}});case 2:for(a=e.sent,t.count=a.count,t.goodsdetail=a.list,t.total=a.total,i=[],o=!0,r=!1,c=void 0,e.prev=10,u=t.goodsdetail[Symbol.iterator]();!(o=(l=u.next()).done);o=!0)d=l.value,i.push(d.id);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),r=!0,c=e.t0;case 18:e.prev=18,e.prev=19,!o&&u.return&&u.return();case 21:if(e.prev=21,!r){e.next=24;break}throw c;case 24:return e.finish(21);case 25:return e.finish(18);case 26:if(!(i.length>0)){e.next=55;break}return e.next=29,n.a.invent_getGoodsNum({data:{gids:i.join(",")}});case 29:h=e.sent,e.t1=regeneratorRuntime.keys(t.goodsdetail);case 31:if((e.t2=e.t1()).done){e.next=54;break}for(p=e.t2.value,v=!0,f=!1,g=void 0,e.prev=36,m=h[Symbol.iterator]();!(v=(b=m.next()).done);v=!0)w=b.value,t.goodsdetail[p].id==w.id&&(t.goodsdetail[p].goodsNum=w);e.next=44;break;case 40:e.prev=40,e.t3=e.catch(36),f=!0,g=e.t3;case 44:e.prev=44,e.prev=45,!v&&m.return&&m.return();case 47:if(e.prev=47,!f){e.next=50;break}throw g;case 50:return e.finish(47);case 51:return e.finish(44);case 52:e.next=31;break;case 54:t.goodsdetail=s.a.deepCopy(t.goodsdetail);case 55:case"end":return e.stop()}},e,t,[[10,14,18,26],[19,,21,25],[36,40,44,52],[45,,47,51]])}))()},suppage:function(t){u=t,console.log(t)},addCount:function(t){return/^0+/.test(t+="")&&(t=t.replace(/^0+/,"")),/\./.test(t)||(t+=".000"),/^\./.test(t)&&(t="0"+t),t=(t+="000").match(/([+-]?)\d+\.\d{3}/)[0]},searchReset:function(){this.searchName="",this.searchCode="",this.checkGoods=this.goodsdetail,this.listType=-1,this.page=1,this.$refs.select.sortName="全部类型",this.$refs.select.selected=0,this.init()},searchList:function(){this.page=1,this.init()},showDetail:function(t,e){t.index=e,i.a.session("goodsDetail",t),this.$router.push({path:"inventoryManagement/detail",query:this.$route.query})},addListhouse:function(t){this.$route.query.gid=t.gid,this.$router.push({path:"inventoryManagement/putStroage",query:this.$route.query})},openBar:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.a.getDetails({data:{gid:t.gid,shopId:e.shopId}});case 2:i=a.sent,e.detailId=t.gid,e.openWin(i,t);case 5:case"end":return a.stop()}},a,e)}))()},winEvent:function(t){this.winshow=!1,"ok"==t&&this.openOrClose()},openWin:function(t,e){this.winshow=!0,this.win={goodsDel:t,title:"打印条码",list:e}},openOrClose:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.$refs.print,i=/^\d*\.?\d+$/,t.winshow=!0,a.classification.length){e.next=6;break}return t.alert("请输入数量"),e.abrupt("return");case 6:s=0;case 7:if(!(s<a.classification.length)){e.next=32;break}if(1!=a.goodsDel.type||a.classWeight[s]){e.next=11;break}return t.alert("请输入重量"),e.abrupt("return",!1);case 11:if(!+!a.classification[s]){e.next=14;break}return t.alert("请输入数量"),e.abrupt("return",!1);case 14:if(0!=+a.classification[s]){e.next=17;break}return t.alert("数量必须大于0"),e.abrupt("return",!1);case 17:if(!(+a.classification[s]>100)){e.next=20;break}return t.alert("数量请少于100"),e.abrupt("return");case 20:if(1!=a.goodsDel.type){e.next=26;break}if(i.test(Number(a.classification[s]))&&i.test(Number(a.classWeight[s]))){e.next=24;break}return t.alert("输入格式错误"),e.abrupt("return",!1);case 24:e.next=29;break;case 26:if(i.test(Number(a.classification[s]))){e.next=29;break}return t.alert("输入格式错误"),e.abrupt("return",!1);case 29:s++,e.next=7;break;case 32:return e.next=34,n.a.inventoryPrintCode({data:{gid:t.detailId,num:"["+a.classification+"]",weight:"["+a.classWeight+"]"}});case 34:t.winshow=!1;case 35:case"end":return e.stop()}},e,t)}))()},changePage:function(t){this.page=t.page,c=this.page,this.init()},selectList:function(t){this.listType=t-1},tebClick:function(t){this.tabactive=t,r=t,i.a.session("tabactive",t)},alert:function(t,e){this.$store.commit("setWin",{title:e,winType:"alert",content:t})},addEduce:function(){this.$store.commit("setPageTools",[])},suppliesBtn:function(){var t=this;this.$store.commit("setPageTools",[{name:"领料",className:["wearhouse create"],fn:function(){t.$router.push({path:"pickingList/picking"})}},{name:"新建物料",className:["wearhouse handle"],fn:function(){t.$router.push({path:"inventoryManagement/materialCreate"})}}])}},beforeMount:function(){this.page2=u},mounted:function(){this.shopId=i.a.session("itemId"),this.inventConfigure=i.a.session("inventConfigure")||0,this.tabactive=0==this.inventConfigure?0:this.inventConfigure-1,i.a.session("tabactive")&&0==this.inventConfigure&&(this.tabactive=i.a.session("tabactive")),this.tabactive=r,this.page=c,this.init()},destroyed:function(){i.a.session("tabactive",null)},computed:{contentRefs:function(){return this.$store.state.contentDislpay}},watch:{tabactive:function(){this.tabactive?this.suppliesBtn():this.addEduce()},contentRefs:function(){this.inventConfigure=this.contentRefs,this.tabactive=0==this.contentRefs?0:this.contentRefs-1}},components:{selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},pageTurn:function(){return a.e("page_element").then(a.bind(null,"5921"))},printingWin:function(){return a.e("printing_win").then(a.bind(null,"f6e4"))},inventSupplies:function(){return a.e("invent_supplies").then(a.bind(null,"f5c4"))},comTable:function(){return a.e("table").then(a.bind(null,"4360"))}}},d=(a("a9e3"),a("d801")),h=Object(d.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.conshow?a("div",{attrs:{id:"inventory"}},[0==t.inventConfigure?a("ul",{staticClass:"tebBox"},t._l(t.tebData,function(e,n){return a("li",{key:n,class:{active:t.tabactive==n},on:{click:function(e){t.tebClick(n)}}},[t._v(t._s(e))])})):t._e(),t._v(" "),0==t.tabactive?a("section",{staticStyle:{clear:"both","margin-top":"20px"}},[a("section",{staticClass:"statisticsList",staticStyle:{"vertical-align":"middle","margin-bottom":"20px"}},[a("section",{staticClass:"filter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchName,expression:"searchName"}],attrs:{type:"text",placeholder:"请输入商品名"},domProps:{value:t.searchName},on:{input:function(e){e.target.composing||(t.searchName=e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchCode,expression:"searchCode"}],attrs:{type:"text",placeholder:"请输入条形码"},domProps:{value:t.searchCode},on:{input:function(e){e.target.composing||(t.searchCode=e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.secBarCode,expression:"secBarCode"}],attrs:{type:"text",placeholder:"请输入副条形码"},domProps:{value:t.secBarCode},on:{input:function(e){e.target.composing||(t.secBarCode=e.target.value)}}}),t._v(" "),a("div",{staticClass:"selBox"},[a("select-btn",{ref:"select",attrs:{sorts:t.goodsList,name:t.allGoods},on:{selOn:t.selectList}}),t._v(" "),a("a",{staticClass:"blue",staticStyle:{width:"100px",height:"40px","line-height":"40px","margin-right":"8px"},attrs:{href:"javascript:void(0);"},on:{click:t.searchList}},[t._v("筛选")]),t._v(" "),a("a",{staticClass:"gray",staticStyle:{width:"100px",height:"40px","line-height":"40px"},attrs:{href:"javascript:void(0);"},on:{click:t.searchReset}},[t._v("重置")])],1)])]),t._v(" "),a("com-table",{attrs:{listName:"商品列表",fixed:2,titleData:t.titleList,allTotal:t.count,introData:t.goodsdetail,listWidth:1500},scopedSlots:t._u([{key:"con-0",fn:function(e){return a("div",{staticClass:"infoDetail"},[a("a",{staticStyle:{color:"#5ebee8"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.showDetail(e.data,e.index)}}},[t._v("查看详情")]),t._v(" "),a("span",[t._v("|")]),t._v(" "),a("a",{staticStyle:{color:"red"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.addListhouse(e.data)}}},[t._v("入库")]),t._v(" "),3!=t.ischain?a("span",[t._v("|")]):t._e(),t._v(" "),3!=t.ischain?a("a",{staticStyle:{color:"orange"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.openBar(e.data)}}},[t._v("打印条码")]):t._e()])}},{key:"con-1",fn:function(e){return a("span",{},[t._v(t._s(e.index+1+10*(t.page-1)))])}},{key:"con-5",fn:function(e){return a("span",{},[t._v(t._s(1==e.data.type?"称重商品":"普通商品"))])}},{key:"con-6",fn:function(e){return e.data.goodsNum?a("span",{attrs:{title:e.data.goodsNum.surplus}},[t._v(t._s(t.addCount(e.data.goodsNum.surplus))+t._s(e.data.unit))]):t._e()}},{key:"con-7",fn:function(e){return e.data.goodsNum?a("span",{attrs:{title:e.data.goodsNum.batch}},[t._v(t._s(e.data.goodsNum.batch))]):t._e()}},{key:"con-8",fn:function(e){return e.data.goodsNum?a("span",{attrs:{title:e.data.goodsNum.shelvesNum}},[t._v(t._s(t.addCount(e.data.goodsNum.shelvesNum))+t._s(e.data.unit))]):t._e()}},{key:"con-9",fn:function(e){return e.data.goodsNum?a("span",{attrs:{title:Number(e.data.goodsNum.shelvesNum)+Number(e.data.goodsNum.surplus)}},[t._v(t._s(t.addCount(Number(e.data.goodsNum.shelvesNum)+Number(e.data.goodsNum.surplus)))+t._s(e.data.unit))]):t._e()}}])})],1):t._e(),t._v(" "),a("invent-supplies",{directives:[{name:"show",rawName:"v-show",value:1==t.tabactive,expression:"tabactive==1"}],attrs:{page2:t.page2,tabactive:t.tabactive},on:{page:t.suppage}}),t._v(" "),0==t.tabactive?a("div",{staticClass:"somePage"},[a("page-turn",{ref:"pageTurn",attrs:{total:t.total,isNoJump:!1,isNoPaging:!0,page:t.page},on:{pageNum:t.changePage}})],1):t._e(),t._v(" "),t.winshow?a("printing-win",{ref:"print",attrs:{title:t.win.title,goodsDel:t.win.goodsDel,listDel:t.win.list},on:{winEvent:t.winEvent}}):t._e()],1):t._e()},[],!1,null,"1ba22bc9",null);e.default=h.exports},a9e3:function(t,e,a){"use strict";var n=a("27b9");a.n(n).a}}]);