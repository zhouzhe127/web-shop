(window.webpackJsonp=window.webpackJsonp||[]).push([["clusion_supplies"],{3676:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("win",{attrs:{align:"center",width:1024,height:600,ok:t.btnOk},on:{winEvent:t.closeSelfWin}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{attrs:{slot:"content",id:"select-batch"},slot:"content"},[i("div",{staticClass:"batch-title"},[i("ul",[i("li",[t._v("物料名称:"+t._s(t.needItem.itemName))]),t._v(" "),i("li",[t._v("物料单位:"+t._s(t.unitStr))]),t._v(" "),i("li",[t._v("默认单位:"+t._s(t.defaultUnit))]),t._v(" "),i("li",[t._v("申请单位:"+t._s(t.needItem.selectName))])]),t._v(" "),i("ul",[i("li",[t._v("保质期:"+t._s(t.validity))]),t._v(" "),i("li",[t._v("分类:"+t._s(t.cateArr))]),t._v(" "),i("li",[t._v("最小单位:"+t._s(t.minUnit))]),t._v(" "),i("li",[t._v("需求数量:"+t._s(t.getSurplus(t.needItem.num)))])])]),t._v(" "),i("div",{staticClass:"search-div"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.batchNum,expression:"batchNum"}],staticClass:"search-input",attrs:{type:"text",placeholder:"请输入批次编号"},domProps:{value:t.batchNum},on:{input:function(e){e.target.composing||(t.batchNum=e.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.supplier,expression:"supplier"}],staticClass:"search-input",attrs:{type:"text",placeholder:"请输入供应商"},domProps:{value:t.supplier},on:{input:function(e){e.target.composing||(t.supplier=e.target.value)}}}),t._v(" "),i("div",{staticClass:"timer"},[i("calendar",{attrs:{only:!1,time:t.startTime,format:"yyyy年MM月dd日"},on:{emit:t.startTimeChange}})],1),t._v(" "),i("div",{staticClass:"timer"},[i("calendar",{attrs:{only:!1,time:t.endTime,format:"yyyy年MM月dd日"},on:{emit:t.endTimeChange}})],1),t._v(" "),i("div",{staticClass:"filter blue",on:{click:t.search}},[t._v("\n\t\t\t\t\t筛选\n\t\t\t\t")]),t._v(" "),i("div",{staticClass:"reset gray",on:{click:t.reset}},[t._v("\n\t\t\t\t\t重置\n\t\t\t\t")])]),t._v(" "),i("div",{staticClass:"table"},[i("div",{staticClass:"table-head"},[i("li",[t._v("序号")]),t._v(" "),i("li",[t._v("批次编号")]),t._v(" "),i("li",[t._v("生产日期")]),t._v(" "),i("li",[t._v("供应商")]),t._v(" "),i("li",[t._v("所属仓库区域")]),t._v(" "),i("li",{staticStyle:{"line-height":"20px"}},[t._v("当前批次\n\t\t\t\t\t\t"),i("br"),t._v("数量/重量")]),t._v(" "),i("li",[t._v("出库数量/重量")])]),t._v(" "),i("div",{staticClass:"table-body"},t._l(t.changeList,function(e,n){return i("div",{key:n,staticClass:"table-row"},[i("li",[t._v(t._s(n+1))]),t._v(" "),i("li",[t._v(t._s(e.batchCode))]),t._v(" "),i("li",[t._v(t._s(t.getTime(e.productionTime)))]),t._v(" "),i("li",[t._v(t._s(e.supplier))]),t._v(" "),i("li",[t._v(t._s(e.wName||"暂无"/e.aName||"暂无"))]),t._v(" "),i("li",[t._v(t._s(t.getSurplus(e.surplus)))]),t._v(" "),i("li",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.outNum,expression:"item.outNum"}],staticClass:"input-num",attrs:{type:"text",placeholder:"输入数字",maxlength:"9"},domProps:{value:e.outNum},on:{input:[function(i){i.target.composing||t.$set(e,"outNum",i.target.value)},function(i){t.getmin(i,e)}]}}),t._v(" "),i("span",{staticClass:"unitBox"},[t._v(t._s(t.needItem.selectName))])])])}))])])])};n._withStripped=!0;var a=i("bbb9"),s=i("81a2"),r=i("05dd");var u={data:function(){return{title:"批次选择",btnOk:{},btnCancel:{},showTime:!1,startTime:"",endTime:"",cate:"",allList:"",changeList:"",batchNum:"",supplier:"",unitStr:"",defaultUnit:"",minUnit:"",cateArr:"",validity:"",validityType:["月","日","年"]}},props:["pObj","needItem","wid","shopId"],methods:{init:function(){var t,e=this;return(t=regeneratorRuntime.mark(function t(){var i,n,r,u,l,o,c,d,m,v,h,p,_,f,b,g,y,w,N,x,T,I,k,C,L,S,M;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.All([{httpId:"invoic_getMaterialDetail",data:{mid:e.needItem.id,shopId:e.shopId}},{httpId:"getMaterialBatch",data:{mid:e.needItem.id,wid:e.wid||"",shopId:e.shopId}}]);case 2:if(i=t.sent,e.detail=i[0].data,n=[],!(e.detail.unit&&e.detail.unit.length>0)){t.next=25;break}for(r=!0,u=!1,l=void 0,t.prev=9,o=e.detail.unit[Symbol.iterator]();!(r=(c=o.next()).done);r=!0)d=c.value,n.push(d.name),1==d.isDefault&&(e.defaultUnit=d.name),1==d.isMin&&(e.minUnit=d.name);t.next=17;break;case 13:t.prev=13,t.t0=t.catch(9),u=!0,l=t.t0;case 17:t.prev=17,t.prev=18,!r&&o.return&&o.return();case 20:if(t.prev=20,!u){t.next=23;break}throw l;case 23:return t.finish(20);case 24:return t.finish(17);case 25:for(m=[],v=!0,h=!1,p=void 0,t.prev=29,_=e.detail.cate[Symbol.iterator]();!(v=(f=_.next()).done);v=!0)b=f.value,m.push(b.name);t.next=37;break;case 33:t.prev=33,t.t1=t.catch(29),h=!0,p=t.t1;case 37:t.prev=37,t.prev=38,!v&&_.return&&_.return();case 40:if(t.prev=40,!h){t.next=43;break}throw p;case 43:return t.finish(40);case 44:return t.finish(37);case 45:e.validity=""+e.detail.validity+e.validityType[e.detail.validityType],e.cateArr=m.join(","),e.unitStr=n.join(","),e.allList=i[1].data.list,e.changeList=a.a.deepCopy(e.allList),g=!0,y=!1,w=void 0,t.prev=53,N=e.changeList[Symbol.iterator]();case 55:if(g=(x=N.next()).done){t.next=83;break}if(T=x.value,!(e.needItem.batchList&&e.needItem.batchList.length>0)){t.next=79;break}for(I=!0,k=!1,C=void 0,t.prev=61,L=e.needItem.batchList[Symbol.iterator]();!(I=(S=L.next()).done);I=!0)M=S.value,T.batchId==M.batchId&&(T.outNum=M.outNum);t.next=69;break;case 65:t.prev=65,t.t2=t.catch(61),k=!0,C=t.t2;case 69:t.prev=69,t.prev=70,!I&&L.return&&L.return();case 72:if(t.prev=72,!k){t.next=75;break}throw C;case 75:return t.finish(72);case 76:return t.finish(69);case 77:t.next=80;break;case 79:T.outNum="";case 80:g=!0,t.next=55;break;case 83:t.next=89;break;case 85:t.prev=85,t.t3=t.catch(53),y=!0,w=t.t3;case 89:t.prev=89,t.prev=90,!g&&N.return&&N.return();case 92:if(t.prev=92,!y){t.next=95;break}throw w;case 95:return t.finish(92);case 96:return t.finish(89);case 97:case"end":return t.stop()}},t,e,[[9,13,17,25],[18,,20,24],[29,33,37,45],[38,,40,44],[53,85,89,97],[61,65,69,77],[70,,72,76],[90,,92,96]])}),function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(a,s){try{var r=e[a](s),u=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(u).then(function(t){n("next",t)},function(t){n("throw",t)});t(u)}("next")})})()},chooseTime:function(){this.showTime=!this.showTime},transFormDate:function(t){return a.a.format(new Date(t),"yyyy-MM-dd")},closeSelfWin:function(t){this.$emit("throwWin",t,this.changeList)},initBtn:function(){this.btnOk={content:"确定",style:"background-color:#ff9200;"}},getSurplus:function(t){return r.a.comUnit(t,this.needItem.selectValue,this.needItem.selectName,this.minUnit)},search:function(){var t=[];for(var e in this.allList){var i=this.allList[e];-1!=i.supplier.indexOf(this.supplier)&&0==i.batchCode.indexOf(this.batchNum)&&1e3*i.productionTime>this.startTime&&1e3*i.productionTime<this.endTime&&t.push(i)}this.changeList=t},reset:function(){this.supplier="",this.batchNum="",this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).getTime(),this.changeList=this.allList},getmin:function(t,e){var i=Number(this.needItem.selectValue);e.outNum=/^\d*\.?\d+$/.test(e.outNum)?e.outNum:0,""!=e.outNum&&(Number(e.outNum)*i>Number(e.surplus)&&(e.outNum=parseInt(1e3*Number(e.surplus)/i)/1e3),t.target.value=(e.outNum+"").replace(/^(\d*)\.?\d{4}$/g,parseInt(1e3*e.outNum)/1e3),e.outNum=t.target.value)},startTimeChange:function(t){this.startTime=a.a.getTime({time:t}).start},endTimeChange:function(t){this.endTime=a.a.getTime({time:t}).end},getTime:function(t){return a.a.format(1e3*parseInt(t),"yyyy年MM月dd日")}},mounted:function(){this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).getTime(),this.initBtn(),this.init()},components:{win:function(){return i.e("win").then(i.bind(null,"f60a"))},calendar:function(){return i.e("calendar_type").then(i.bind(null,"f2dd"))}}},l=(i("f9f7"),i("7610")),o=Object(l.a)(u,n,[],!1,null,"657ac06a",null);o.options.__file="src\\module\\invoicing_system\\conclusion\\clusion_supplies.vue";e.default=o.exports},6087:function(t,e,i){},f9f7:function(t,e,i){"use strict";var n=i("6087");i.n(n).a}}]);