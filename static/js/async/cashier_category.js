(window.webpackJsonp=window.webpackJsonp||[]).push([["cashier_category"],{"3f18":function(t,e,s){"use strict";var i=s("6fa0");s.n(i).a},"5a7d":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"report-cate"}},[s("section",{staticClass:"yuChairFix clearfix"},[s("section",{staticClass:"top-box fl",on:{click:t.fadeAway}},[s("span",{staticClass:"wordSize"},[t._v("时间类型：")]),t._v(" "),s("selectBtn",{staticClass:"select-btn",attrs:{sorts:t.options,name:t.selectedName},on:{emit:t.selectType,"update:sorts":function(e){t.options=e},"update:name":function(e){t.selectedName=e}}})],1),t._v(" "),s("section",{staticClass:"top-box fl",staticStyle:{"margin-right":"0"},on:{click:t.fadeAway}},[s("section",{staticClass:"cala chairFix"},[s("calendar",{staticClass:"data-box",attrs:{time:t.startTime,type:t.selectedType,format:"yyyy年MM月dd日"},on:{emit:t.startTimeChange}})],1)]),t._v(" "),s("span",{staticClass:"line"},[t._v("-")]),t._v(" "),s("section",{staticClass:"top-box fl",on:{click:t.fadeAway}},[s("section",{staticClass:"cala chairFix"},[s("calendar",{staticClass:"data-box",attrs:{time:t.endTime,type:t.selectedType,format:"yyyy年MM月dd日"},on:{emit:t.endTimeChange}})],1)]),t._v(" "),s("section",{staticClass:"top-box fl",on:{click:t.fadeAway}},[s("span",{staticClass:"wordSize"},[t._v("时间段筛选：")]),t._v(" "),s("timehm",{attrs:{start:t.start,end:t.end,index:t.index},on:{timeChoose:t.getTime}})],1),t._v(" "),s("section",{staticStyle:{display:"inline-block"}},[s("section",{staticClass:"top-box fl",staticStyle:{height:"42px"}},[s("selectstore",{attrs:{reset:t.reset,show:t.hide,showNum:!0},on:{returnShop:t.getShop}})],1),t._v(" "),s("section",{staticClass:"top-box fl detLi ",staticStyle:{height:"55px"}},[s("a",{staticClass:"blue searchs",attrs:{href:"javascript:void(0);"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),s("a",{staticClass:"gray",attrs:{href:"javascript:void(0);"},on:{click:t.resetAll}},[t._v("重置")])])])]),t._v(" "),t.orderList.length>0&&t.loading?s("categoryRetail",{attrs:{taskId:t.taskId,chooseShopList:t.chooseShopList.filter(function(t){return t.selected}),shopList:t.shopList,orderList:t.orderList,loading:t.loading,selShopid:t.selShopid,shopName:t.shopName,selectedType:t.selectedType}}):t._e(),t._v(" "),t.loading&&0==t.orderList.length?s("section",{staticStyle:{border:"1px solid #ccc",height:"200px","text-align":"center","line-height":"200px","font-size":"24px",color:"#B3B3B3","margin-top":"20px"}},[t._v("\n\t\t-暂无数据-\n\t")]):t._e(),t._v(" "),t.loading?t._e():s("loading",{attrs:{totalCount:t.totalCount,taskCountTotal:t.taskCountTotal,taskCount:t.taskCount}})],1)};i._withStripped=!0;var n=s("81a2"),a=s("f6ce"),o=s("bbb9");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,s){return function i(n,a){try{var o=e[n](a),r=o.value}catch(t){return void s(t)}if(!o.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var h={data:function(){return{shopId:null,options:["日报表","周报表","月报表","季度报表","年报表"],selectedType:0,selectedName:"日报表",startTime:"",timeStart:"",timeEnd:"",endTime:"",start:{hour:"00",minute:"00"},end:{hour:"23",minute:"59"},index:0,shopList:[],selects:[],shopName:"请选择店铺",showShoplist:!1,selShopid:[],chooseShopList:[],buttonList:{flag:0,list:[{index:0,name:"原表"},{index:1,name:"占比"},{index:2,name:"总占比"},{index:3,name:"环比"},{index:4,name:"同比"}]},taskId:"",orderList:[],selOrderList:[],selTotalList:[],loading:!0,repeat:!1,list:[],ChartShopName:[],typeFlag:-1,hide:1,reset:1,industry:"",taskCountTotal:1,taskCount:0,totalCount:1}},mounted:function(){var t=a.a.session("userShop");this.shopId=t.currentShop.id,document.addEventListener("click",this.show),this.getShopList()},methods:{show:function(){this.showShoplist=!1,this.formHead=!1},getShopList:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.getShopList({data:{shopId:t.shopId}});case 2:s=e.sent,t.shopList=s;case 4:case"end":return e.stop()}},e,t)}))()},classifiedReport:function(t){var e=this;return r(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n.a.classifiedReport({data:{shopId:e.shopId,timeType:e.selectedType+1,startTime:0===e.selectedType?e.startTime:e.timeStart,endTime:0===e.selectedType?e.endTime:e.timeEnd,timeBetween:t,reportType:e.buttonList.flag+1,shopIds:e.selShopid.join(),type:20},timeout:6e4}).then(function(t){e.taskId=t.taskId,e.taskCountTotal=t.taskCount,e.totalCount=1,e.taskInfo(t),window.timer=setInterval(function(){e.taskInfo(t)},3e3)});case 1:case"end":return s.stop()}},s,e)}))()},taskInfo:function(t){var e=this;return r(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n.a.taskInfo({data:{shopId:e.shopId,taskId:t.taskId}}).then(function(s){e.taskCount=s.taskCount,e.totalCount+=3,3==s.status?(clearInterval(window.timer),e.repeat=!1,e.getCategoryData(t.taskId)):2==s.status&&(clearInterval(window.timer),e.repeat=!1,e.loading=!0,e.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"查询失败，请重试"}))});case 1:case"end":return s.stop()}},s,e)}))()},getAnalysis:function(t){var e=this;return r(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n.a.getAnalysis({data:{shopId:e.shopId,taskId:t},timeout:6e4}).then(function(t){e.orderList=o.a.deepCopy(t),e.list=o.a.deepCopy(t),e.loading=!0});case 1:case"end":return s.stop()}},s,e)}))()},getCategoryData:function(t){var e=this;return r(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n.a.getCategoryData({data:{shopId:e.shopId,taskId:t},timeout:6e4}).then(function(t){e.orderList=o.a.deepCopy(t),e.list=o.a.deepCopy(t),e.loading=!0});case 1:case"end":return s.stop()}},s,e)}))()},fadeAway:function(){this.hide++},selectType:function(t){this.selectedType=t},startTimeChange:function(t,e){this.startTime=t,2==this.selectedType?this.timeStart=new Date(t).getFullYear()+"年"+(new Date(t).getMonth()+1):(this.timeStart=e,this.timeStart=this.timeStart.substring(0,this.timeStart.length-1),3==this.selectedType&&(this.timeStart=this.timeStart.substring(0,this.timeStart.length-1)),this.timeStart=this.timeStart.replace(/\s/g,""))},endTimeChange:function(t,e){this.endTime=t,2==this.selectedType?this.timeEnd=new Date(t).getFullYear()+"年"+(new Date(t).getMonth()+1):(this.timeEnd=e,this.timeEnd=this.timeEnd.substring(0,this.timeEnd.length-1),3==this.selectedType&&(this.timeEnd=this.timeEnd.substring(0,this.timeEnd.length-1)),this.timeEnd=this.timeEnd.replace(/\s/g,""))},getTime:function(t){this.start.hour=t.start.hour,this.start.minute=t.start.minute,this.end.hour=t.end.hour,this.end.minute=t.end.minute},getShopname:function(){if("请选择店铺"!=this.shopName){for(var t=this.shopName.split(","),e=[],s=0;s<t.length;s++){var i={};0===s?(i.className="chyellow",i.name=t[s]):1===s?(i.className="chblue",i.name=t[s]):2===s?(i.className="chgreen",i.name=t[s]):(i.className="",i.name=t[s]),e.push(i)}this.ChartShopName=e}else this.shopName="请选择店铺"},getShop:function(t,e,s){this.chooseShopList=s,(t||e)&&(this.selShopid=t,this.shopName=e),this.getShopname()},search:function(){if(this.endTime<this.startTime)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"结束时间不能小于开始时间"}),!1;if(this.repeat)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"当前查询尚未结束，请结束后再进行查询或刷新浏览器重新查询！"}),!1;if(0==this.selShopid.length)return this.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请选择店铺"}),!1;switch(this.loading=!1,this.repeat=!0,this.taskCountTotal=1,this.taskCount=0,this.selectedType){case 0:this.startTime=o.a.format(new Date(this.startTime),"yyyy-MM-dd"),this.endTime=o.a.format(new Date(this.endTime),"yyyy-MM-dd");break;case 1:this.timeStart=this.timeStart.replace("年第","/"),this.timeEnd=this.timeEnd.replace("年第","/");break;case 2:this.timeStart=this.timeStart.replace("年","/"),this.timeEnd=this.timeEnd.replace("年","/");break;case 3:this.timeStart=this.timeStart.replace("年第","/"),this.timeEnd=this.timeEnd.replace("年第","/")}var t=this.start.hour+":"+this.start.minute+"-"+this.end.hour+":"+this.end.minute;this.classifiedReport(t),this.typeFlag=this.selectedType},chartSearch:function(t){this.buttonList.flag=t,this.search()},resetAll:function(){this.options=["日报表","周报表","月报表","季度报表","年报表"],this.shopName="请选择店铺",this.reset++,this.selects=[],this.selectedType=0,this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).setHours(0,0,0,0),this.index++,this.start={hour:"00",minute:"00"},this.end={hour:"23",minute:"59"},this.selShopid=[]},showHead:function(){this.formHead=!this.formHead,this.headList=o.a.deepCopy(this.selHead)},light:function(t){this.buttonList.flag=t,this.search()}},components:{selectBtn:function(){return s.e("select_btn").then(s.bind(null,"3d41"))},calendar:function(){return s.e("calendar_type").then(s.bind(null,"f2dd"))},timehm:function(){return s.e("time").then(s.bind(null,"4712"))},mulSelect:function(){return s.e("mul_select").then(s.bind(null,"7d09"))},categoryRetail:function(){return s.e("category_form").then(s.bind(null,"af57"))},selectstore:function(){return s.e("select_shop").then(s.bind(null,"27a4"))},loading:function(){return s.e("category_loading").then(s.bind(null,"ab0a"))},formShop:function(){return s.e("form_shop").then(s.bind(null,"1e0a"))}},destroyed:function(){clearInterval(window.timer)}},c=(s("3f18"),s("7610")),l=Object(c.a)(h,i,[],!1,null,"407a5666",null);l.options.__file="src\\module\\cashier\\cashier_category.vue";e.default=l.exports},"6fa0":function(t,e,s){}}]);