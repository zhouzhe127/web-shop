(window.webpackJsonp=window.webpackJsonp||[]).push([["survey"],{3342:function(t,e,s){"use strict";var a=s("453e");s.n(a).a},"453e":function(t,e,s){},a428:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{attrs:{id:"survey"}},[a("section",{staticClass:"top"},[a("span",{staticStyle:{"margin-right":"100px"}},[a("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[t._v("HI,\n\t\t\t\t"),a("span",{staticStyle:{color:"#2980B9","font-size":"16px"}},[t._v(t._s(t.userData.user.name))])]),t._v("\n\t\t\t欢迎回来！\n\t\t")]),t._v(" "),a("span",[t._v("今天是：\n\t\t\t"),a("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[t._v(t._s(t.newTime))])])]),t._v(" "),a("div",{staticStyle:{height:"10px"}}),t._v(" "),t.coverShow&&!t.isContent?a("div",{staticClass:"loding-cover"},[a("img",{attrs:{src:s("b8bc")}})]):t._e(),t._v(" "),t.coverShow||t.isContent?t._e():a("div",{staticClass:"left",style:{width:t.noticeList.length>0||t.updateList.length>0?"76%":"90%"}},[a("div",{staticStyle:{"margin-bottom":"15px"}},[a("div",{staticClass:"specific"},t._l(t.eachList,function(e,s){return a("div",{key:s},[e.data.length>=2?a("div",{staticClass:"block",style:{marginRight:3==s||1==s?"0%":"4%"}},[a("div",{staticClass:"name"},[t._v("\n\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t"),e.iconShow?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.tipsContent[e.field],placement:"right-start"}},[a("em",{staticClass:"help-icon"})]):t._e()],1),t._v(" "),a("div",{staticClass:"total"},[a("P",{staticClass:"num"},[a("span",[t._v(t._s(e.total))]),t._v(" "),e.iconShow?a("em",[t._v("."+t._s(t.salesPoint[e.field]))]):t._e()])],1),t._v(" "),a("div",{staticClass:"branch"},t._l(e.data,function(s,n){return a("div",{key:n,staticClass:"box",style:{width:2==e.data.length?"50%":3==e.data.length?"33.3%":"25%"}},[a("span",[t._v(t._s(s.name))]),t._v(" "),a("p",{attrs:{title:s.showData}},[t._v(t._s(s.showData))])])}))]):t._e(),t._v(" "),e.data.length<2?a("div",{staticClass:"block",style:{marginRight:3==s||1==s?"0%":"4%"}},[a("div",{staticClass:"name"},[t._v("\n\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t"),e.iconShow?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.tipsContent[e.field],placement:"right-start"}},[a("em",{staticClass:"help-icon"})]):t._e()],1),t._v(" "),a("div",{staticClass:"totalOne"},[a("P",{staticClass:"num"},[1==e.data.length?a("span",{staticStyle:{"font-size":"16px","margin-right":"5px"}},[t._v(t._s(e.data[0].name))]):t._e(),t._v(" "),a("span",[t._v(t._s(e.total))]),t._v(" "),e.iconShow?a("em",[t._v("."+t._s(t.salesPoint[e.field]))]):t._e()])],1)]):t._e()])}))]),t._v(" "),t.echarts?a("pieChart",{attrs:{pie:t.pie,echarts:t.echarts,isBrand:t.isBrand}}):t._e(),t._v(" "),t.isBrand&&t.echarts&&t.userShopIdStr.length>1?a("barChart",{staticStyle:{"margin-bottom":"40px"},attrs:{bar:t.bar,echarts:t.echarts,shopList:t.shopList,shopIds:t.shopIds}}):t._e(),t._v(" "),t.echarts&&!t.isBrand?a("lineChart",{staticStyle:{"margin-bottom":"40px"},attrs:{line:t.line,echarts:t.echarts}}):t._e()],1),t._v(" "),t.isContent?a("div",{staticClass:"isContent"},[a("div",{staticClass:"head"},[t._v(t._s(t.noticeContent.title)+"\n\t\t\t"),a("span",{staticClass:"back",on:{click:function(e){t.toBack()}}},[t._v("\n\t\t\t\t返回\n\t\t\t")])]),t._v(" "),a("div",{staticClass:"content"},[a("div",[a("span",{domProps:{innerHTML:t._s(t.line2br(t.noticeContent.content))}})]),t._v(" "),a("div",{staticClass:"time"},[t._v(t._s(t.noticeContent.time))])])]):t._e(),t._v(" "),a("div",{staticClass:"right"},[t.noticeList.length>0?a("section",{staticClass:"right-content"},[a("div",{staticClass:"head"},[t._v("通知")]),t._v(" "),a("div",{staticClass:"content"},t._l(t.noticeList,function(e,s){return a("section",{key:s},[a("div",[t._v(t._s(e.time))]),t._v(" "),a("div",{class:{"title ":e.isContent},staticStyle:{"margin-bottom":"15px"},on:{click:function(s){t.toContent(e)}}},[t._v(t._s(e.title))])])}))]):t._e(),t._v(" "),t.updateList.length>0?a("section",{staticClass:"right-two"},[a("div",{staticClass:"head"},[t._v("近期更新")]),t._v(" "),a("div",{staticClass:"content"})]):t._e()])])};a._withStripped=!0;var n=s("f6ce"),i=s("bbb9"),r=s("81a2");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,s){return function a(n,i){try{var r=e[n](i),o=r.value}catch(t){return void s(t)}if(!r.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var c={data:function(){return{echarts:null,newTime:"",isBrand:!1,eachList:[{name:"营业总额（元）",field:"business",iconShow:!0,data:[]},{name:"优惠总额（元）",field:"discount",iconShow:!0,data:[]},{name:"入账金额（元）",field:"amount",iconShow:!0,data:[]},{name:"订单量（单）",field:"orderNumber",data:[]}],sales:{eatIn:{business:0,amount:0,orderNumber:0,discount:0},takeOut:{business:0,amount:0,orderNumber:0,discount:0},quickPayment:{business:0,amount:0,orderNumber:0,discount:0},total:{business:0,amount:0,orderNumber:0,discount:0}},salesPoint:{business:"00",discount:"00",amount:"00"},tipsContent:{business:"该时间段内所有堂吃商品原价+堂吃服务费+外卖商品原价 = 营业总额（不计入退品）",discount:"活动优惠券、店内优惠（整单减免、整单折扣、整单强折、单品减免、单品折扣、赠菜金额、积分抵扣）以及外卖活动优惠金额",amount:"入账总额 = 营业总额 - 优惠总额（不计入未入账的支付方式的金额）"},coverShow:!0,pie:[],oneDiscount:{},line:[],bar:{},userShopIdStr:[],shopIds:[],shopList:[],noticeList:[],updateList:[],noticeContent:{},isContent:!1}},created:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a,r,o,c,u,l,d,h,m,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.newTime=i.a.format((new Date).getTime(),"yyyy-MM-dd"),t.userData=n.a.session("userShop"),a=t.userData.currentShop,t.isBrand="3"==a.ischain,!t.isBrand){e.next=33;break}if(r=n.a.session("shopList"),console.log(r),!(r.length>0)){e.next=30;break}for(o=!0,c=!1,u=void 0,e.prev=11,l=r[Symbol.iterator]();!(o=(d=l.next()).done);o=!0)h=d.value,t.userShopIdStr.push(h.id),m={id:h.id,name:h.shopName},t.shopList.push(m);e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),c=!0,u=e.t0;case 19:e.prev=19,e.prev=20,!o&&l.return&&l.return();case 22:if(e.prev=22,!c){e.next=25;break}throw u;case 25:return e.finish(22);case 26:return e.finish(19);case 27:for(p=0;p<t.userShopIdStr.length/8;p++)t.shopIds.push(t.userShopIdStr.slice(8*p,8*p+8));e.next=32;break;case 30:t.shopIds=[[]],t.shopList={};case 32:console.log(t.shopIds);case 33:return e.next=35,s.e("echarts").then(function(){var t=s("375c");return"object"==typeof t&&t&&t.__esModule?t:Object.assign({},"object"==typeof t&&t,{default:t})});case 35:t.echarts=e.sent,t.init(),t.getNoticeList();case 38:case"end":return e.stop()}},e,t,[[11,15,19,27],[20,,22,26]])}))()},methods:{getNoticeList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.getSurveyNoticeList({data:{}});case 2:(s=e.sent)&&(t.noticeList=s.map(function(t){return t.time=i.a.format(t.time,"yyyy-MM-dd"),t.isContent&&(t.title=t.title+">>"),t}));case 4:case"end":return e.stop()}},e,t)}))()},toContent:function(t){var e=this;return o(regeneratorRuntime.mark(function s(){var a;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t.isContent){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,r.a.noticeSurveyGetOne({data:{id:t.id}});case 4:(a=s.sent)&&(e.isContent=!0,a.time=i.a.format(a.time,"yyyy-MM-dd"),e.noticeContent=a);case 6:case"end":return s.stop()}},s,e)}))()},toBack:function(){this.isContent=!1},line2br:function(t){return t.split("\n").join("<br/>")},init:function(){this.isBrand?this.getBrandData():(console.log("单店"),this.getData(this.userData.currentShop.id))},getData:function(t){var e=this;return o(regeneratorRuntime.mark(function s(){var a,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e.coverShow=!0,s.next=3,r.a.statisticsBusiness({data:{endTime:i.a.format((new Date).getTime(),"yyyyMMdd"),startTime:i.a.format((new Date).getTime(),"yyyyMMdd"),dateType:1,isOpenTime:1,shopId:t}});case 3:return a=s.sent,e.sales=a.sales,e.pie=a.proportion,s.next=8,r.a.statisticsBusiness({data:{endTime:i.a.format((new Date).getTime(),"yyyyMMdd"),startTime:i.a.format((new Date).getTime()-5184e5,"yyyyMMdd"),dateType:1,isOpenTime:1,shopId:t}});case 8:return n=s.sent,e.line=n.list,s.next=12,r.a.TurnoverGetDiscountDataOne({data:{}});case 12:e.oneDiscount=s.sent,e.analytic(),e.doDate(),e.coverShow=!1;case 16:case"end":return s.stop()}},s,e)}))()},getBrandData:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var s,a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.coverShow=!0,e.next=3,r.a.TurnoverGetBrandStat({data:{type:1}});case 3:return s=e.sent,t.sales.eatIn.business=s.ePrice,t.sales.eatIn.amount=s.eRealPrice,t.sales.eatIn.orderNumber=s.eOrderNum,t.sales.eatIn.discount=s.eDiscount,t.sales.quickPayment.business=s.kPrice,t.sales.quickPayment.amount=s.kRealPrice,t.sales.quickPayment.orderNumber=s.kOrderNum,t.sales.quickPayment.discount=s.kDiscount,t.sales.takeOut.business=s.tPrice,t.sales.takeOut.amount=s.tRealPrice,t.sales.takeOut.orderNumber=s.tOrderNum,t.sales.takeOut.discount=s.tDiscount,t.sales.total.business=s.Price,t.sales.total.amount=s.RealPrice,t.sales.total.orderNumber=s.OrderNum,t.sales.total.discount=s.Discount,t.sales.selfTakeOut={},t.sales.selfTakeOut.business=s.sPrice,t.sales.selfTakeOut.amount=s.sRealPrice,t.sales.selfTakeOut.orderNumber=s.sOrderNum,t.sales.selfTakeOut.discount=s.sDiscount,t.analytic(),t.doDate(),e.next=29,r.a.turnoverGetMoreShopStat({data:{shopIds:t.shopIds[0],type:1}});case 29:for(n in a=e.sent)t.bar[n]={},t.bar[n].eatIn={},t.bar[n].quickPayment={},t.bar[n].takeOut={},t.bar[n].total={},t.bar[n].selfTakeOut={},t.bar[n].eatIn.business=a[n].ePrice,t.bar[n].eatIn.amount=a[n].eRealPrice,t.bar[n].eatIn.orderNumber=a[n].eOrderNum,t.bar[n].eatIn.discount=a[n].eDiscount,t.bar[n].quickPayment.business=a[n].kPrice,t.bar[n].quickPayment.amount=a[n].kRealPrice,t.bar[n].quickPayment.orderNumber=a[n].kOrderNum,t.bar[n].quickPayment.discount=a[n].kDiscount,t.bar[n].takeOut.business=a[n].tPrice,t.bar[n].takeOut.amount=a[n].tRealPrice,t.bar[n].takeOut.orderNumber=a[n].tOrderNum,t.bar[n].takeOut.discount=a[n].tDiscount,t.bar[n].total.business=a[n].Price,t.bar[n].total.amount=a[n].RealPrice,t.bar[n].total.orderNumber=a[n].OrderNum,t.bar[n].total.discount=a[n].Discount,t.bar[n].selfTakeOut.business=a[n].sPrice,t.bar[n].selfTakeOut.amount=a[n].sRealPrice,t.bar[n].selfTakeOut.orderNumber=a[n].sOrderNum,t.bar[n].selfTakeOut.discount=a[n].sOrderNum;t.coverShow=!1;case 32:case"end":return e.stop()}},e,t)}))()},analytic:function(){var t=this.sales;for(var e in t)if("total"==e)for(var s in t[e])if("orderNumber"!=s){var a=(t[e][s]+"").split(".");a[1]?(a[1].length<=1&&(a[1]=a[1]+"0"),this.salesPoint[s]=(a[1]+"").substring(0,2)):this.salesPoint[s]="00"}},doDate:function(){for(var t=["business","discount","amount","orderNumber"],e=0;e<t.length;e++)this.eachList[e].data=[],0!=this.sales.eatIn[t[e]]&&(this.eachList[e].data[this.eachList[e].data.length]={name:"堂吃",showData:3==e?this.sales.eatIn[t[e]]:Number(this.sales.eatIn[t[e]]).toFixed(2)}),0!=this.sales.takeOut[t[e]]&&(this.eachList[e].data[this.eachList[e].data.length]={name:"外卖",showData:3==e?this.sales.takeOut[t[e]]:Number(this.sales.takeOut[t[e]]).toFixed(2)}),0!=this.sales.quickPayment[t[e]]&&(this.eachList[e].data[this.eachList[e].data.length]={name:"快捷支付",showData:3==e?this.sales.quickPayment[t[e]]:Number(this.sales.quickPayment[t[e]]).toFixed(2)}),this.isBrand&&0!=this.sales.selfTakeOut[t[e]]&&(this.eachList[e].data[this.eachList[e].data.length]={name:"自营外卖",showData:3==e?this.sales.selfTakeOut[t[e]]:Number(this.sales.selfTakeOut[t[e]]).toFixed(2)}),this.eachList[e].total=parseInt(this.sales.total[t[e]]),this.eachList[e].totalPie=this.sales.total[t[e]];this.pie.totalHuo={discount:Number(this.eachList[1].totalPie).toFixed(2),amount:Number(this.eachList[2].totalPie).toFixed(2)},this.isBrand?this.pie.orderNumber={eatIn:this.sales.eatIn.orderNumber,takeOut:this.sales.takeOut.orderNumber,selfTakeOut:this.sales.selfTakeOut.orderNumber,quickPayment:this.sales.quickPayment.orderNumber}:this.pie.discount={giveGoods:Number(this.oneDiscount.giveGoods.price).toFixed(2),orderDiscount:Number(this.oneDiscount.orderDiscount.price).toFixed(2),orderDiscountForce:Number(this.oneDiscount.orderDiscountForce.price).toFixed(2),goodsDiscount:Number(this.oneDiscount.goodsDiscount.price).toFixed(2),coupon:Number(this.oneDiscount.coupon.price).toFixed(2),takeout:Number(this.oneDiscount.takeout.price).toFixed(2),self:Number(this.oneDiscount.self.price).toFixed(2),other:Number(this.oneDiscount.pointDeduction.price+this.oneDiscount.vipDiscount.price+this.oneDiscount.vipReduction.price+this.oneDiscount.fastPaymentPoint.price+this.oneDiscount.fastPaymentDiscount.price+this.oneDiscount.orderReduction.price).toFixed(2)}}},components:{pieChart:function(){return s.e("survey_pie").then(s.bind(null,"e8d4"))},lineChart:function(){return s.e("survey_line").then(s.bind(null,"631c"))},barChart:function(){return s.e("survey_bar").then(s.bind(null,"06b0"))}}},u=(s("3342"),s("6ceb")),l=Object(u.a)(c,a,[],!1,null,"41c6afc1",null);l.options.__file="src\\module\\home_page\\survey.vue";e.default=l.exports},b8bc:function(t,e,s){t.exports=s.p+"images/preloader.3e54c692.gif"}}]);