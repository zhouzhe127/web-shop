(window.webpackJsonp=window.webpackJsonp||[]).push([["integralcard_coupon"],{"26f2":function(t,e,i){},"394a":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAJCAYAAAALpr0TAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUwOEQyNTZCQTRCRTExRTZCNUU0RjY1REI2NkY3ODg0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUwOEQyNTZDQTRCRTExRTZCNUU0RjY1REI2NkY3ODg0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTA4RDI1NjlBNEJFMTFFNkI1RTRGNjVEQjY2Rjc4ODQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTA4RDI1NkFBNEJFMTFFNkI1RTRGNjVEQjY2Rjc4ODQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7or2pHAAAAc0lEQVR42mLcvHnzDgYGBncG/GAXE5AoBeK/eBSB5EpBCi8D8QI8ChcC8SUmKKcWiL9gUfQViGtADJjC50Dcg0VhD1QOrhAm+AyJD1LQDeMwoVlTi8SvgYphKGSAeuoSFC9ElmBBU/gPiEuAmBE9yAACDAATAxqU6+dAOgAAAABJRU5ErkJggg=="},a3a4:function(t,e,i){"use strict";var a=i("26f2");i.n(a).a},bdf6:function(t,e,i){t.exports=i.p+"images/alert.cbc28c67.jpg"},ec50:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("div",{attrs:{id:"breakCoupon"}},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"fl"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.couponName,expression:"couponName"}],staticClass:"inp",attrs:{maxlength:"20",placeholder:"请输入优惠券名称"},domProps:{value:t.couponName},on:{input:function(e){e.target.composing||(t.couponName=e.target.value)}}})])]),t._v(" "),t._m(2),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"fl"},[a("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.deratePrice,expression:"deratePrice",modifiers:{trim:!0,number:!0}}],staticClass:"input denomination",attrs:{maxlength:"6",placeholder:"请输入积分量"},domProps:{value:t.deratePrice},on:{input:function(e){e.target.composing||(t.deratePrice=t._n(e.target.value.trim()))},blur:function(e){t.$forceUpdate()}}})])]),t._v(" "),t._m(3),t._v(" "),a("div",{staticClass:"right"},t._l(t.validList,function(e,i){return a("section",{key:i,staticClass:"fl reduce"},[a("span",{class:{sign:t.validType.index==i},on:{click:function(a){t.changevalidType(e,i)}}},[t._v(t._s(e.name))])])})),t._v(" "),a("div",{staticClass:"left "}),t._v(" "),0==t.validType.index?a("div",{staticClass:"right"},[a("div",{staticClass:"line",staticStyle:{"text-align":"left"}},[t._v("\n\t\t\t\t领券后\n\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.validType.time,expression:"validType.time",modifiers:{trim:!0,number:!0}}],staticClass:"input couponinp",attrs:{maxlength:"3"},domProps:{value:t.validType.time},on:{input:function(e){e.target.composing||t.$set(t.validType,"time",t._n(e.target.value.trim()))},blur:function(e){t.$forceUpdate()}}}),t._v(" 日内有效\n\t\t\t")])]):t._e(),t._v(" "),1==t.validType.index?a("div",{staticClass:"right",staticStyle:{"padding-left":"10px"}},[a("div",{staticClass:"cleander"},[a("div",{staticClass:"cleander_o",on:{click:t.showCalendar}},[a("div",{staticClass:"cleander_t"},[t._v(t._s(t.transformDate(t.validType.startTime)))]),t._v(" "),a("div",{staticClass:"cleander_f"},[t._v("\n\t\t\t\t\t\t至\n\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"cleander_s"},[t._v(t._s(t.transformDate(t.validType.endTime)))])]),t._v(" "),t.isShowCa?a("can-multi",{attrs:{sideStart:t.validType.startTime,sideEnd:t.validType.endTime},on:{closeCan:function(){t.isShowCa=!1},castTime:t.getAddAlltime}}):t._e()],1),t._v(" "),a("div",{staticClass:"triangle",on:{click:t.showCalendar}},[a("img",{attrs:{src:i("394a")}})]),t._v(" "),a("div",{staticClass:"foday"},[t._v("\n\t\t\t\t共"+t._s(t.getValidDay())+"天\n\t\t\t")])]):t._e(),t._v(" "),t._m(4),t._v(" "),a("div",{staticClass:"fl",staticStyle:{width:"100%"}}),t._v(" "),t._m(5),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"fl note"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.annotation,expression:"annotation"}],staticClass:"input",attrs:{placeholder:"20字",maxlength:"20"},domProps:{value:t.annotation},on:{input:function(e){e.target.composing||(t.annotation=e.target.value)}}})])]),t._v(" "),t._m(6),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"fl useinformation"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.useKnow,expression:"useKnow"}],staticClass:"describe",attrs:{maxlength:"150"},domProps:{value:t.useKnow},on:{input:function(e){e.target.composing||(t.useKnow=e.target.value)}}}),t._v(" "),t._m(7)])]),t._v(" "),a("div",{staticClass:"save-coupon"},[a("a",{staticClass:"yellow",staticStyle:{width:"200px"},attrs:{href:"javascript:void(0);"},on:{click:t.getSendInfo}},[t._v("保存")])])])])},n=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"title"},[this._v("主要信息")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left "},[e("div",{staticClass:"text required"},[this._v("\n\t\t\t\t积分卡券名称\n\t\t\t")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left"},[e("div",{staticClass:"text required"},[this._v("\n\t\t\t\t积分量\n\t\t\t")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left "},[e("div",{staticClass:"text required"},[this._v("\n\t\t\t\t券有效期\n\t\t\t")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line",staticStyle:{float:"left"}},[e("div",{staticClass:"title"},[this._v("其他设置")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left "},[e("div",{staticClass:"text",staticStyle:{"margin-right":"10px"}},[this._v("\n\t\t\t\t备注\n\t\t\t")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left "},[e("div",{staticClass:"text",staticStyle:{"margin-right":"10px"}},[this._v("\n\t\t\t\t使用须知\n\t\t\t")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fl describetip"},[e("div",{staticClass:"fl tips"},[e("img",{attrs:{src:i("bdf6")}})]),this._v(" "),e("div",{staticClass:"fl"},[this._v("\n\t\t\t\t\t\t限制150字\n\t\t\t\t\t")])])}];a._withStripped=!0;var s=i("05dd"),r=i("f6ce"),o=i("81a2"),l=i("bbb9");var c={data:function(){return{ischain:"",couponName:"",isShowCa:!1,selectShops:[],validList:[{validType:"0",name:"相对时间"},{validType:"1",name:"指定时间"}],validType:{index:0,time:"",startTime:(new Date).getTime(),endTime:(new Date).getTime()},annotation:"",useKnow:"",deratePrice:"",editCoupon:!1}},props:{couponDetail:Object},mounted:function(){if(this.ischain=r.a.session("userShop").currentShop.ischain,!l.a.isEmptyObject(this.couponDetail)){var t=this.couponDetail;this.editCoupon=!0,this.couponName=t.name,this.validType.index=t.validityType,0==t.validityType?this.validType.time=t.relativeTime:1==t.validityType&&(this.validType.startTime=1e3*(t.startTime-0),this.validType.endTime=1e3*(t.endTime-0)),this.useDate.index=t.periodSel,this.annotation=t.annotation,this.useKnow=t.useKnow}},components:{"can-multi":function(){return i.e("can_multi").then(i.bind(null,"742e"))},selectBtn:function(){return i.e("select_btn").then(i.bind(null,"3d41"))},"use-time":function(){return i.e("use_time").then(i.bind(null,"5b788"))},goodListWin:function(){return i.e("good_list_win").then(i.bind(null,"8bf4"))}},methods:{closeShopWin:function(t){this.shopWin=!1,t&&(this.selectShops=t.selectShops)},getArrLength:function(t){return this[t].length},changevalidType:function(t,e){this.validType.index=e},showCalendar:function(){this.isShowCa=!this.isShowCa},transformDate:function(t){return l.a.format(new Date(t),"yyyy-MM-dd")},getValidDay:function(){return Math.floor((this.validType.endTime-this.validType.startTime)/864e5+1)},getAddAlltime:function(t){this.validType.startTime=t.startTime,this.validType.endTime=t.endTime,this.isShowCa=!1},valiData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示信息",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"alert";this.$store.commit("setWin",{winType:i,title:e,content:t})},arrToString:function(t){for(var e="",i=0;i<t.length;i++)e+=t[i],i<t.length-1&&(e+=",");return e},changeArr:function(t,e){for(var i=[],a=0;a<t.length;a++){var n={};"w"==e?n.week=t[a].week.sort(function(t,e){return t-e}):"m"==e&&(n.month=t[a].month.sort(function(t,e){return t-e})),n.isNextDay=t[a].isNextDay;var s=t[a].startslotH+":"+t[a].startslotM,r=t[a].endslotH+":"+t[a].endslotM;n.startslot=s,n.endslot=r,i.push(n)}return i},changeArrToNeed:function(t,e){for(var i=[],a=0;a<t.length;a++){var n={};n.startslotH=t[a].startslot.split(":")[0],n.startslotM=t[a].startslot.split(":")[1],n.endslotH=t[a].endslot.split(":")[0],n.endslotM=t[a].endslot.split(":")[1],n.isNextDay=t[a].isNextDay,"w"==e?n.week=t[a].week:"m"==e&&(n.month=t[a].month),i.push(n)}return i},checkData:function(){if(!s.a.checkData({couponName:{cond:"$$.trim() !== '' && $$.length<=20",pro:"积分卡券名称不能为空且不能超过20个字"}},this))return!1;if(!/^[0-9]+$/.test(this.deratePrice))return this.valiData("积分量只能是正整数"),!1;if(this.deratePrice-0<0)return this.valiData("积分量不能小于0"),!1;if(""==this.deratePrice)return this.valiData("请输入积分量"),!1;if(0==this.validType.index){if(""==this.validType.time.toString().trim())return this.valiData("请输入券有效期"),!1;if(!/^[0-9]*$/.test(this.validType.time))return this.valiData("券有效期只能是整数"),!1}return this.annotation.length>20?(this.valiData("备注字数不能大于20"),!1):!(this.useKnow.length>150)||(this.valiData("使用须知字数不能大于150"),!1)},getSendInfo:function(){if(this.checkData()){var t={};t.shopIds=r.a.session("userShop").currentShop.id,t.gids="",t.pids="",t.name=this.couponName,t.param=this.deratePrice,t.delayHours="",t.annotation=this.annotation,t.useKnow=this.useKnow,t.validityType=this.validType.index,t.periodSel="",t.isDiscount="",t.tastePrice="",t.useLimit="",t.billPrice="",t.reckoningPrice="",t.lowestConsume="";t.useTime={},0==this.validType.index?t.relativeTime=this.validType.time:(t.startTime=parseInt(this.validType.startTime/1e3),t.endTime=parseInt(this.validType.endTime/1e3)),t.type=7,l.a.isEmptyObject(this.couponDetail)||(t.id=this.couponDetail.id),this.operateCoupons(t)}},operateCoupons:function(t){var e,i=this;return(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.editCoupon){e.next=7;break}return e.next=3,o.a.addCoupon({data:t});case 3:i.valiData("添加成功"),i.$router.push("/admin/addCoupon"),e.next=11;break;case 7:return e.next=9,o.a.editCoupon({data:t});case 9:i.valiData("修改成功"),setTimeout(function(){r.a.session("couponDetail",""),i.$emit("changeMnage")},500);case 11:case"end":return e.stop()}},e,i)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function a(n,s){try{var r=t[n](s),o=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});e(o)}("next")})})()}},computed:{}},d=(i("a3a4"),i("6ceb")),u=Object(d.a)(c,a,n,!1,null,"026e6957",null);u.options.__file="src\\module\\marketing_tools\\new_coupons\\integralcard_coupon.vue";e.default=u.exports}}]);