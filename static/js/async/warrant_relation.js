(window.webpackJsonp=window.webpackJsonp||[]).push([["warrant_relation"],{"0fad":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"shopList"},[n("p",[t._v("请选择\n\t\t\t"),1==t.bandtype?n("span",{staticStyle:{"font-size":"22px"}},[t._v("饿了么")]):t._e(),t._v(" "),2==t.bandtype?n("span",{staticStyle:{"font-size":"22px"}},[t._v("美团")]):t._e(),t._v(" "),3==t.bandtype?n("span",{staticStyle:{"font-size":"22px"}},[t._v("百度")]):t._e(),t._v("\n\t\t\t关联店铺\n\t\t")]),t._v(" "),t._m(0),t._v(" "),t._l(t.shopList,function(e,i){return n("ul",{key:i,staticClass:"eleShop",on:{click:function(n){t.shopSelect(e.TakeoutShopId)}}},[n("li",[t._v("0"+t._s(i+1))]),t._v(" "),n("li",[t._v(t._s(e.TakeoutShopName))]),t._v(" "),n("li",{staticStyle:{cursor:"pointer"}},[n("div",{staticClass:"circle active",class:{"ele-active":t.selShopid==e.TakeoutShopId}})])])})],2),t._v(" "),n("div",[n("a",{staticClass:"gray",attrs:{href:"javascript:void(0);"},on:{click:t.relieve}},[t._v("解除授权")]),t._v(" "),n("a",{staticClass:"yellow",attrs:{href:"javascript:void(0);"},on:{click:t.next}},[t._v("下一步")])]),t._v(" "),t.showdel?n("meiTuan-warrant",{attrs:{urlData:t.urlData},on:{show:t.hidden}}):t._e()],1)};i._withStripped=!0;var a=n("81a2"),r=n("f6ce"),s=n("44e7");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,r){try{var s=e[a](r),o=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var c={data:function(){return{bandtype:"",shopList:[],brandId:"",userData:"",selShopid:"",showdel:!1,urlData:"",timer:""}},methods:{init:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getTakeoutShop({data:{type:t.bandtype,brandId:t.brandId}});case 2:n=e.sent,t.shopList.push(n);case 4:case"end":return e.stop()}},e,t)}))()},shopSelect:function(t){this.selShopid=t},relieve:function(){var t,e=this;if(""==this.selShopid)return this.$store.commit("setWin",{title:"提示",content:"请选择店铺！"}),!1;this.$store.commit("setWin",{title:"提示",content:"是否解除授权",winType:"confirm",callback:(t=o(regeneratorRuntime.mark(function t(n){var i,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("ok"!=n){t.next=18;break}if(i=void 0,1!=e.bandtype){t.next=11;break}return t.next=5,a.a.releaseAuth({data:{type:e.bandtype}});case 5:i=t.sent,e.$store.commit("setWin",{title:"提示",content:"解除授权成功！"}),window.opener.location.reload(),setTimeout(function(){window.close()},1e3),t.next=18;break;case 11:return t.next=13,a.a.getReleaseAuthUrl({data:{type:e.bandtype,brandId:e.brandId}});case 13:i=t.sent,e.showdel=!0,r=window.location.href,e.urlData=i+"&eOrigin="+r,e.timer=s.a.add(e.getReturn(e.bandtype,0),1500);case 18:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)})})},next:function(){if(2==this.bandtype)this.$router.push({path:"relation/config"});else{if(!r.a.session("goodList"))return this.$store.commit("setWin",{title:"提示",content:"菜品加载中请稍后"}),!1;this.$router.push({path:"relation/relationele",query:{id:this.selShopid}})}},getGoods:function(){a.a.getAllGoods({data:{page:1,num:9999,shopIds:this.userData.currentShop.id}}).then(function(t){console.log(t),r.a.session("goodList",t)}),a.a.getAllPackage({data:{page:1,num:9999,shopIds:this.userData.currentShop.id}}).then(function(t){console.log(t),r.a.session("packageList",t)})},hidden:function(t){this.showdel=t},getReturn:function(t,e,n){var i=this;return function(){a.a.getReturnInfo({data:{type:t}}).then(function(t){0==t&&(s.a.clear(i.timer),window.opener.location.reload(),i.$store.commit("setWin",{title:"提示",content:"解除授权成功！"}),window.close())},function(t){s.a.clear(i.timer),i.$store.commit("setWin",{title:"提示",content:t})}),(e+=1)>180&&(n.close(),s.a.clear(i.timer))}}},mounted:function(){this.bandtype=r.a.session("waimai"),this.userData=r.a.session("userShop"),this.getGoods(),this.brandId=0==this.userData.currentShop.ischain?0:this.userData.currentShop.brandId,this.init()},components:{meiTuanWarrant:function(){return n.e("iframe_warrant").then(n.bind(null,"6d65"))}},destroyed:function(){s.a.clear(this.timer)}},u=(n("e49c"),n("7610")),l=Object(u.a)(c,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"title"},[e("li",[this._v("序号")]),this._v(" "),e("li",[this._v("店铺名称")]),this._v(" "),e("li",[this._v("选择")])])}],!1,null,"48f9c336",null);l.options.__file="src\\module\\outfood\\accredit\\warrant_relation.vue";e.default=l.exports},"18ee":function(t,e,n){},e49c:function(t,e,n){"use strict";var i=n("18ee");n.n(i).a}}]);