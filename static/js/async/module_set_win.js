(window.webpackJsonp=window.webpackJsonp||[]).push([["module_set_win"],{"81e9":function(t,e,i){"use strict";i.r(e);var n=i("81a2"),s=i("bbb9"),o=i("b1f5");function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(s,o){try{var l=e[s](o),a=l.value}catch(t){return void i(t)}if(!l.done)return Promise.resolve(a).then(function(t){n("next",t)},function(t){n("throw",t)});t(a)}("next")})}}var a={data:function(){return{openOptios:!1,opindex:-2,showInfo:null,needInfo:null,showHtml:null,obj:{},editContener:null,template_id:null,alert:null,cancelStyle:null}},props:{userData:Object,index:"",item:Object,optionsList:Array,list:Array,infoList:Object},mounted:function(){this.cancelStyle={content:"删除",style:{backgroundColor:"red",color:"#fff "}};var t=s.a.deepCopy(this.infoList);for(var e in t)t[e].type==this.item.type&&(this.item.key=t[e].key);this.getNeedData(),this.setNeedInfoToData(),this.getShowHtml(),this.getAlert()},methods:{getNeedData:function(){var t=s.a.deepCopy(this.list),e=s.a.deepCopy(this.optionsList),i=s.a.deepCopy(this.infoList),n=t[this.index].type,o=null;for(var l in i)i[l].type==n&&(o=i[l].key,this.needInfo=i[l].data);if(null==o||""==o||void 0==o)this.showInfo=null;else for(var a=0;a<e.length;a++)e[a].template_id&&e[a].template_id==o&&(this.opindex=a,this.showInfo=e[a])},getShowHtml:function(){var t=this;if(null==this.showInfo)return!1;var e=/^\{\{[^}{]*\}\}$/g,i=this.showInfo.content.split(/[\n|\r|\r\n|\n\r]/g);i=this.arrunique(i);for(var n="<div class='required' style='width: 80px;height: 40px;float: left;padding-right: 8px;text-align: right;'>",l="</div>",a="<input type='text' class='input' style='width:160px;float: left;margin-right: 10px;' placeholder='请输入' v-model='",r="<input type='text' class='input' style='width: 340px;float: left;margin-right: 10px;' placeholder='请输入'  v-model='",h="",p=[],c=0;c<i.length;c++){if(h+="<div  style='width: 550px;margin-left: 10px;line-height: 40px;height: 40px;text-align: center;margin-bottom: 10px;float: left;'>",e.test(i[c]))i[c]=i[c].match(e)[0],i[c]=i[c].substring(2,i[c].length-2),h+=n,"first.DATA"==i[c]?h+="首行文字":"remark.DATA"==i[c]&&(h+="末行文字"),h+=l,h+=r+"obj."+i[c].split(".")[0]+"'>",p.push(i[c].split(".")[0]);else if(i[c].split("：").length>1){var d=i[c].split("：");e.test(d[0])?(h+=n+l,d[0]=d[0].match(e)[0],d[0]=d[0].substring(2,d[0].length-2),h+=a+"obj."+d[0].split(".")[0]+"'>",p.push(d[0].split(".")[0]),d[1]=d[1].match(e)[0],d[1]=d[1].substring(2,d[1].length-2),h+=a+"obj."+d[1].split(".")[0]+"'>",p.push(d[1].split(".")[0])):(h+=n+d[0]+l,d[1]=d[1].match(e)[0],d[1]=d[1].substring(2,d[1].length-2),h+=r+"obj."+d[1].split(".")[0]+"'>",p.push(d[1].split(".")[0]))}else h+="<div style='width:470px;text-align: left;text-indent: 80px;'>"+i[c]+l;h+="</div>"}this.editContener&&this.editContener.$destroy(!0);var u="editContener"+this.opindex;this.showHtml="<div id="+u+">"+h+"</div>",setTimeout(function(){t.editContener=new o.default({el:"#"+u,data:{obj:s.a.deepCopy(t.obj)}})},300)},setNeedInfoToData:function(){var t=this.needInfo;if((t+"").length<3)return!1;var e={};if(null!=(t=/\\'value/.test(t)?JSON.parse(JSON.parse(t)):JSON.parse(t))&&"{}"!=t)for(var i in t)e[i]=t[i].value;this.optionsList[this.opindex]&&this.optionsList[this.opindex].template_id==this.item.key?this.obj=e:this.obj={}},getAlert:function(){for(var t="",e=0;e<this.item.remind.length;e++)t+=this.item.remind[e].name,t+=this.item.remind[e].remark,t+="; ";this.alert=t},arrunique:function(t){for(var e=[],i=0;i<t.length;i++)""!=t[i]&&e.push(t[i]);return e},openOpensList:function(){this.openOptios?this.openOptios=!1:this.openOptios=!0},clickOptios:function(t){s.a.deepCopy(this.opindex)!=t&&(this.opindex=t,this.showInfo=this.optionsList[t],this.openOptios=!1,this.setNeedInfoToData(),this.getShowHtml())},editmeTe:function(t,e){var i=this;return l(regeneratorRuntime.mark(function s(){var o;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,n.a.saveTemplate({data:{type:i.list[i.index].type,key:i.showInfo.template_id,data:t,shopId:i.userData.currentShop.id}});case 2:(o=s.sent)&&(o.data=JSON.parse(o.data),i.infoList[i.item.type]=o,i.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"保存成功！"}),i.$emit("throwWinResult",e));case 4:case"end":return s.stop()}},s,i)}))()},delectMete:function(t){var e=this;return l(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.a.delTemplate({data:{type:e.item.type,shopId:e.userData.currentShop.id}});case 2:i.sent&&(e.infoList[e.item.type].key="",e.$emit("throwWinResult",t));case 4:case"end":return i.stop()}},i,e)}))()},clickResult:function(t){if("ok"==t)if(this.editContener&&this.editContener.obj){var e=s.a.deepCopy(this.editContener.obj),i={};for(var n in e){if(e[n]=e[n].replace(/(^\s*)|(\s*$)/g,""),""==e[n])return this.$store.commit("setWin",{title:"提示信息",winType:"alter",content:"输入框不能为空"}),!1;var o={};o.value=e[n],o.color="#173177",i[n]=o}this.editmeTe(i,t)}else this.$emit("throwWinResult",t);else"cancel"==t?this.delectMete(t):this.$emit("throwWinResult",t)}},components:{win:function(){return i.e("win").then(i.bind(null,"f60a"))}}},r=(i("ff02"),i("d801")),h=Object(r.a)(a,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("win",{attrs:{align:"right",width:600,height:650,cancel:t.cancelStyle},on:{winEvent:t.clickResult}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v("模板编辑")]),t._v(" "),i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{attrs:{id:"msnmodel-window"}},[i("div",{staticClass:"win-title",staticStyle:{"margin-bottom":"20px"}},[i("div",{staticClass:"w100",staticStyle:{"text-align":"right"}},[t._v("\n\t\t\t\t\t标题\n\t\t\t\t")]),t._v(" "),i("div",{staticClass:"w350 "},[null!=t.showInfo?i("div",{staticClass:"fl width290",on:{click:function(e){t.openOpensList()}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.showInfo.title)+"\n\t\t\t\t\t")]):i("div",{staticClass:"fl width290",on:{click:function(e){t.openOpensList()}}}),t._v(" "),i("div",{staticClass:"fr win-options",on:{click:function(e){t.openOpensList()}}}),t._v(" "),t.openOptios?i("div",{staticClass:"win-select"},t._l(t.optionsList,function(e,n){return i("div",{key:n},[i("span",{class:{selected:n==t.opindex},on:{click:function(e){t.clickOptios(n)}}},[t._v(t._s(e.title))])])})):t._e()])]),t._v(" "),i("div",{domProps:{innerHTML:t._s(t.showHtml)}}),t._v(" "),i("div",{staticClass:"width100"}),t._v(" "),i("div",{staticClass:"win-title",staticStyle:{"text-align":"left"}},[i("div",{staticClass:"w100 fl",staticStyle:{"text-align":"right",position:"relative",height:"140px"}},[t._v("\n\t\t\t\t\t温馨提示：\n\t\t\t\t")]),t._v("\n\t\t\t\t"+t._s(t.alert)+"\n\t\t\t")]),t._v(" "),i("div",{staticClass:"width100"}),t._v(" "),i("div",{staticClass:"win-title",staticStyle:{height:"auto"}},[i("div",{staticClass:"w100 fl",staticStyle:{"text-align":"right",position:"relative",height:"40px"}},[t._v("\n\t\t\t\t\t内容实例：\n\t\t\t\t")]),t._v(" "),i("div",{staticClass:"width350"},[null!=t.showInfo?i("xmp",{staticStyle:{margin:"0",float:"left"}},[t._v(t._s(t.showInfo.example))]):t._e()],1)])])])])},[],!1,null,"3d80ec31",null);e.default=h.exports},c146:function(t,e,i){},ff02:function(t,e,i){"use strict";var n=i("c146");i.n(n).a}}]);