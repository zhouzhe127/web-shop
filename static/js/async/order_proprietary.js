(window.webpackJsonp=window.webpackJsonp||[]).push([["order_proprietary"],{a66a:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"padding-top":"20px"},attrs:{id:"proprietary"}},["all"==t.showtype?a("section",[a("div",{staticClass:"button"},[a("a",{attrs:{href:"javascript:void(0);"},on:{click:t.toOrder}},[t._v("堂吃")]),t._v(" "),a("a",{attrs:{href:"javascript:void(0);"},on:{click:t.toTakeout}},[t._v("外卖")]),t._v(" "),a("a",{staticClass:"select",attrs:{href:"javascript:void(0);"}},[t._v("自营外卖")])]),t._v(" "),a("div",{staticClass:"filter clearfix"},[a("section",{staticClass:"fl",staticStyle:{height:"40px","margin-bottom":"20px","line-height":"40px"}},[a("section",{staticClass:"fl"},[a("calendar",{attrs:{pObj:t.startObj},on:{throwTime:t.getStartTime}})],1),t._v(" "),a("span",{staticClass:"fl line"},[t._v("-")]),t._v(" "),a("section",{staticClass:"fl"},[a("calendar",{attrs:{pObj:t.endObj},on:{throwTime:t.getEndTime}})],1)]),t._v(" "),a("div",{staticClass:"orderNum fl"},[a("div",{staticClass:"checkBox",class:{selected:t.isOpenTime},on:{click:t.selectBusinessHours}}),t._v(" "),a("span",{staticStyle:{"font-size":"16px"}},[t._v("按营业时间")])]),t._v(" "),"3"==t.ischain?a("div",{staticClass:"orderNum fl"},[a("selectstore",{attrs:{sorts:t.postSelectShopList,tipName:t.selectName},on:{emit:t.getSelectShopList}})],1):t._e(),t._v(" "),a("div",{staticClass:"search-box fl"},[a("span",{staticClass:"search-btn blue",on:{click:function(e){t.takeoutOrderQuery()}}},[t._v("筛选")]),t._v(" "),a("span",{staticClass:"reset-btn gray",on:{click:function(e){t.resetting()}}},[t._v("重置")])])]),t._v(" "),a("div",{staticClass:"compared"},t._l(t.payWays,function(e,i){return a("span",{key:i,class:{effect:t.payType==e.id},on:{click:function(a){t.changeRadio(e)}}},[t._v(t._s(e.name))])})),t._v(" "),a("section",{staticStyle:{"margin-bottom":"20px"}},[a("com-table",{attrs:{listHeight:80,listWidth:1400,showHand:!1,titleData:t.titleList,introData:t.staticLists},scopedSlots:t._u([{key:"con-6",fn:function(e){return a("div",{},[t._v("\n\t\t\t\t\t"+t._s(e.data.totalVouchersPain)+"("+t._s(e.data.totalVouchersNum)+"张)\n\t\t\t\t")])}}])})],1),t._v(" "),a("section",[a("com-table",{key:t.index,attrs:{listHeight:80,listWidth:1400,showHand:!0,titleData:t.shoptitleList,introData:t.formList,listName:"外卖统计",showTitle:1,allTotal:t.allFormList.length},scopedSlots:t._u([{key:"con-0",fn:function(e){return a("div",{on:{click:function(a){t.showoneshopDetail(e.data)}}},[t._v("\n\t\t\t\t\t"+t._s(t.getshopName(e.data.shopId))+"\n\t\t\t\t")])}},{key:"con-6",fn:function(e){return a("div",{},[t._v("\n\t\t\t\t\t"+t._s(e.data.totalVouchersPain)+"("+t._s(e.data.totalVouchersNum)+"张)\n\t\t\t\t")])}}])})],1),t._v(" "),a("section",{staticClass:"turn-page"},[a("pageElement",{attrs:{page:Number(t.page),total:Number(t.endTotal),numArr:[10,20,30,40,50],isNoJump:!0},on:{pageNum:t.getPageNum}})],1)]):t._e(),t._v(" "),"one"==t.showtype?a("oneshop-statics",{attrs:{constructionsName:t.constructionsName,startTime:t.startObj.time,endTime:t.endObj.time,isOpenTime:t.isOpenTime,constructionsId:t.constructionsId,taskId:t.taskId,payTypes:t.payType},on:{throwWinResult:t.getDetailShow}}):t._e()],1)};i._withStripped=!0;var s=a("81a2"),n=a("f6ce"),o=a("05dd");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(s,n){try{var o=e[s](n),r=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var l={data:function(){return{ischain:"",index:null,page:1,num:10,endTotal:1,startObj:{time:(new Date).setHours(0,0,0,0),width:170},endObj:{time:(new Date).setHours(23,59,59,999),width:170},payWays:[{id:0,name:"已完成"},{id:1,name:"已取消/退单"}],payType:0,titleList:[{titleName:"天数",dataName:"days"},{titleName:"订单数",dataName:"totalOrderNum"},{titleName:"销量 ",dataName:"totalSales"},{titleName:"赠品数",dataName:"totalGift"},{titleName:"配送总额",dataName:"totalMoveFee"},{titleName:"优惠总额",dataName:"totalDiscount"},{titleName:"代金券"},{titleName:"消费总额",dataName:"totalConsumption"},{titleName:"微信支付",dataName:"totalWeChatPain"},{titleName:"会员支付",dataName:"totalMemberPain"},{titleName:"积分抵扣总额",dataName:"totalPointCash"},{titleName:"实收总额",dataName:"totalPain"}],staticLists:[],shoptitleList:[{titleName:"店铺名称",dataName:"shopId",conStyle:{color:"#27a8e0",cursor:"pointer"}},{titleName:"订单数",dataName:"totalOrderNum"},{titleName:"销量",dataName:"totalSales"},{titleName:"赠品数",dataName:"totalGift"},{titleName:"配送金额",dataName:"totalMoveFee"},{titleName:"优惠总额",dataName:"totalDiscount"},{titleName:"代金券"},{titleName:"消费金额",dataName:"totalConsumption"},{titleName:"微信支付",dataName:"totalWeChatPain"},{titleName:"会员支付",dataName:"totalMemberPain"},{titleName:"积分抵扣总额",dataName:"totalPointCash"},{titleName:"实收金额",dataName:"totalPain"}],allFormList:[],formList:[],isOpenTime:!1,postSelectShopList:[],selectName:null,shopIds:null,timer:"",timeout:"",taskId:"",timerqueue:[],isloadingstatus:!1,loading:!1,constructionsName:"",constructionsId:"",showtype:"all"}},methods:{getStartTime:function(t){this.startObj.time=new Date(t).getTime()},getEndTime:function(t){this.endObj.time=new Date(t).getTime()},changeRadio:function(t){var e=t.id;this.payType=e,this.takeoutOrderQuery()},getPageNum:function(t){this.page=t.page,this.num=t.num,this.setPage()},setPage:function(){this.endTotal=Math.ceil(this.allFormList.length/this.num);var t=(this.page-1)*this.num,e=this.page*this.num,a=this.allFormList.slice(t,e);this.formList=a},selectBusinessHours:function(){this.isOpenTime=!this.isOpenTime},getshopName:function(t){var e="",a=!0,i=!1,s=void 0;try{for(var n,o=this.postSelectShopList[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var r=n.value;if(r.id==t){e=r.name?r.name:r.shopName;break}}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}return e},getSelectShopList:function(t){this.postSelectShopList=t;for(var e=[],a=[],i=0;i<t.length;i++)1==t[i].selected&&(e.push(t[i].id),a.push(t[i].name));this.shopIds=e.join(","),this.selectName=""==a?"请选择店铺":a.join(",")},getshopIdorshopName:function(){if("3"==this.ischain){var t=n.a.session("shopList"),e=[],a=[],i=!0,s=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done);i=!0){var c=r.value;c.selected=!0,c.name=c.shopName,e.push(c.id),a.push(c.name)}}catch(t){s=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(s)throw o}}this.shopIds=e.join(","),this.selectName=a.join(","),this.postSelectShopList=t}else this.shopIds=n.a.session("userShop").currentShop.id,this.selectName=n.a.session("userShop").currentShop.name,this.postSelectShopList.push(n.a.session("userShop").currentShop)},checkData:function(){return this.endObj.time-this.startObj.time>o.a.timeConst.THREEMONTHS?(this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"只能查询间隔三个月的数据"}),!1):this.startObj.time-this.endObj.time>0?(this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"查询时间选择错误"}),!1):1!=this.loading||(this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"正在搜索,请勿重复点击"}),!1)},takeoutOrderQuery:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.checkData()){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,t.isloadingstatus=!1,e.next=6,s.a.takeoutOrderQuery({data:{shopIds:t.shopIds,isOpenTime:Number(t.isOpenTime),startTime:parseInt(t.startObj.time/1e3),endTime:parseInt(t.endObj.time/1e3),orderStatus:t.payType}});case 6:(a=e.sent)&&(t.taskId=a,t.timer=setInterval(function(){t.getTaskStatus(a)},2e3));case 8:case"end":return e.stop()}},e,t)}))()},getTaskStatus:function(t){var e=this;return r(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.getScanTaskStatus({data:{taskId:t}});case 2:if(i=a.sent,e.timeout=setTimeout(function(){if(!e.isloadingstatus){for(e.loading=!1,e.$store.commit("setWin",{content:"页面加载失败,请重新加载",title:"操作提示",winType:"alert"}),clearInterval(e.timer);e.timerqueue.length;)clearTimeout(e.timerqueue.pop());return!1}},1e4),e.timerqueue.push(e.timeout),1==i){for(clearInterval(e.timer);e.timerqueue.length;)clearTimeout(e.timerqueue.pop());e.getTakeoutData(t)}case 6:case"end":return a.stop()}},a,e)}))()},getTakeoutData:function(t){var e=this;return r(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.getTakeoutData({data:{taskId:t,showDetail:0,showShopId:"",showDay:""}});case 2:(i=a.sent)&&(e.loading=!1,e.isloadingstatus=!0,e.staticLists=[],e.staticLists.push(i.total),e.allFormList=i.list,e.$nextTick(function(){e.setPage()}));case 4:case"end":return a.stop()}},a,e)}))()},showoneshopDetail:function(t){this.showtype="one",this.constructionsName=this.getshopName(t.shopId),this.constructionsId=t.shopId},getDetailShow:function(t){this.showtype=t},resetting:function(){this.isOpenTime=!1,this.getshopIdorshopName(),this.takeoutOrderQuery()},toOrder:function(){this.$router.push({path:"/admin/orderStatistics",query:this.$route.query})},toTakeout:function(){this.$router.push({path:"/admin/orderStatistics/takeawayBrand",query:this.$route.query})}},watch:{},components:{calendar:function(){return a.e("calendar_result").then(a.bind(null,"9265"))},pageElement:function(){return a.e("page_element").then(a.bind(null,"5921"))},comTable:function(){return a.e("table").then(a.bind(null,"4360"))},selectstore:function(){return a.e("win").then(a.bind(null,"cb83"))},oneshopStatics:function(){return a.e("order_proprietary_shopstatistics").then(a.bind(null,"1495"))}},created:function(){var t={titleStyle:{fontSize:"16px"}},e={conStyle:{color:"#ff9800"}},a=!0,i=!1,s=void 0;try{for(var n,o=this.titleList[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var r=n.value;Object.assign(r,t,e)}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}var l=!0,c=!1,u=void 0;try{for(var m,h=this.shoptitleList[Symbol.iterator]();!(l=(m=h.next()).done);l=!0){var d=m.value;Object.assign(d,t)}}catch(t){c=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(c)throw u}}},mounted:function(){this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).setHours(23,59,59,999),this.ischain=n.a.session("userShop").currentShop.ischain,this.getshopIdorshopName(),this.takeoutOrderQuery()},destroyed:function(){clearInterval(this.timer),clearTimeout(this.timeout)}},c=(a("fb77"),a("6ceb")),u=Object(c.a)(l,i,[],!1,null,"90d6cea2",null);u.options.__file="src\\module\\statistics\\order_proprietary.vue";e.default=u.exports},c0df:function(t,e,a){},fb77:function(t,e,a){"use strict";var i=a("c0df");a.n(i).a}}]);