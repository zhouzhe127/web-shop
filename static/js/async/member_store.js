(window.webpackJsonp=window.webpackJsonp||[]).push([["member_store"],{"193d":function(t,e,n){"use strict";n.r(e);var i=n("bbb9"),a=n("81a2"),s=n("f6ce"),o=n("05dd");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,s){try{var o=e[a](s),r=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var c={data:function(){return{startTime:(new Date).setHours(0,0,0,0)-o.a.timeConst.THREEMONTHS,endTime:(new Date).setHours(23,59,59,999),expirationTimeList:[{name:"全部渠道",id:0},{name:"微信",id:1},{name:"POS收银",id:2}],expirationTimeId:0,expirationTime:"全部",shopsList:[],shopsName:"选择适用门店",storeList:[{name:"全部"},{name:"固定方案"},{name:"自定义方案"}],indexOn:0,packageList:[],type:"",storeArr:[],isFlag:!1,id:null,show:!1,index:null,item:null,titleList:[{titleName:"操作",titleStyle:{width:"220px",flex:"none"}},{titleName:"创建时间",titleStyle:{width:"160px",flex:"none"}},{titleName:"方案名称",dataName:"name"},{titleName:"储值金额"},{titleName:"支付金额"},{titleName:"渠道",titleStyle:{width:"120px",flex:"none"}},{titleName:"赠送条件",titleStyle:{width:"180px",flex:"none"}},{titleName:"赠送内容",titleStyle:{width:"220px",flex:"none"}},{titleName:"方案类型"},{titleName:"排序",dataName:"sort"},{titleName:"操作人",dataName:"createUid"}],userShop:"",ischain:"",selectName:"请选择店铺",selectShopId:[],allFormList:[],page:1,num:10,endTotal:1,count:"0"}},methods:{pageChange:function(t){this.page=t.page,this.num=t.num,this.getStoreList()},startTimeChange:function(t){this.startTime=new Date(t).setHours(0,0,0,0)},endTimeChange:function(t){this.endTime=new Date(t).setHours(23,59,59,999)},selexpirationTime:function(t){this.expirationTime=this.expirationTimeList[t].name,this.expirationTimeId=this.expirationTimeList[t].id},translateTime:function(t){return i.a.format(t,"yyyy-MM-dd/hh:mm")},getStoreList:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getListDep({data:{startTime:parseInt(t.startTime/1e3),endTime:parseInt(t.endTime/1e3),channel:t.expirationTimeId,shopIds:t.selectShopId.join(","),type:t.indexOn,page:t.page,num:t.num}});case 2:for(n=e.sent,t.packageList=n.list,t.endTotal=n.pageNum,t.count=n.total,i=0;i<t.packageList.length;i++)t.packageList[i].couponIds&&(t.packageList[i].couponIds=JSON.parse(t.packageList[i].couponIds));case 7:case"end":return e.stop()}},e,t)}))()},delList:function(t,e){var n,i=this;this.$store.commit("setWin",{title:"删除方案",content:"是否删除该储值方案'"+t.name+"'",winType:"confirm",ok:{content:"确认删除"},cancle:{content:"取消删除"},callback:(n=r(regeneratorRuntime.mark(function n(o){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("ok"!=o){n.next=4;break}return n.next=3,a.a.delDep({data:{id:t.id,shopId:s.a.session("shopId")}});case 3:i.packageList.splice(e,1);case 4:case"end":return n.stop()}},n,i)})),function(t){return n.apply(this,arguments)})})},winEvent:function(t){var e=this;this.show=!1,"ok"==t&&this.isFlag&&setTimeout(function(){e.editDetail(e.item)},500)},clickDetail:function(t){this.show=!0,this.id=t.id,this.item=t},editDetail:function(t){var e=this;return r(regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.getDetailDep({data:{id:t.id,shopId:s.a.session("shopId")}});case 2:i=n.sent,s.a.session("editdetail",i),e.$router.push("/admin/memberStoredValueScheme/solution");case 5:case"end":return n.stop()}},n,e)}))()},openStore:function(){this.$router.push("/admin/memberStoredValueScheme/solution")},chooseStore:function(t){this.page=1,this.indexOn=t,this.getStoreList()},getShopList:function(){if(this.selectShopId=[],"3"==this.ischain){this.shopsList=s.a.session("shopList");var t=!0,e=!1,n=void 0;try{for(var i,a=this.shopsList[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;o.name=o.shopName}}catch(t){e=!0,n=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw n}}this.selectShopId=this.shopsList.map(function(t){return t.id});for(var r="",c=0;c<this.shopsList.length;c++)r=r+this.shopsList[c].name+",";this.selectName=r}else this.selectShopId.push(this.userShop.currentShop.id),this.selectName=this.userShop.currentShop.name},resetFun:function(){this.startTime=(new Date).setHours(0,0,0,0)-o.a.timeConst.THREEMONTHS,this.endTime=(new Date).setHours(23,59,59,999),this.expirationTimeId=0,this.expirationTime="全部",this.getShopList(),this.getStoreList()},getSelectShopList:function(t){this.selectShopId=t;for(var e="",n=0;n<this.shopsList.length;n++)this.selectShopId.includes(this.shopsList[n].id)?(this.shopsList[n].selected=!0,e=e+this.shopsList[n].name+","):this.shopsList[n].selected=!1;this.selectName=""==e?"请选择店铺":e}},mounted:function(){var t=this;this.userShop=s.a.session("userShop"),this.ischain=this.userShop.currentShop.ischain,this.currentShop=this.userShop.currentShop,0!=this.currentShop.ischain&&3!=this.currentShop.ischain||(this.isFlag=!this.isFlag),this.isFlag&&this.$store.commit("setPageTools",[{name:"创建方案",fn:function(){t.openStore()},className:"userLabel"}]),this.getShopList(),this.getStoreList()},components:{detail:function(){return n.e("member_store_detail").then(n.bind(null,"29ce"))},comTable:function(){return n.e("table").then(n.bind(null,"4360"))},Calendar:function(){return n.e("calendar_type").then(n.bind(null,"f2dd"))},selectBtn:function(){return n.e("select_btn").then(n.bind(null,"3d41"))},elShopList:function(){return n.e("el_shopList").then(n.bind(null,"60ff"))},selectStore:function(){return n.e("select_store").then(n.bind(null,"cb83"))},pageElement:function(){return n.e("page_element").then(n.bind(null,"5921"))}}},l=(n("ff1a"),n("d801")),d=Object(l.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"min-width":"1437px"},attrs:{id:"member-store"}},[n("div",{staticClass:"timeSearch"},[n("div",{staticClass:"selectDate"},[n("div",{staticClass:"activation fl"},[t._v("\n\t\t\t\t\t创建时间\n\t\t\t\t")]),t._v(" "),n("div",{staticClass:"inp-box inp-start fl"},[n("calendar",{staticClass:"data-box",attrs:{time:t.startTime,type:0,format:"yyyy年MM月dd日"},on:{emit:t.startTimeChange}})],1),t._v(" "),n("span",{staticClass:"line"},[t._v(" - ")]),t._v(" "),n("div",{staticClass:"inp-box inp-start fl"},[n("calendar",{staticClass:"data-box",attrs:{time:t.endTime,type:0,format:"yyyy年MM月dd日"},on:{emit:t.endTimeChange}})],1),t._v(" "),n("div",{staticClass:"orderNum fl"},[n("span",{staticClass:"title fl"},[t._v("渠道")]),t._v(" "),n("select-btn",{attrs:{name:t.expirationTime,sorts:t.expirationTimeList.map(function(t){return t.name}),width:157},on:{selOn:t.selexpirationTime}})],1),t._v(" "),"3"==t.ischain?n("div",{staticClass:"orderNum fl"},[n("span",{staticClass:"title fl"},[t._v("门店")]),t._v(" "),n("elShopList",{attrs:{shopIds:t.selectShopId},on:{chooseShop:t.getSelectShopList}})],1):t._e(),t._v(" "),n("div",{staticClass:"search-box fl"},[n("span",{staticClass:"search-btn blue",on:{click:t.getStoreList}},[t._v("筛选")]),t._v(" "),n("span",{staticClass:"reset-btn gray",on:{click:t.resetFun}},[t._v("重置")])])])]),t._v(" "),n("p",{staticClass:"btn"},t._l(t.storeList,function(e,i){return n("span",{key:i,staticClass:"all",class:{active:t.indexOn==i},on:{click:function(e){t.chooseStore(i)}}},[t._v(t._s(e.name))])})),t._v(" "),"3"==t.ischain?n("p",{staticClass:"btn"},[t._v("\n\t\t\t选择门店:"+t._s(t.selectName)+"\n\t\t")]):t._e(),t._v(" "),n("com-table",{key:t.index,attrs:{listHeight:80,showHand:!0,showTitle:2,listWidth:1300,introData:t.packageList,titleData:t.titleList,allTotal:t.count,listName:"储值方案"},scopedSlots:t._u([{key:"con-0",fn:function(e){return n("div",{staticClass:"doBtn"},[n("span",{on:{click:function(n){t.clickDetail(e.data)}}},[t._v("查看详情")]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.isFlag,expression:"isFlag"}],on:{click:function(n){t.editDetail(e.data)}}},[t._v("编辑")]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.isFlag,expression:"isFlag"}],on:{click:function(n){t.delList(e.data,e.index)}}},[t._v("删除")])])}},{key:"con-1",fn:function(e){return n("div",{},[t._v(t._s(t.translateTime(e.data.createTime)))])}},{key:"con-3",fn:function(e){return n("div",{},[t._v(t._s(2==e.data.type?"-":e.data.deposit))])}},{key:"con-4",fn:function(e){return n("div",{},[t._v(t._s(2==e.data.type?"-":e.data.payment))])}},{key:"con-5",fn:function(e){return n("div",{},[12==e.data.channel||21==e.data.channel?[t._v("\n\t\t\t\t\t微信、POS收银\n\t\t\t\t")]:t._e(),t._v(" "),1==e.data.channel?[t._v("\n\t\t\t\t\t微信\n\t\t\t\t")]:t._e(),t._v(" "),2==e.data.channel?[t._v("\n\t\t\t\t\tPOS收银\n\t\t\t\t")]:t._e()],2)}},{key:"con-6",fn:function(e){return n("div",{},[1==e.data.type?[t._v("-")]:t._e(),t._v(" "),2==e.data.type?[2==e.data.depositRule?[t._v("\n\t\t\t\t\t\t"+t._s(e.data.deposit)+" <=支付金额 <= "+t._s(e.data.payment)+"\n\t\t\t\t\t")]:t._e(),t._v(" "),1==e.data.depositRule?[t._v("\n\t\t\t\t\t\t支付金额 = "+t._s(e.data.deposit)+"\n\t\t\t\t\t")]:t._e(),t._v(" "),3==e.data.depositRule?[t._v("\n\t\t\t\t\t\t支付金额 >= "+t._s(e.data.deposit)+"\n\t\t\t\t\t")]:t._e(),t._v(" "),4==e.data.depositRule?[t._v("\n\t\t\t\t\t\t支付金额 <= "+t._s(e.data.deposit)+"\n\t\t\t\t\t")]:t._e()]:t._e()],2)}},{key:"con-7",fn:function(e){return n("div",{staticClass:"giftcontent"},[1==e.data.type?[0==e.data.giftAmount&&0==e.data.giftPoint&&""==e.data.couponIds?[t._v("\n\t\t\t\t\t\t-\n\t\t\t\t\t")]:t._e(),t._v(" "),0==e.data.giftAmount&&0!=e.data.giftPoint?[t._v("\n\t\t\t\t\t\t赠送"+t._s(e.data.giftPoint)+"积分\n\t\t\t\t\t")]:t._e(),t._v(" "),0!=e.data.giftAmount&&0==e.data.giftPoint?[t._v("\n\t\t\t\t\t\t赠送金额"+t._s(e.data.giftAmount)+"元\n\t\t\t\t\t")]:t._e(),t._v(" "),0!=e.data.giftAmount&&0!=e.data.giftPoint?[t._v("\n\t\t\t\t\t\t赠送金额"+t._s(e.data.giftAmount)+"元，赠送"+t._s(e.data.giftPoint)+"积分\n\t\t\t\t\t")]:t._e(),t._v(" "),e.data.couponIds?[t._l(e.data.couponIds,function(e){return[t._v("\n\t\t\t\t\t\t\t赠送"+t._s(e.name)+"优惠券"+t._s(e.num)+"张\n\t\t\t\t\t\t")]})]:t._e()]:t._e(),t._v(" "),2==e.data.type?[0==e.data.giftAmountRule&&0==e.data.giftPointRule?[t._v("\n\t\t\t\t\t\t-\n\t\t\t\t\t")]:t._e(),t._v(" "),1==e.data.giftAmountRule?[0==e.data.giftAmount?[t._v("\n\t\t\t\t\t\t\t-\n\t\t\t\t\t\t")]:[t._v("\n\t\t\t\t\t\t\t赠送固定储值金额"+t._s(e.data.giftAmount)+"元 ,\n\t\t\t\t\t\t")]]:t._e(),t._v(" "),2==e.data.giftAmountRule?[0==e.data.giftAmount?void 0:[t._v("\n\t\t\t\t\t\t\t按比例赠送储值金额"+t._s(e.data.giftAmount)+"%,\n\t\t\t\t\t\t")]]:t._e(),t._v(" "),1==e.data.giftPointRule?[0==e.data.giftPoint?[t._v("\n\t\t\t\t\t\t\t-\n\t\t\t\t\t\t")]:[t._v("\n\t\t\t\t\t\t\t赠送固定积分"+t._s(e.data.giftPoint)+"分\n\t\t\t\t\t\t")]]:t._e(),t._v(" "),2==e.data.giftPointRule?[0==e.data.giftPoint?[t._v("\n\t\t\t\t\t\t\t-\n\t\t\t\t\t\t")]:[t._v("\n\t\t\t\t\t\t\t按比例赠送积分"+t._s(e.data.giftPoint)+"%\n\t\t\t\t\t\t")]]:t._e()]:t._e()],2)}},{key:"con-8",fn:function(e){return n("div",{},[t._v(t._s(1==e.data.type?"固定方案":"自定义方案"))])}}])}),t._v(" "),n("div",{staticClass:"store"},[t.show?n("detail",{attrs:{id:t.id,shopsList:t.shopsList},on:{winEvent:t.winEvent}}):t._e()],1),t._v(" "),n("section",{staticClass:"turn-page"},[n("pageElement",{attrs:{page:Number(t.page),total:Number(t.endTotal),numArr:[10,20,30,40,50],isNoJump:!0},on:{pageNum:t.pageChange}})],1)],1)},[],!1,null,"4c3600a1",null);e.default=d.exports},f177:function(t,e,n){},ff1a:function(t,e,n){"use strict";var i=n("f177");n.n(i).a}}]);