(window.webpackJsonp=window.webpackJsonp||[]).push([["invcontrol_set_win"],{"82aa":function(t,i,o){"use strict";o.r(i);var e=function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("div",[o("win",{attrs:{align:"center",width:t.winWidth,height:200},on:{winEvent:t.closeSelfWin}},[o("span",{attrs:{slot:"title"},slot:"title"},[t._v("库存设置")]),t._v(" "),o("section",{staticClass:"lContForm",attrs:{slot:"content",id:"invcontro_win"},slot:"content"},[0==t.good.isGroup?o("section",[o("section",{staticClass:"group"},[o("div",{staticClass:"oBox"},[o("span",{staticStyle:{"margin-right":"10px"}},[t._v("库存")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.groupData[0].goodsNum,expression:"groupData[0].goodsNum"}],staticStyle:{"margin-right":"20px",width:"120px"},attrs:{maxlength:"9",type:"text",placeholder:"输入库存数量"},domProps:{value:t.groupData[0].goodsNum},on:{input:function(i){i.target.composing||t.$set(t.groupData[0],"goodsNum",i.target.value)}}}),t._v(" "),o("span",{staticStyle:{"margin-right":"10px"}},[t._v("库存预警")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.groupData[0].goodsThreshold,expression:"groupData[0].goodsThreshold"}],staticStyle:{"margin-right":"20px",width:"120px"},attrs:{placeholder:"输入库存预警数量",type:"text",maxlength:"9"},domProps:{value:t.groupData[0].goodsThreshold},on:{input:function(i){i.target.composing||t.$set(t.groupData[0],"goodsThreshold",i.target.value)}}})]),t._v(" "),"0"==t.good.type?o("div",{staticClass:"oBox"},[o("div",{staticStyle:{"margin-right":"10px",float:"left"}},[t._v("每日限售")]),t._v(" "),o("div",{staticStyle:{"margin-right":"10px",float:"left"}},[o("span",{class:{"check-span off":"0"==t.groupData[0].isLimit,"check-span on":"1"==t.groupData[0].isLimit},on:{click:function(i){t.onLimit(t.groupData[0])}}})]),t._v(" "),o("input",{directives:[{name:"show",rawName:"v-show",value:"1"==t.groupData[0].isLimit,expression:"groupData[0].isLimit=='1'"},{name:"model",rawName:"v-model",value:t.groupData[0].limitNum,expression:"groupData[0].limitNum"}],staticStyle:{width:"120px",float:"left","margin-top":"5px"},attrs:{type:"text",maxlength:"9",placeholder:"每日限售数量"},domProps:{value:t.groupData[0].limitNum},on:{input:function(i){i.target.composing||t.$set(t.groupData[0],"limitNum",i.target.value)}}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:"1"==t.groupData[0].isLimit&&"1"==t.groupData[0].oldisLimit,expression:"groupData[0].isLimit=='1'&&groupData[0].oldisLimit=='1'"}],staticClass:"gray ret",on:{click:function(i){t.reset(t.groupData[0])}}},[t._v("余量重置")])]):t._e()])]):t._e(),t._v(" "),1==t.good.isGroup?o("section",t._l(t.groupData,function(i,e){return o("section",{key:e},[o("section",{staticClass:"group"},[o("div",{staticClass:"aBox",staticStyle:{width:"146px"}},[0===e?o("span",{staticClass:"aSpan"},[t._v("规格一：")]):t._e(),t._v(" "),1===e?o("span",{staticClass:"aSpan"},[t._v("规格二：")]):t._e(),t._v(" "),2===e?o("span",{staticClass:"aSpan"},[t._v("规格三：")]):t._e(),t._v(" "),o("span",{staticClass:"aSpan",staticStyle:{width:"80px"},attrs:{title:i.goodsName}},[t._v(t._s(t._f("hide")(i.goodsName)))])]),t._v(" "),o("div",{staticClass:"aBox",staticStyle:{width:"240px"}},[o("span",{staticStyle:{"margin-right":"10px"}},[t._v("库存")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:i.goodsNum,expression:"item.goodsNum"}],staticStyle:{"margin-right":"20px"},attrs:{maxlength:"9",type:"text"},domProps:{value:i.goodsNum},on:{input:function(o){o.target.composing||t.$set(i,"goodsNum",o.target.value)}}}),t._v(" "),o("span",{staticStyle:{"margin-right":"10px"}},[t._v("库存预警")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:i.goodsThreshold,expression:"item.goodsThreshold"}],attrs:{type:"text",maxlength:"9"},domProps:{value:i.goodsThreshold},on:{input:function(o){o.target.composing||t.$set(i,"goodsThreshold",o.target.value)}}})]),t._v(" "),"0"==t.good.type?o("div",{staticClass:"aBox",staticStyle:{width:"370px"}},[o("div",{staticStyle:{"margin-right":"10px",float:"left"}},[t._v("每日限售")]),t._v(" "),o("div",{staticStyle:{"margin-right":"10px",float:"left"}},[o("span",{staticClass:"check-span",class:{off:"0"==i.isLimit,on:"1"==i.isLimit},on:{click:function(o){t.onLimit(i)}}})]),t._v(" "),o("input",{directives:[{name:"show",rawName:"v-show",value:"1"==i.isLimit,expression:"item.isLimit=='1'"},{name:"model",rawName:"v-model",value:i.limitNum,expression:"item.limitNum"}],staticStyle:{width:"100px",float:"left","margin-top":"5px"},attrs:{type:"text",maxlength:"9",placeholder:"每日限售数量"},domProps:{value:i.limitNum},on:{input:function(o){o.target.composing||t.$set(i,"limitNum",o.target.value)}}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:"1"==i.isLimit&&"1"==i.oldisLimit,expression:"item.isLimit=='1'&&item.oldisLimit=='1'"}],staticClass:"gray ret",on:{click:function(o){t.reset(i)}}},[t._v("余量重置")])]):t._e()])])})):t._e()])])],1)};e._withStripped=!0;var s=o("f6ce"),a=o("81a2");function n(t){return function(){var i=t.apply(this,arguments);return new Promise(function(t,o){return function e(s,a){try{var n=i[s](a),r=n.value}catch(t){return void o(t)}if(!n.done)return Promise.resolve(r).then(function(t){e("next",t)},function(t){e("throw",t)});t(r)}("next")})}}var r={data:function(){return{shopId:null,gid:null,good:{},groupData:[{}],copyData:null,winWidth:800,isOpen:!1}},props:{pObj:Object},methods:{reset:function(t){var i=this;this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确认重置“"+t.goodsName+"”今日限购余量?",callback:function(o){"ok"==o&&i.newRe(t)}})},newRe:function(t){var i=this;return n(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,a.a.resetLimitNum({data:{gid:t.gid}});case 2:o.sent&&i.$store.commit("setWin",{title:"温馨提示",content:"限购商品“"+t.goodsName+"”重置成功!"});case 4:case"end":return o.stop()}},o,i)}))()},onLimit:function(t){t.isLimit="0"==t.isLimit?"1":"0"},checkForm:function(){var t=this;return!this.groupData.some(function(i){var o=i.goodsNum,e=i.limitNum,s=i.goodsThreshold;if(!o)return t.$store.commit("setWin",{title:"温馨提示",content:"请输入库存数量!"}),!0;var a=null,n=null;if(1==t.good.type?(a=/(^[1-9]\d*(\.\d{0,2})?$)|(^0\.\d{0,2}$)/,n="库存数和库存预警为数字!"):(a=/^[1-9]\d{0,}$/g,n="商品库存和库存预警为整数且不能为0!"),!a.test(o))return t.$store.commit("setWin",{title:"温馨提示",content:n}),!0;if(s&&(1==t.good.type?(a=/(^[1-9]\d*(\.\d{0,2})?$)|(^0\.\d{0,2}$)/,n="库存数和库存预警为数字!"):(a=/^[1-9]\d{0,}$/g,n="商品库存和库存预警为整数且不能为0!"),!a.test(i.goodsThreshold)))return t.$store.commit("setWin",{title:"温馨提示",content:n}),!0;return"1"!=i.isLimit||/^[1-9]\d{0,}$/g.test(e)?void 0:(t.$store.commit("setWin",{title:"温馨提示",content:"开启限售，每日限售数量只能为整数!"}),!0)})&&!this.groupData.some(function(i){var o=i.goodsThreshold;if(i.goodsThreshold||(o=0),parseInt(i.goodsNum)<=parseInt(o))return t.$store.commit("setWin",{title:"温馨提示",content:"库存数量不能小于预警数量!"}),!0})},formarData:function(){var t=[];if(0==this.good.isGroup){var i={gid:this.groupData[0].gid,shopId:this.groupData[0].shopId,goodsNum:this.groupData[0].goodsNum,goodsThreshold:this.groupData[0].goodsThreshold,isWarn:this.groupData[0].isWarn,isLimit:Number(this.groupData[0].isLimit),limitNum:this.groupData[0].limitNum};t.push(i)}else this.groupData.forEach(function(i){var o={gid:i.gid,shopId:i.shopId,goodsNum:i.goodsNum,goodsThreshold:i.goodsThreshold,isWarn:i.isWarn,isLimit:Number(i.isLimit),limitNum:i.limitNum};t.push(o)});return t},closeSelfWin:function(t){var i=this;if("ok"!=t)this.$emit("throwInvcontrolWin","close");else{if(!this.checkForm())return;var o=this.formarData();this.InventorySet(o).then(function(t){t&&i.$emit("throwInvcontrolWin","edit",i.groupData)})}},initGroupData:function(t){if(t){if(t[0]&&t[0].gid)this.groupData=[],this.groupData=t,this.groupData=this.groupData.map(function(t){return t.oldisLimit=t.isLimit?t.isLimit:"0",t.isLimit=t.isLimit?t.isLimit:"0",t.limitNum=parseInt(t.limitNum),0==t.goodsNum&&(t.goodsNum=""),0==t.goodsThreshold&&(t.goodsThreshold=""),t});else{this.groupData=[];this.groupData.push({goodsNum:"",goodsThreshold:"",isLimit:"0",limitNum:"",oldisLimit:"0"})}var i=JSON.stringify(this.groupData);this.copyData=JSON.parse(i)}},initData:function(){var t=s.a.session("userShop");this.shopId=t.currentShop.id,this.gid=this.pObj.good.id,this.good=this.pObj.good},InventoryGet:function(){var t=this;return n(regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.a.InventoryGet({data:{shopId:t.shopId,gid:t.good.id}});case 2:return o=i.sent,i.abrupt("return",o);case 4:case"end":return i.stop()}},i,t)}))()},InventorySet:function(t){var i=this;return n(regeneratorRuntime.mark(function o(){var e;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,a.a.InventorySet({data:{inventoryData:JSON.stringify(t),shopId:i.shopId,id:i.gid}});case 2:return e=o.sent,o.abrupt("return",e);case 4:case"end":return o.stop()}},o,i)}))()}},mounted:function(){var t=this;this.initData(),this.InventoryGet().then(function(i){t.initGroupData(i)}),0==this.good.isGroup?this.winWidth=500:this.winWidth=800},components:{win:function(){return o.e("win").then(o.bind(null,"f60a"))},onOff:function(){return o.e("on_off").then(o.bind(null,"034b"))}},filters:{hide:function(t){var i=t+"";return i.length<6?i:i.slice(0,6)+"..."}}},u=(o("c4b6"),o("6ceb")),m=Object(u.a)(r,e,[],!1,null,"3fd13ca5",null);m.options.__file="src\\module\\goods_config\\invcontrol\\invcontrol_set_win.vue";i.default=m.exports},a56b:function(t,i,o){},c4b6:function(t,i,o){"use strict";var e=o("a56b");o.n(e).a}}]);