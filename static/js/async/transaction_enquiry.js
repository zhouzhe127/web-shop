(window.webpackJsonp=window.webpackJsonp||[]).push([["transaction_enquiry"],{"699e":function(t,e,n){"use strict";var i=n("b08d");n.n(i).a},b08d:function(t,e,n){},e85b:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"transaction-enquiry"}},["all"==t.isShow?n("section",[n("div",{staticClass:"content"},[n("div",{staticClass:"date"},[n("section",{staticClass:"fl"},[n("section",[n("calendar",{ref:"triggerStartTime",attrs:{pObj:{time:t.startTime}},on:{throwTime:t.getStartTime}})],1)]),t._v(" "),n("span",{staticClass:"data-center"},[t._v("至")]),t._v(" "),n("section",{staticClass:"fl"},[n("section",[n("calendar",{ref:"triggerEndTime",attrs:{pObj:{time:t.endTime}},on:{throwTime:t.getEndTime}})],1)]),t._v(" "),n("span",{staticClass:"order-order-searchA"},[n("span",{staticClass:"order-order-search",on:{click:function(e){t.screeningBtn()}}})])]),t._v(" "),n("div",{staticClass:"choise",staticStyle:{float:"left"}},[n("section",{staticClass:"statisticsLists"},[n("section",{staticClass:"tableListInp chairFix",on:{click:function(e){t.showhighList(1,e)}}},[n("span",{staticClass:"spanSty"},[t._v(t._s(t.belongshigh))]),t._v(" "),t._m(0)]),t._v(" "),t.belongsLimit?n("ul",{staticClass:"tableListUl"},t._l(t.belongsList,function(e,i){return n("li",{key:i,on:{click:function(e){t.costhighShow(i,1,e)}}},[t._v(t._s(e.name))])})):t._e()]),t._v(" "),n("section",{staticClass:"statisticsLists"},[n("section",{staticClass:"tableListInp chairFix",on:{click:function(e){t.showhighList(2,e)}}},[n("span",{staticClass:"spanSty"},[t._v(t._s(t.storeshigh))]),t._v(" "),t._m(1)]),t._v(" "),t.storesLimit?n("ul",{staticClass:"tableListUl"},t._l(t.storesList,function(e,i){return n("li",{key:i,on:{click:function(e){t.costhighShow(i,2,e)}}},[t._v(t._s(e.name))])})):t._e()]),t._v(" "),n("section",{staticClass:"statisticsLists"},[n("section",{staticClass:"tableListInp chairFix",on:{click:function(e){t.showhighList(3,e)}}},[n("span",{staticClass:"spanSty"},[t._v(t._s(t.trantypehigh))]),t._v(" "),t._m(2)]),t._v(" "),t.trantypeLimit?n("ul",{staticClass:"tableListUl"},t._l(t.trantypeList,function(e,i){return n("li",{key:i,on:{click:function(e){t.costhighShow(i,3,e)}}},[t._v(t._s(e.name))])})):t._e()])]),t._v(" "),n("a",{staticStyle:{background:"#2EA8DC"},attrs:{href:"javascript:;"},on:{click:function(e){t.screeningBtn()}}},[t._v("筛选")]),t._v(" "),n("a",{staticStyle:{background:"#B3B3B3"},attrs:{href:"javascript:;"},on:{click:function(e){t.filterReset()}}},[t._v("重置")])]),t._v(" "),n("div",{staticStyle:{clear:"both",height:"20px"}}),t._v(" "),n("comTable",{attrs:{listName:"交易列表",titleData:t.titleData,introData:t.consumeList,allTotal:t.count,bannerStyle:t.bannerStyle,contentStyle:t.contentStyle,titleHeight:50,listHeight:50,listWidth:1300,fixed:0},scopedSlots:t._u([{key:"con-0",fn:function(e){return n("span",{on:{click:function(n){t.openDetail(e.data)}}},[t._v("\n\t\t\t\t"+t._s(e.data.cardNumber))])}},{key:"con-2",fn:function(e){return n("span",{},[t._v(t._s(t.formatTime(e.data.createTime,"yyyy-MM-dd hh:mm")))])}},{key:"con-3",fn:function(e){return n("span",{on:{click:function(n){t.openOid(e.data.oid,e.data.belongToShop,e.data.fromId)}}},[t._v("\n\t\t\t\t"+t._s(""==e.data.oid||"0"==e.data.oid?"--":e.data.oid))])}},{key:"con-4",fn:function(e){return n("span",{},[t._v(t._s(t.getshopName(e.data.belongToShop)))])}},{key:"con-5",fn:function(e){return n("span",{},[t._v(t._s(t.getconsumeName(e.data.type)))])}},{key:"con-6",fn:function(e){return n("span",{},[t._v(t._s("4"==e.data.type||"9"==e.data.type?e.data.operatePoint:e.data.operateAmount))])}},{key:"con-7",fn:function(e){return n("span",{},[t._v(t._s("4"==e.data.type||"9"==e.data.type?e.data.point:e.data.amount))])}},{key:"con-8",fn:function(e){return n("span",{},[t._v(t._s(t.getPaytype(e.data)))])}},{key:"con-9",fn:function(e){return n("span",{},[t._v(t._s(t.isBrand?t.getshopName(e.data.fromId):t.getshopName(e.data.shopId)))])}}])}),t._v(" "),n("section",{staticClass:"turn-page"},[n("pageElement",{attrs:{page:Number(t.page),total:Number(t.TotalPage),numArr:[10,20,30,40,50],isNoJump:!0},on:{pageNum:t.getPageNum}})],1)],1):t._e(),t._v(" "),"order"==t.isShow?n("orderDetail",{attrs:{detail:t.detail,isDelete:!1},on:{detailShow:t.getDetailShow}}):t._e(),t._v(" "),"detail"==t.isShow?n("cardDetail",{attrs:{cardNumber:t.cardNumber},on:{throwWinResult:t.getDetail}}):t._e()],1)};i._withStripped=!0;var s=n("81a2"),a=n("f6ce"),r=n("bbb9");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(s,a){try{var r=e[s](a),o=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var c={data:function(){return{isShow:"all",detail:null,userData:Object,isBrand:!1,belongsList:[],storesList:[],shopList:[],startTime:(new Date).setHours(0,0,0,0),endTime:(new Date).setHours(23,59,59,999),belongsId:"",storesId:"",belongsLimit:!1,storesLimit:!1,belongshigh:"选择卡属门店",storeshigh:"选择操作门店",trantypeList:[{name:"全部",id:0},{name:"消费",id:1},{name:"储值",id:2},{name:"卡激活",id:15},{name:"积分消费",id:9},{name:"积分奖励",id:4}],trantypeId:"",trantypeLimit:!1,trantypehigh:"全部",consumeList:[],page:1,num:10,TotalPage:"",count:"0",titleData:[],bannerStyle:null,contentStyle:null,cardNumber:""}},created:function(){this.titleData=[{titleName:"卡号",titleStyle:{width:"170px",fontSize:"16px",flex:"none"},conStyle:{color:"#00AAE5",cursor:"pointer"},dataName:"cardNumber"},{titleName:"卡类型",dataName:"cardTypeName",titleStyle:{fontSize:"16px"}},{titleName:"交易时间",titleStyle:{width:"150px",fontSize:"16px",flex:"none"}},{titleName:"订单",titleStyle:{width:"180px",fontSize:"16px",flex:"none"},conStyle:{color:"#00AAE5",cursor:"pointer"}},{titleName:"卡属门店",titleStyle:{fontSize:"16px"}},{titleName:"交易类型",titleStyle:{fontSize:"16px"}},{titleName:"交易金额",titleStyle:{fontSize:"16px"}},{titleName:"余额",dataName:"amount",titleStyle:{fontSize:"16px"}},{titleName:"支付类型",titleStyle:{fontSize:"16px"}},{titleName:"操作来源",titleStyle:{fontSize:"16px"}}],this.bannerStyle={backgroundColor:"#F2F2F2",color:"#434149",fontSize:"16px"},this.contentStyle={color:"#666",fontSize:"14px"}},mounted:function(){var t=this;this.$store.commit("setPageTools",[{name:"导出",className:["fd-blue"],fn:function(){t.export()}}]),this.userData=a.a.session("userShop"),this.userData.currentShop&&3==this.userData.currentShop.ischain?this.isBrand=!0:this.isBrand=!1;var e=[],n=[],i=[];if(this.isBrand)for(var s in i=a.a.session("shopList")){var r={name:i[s].shopNumber+"-"+i[s].shopName,id:i[s].id},o={name:i[s].shopName,id:i[s].id};n.push(r),e.push(o)}else{i.push(this.userData.currentShop);var c={name:this.userData.currentShop.shopNumber+"-"+this.userData.currentShop.name,id:this.userData.currentShop.id},u={name:this.userData.currentShop.name,id:this.userData.currentShop.id};n.push(c),e.push(u)}this.belongsList=e,this.storesList=e,this.shopList=i,this.getCardConsumeList(),document.onclick=function(){t.belongsLimit=!1,t.storesLimit=!1,t.trantypeLimit=!1}},destroyed:function(){a.a.session("orderDetial",null)},methods:{getStartTime:function(t){this.startTime=new Date(t).getTime()},getEndTime:function(t){this.endTime=new Date(t).getTime()},getDetailShow:function(){this.isShow="all"},showhighList:function(t,e){switch(t){case 1:e.stopPropagation(),this.belongsLimit=!this.belongsLimit;break;case 2:e.stopPropagation(),this.storesLimit=!this.storesLimit;break;case 3:e.stopPropagation(),this.trantypeLimit=!this.trantypeLimit}},costhighShow:function(t,e,n){switch(e){case 1:n.stopPropagation(),console.log(this.belongsList),this.belongshigh=this.belongsList[t].name,this.belongsId=this.belongsList[t].id,this.belongsLimit=!1;break;case 2:n.stopPropagation(),this.storeshigh=this.storesList[t].name,this.storesId=this.storesList[t].id,this.storesLimit=!1;break;case 3:n.stopPropagation(),this.trantypehigh=this.trantypeList[t].name,this.trantypeId=this.trantypeList[t].id,this.trantypeLimit=!1}},getCardConsumeList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.startTime>t.endTime)){e.next=3;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请选择正确的时间进行筛选"}),e.abrupt("return",!1);case 3:if(""!=String(t.storesType)){e.next=6;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请选择卡属门店"}),e.abrupt("return",!1);case 6:if(""!=String(t.operatingType)){e.next=9;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请选择操作门店"}),e.abrupt("return",!1);case 9:return e.next=11,s.a.getCardConsumeList({data:{startTime:parseInt(t.startTime/1e3),endTime:parseInt(t.endTime/1e3),page:t.page,num:t.num,fromId:t.storesId,belongToShop:t.belongsId,memberCardId:0,consumeType:t.trantypeId}});case 11:(n=e.sent)&&(t.consumeList=n.consumeList,1==t.page&&n.total&&(t.TotalPage=n.total),1==t.page&&n.count&&(t.count=n.count),0==t.consumeList.length&&(t.count=0));case 13:case"end":return e.stop()}},e,t)}))()},screeningBtn:function(){this.TotalPage="",this.page=1,this.getCardConsumeList()},getconsumeName:function(t){switch(Number(t)){case 1:return"消费";case 2:return"储值";case 3:return"积分兑换";case 15:return"卡激活";case 9:return"积分消费";case 4:return"积分奖励";case 5:return"裂变获得积分";case 6:return"微信消费";case 10:return"积分增加";case 11:return"积分减少";case 12:return"余额增加";case 13:return"余额减少";case 14:return"退款失败";default:return"全部"}},getPaytype:function(t){if("3"==t.type||"4"==t.type||"9"==t.type||"10"==t.type||"11"==t.type||"12"==t.type||"13"==t.type||"14"==t.type)return"--";if("1"==t.type){if("0"==t.memberType)return"会员卡支付";if("1"==t.type)return"卡支付"}else{if("1"==t.payType)return"现金";if("2"==t.payType)return"银行卡";if("3"==t.payType)return"微信";if("4"==t.payType)return"支付宝";if("6"==t.payType)return"中信微信";if("7"==t.payType)return"中信支付宝";if("6"==t.payType)return"卡支付"}},formatTime:function(t,e){return r.a.format(new Date(1e3*Number(t)),e)},getshopId:function(t,e){var n="";if(""==String(t))return"";for(var i=0;i<this.shopList.length;i++)e[Number(t)]==this.shopList[i].name&&(n=this.shopList[i].id);return n},getshopName:function(t){for(var e=void 0,n=0;n<this.shopList.length;n++)t==this.shopList[n].id&&(e=this.isBrand?this.shopList[n].shopName:this.shopList[n].name);return e},filterReset:function(){this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).setHours(23,59,59,999),this.page=1,this.belongshigh="选择卡属门店",this.belongsId="",this.storeshigh="选择操作门店",this.trantypehigh="全部",this.trantypeId="",this.screeningBtn()},openOid:function(t,e,n){var i=this;return o(regeneratorRuntime.mark(function a(){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(""!=t&&"0"!=t){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,s.a.OrderstatisticsBillDelite({data:{shopId:1==i.isBrand?n:e,oid:t}});case 4:(r=a.sent)&&(r.oidDetial="enquiry",i.detail=r,i.isBrand&&(i.detail.fromId=n)),i.isShow="order";case 7:case"end":return a.stop()}},a,i)}))()},getPageNum:function(t){this.page=t.page,this.num=t.num,this.getCardConsumeList()},export:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.exportCardConsumeList({data:{startTime:parseInt(t.startTime/1e3),endTime:parseInt(t.endTime/1e3),page:t.page,num:t.num,fromId:t.storesId,belongToShop:t.belongsId,memberCardId:0,consumeType:t.trantypeId,export:1}});case 2:case"end":return e.stop()}},e,t)}))()},openDetail:function(t){this.cardNumber=t.cardNumber,this.isShow="detail"},getDetail:function(){var t=this;this.isShow="all",this.$store.commit("setPageTools",[{name:"导出",className:["fd-blue"],fn:function(){t.export()}}])}},components:{orderDetail:function(){return n.e("delete_detail").then(n.bind(null,"603c"))},calendar:function(){return n.e("calendar_result").then(n.bind(null,"9265"))},pageElement:function(){return n.e("page_element").then(n.bind(null,"5921"))},comTable:function(){return n.e("table").then(n.bind(null,"4360"))},cardDetail:function(){return n.e("card_queries_detail").then(n.bind(null,"1a010"))}}},u=(n("699e"),n("7610")),l=Object(u.a)(c,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fl calendar-ctr"},[e("i")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fl calendar-ctr"},[e("i")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fl calendar-ctr"},[e("i")])}],!1,null,"662c9b10",null);l.options.__file="src\\module\\member_system\\transaction_enquiry.vue";e.default=l.exports}}]);