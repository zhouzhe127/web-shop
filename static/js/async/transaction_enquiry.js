(window.webpackJsonp=window.webpackJsonp||[]).push([["transaction_enquiry"],{"40a7":function(e,t,n){},"99d3":function(e,t,n){"use strict";var r=n("40a7");n.n(r).a},aed6:function(e,t,n){"use strict";n.r(t);var r=n("81a2"),a=n("f6ce"),s=n("bbb9");function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,s){try{var i=t[a](s),o=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(o).then(function(e){r("next",e)},function(e){r("throw",e)});e(o)}("next")})}}var o={data:function(){return{isShow:"all",detail:null,userData:Object,isBrand:!1,belongsList:[],storesList:[],shopList:[],valueTime:[(new Date).setHours(0,0,0,0),(new Date).setHours(23,59,59,999)],belongsId:[],storesId:[],trantypeList:[{name:"全部",id:0},{name:"消费",id:1},{name:"储值",id:2},{name:"卡激活",id:15},{name:"积分消费",id:9},{name:"积分奖励",id:4}],trantypeId:"",trantypeLimit:!1,trantypehigh:"全部",consumeList:[],page:1,num:10,TotalPage:1,count:0,titleData:[],bannerStyle:null,contentStyle:null,cardNumber:"",cardTypeselect:"电子卡",cardTypeList:[{name:"电子卡",id:0},{name:"实体卡",id:1}],cardTypeId:0,mid:"",shopsId:"",constructionshopId:""}},mounted:function(){var e=this;this.$store.commit("setPageTools",[{name:"导出",className:["fd-blue"],fn:function(){e.export()}}]),this.userData=a.a.session("userShop"),this.userData.currentShop&&3==this.userData.currentShop.ischain?this.isBrand=!0:(this.isBrand=!1,this.constructionshopId=this.userData.currentShop.id);var t=[],n=[],r=[];if(this.isBrand)for(var s in r=a.a.session("shopList")){var i={name:r[s].shopNumber+"-"+r[s].shopName,id:r[s].id},o={name:r[s].shopName,id:r[s].id};n.push(i),t.push(o)}else{r.push(this.userData.currentShop);var u={name:this.userData.currentShop.shopNumber+"-"+this.userData.currentShop.name,id:this.userData.currentShop.id},c={name:this.userData.currentShop.name,id:this.userData.currentShop.id};n.push(u),t.push(c)}this.belongsList=t,this.storesList=t,this.shopList=r,this.isBrand||this.getCardConsumeList(),document.onclick=function(){e.belongsLimit=!1,e.storesLimit=!1,e.trantypeLimit=!1}},destroyed:function(){a.a.session("orderDetial",null)},methods:{getStartTime:function(e){this.startTime=new Date(e).getTime()},getEndTime:function(e){this.endTime=new Date(e).getTime()},getDetailShow:function(){this.isShow="all"},showhighList:function(e,t){switch(e){case 1:t.stopPropagation(),this.belongsLimit=!this.belongsLimit;break;case 2:t.stopPropagation(),this.storesLimit=!this.storesLimit;break;case 3:t.stopPropagation(),this.trantypeLimit=!this.trantypeLimit}},checkForm:function(){return 0==this.storesId.length&&this.isBrand?(this.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请选择操作门店"}),!1):0!=this.belongsId.length||1!=this.cardTypeId||!this.isBrand||(this.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"请选择卡属门店"}),!1)},getCardConsumeList:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.checkForm()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,r.a.getCardConsumeList({data:{startTime:parseInt(e.valueTime[0]/1e3),endTime:parseInt(e.valueTime[1]/1e3),page:e.page,num:e.num,fromId:e.isBrand?e.storesId.join(","):e.constructionshopId,belongToShop:e.isBrand?e.belongsId.join(","):"",memberCardId:0,consumeType:e.trantypeId,memberType:e.cardTypeId}});case 4:(n=t.sent)&&(e.consumeList=n.consumeList,1==e.page&&n.total&&(e.TotalPage=n.total),1==e.page&&n.count&&(e.count=n.count),0==e.consumeList.length&&(e.count=0));case 6:case"end":return t.stop()}},t,e)}))()},screeningBtn:function(){this.TotalPage=1,this.page=1,this.getCardConsumeList()},getconsumeName:function(e){switch(Number(e)){case 1:return"消费";case 2:return"储值";case 3:return"积分兑换";case 15:return"卡激活";case 9:return"积分消费";case 4:return"积分奖励";case 5:return"裂变获得积分";case 6:return"微信消费";case 10:return"积分增加";case 11:return"积分减少";case 12:return"余额增加";case 13:return"余额减少";case 14:return"退款失败";default:return"全部"}},getPaytype:function(e){if("3"==e.type||"4"==e.type||"9"==e.type||"10"==e.type||"11"==e.type||"12"==e.type||"13"==e.type||"14"==e.type)return"--";if("1"==e.type){if("0"==e.memberType)return"会员卡支付";if("1"==e.type)return"卡支付"}else{if("1"==e.payType)return"现金";if("2"==e.payType)return"银行卡";if("3"==e.payType)return"微信";if("4"==e.payType)return"支付宝";if("6"==e.payType)return"中信微信";if("7"==e.payType)return"中信支付宝";if("6"==e.payType)return"卡支付"}},formatTime:function(e,t){return s.a.format(new Date(1e3*Number(e)),t)},getshopId:function(e,t){var n="";if(""==String(e))return"";for(var r=0;r<this.shopList.length;r++)t[Number(e)]==this.shopList[r].name&&(n=this.shopList[r].id);return n},getshopName:function(e){for(var t="--",n=0;n<this.shopList.length;n++)e==this.shopList[n].id&&(t=this.isBrand?this.shopList[n].shopName:this.shopList[n].name);return t},filterReset:function(){this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).setHours(23,59,59,999),this.page=1,this.belongshigh="选择卡属门店",this.belongsId="",this.storeshigh="选择操作门店",this.trantypehigh="全部",this.trantypeId="",this.screeningBtn()},openOid:function(e,t,n){var a=this;return i(regeneratorRuntime.mark(function s(){var i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(""!=e&&"0"!=e){s.next=2;break}return s.abrupt("return");case 2:if(""!=t&&0!=t){s.next=5;break}return a.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"快捷支付暂无法查看订单详情"}),s.abrupt("return",!1);case 5:return s.next=7,r.a.OrderstatisticsBillDelite({data:{shopId:1==a.isBrand?n:t,oid:e}});case 7:(i=s.sent)&&(i.oidDetial="enquiry",a.detail=i,a.isBrand&&(a.detail.fromId=n)),a.isShow="order";case 10:case"end":return s.stop()}},s,a)}))()},getPageNum:function(e){this.page=e.page,this.num=e.num,this.getCardConsumeList()},export:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.exportCardConsumeList({data:{startTime:parseInt(e.valueTime[0]/1e3),endTime:parseInt(e.valueTime[1]/1e3),page:e.page,num:e.num,fromId:e.isBrand?e.storesId.join(","):e.constructionshopId,belongToShop:e.isBrand?e.belongsId.join(","):"",memberCardId:0,consumeType:e.trantypeId,memberType:e.cardTypeId,export:1}});case 2:case"end":return t.stop()}},t,e)}))()},openDetail:function(e){""==e.cardNumber?(this.isShow="member",this.mid=e.memberId,this.shopsId=e.shopId):(this.cardNumber=e.cardNumber,this.isShow="detail")},getDetail:function(){var e=this;this.isShow="all",this.$store.commit("setPageTools",[{name:"导出",className:["fd-blue"],fn:function(){e.export()}}])},backShopId:function(e){this.belongsId=e},backstoresId:function(e){this.storesId=e},selData:function(e){this.trantypeId=e},selcardType:function(e){this.page=1,this.cardTypeId=e.id,this.count=0,this.TotalPage=1,this.consumeList=[],this.getCardConsumeList()},handleSizeChange:function(e){this.num=e,this.getCardConsumeList()},pageChange:function(e){this.page=e,this.getCardConsumeList()},judgeTypes:function(e){return"3"==e.type||"4"==e.type||"5"==e.type||"8"==e.type||"9"==e.type||"10"==e.type||"11"==e.type?e.operatePoint:"1"==e.type||"6"==e.type?Number(e.operateAmount)+Number(e.operateGiftAmount):"2"==e.type?(parseInt(100*Number(e.operateGiftAmount))+parseInt(100*Number(e.rechargeAmount)))/100:(parseInt(100*Number(e.operateGiftAmount))+parseInt(100*Number(e.operateGiftAmount)))/100}},components:{orderDetail:function(){return n.e("delete_detail").then(n.bind(null,"603c"))},calendar:function(){return n.e("calendar_result").then(n.bind(null,"9265"))},pageElement:function(){return n.e("page_element").then(n.bind(null,"5921"))},comTable:function(){return n.e("table").then(n.bind(null,"4360"))},cardDetail:function(){return n.e("card_queries_detail").then(n.bind(null,"1a010"))},selectStore:function(){return n.e("transaction_shop").then(n.bind(null,"7f1e"))},memberDetail:function(){return n.e("member_manage_detail").then(n.bind(null,"7321"))}}},u=(n("99d3"),n("d801")),c=Object(u.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"transaction-enquiry"}},["all"==e.isShow?n("section",[n("div",{staticClass:"date"},[n("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp",clearable:!1},model:{value:e.valueTime,callback:function(t){e.valueTime=t},expression:"valueTime"}})],1),e._v(" "),n("div",{staticClass:"date"},[1==e.cardTypeId&&e.isBrand?n("div",{staticClass:"dateBox fl"},[n("selectStore",{attrs:{showName:"请选择卡属门店",shopIds:e.belongsId},on:{chooseShop:e.backShopId}})],1):e._e(),e._v(" "),e.isBrand?n("div",{staticClass:"dateBox fl"},[n("selectStore",{attrs:{showName:"请选择操作门店",shopIds:e.storesId},on:{chooseShop:e.backstoresId}})],1):e._e(),e._v(" "),n("div",{staticClass:"dateBox fl"},[n("el-select",{staticStyle:{color:"#c0c4cc"},attrs:{placeholder:"请选择"},on:{change:e.selData},model:{value:e.trantypehigh,callback:function(t){e.trantypehigh=t},expression:"trantypehigh"}},e._l(e.trantypeList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),n("div",{staticClass:"dateBox fl"},[n("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:e.screeningBtn}},[e._v("筛选")]),e._v(" "),n("el-button",{staticStyle:{width:"120px"},attrs:{type:"info"},on:{click:e.filterReset}},[e._v("重置")])],1)]),e._v(" "),n("div",{staticClass:"date"},[n("el-radio-group",{model:{value:e.cardTypeselect,callback:function(t){e.cardTypeselect=t},expression:"cardTypeselect"}},e._l(e.cardTypeList,function(t,r){return n("el-radio-button",{key:r,attrs:{label:t.name},nativeOn:{change:function(n){e.selcardType(t)}}})}))],1),e._v(" "),n("div",{staticClass:"list"},[n("div",{staticClass:"list_title"},[n("div",{staticClass:"list_title_l fl"},[n("span",[e._v("交易列表")]),e._v(" "),n("span"),e._v(" "),n("span",[e._v("共\n\t\t\t\t\t\t\t"),n("a",{attrs:{href:"javascript:;"}},[e._v(e._s(e.count))]),e._v("条记录")])]),e._v(" "),n("div",{staticClass:"list_title_r fr"})]),e._v(" "),n("el-table",{staticStyle:{width:"1400px","margin-bottom":"20px"},attrs:{data:e.consumeList,border:"",stripe:!0,"header-cell-style":{"background-color":"#f5f7fa"}}},[n("el-table-column",{attrs:{fixed:"",prop:"cardNumber",label:"卡号",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==e.cardTypeId?n("span",{staticStyle:{color:"#E1BB4A"},on:{click:function(n){e.openDetail(t.row)}}},[e._v(e._s(t.row.mobile))]):n("span",{staticStyle:{color:"#E1BB4A"},on:{click:function(n){e.openDetail(t.row)}}},[e._v(e._s(t.row.cardNumber))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"cardTypeName",label:"卡类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==e.cardTypeId?n("span",[e._v("电子卡")]):n("span",[e._v(e._s(t.row.cardTypeName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"createTime",label:"交易时间",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formatTime(t.row.createTime,"yyyy-MM-dd hh:mm")))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"oid",label:"订单",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticStyle:{color:"#E1BB4A"},on:{click:function(n){e.openOid(t.row.oid,t.row.belongToShop,t.row.fromId)}}},[e._v(e._s(""==t.row.oid||"0"==t.row.oid?"--":t.row.oid))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"卡属门店",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.getshopName(t.row.belongToShop)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"receiveNum",label:"交易类型",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.getconsumeName(t.row.type)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"receiveNum",label:"交易金额",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.judgeTypes(t.row)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"receiveNum",label:"余额",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s("4"==t.row.type||"9"==t.row.type?t.row.point:t.row.amount))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"receiveNum",label:"支付类型",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.getPaytype(t.row)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"receiveNum",label:"操作来源",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.isBrand?e.getshopName(t.row.fromId):e.getshopName(t.row.shopId)))])]}}])})],1)],1),e._v(" "),n("section",{staticClass:"turn-page"},[n("div",{staticClass:"pageWrap"},[n("el-pagination",{attrs:{background:"","current-page":e.page,"page-size":e.num,layout:"sizes, prev, pager, next","page-count":e.TotalPage,"page-sizes":[10,20,30]},on:{"size-change":e.handleSizeChange,"current-change":e.pageChange}})],1)])]):e._e(),e._v(" "),"order"==e.isShow?n("orderDetail",{attrs:{detail:e.detail,isDelete:!1},on:{detailShow:e.getDetailShow}}):e._e(),e._v(" "),"detail"==e.isShow?n("cardDetail",{attrs:{cardNumber:e.cardNumber},on:{throwWinResult:e.getDetail}}):e._e(),e._v(" "),"member"==e.isShow?n("memberDetail",{attrs:{mid:e.mid,shopsId:e.shopsId},on:{throwWinResult:e.getDetail}}):e._e()],1)},[],!1,null,"735aa8f8",null);t.default=c.exports}}]);