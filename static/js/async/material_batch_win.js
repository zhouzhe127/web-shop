(window.webpackJsonp=window.webpackJsonp||[]).push([["material_batch_win"],{"12ae":function(t,e,i){"use strict";var a=i("fa10");i.n(a).a},1859:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("win",{attrs:{align:"center",width:1024,height:"auto",ok:t.btnOk},on:{winEvent:t.closeSelfWin}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{attrs:{slot:"content",id:"select-batch"},slot:"content"},[i("div",{staticClass:"batch-title"},[i("li",[i("em",[t._v("物料名称：")]),t._v(t._s(t.detail.name))]),t._v(" "),i("li",[i("em",[t._v("物料单位：")]),t._v(t._s(t.detail.unitWord))]),t._v(" "),i("li",[i("em",[t._v("默认单位：")]),t._v(t._s(t.detail.defaultUnit))])]),t._v(" "),i("div",{staticClass:"batch-title"},[i("li",{staticClass:"mid"},[i("em",[t._v("保质期：")]),t._v(t._s(t.detail.validity)+t._s(t.validityHash[t.detail.validityType]))]),t._v(" "),i("li",{staticClass:"narrow"},[i("em",[t._v("分类：")]),t._v(t._s(t.detail.cateWord))]),t._v(" "),i("li",[i("em",[t._v("最小单位：")]),t._v(t._s(t.detail.minUnit))])]),t._v(" "),i("div",{staticClass:"filter"},[i("div",{staticClass:"inline-box"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.batchCode,expression:"batchCode"}],attrs:{type:"text",placeholder:"请输入批次编号"},domProps:{value:t.batchCode},on:{input:function(e){e.target.composing||(t.batchCode=e.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.supplier,expression:"supplier"}],attrs:{type:"text",placeholder:"请输入供应商"},domProps:{value:t.supplier},on:{input:function(e){e.target.composing||(t.supplier=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"inline-box"},[i("calendar",{attrs:{time:t.startTime,format:t.timeFormat,tips:t.startTips},on:{emit:t.startTimeChange}})],1),t._v(" "),i("div",{staticClass:"inline-box"},[i("calendar",{attrs:{time:t.endTime,format:t.timeFormat,tips:t.endTips},on:{emit:t.endTimeChange}})],1),t._v(" "),i("div",{staticClass:"inline-box"},[i("div",{staticClass:"button-box"},[i("span",{staticClass:"blue",on:{click:t.filter}},[t._v("筛选")]),t._v(" "),i("span",{staticClass:"gray",on:{click:t.reset}},[t._v("重置")])])])]),t._v(" "),i("div",{staticClass:"table"},[i("div",{staticClass:"table-head"},[i("span",[t._v("序号")]),t._v(" "),i("span",[t._v("批次编号")]),t._v(" "),i("span",[t._v("生产日期")]),t._v(" "),i("span",[t._v("供应商")]),t._v(" "),i("span",[t._v("所属仓库")]),t._v(" "),i("span",[t._v("当前批次数量/重量")]),t._v(" "),i("span",[t._v("盘库库存量"),i("em",{on:{click:t.clearInput}},[t._v("清空输入")])])]),t._v(" "),i("div",{staticClass:"table-body"},[t._l(t.changeList,function(e,a){return i("div",{key:a,staticClass:"table-row"},[i("div",{staticClass:"cell"},[t._v(t._s(a+1))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(e.batchCode))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(t.getTime(e.productionTime)))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(e.supplier))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(e.wName||"暂无")+"-"+t._s(e.aName||"暂无"))]),t._v(" "),i("div",{staticClass:"cell"},[t._v(t._s(t.setSuprlus(e.surplus,t.listData.relation)))]),t._v(" "),i("div",{staticClass:"cell unit-box"},[t.oneName?[i("div",{staticClass:"input-box"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.oneNum,expression:"item.oneNum"}],attrs:{type:"text",maxlength:"10",placeholder:"请输入"},domProps:{value:e.oneNum},on:{input:function(i){i.target.composing||t.$set(e,"oneNum",i.target.value)}}}),t._v(" "),i("div",{staticClass:"word"},[t._v(t._s(t.oneName))])]),t._v("\n\t\t\t\t\t\t\t+\n\t\t\t\t\t\t")]:t._e(),t._v(" "),i("div",{staticClass:"input-box"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.twoNum,expression:"item.twoNum"}],attrs:{type:"text",maxlength:"10",placeholder:"请输入"},domProps:{value:e.twoNum},on:{input:function(i){i.target.composing||t.$set(e,"twoNum",i.target.value)}}}),t._v(" "),i("div",{staticClass:"word"},[t._v(t._s(t.twoName))])])],2)])}),t._v(" "),t.changeList.length?t._e():i("div",{staticClass:"empty"},[t._v("- 暂无条目 -")])],2)])])])};a._withStripped=!0;var n=i("bbb9"),r=i("81a2"),s=i("05dd");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(n,r){try{var s=e[n](r),o=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var l={data:function(){return{title:"批次选择",timeFormat:"yyyy年MM月dd日",startTips:"请选择时间",endTips:"请选择时间",detail:{},listData:{},batchCode:"",supplier:"",startTime:"",endTime:"",validityHash:{0:"月",1:"日",2:"年"},btnOk:{content:"确定",style:"background-color:#ff9200;"},btnCancel:{},cate:"",allList:[],selList:[],changeList:[],batchNum:"",unitArr:[],unitValue:"",oneName:"",twoName:"",mid:"",wid:"",areaId:"",unitId:"",isInit:!0}},props:["material","selItem"],mounted:function(){this.init(),this.getBatch(),this.getBatchList()},components:{win:function(){return i.e("win").then(i.bind(null,"f60a"))},calendar:function(){return i.e("can_multi").then(i.bind(null,"f2dd"))},selectBtn:function(){return i.e("select_btn").then(i.bind(null,"3d41"))}},methods:{init:function(){for(var t in this.material)this[t]=this.material[t]},startTimeChange:function(t){this.startTime=t,this.startTips=""},endTimeChange:function(t){this.endTime=t,this.endTips=""},clearInput:function(){var t=n.a.deepCopy(this.changeList),e=n.a.deepCopy(this.allList),i=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var l=s.value;l.oneNum="",l.twoNum="",l.totalItem=0;var u=!0,c=!1,v=void 0;try{for(var m,d=e[Symbol.iterator]();!(u=(m=d.next()).done);u=!0){var h=m.value;l.batchId==h.batchId&&(h.oneNum="",h.twoNum="",h.totalItem=0)}}catch(t){c=!0,v=t}finally{try{!u&&d.return&&d.return()}finally{if(c)throw v}}}}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}this.changeList=t,this.allList=e},setSuprlus:function(t,e){var i="",a="",n=1,r=!0,o=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var v=u.value;1==v.isMin?(a=v.name,1==v.isDefault&&(i=v.name,n=v.value)):1==v.isDefault&&(i=v.name,n=v.value)}}catch(t){o=!0,l=t}finally{try{!r&&c.return&&c.return()}finally{if(o)throw l}}return s.a.comUnit(t,n,i,a)},getBatch:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i,a,n,s,o,l,u,c,v,m,d,h,f,p,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.getMaterialDetail({data:{mid:t.mid,wid:t.wid}});case 2:for(i=e.sent,a=[],n=!0,s=!1,o=void 0,e.prev=7,l=i.unit[Symbol.iterator]();!(n=(u=l.next()).done);n=!0)c=u.value,a.push(c.name),1==c.isMin&&(i.minUnit=c.name),1==c.isDefault&&(i.defaultUnit=c.name);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),s=!0,o=e.t0;case 15:e.prev=15,e.prev=16,!n&&l.return&&l.return();case 18:if(e.prev=18,!s){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:for(i.unitWord=a.join(", "),v=[],m=!0,d=!1,h=void 0,e.prev=28,f=i.cate[Symbol.iterator]();!(m=(p=f.next()).done);m=!0)_=p.value,v.push(_.name);e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),d=!0,h=e.t1;case 36:e.prev=36,e.prev=37,!m&&f.return&&f.return();case 39:if(e.prev=39,!d){e.next=42;break}throw h;case 42:return e.finish(39);case 43:return e.finish(36);case 44:i.cateWord=v.join(", "),t.detail=i;case 46:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22],[28,32,36,44],[37,,39,43]])}))()},getBatchList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.InvoicingGetMaterialBatch({data:{mid:t.mid,wid:t.wid,areaId:t.areaId}});case 2:i=e.sent,t.listData=i,t.setListData(i);case 5:case"end":return e.stop()}},e,t)}))()},setListData:function(t){for(var e="",i="",a=1,n=0;n<t.relation.length;n++){var r=t.relation[n];1==r.isMin?i=r.name:r.muId==this.unitId&&(e=r.name,a=r.value)}var s=!0,o=!1,l=void 0;try{for(var u,c=t.list[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var v=u.value;v.oneNum="",v.twoNum=""}}catch(t){o=!0,l=t}finally{try{!s&&c.return&&c.return()}finally{if(o)throw l}}this.oneName=e,this.twoName=i,this.unitValue=a,this.allList=t.list,this.changeList=t.list,this.setDefault()},setDefault:function(){var t=!0,e=!1,i=void 0;try{for(var a,n=this.allList[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var r=a.value,o=!0,l=!1,u=void 0;try{for(var c,v=this.selItem[Symbol.iterator]();!(o=(c=v.next()).done);o=!0){var m=c.value;if(m.batchId==r.batchId){var d="",h=this.twoName;this.oneName||(d=this.twoName);var f=s.a.comUnit(m.totalItem,this.unitValue,d,h,!0);r.oneNum=f.oNull,r.twoNum=f.tNull}}}catch(t){l=!0,u=t}finally{try{!o&&v.return&&v.return()}finally{if(l)throw u}}}}catch(t){e=!0,i=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw i}}},closeSelfWin:function(t){if("ok"==t){if(!this.veriNum())return;var e=0,i=[],a=!0,n=!1,r=void 0;try{for(var s,o=this.allList[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value,u=Number(l.oneNum)*Number(this.unitValue)+Number(l.twoNum);""===l.oneNum.trim()&&""===l.twoNum.trim()||(e+=u,l.totalItem=u,i.push(l))}}catch(t){n=!0,r=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw r}}var c={list:i,allNum:e};this.$emit("emit",c)}else this.$emit("emit",!1)},veriNum:function(){var t=!0,e=!1,i=void 0;try{for(var a,n=this.allList[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var r=a.value;if(Number(r.oneNum)+Number(r.twoNum)<0)return this.myAlert("批次编号:"+r.batchCode+",盘库数量不能小于0"),!1;if(isNaN(r.oneNum)||isNaN(r.oneNum))return this.myAlert("批次编号:"+r.batchCode+",盘库数量必须为数字"),!1}}catch(t){e=!0,i=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw i}}return!0},filter:function(){this.isInit=!1;var t="",e="";if(this.isInit)t="",e="";else{var i=this.endTime?new Date(this.endTime).setHours(23,59,59,0):"";t=this.startTime,e=i}var a={batchCode:this.batchCode,supplier:this.supplier,startTime:t,endTime:e};this.condition(a)},condition:function(t){var e=n.a.deepCopy(this.allList);for(var i in t){var a=[];if(""!=t[i]){if(console.log(i,t[i]),"startTime"==i||"endTime"==i){var r=!0,s=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var c=l.value;t.startTime<=1e3*c.productionTime&&t.endTime>=1e3*c.productionTime&&a.push(c)}}catch(t){s=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(s)throw o}}}else{var v=!0,m=!1,d=void 0;try{for(var h,f=e[Symbol.iterator]();!(v=(h=f.next()).done);v=!0){var p=h.value;p[i].includes(t[i])&&a.push(p)}}catch(t){m=!0,d=t}finally{try{!v&&f.return&&f.return()}finally{if(m)throw d}}}e=a}}this.changeList=e},myAlert:function(t){this.$store.commit("setWin",{title:"操作提示",content:t})},reset:function(){this.supplier="",this.batchCode="",this.startTime="",this.endTime="",this.startTips="请选择时间",this.endTips="请选择时间",this.isInit=!0,this.changeList=this.allList},getTime:function(t){return n.a.format(1e3*parseInt(t),"yyyy年MM月dd日")}}},u=(i("12ae"),i("6ceb")),c=Object(u.a)(l,a,[],!1,null,"d1c93b62",null);c.options.__file="src\\module\\invoicing_system\\invoicing\\check_warehouse\\material_batch_win.vue";e.default=c.exports},fa10:function(t,e,i){}}]);