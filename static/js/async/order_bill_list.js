(window.webpackJsonp=window.webpackJsonp||[]).push([["order_bill_list"],{"0da2":function(e,t,i){"use strict";i.r(t);var s=i("81a2"),a=i("f6ce"),n=i("bbb9");function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function s(a,n){try{var l=t[a](n),r=l.value}catch(e){return void i(e)}if(!l.done)return Promise.resolve(r).then(function(e){s("next",e)},function(e){s("throw",e)});e(r)}("next")})}}var r={data:function(){return{orderCredit:[],startTime:(new Date).setHours(0,0,0,0),endTime:(new Date).setHours(0,0,0,0),selectedType:0,page:1,num:10,total:1,showDetails:!1,optionValue:"",totalList:{totalDay:1,orderNum:0,originalPrice:0,billPrice:0},optionsOne:[{name:"挂账时间",id:0},{name:"结算时间",id:1}],selectedTypeOne:0,optionsTwo:[{name:"全部",id:0},{name:"个人账户",id:1},{name:"企业账户",id:2}],selectedTypeTwo:0,optionsThree:[],billId:0,allBill:[],optionsFour:[{name:"订单号",id:0},{name:"挂账人名称",id:1},{name:"操作人名称",id:2}],selectedTypeFour:0,shuName:"请输入订单号",status:-1,isOpenTime:!0,userdata:{}}},props:["sId","shopName","sTime","eTime","gType","isOpen"],created:function(){var e=this;this.userdata=a.a.session("userShop"),this.shopName&&(this.startTime=this.sTime,this.endTime=this.eTime,this.selectedTypeOne=this.gType,this.isOpenTime=Boolean(this.isOpen),this.$store.commit("setPageTools",[{name:"返回",className:["export-btn"],fn:function(){var t={startTime:e.sTime,endTime:e.eTime,operateTime:e.gType};e.$emit("return",t)}}]))},destroyed:function(){this.$store.commit("setPageTools",[])},beforeMount:function(){this.billGetBillNames(),this.getOrderBillList()},methods:{renderHeader:function(e,t){var i=t.column,s="",a=i.label,n=i.property;return"消费总额"==a&&"originalPrice"==n?s="该时间段内所有商品原价的金额总计（不计入退品金额）":"挂账总额"==a&&"billPrice"==n?s="该时间段内所有订单实际需要支付的金额的总计":"消费金额"==a&&"originalPrice"==n?s="该笔订单内所有商品原价的金额总计（不计入退品金额）":"挂账金额"==a&&"billPrice"==n&&(s="该笔订单实际需要支付的金额的总计"),e("div",[e("span",{},i.label),e("el-popover",{attrs:{class:"item",effect:"dark",content:s,placement:"bottom",width:"300"}},[e("span",{class:"el-icon-question",slot:"reference",style:"font-size: 18px;margin-left:5px;"})])])},selectBusinessHours:function(){this.isOpenTime=!this.isOpenTime},getOidList:function(e){this.status=e,this.page=1,this.getOrderBillList()},filterReset:function(e){this.selectedTypeOne=0,this.selectedTypeTwo=0,this.billId=0,this.selectedTypeFour=0,this.shuName="请输入订单号",e&&(this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).setHours(23,59,59,999)),this.status=-1,this.optionValue="",this.isOpenTime=1,this.page=1,this.num=10,this.total=1,this.getOrderBillList()},selectTypeTwo:function(){this.billId=0,this.changType()},noData:function(e){e.stopPropagation(),0==this.optionsThree.length&&this.$store.commit("setWin",{title:"提示信息",content:"该分类下没有挂账账户"})},selectTypeFour:function(){switch(this.selectedTypeFour+""){case"0":this.shuName="请输入订单号";break;case"1":this.shuName="请输入挂账人名";break;case"2":this.shuName="请输入操作人名"}},billGetBillNames:function(){var e=this;return l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.billGetBillNames({data:{shopId:e.sId?e.sId:e.userdata.currentShop.id}});case 2:e.allBill=t.sent,e.changType();case 4:case"end":return t.stop()}},t,e)}))()},changType:function(){var e=[];switch(this.selectedTypeTwo+""){case"0":e=this.allBill;break;case"1":e=this.allBill.filter(function(e){return 1==e.type});break;case"2":e=this.allBill.filter(function(e){return 2==e.type})}this.optionsThree=n.a.deepCopy(e),this.optionsThree.unshift({billId:0,name:"全部"})},checkDate:function(){var e=this.startTime,t=new Date(Number(this.endTime)).setDate(1);return+e<+(t=new Date(t).setHours(0,0,0,0))?(this.$store.commit("setWin",{title:"提示信息",content:"很抱歉,选择的时间段不能跨月"}),!0):parseInt(this.startTime/1e3)>parseInt(this.endTime/1e3)?(this.$store.commit("setWin",{title:"提示信息",content:"开始时间不能大于结束时间"}),!0):void 0},getOrderBillList:function(){var e=this;return l(regeneratorRuntime.mark(function t(){var i,a,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.checkDate()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,s.a.billstatisticsGetList({data:{startTime:e.startTime/1e3,endTime:e.endTime/1e3+86400-1,page:e.page+0,num:e.num,isOpenTime:Number(e.isOpenTime),operateTime:e.selectedTypeOne,billType:e.selectedTypeTwo,billId:e.billId,isSettle:e.status,optionKey:e.selectedTypeFour+1,optionValue:e.optionValue,shopId:e.sId?e.sId:e.userdata.currentShop.id}});case 4:if(i=t.sent,e.totalList=i.total,a=i.list){t.next=9;break}return t.abrupt("return");case 9:for(l=0;l<a.length;l++)0==a[l].updateTime?a[l].updateTime="--":a[l].updateTime=n.a.format(new Date(1e3*a[l].updateTime),"yyyy-MM-dd hh:mm"),a[l].createTime=n.a.format(new Date(1e3*a[l].createTime),"yyyy-MM-dd hh:mm"),a[l].isSettle=0==a[l].isSettle?"未结清":"已结清",a[l].billType=1==a[l].billType?"个人账户":"企业账户";e.orderCredit=a,e.total=i.pageNum;case 12:case"end":return t.stop()}},t,e)}))()},selectByTime:function(){this.filterReset(!1)},handleSizeChange:function(e){this.num=e,this.page=1,this.getOrderBillList()},pageChange:function(e){this.page=e,this.getOrderBillList()},goDetails:function(e){var t=this;return l(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,s.a.OrderstatisticsBillDelite({data:{trueShopId:t.sId?t.sId:t.userdata.currentShop.id,oid:e}});case 2:(a=i.sent)&&(t.detail=a,t.showDetails=!0);case 4:case"end":return i.stop()}},i,t)}))()},getDetailShow:function(){var e=this;this.showDetails=!1,this.shopName&&this.$store.commit("setPageTools",[{name:"返回",className:["export-btn"],fn:function(){var t={startTime:e.sTime,endTime:e.eTime,operateTime:e.gType};e.$emit("return",t)}}])},transformTime:function(e){return n.a.format(new Date(Number(e)),"yyyy年MM月dd日")}},components:{orderDetail:function(){return i.e("delete_detail").then(i.bind(null,"603c"))}}},o=(i("1781"),i("d801")),c=Object(o.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{attrs:{id:"orMaRetreat"}},[i("section",{directives:[{name:"show",rawName:"v-show",value:!e.showDetails,expression:"!showDetails"}]},[e.shopName?e._e():i("section",{staticClass:"orMaRetreatTime yuChairFix"},[i("section",{staticClass:"block-div"},[i("el-select",{staticStyle:{width:"150px"},model:{value:e.selectedTypeOne,callback:function(t){e.selectedTypeOne=t},expression:"selectedTypeOne"}},e._l(e.optionsOne,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("div",{staticClass:"block-div"},[i("section",{staticClass:"fl yuChairFix"},[i("el-date-picker",{staticStyle:{width:"150px",cursor:"pointer"},attrs:{clearable:!1,type:"date",format:"yyyy-MM-dd","value-format":"timestamp"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],1),e._v(" "),i("span",{staticClass:"zhi"},[e._v("—")]),e._v(" "),i("section",{staticClass:"fl yuChairFix"},[i("el-date-picker",{staticStyle:{width:"150px",cursor:"pointer"},attrs:{clearable:!1,type:"date",format:"yyyy-MM-dd","value-format":"timestamp"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1),e._v(" "),i("span",{staticClass:"order-order-searchA",on:{click:e.selectByTime}},[i("span",{staticClass:"order-order-search"})])]),e._v(" "),i("section",{staticClass:"block-div",staticStyle:{"line-height":"46px"}},[i("div",{class:[{active:e.isOpenTime},"pickBlu"],on:{click:e.selectBusinessHours}}),e._v(" "),i("span",{staticStyle:{"font-size":"16px"}},[e._v("按营业时间")])])]),e._v(" "),e.shopName?i("section",{staticClass:"orMaRetreatTime yuChairFix"},[i("div",{staticClass:"block-div",staticStyle:{"font-size":"16px",color:"#333333"}},[e._v("\n\t\t\t\t选择店铺：\n\t\t\t\t"),i("span",[e._v(e._s(e.shopName))]),e._v(" "),i("span",{staticStyle:{margin:"0 10px"}},[e._v("|")]),e._v("\n\t\t\t\t选择时间：\n\t\t\t\t"),i("span",[e._v(e._s(e.transformTime(e.sTime))+" - "+e._s(e.transformTime(e.eTime)))])])]):e._e(),e._v(" "),i("section",{staticClass:"orMaRetreatTime yuChairFix"},[i("section",{staticClass:"block-div"},[i("el-select",{staticStyle:{width:"150px"},on:{change:e.selectTypeTwo},model:{value:e.selectedTypeTwo,callback:function(t){e.selectedTypeTwo=t},expression:"selectedTypeTwo"}},e._l(e.optionsTwo,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("section",{staticClass:"block-div",on:{click:function(t){e.noData(t)}}},[i("el-select",{staticStyle:{width:"150px"},model:{value:e.billId,callback:function(t){e.billId=t},expression:"billId"}},e._l(e.optionsThree,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.billId}})}))],1),e._v(" "),i("section",{staticClass:"block-div"},[i("el-select",{staticStyle:{width:"150px"},on:{change:e.selectTypeFour},model:{value:e.selectedTypeFour,callback:function(t){e.selectedTypeFour=t},expression:"selectedTypeFour"}},e._l(e.optionsFour,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("div",{staticClass:"block-div"},[i("el-input",{attrs:{placeholder:e.shuName,maxlength:"18"},model:{value:e.optionValue,callback:function(t){e.optionValue=t},expression:"optionValue"}})],1),e._v(" "),i("div",{staticClass:"block-div"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getOrderBillList()}}},[e._v("搜索")]),e._v(" "),i("el-button",{attrs:{type:"info"},on:{click:function(t){e.filterReset(!0)}}},[e._v("重置")])],1)]),e._v(" "),0==e.selectedTypeOne?i("section",{staticClass:"orMaRetreatTime yuChairFix"},[i("section",{staticClass:"oCont"},[i("div",{staticClass:"Box"},[i("section",{staticClass:"oDe",class:{act:-1==e.status},staticStyle:{"border-left":"none"},on:{click:function(t){e.getOidList(-1)}}},[e._v("全部\n\t\t\t\t\t")]),e._v(" "),i("section",{staticClass:"oDe",class:{act:0==e.status},on:{click:function(t){e.getOidList(0)}}},[e._v("未结算\n\t\t\t\t\t")]),e._v(" "),i("section",{staticClass:"oDe",class:{act:1==e.status},on:{click:function(t){e.getOidList(1)}}},[e._v("已结算\n\t\t\t\t\t")])])])]):e._e(),e._v(" "),i("el-table",{attrs:{stripe:"","row-style":{color:"#f8941f"},"header-cell-style":{"background-color":"#f5f7fa"},data:[e.totalList],border:""}},[i("el-table-column",{attrs:{"min-width":"120",align:"center",prop:"totalDay",label:"天数"}}),e._v(" "),i("el-table-column",{attrs:{"min-width":"120",align:"center",prop:"orderNum",label:"订单数"}}),e._v(" "),i("el-table-column",{attrs:{"min-width":"120",align:"center",prop:"originalPrice",label:"消费总额","render-header":e.renderHeader}}),e._v(" "),i("el-table-column",{attrs:{"min-width":"120",align:"center",prop:"billPrice",label:"挂账总额","render-header":e.renderHeader}}),e._v(">\n\t\t")],1),e._v(" "),i("div",{staticClass:"store-list"},[i("div",{staticClass:"length"},[e._v("\n\t\t\t\t挂账统计 · 共\n\t\t\t\t"),i("span",[e._v(" "+e._s(e.orderCredit.length)+" ")]),e._v("条记录\n\t\t\t")]),e._v(" "),i("el-table",{attrs:{stripe:"","header-cell-style":{"background-color":"#f5f7fa"},data:e.orderCredit,border:""}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"180",align:"center",label:"订单号",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"light",on:{click:function(i){e.goDetails(t.row.oid)}}},[e._v(e._s(t.row.oid))])]}}])}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"isSettle",label:"订单状态"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"billType",label:"挂账类型"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"billName",label:"挂账账户"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"personName",label:"挂账人"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"createName",label:"操作人"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"originalPrice",label:"消费金额","render-header":e.renderHeader}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"createTime",label:"挂账时间"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"updateTime",label:"结算时间"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"100",align:"center",prop:"billPrice",label:"挂账金额","render-header":e.renderHeader}})],1)],1),e._v(" "),i("el-pagination",{attrs:{background:"","current-page":e.page,"page-size":e.num,"page-count":e.total,layout:"sizes, prev, pager, next","page-sizes":[10,20,30]},on:{"size-change":e.handleSizeChange,"current-change":e.pageChange}})],1),e._v(" "),e.showDetails?i("div",[i("orderDetail",{attrs:{detail:e.detail,isDelete:!1},on:{detailShow:e.getDetailShow}})],1):e._e()])},[],!1,null,"4acd0482",null);t.default=c.exports},1781:function(e,t,i){"use strict";var s=i("a01f");i.n(s).a},a01f:function(e,t,i){}}]);