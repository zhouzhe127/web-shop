(window.webpackJsonp=window.webpackJsonp||[]).push([["service_fee"],{f59a:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("el-form",{attrs:{"label-width":"130px"}},[n("el-form-item",{attrs:{label:"开启服务费"}},[n("el-switch",{attrs:{"active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:e.on,callback:function(t){e.on=t},expression:"on"}})],1),e._v(" "),n("el-form-item",{attrs:{required:"",label:"服务费使用规范"}},[n("el-radio-group",{model:{value:e.rule,callback:function(t){e.rule=t},expression:"rule"}},e._l(e.list,function(t){return n("el-radio",{key:t.id,attrs:{label:t.id,border:""}},[e._v(e._s(t.name))])}))],1),e._v(" "),n("el-form-item",{attrs:{required:"",label:"服务费费率设置"}},[n("el-input",{staticStyle:{width:"120px"},attrs:{disabled:!e.on,maxlength:"5",placeholder:"输入费率"},model:{value:e.percent,callback:function(t){e.percent=t},expression:"percent"}}),e._v(" "),n("i",[e._v("%")])],1),e._v(" "),n("el-form-item",{attrs:{label:"选择服务费菜品"}},[n("span",{staticClass:"fl spanCom",staticStyle:{"margin-right":"15px"}},[e._v("已选择商品"+e._s(e.goodsLength)+"道,套餐："+e._s(e.packagesLength)+"个")]),e._v(" "),n("el-button",{staticStyle:{width:"150px"},attrs:{type:"primary"},on:{click:e.addList}},[e._v("添加关联菜品")])],1)],1),e._v(" "),n("el-button",{staticStyle:{width:"150px",height:"45px"},attrs:{type:"primary"},on:{click:e.keepOn}},[e._v("保存")]),e._v(" "),e.isGoodsShow?n("goodListWin",{attrs:{goodsIds:e.goodsIds,isGoods:!0,packages:e.packages,goInName:"isMain"},on:{goodListWin:e.doThrowWinGoods}}):e._e()],1)};r._withStripped=!0;var o=n("81a2"),s=n("f6ce");function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,s){try{var a=t[o](s),i=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}("next")})}}var i={data:function(){return{isGoodsShow:!1,on:!1,percent:"",disabled:!0,list:[{id:0,name:"打折前"},{id:1,name:"打折后"}],index:0,goodsLength:0,goodsIds:[],packages:[],packagesLength:0,userData:Object,rule:0}},mounted:function(){this.userData=s.a.session("userShop"),this.init()},methods:{init:function(){var e=this;return a(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.getServiceCharge({data:{shopId:e.userData.currentShop.id}});case 2:(n=t.sent)&&(e.packages=n.packageIds,e.goodsIds=n.goodsIds,e.goodsLength=n.goodsIds.length,e.packagesLength=n.packageIds.length,e.on=Number(n.charge.chargeStatus),e.on=Boolean(e.on),e.rule=Number(n.charge.chargeRule),e.percent=n.charge.chargePercent);case 4:case"end":return t.stop()}},t,e)}))()},addList:function(){this.isGoodsShow=!0},keepOn:function(){var e=this;return a(regeneratorRuntime.mark(function t(){var n,r,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.goodsIds?e.goodsIds.toString():"",r=e.packages?e.packages.toString():"",!e.on){t.next=16;break}if(""!=e.percent){t.next=8;break}return e.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"服务费费率不能为空或0"}),t.abrupt("return",!1);case 8:if(!isNaN(e.percent)){t.next=13;break}return e.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"服务费率只能为数字，请正确输入"}),t.abrupt("return",!1);case 13:if(!(1*e.percent>100||1*e.percent<1)){t.next=16;break}return e.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"服务费率在1-100之间，请正确输入"}),t.abrupt("return",!1);case 16:return t.next=18,o.a.setServiceCharge({data:{shopId:e.userData.currentShop.id,status:Number(e.on),rule:Number(e.rule),percent:e.percent,uid:e.userData.user.id,goodsIds:n,packageIds:r}});case 18:(s=t.sent)&&(e.list.id=s.charge.chargeRule,e.percent=s.charge.chargePercent,e.goodsIds=s.goodsIds,e.packages=s.packageIds,e.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"保存成功"}));case 20:case"end":return t.stop()}},t,e)}))()},doThrowWinGoods:function(e,t){"ok"==e&&(this.goodsIds=t.goodArr,this.packages=t.packArr,this.goodsLength=this.goodsIds.length,this.packagesLength=this.packages.length),this.isGoodsShow=!1}},components:{goodListWin:function(){return n.e("good_list_win").then(n.bind(null,"8bf4"))}}},c=n("6ceb"),u=Object(c.a)(i,r,[],!1,null,null,null);u.options.__file="src\\module\\shop_config\\service_fee.vue";t.default=u.exports}}]);