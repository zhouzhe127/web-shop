(window.webpackJsonp=window.webpackJsonp||[]).push([["payment_configuration"],{"0524":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"payment"}},[t._m(0),t._v(" "),n("div",{staticClass:"online-box clearfix"},[n("span",{staticClass:"online-sub fl required"},[t._v("支付评价功能")]),t._v(" "),n("onOff",{key:1,attrs:{status:t.paySwitch},on:{statusChange:t.openflipSwitch}})],1),t._v(" "),n("div",{staticClass:"online-box clearfix"},[n("span",{staticClass:"online-sub fl required"},[t._v("评价模式")]),t._v(" "),n("div",{staticClass:"rightHalf"},[n("singleSelect",{key:"id",attrs:{index:t.result,styles:{width:"108px",border:"1px solid #cecdcd",marginRight:"8px"},list:t.evaluationList,name:"name"},on:{selOn:t.haveIndex}}),t._v(" "),t._m(1)],1)]),t._v(" "),n("div",{staticClass:"online-box clearfix"},[n("span",{staticClass:"online-sub fl required"},[t._v("选择渠道")]),t._v(" "),n("mul-select",{attrs:{styles:{backgroundColor:"rgb(236,236,236)",marginRight:"8px"},list:t.payWays,selects:t.payType,name:"name",keys:"id",isradio:!1}})],1),t._v(" "),t._m(2),t._v(" "),t._l(t.score,function(e,i){return n("div",{key:i,staticClass:"online-box clearfix"},[n("span",{staticClass:"online-sub fl"},[t._v(t._s(e.name))]),t._v(" "),n("onOff",{key:1,attrs:{status:e.environmentSwitch,names:e.name},on:{statusChange:t.openvironmentSwitch}})],1)}),t._v(" "),t._m(3),t._v(" "),n("div",{staticClass:"online-box clearfix"},[n("span",{staticClass:"online-sub fl"},[t._v("赠送积分")]),t._v(" "),n("onOff",{key:1,attrs:{status:t.givingSwitch},on:{statusChange:t.opengivingSwitch}})],1),t._v(" "),t.givingSwitch?n("div",{staticClass:"online-box clearfix"},[n("span",{staticClass:"online-sub fl"},[t._v("提交评价后赠送")]),t._v(" "),n("div",{staticClass:"rightHalf"},[n("section",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.point,expression:"point"}],staticClass:"cumulative",attrs:{type:"text",placeholder:"请输入正整数",maxlength:"6",onkeyup:"value=value.replace(/[^\\d]/g,'')"},domProps:{value:t.point},on:{input:function(e){e.target.composing||(t.point=e.target.value)}}}),t._v(" "),n("span",[t._v("积分")])]),t._v(" "),n("a",{staticClass:"addclassify",attrs:{href:"javascript:void(0);"},on:{click:t.openCouponWin}},[t._v("添加关联优惠券")]),t._v(" "),t.couponIds.length>=1?n("span",{staticStyle:{color:"#A5A5A5"}},[t._v("已关联"+t._s(t.couponIds.length)+"张优惠券")]):t._e()])]):t._e(),t._v(" "),n("div",{staticClass:"online-box clearfix"},[n("span",{staticClass:"online-sub fl"}),t._v(" "),n("a",{staticClass:"blue fl",staticStyle:{width:"200px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.saveConfig()}}},[t._v("保存")])]),t._v(" "),t.show?n("coupon",{attrs:{couponIds:t.couponIds},on:{compareArr:t.ca,couponChange:t.couponChange,winEvent:t.winEvent}}):t._e()],2)};i._withStripped=!0;var s=n("81a2"),a=n("bbb9");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(s,a){try{var r=e[s](a),o=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var o=/^[1-9]*[1-9][0-9]*$/,c={data:function(){return{paySwitch:!1,score:[{name:"环境评分",environmentSwitch:!0},{name:"口味评分",environmentSwitch:!0},{name:"服务评分",environmentSwitch:!0},{name:"商品评分",environmentSwitch:!0},{name:"文字评分",environmentSwitch:!0}],evaluationList:[{id:1,name:"支付后跳转"},{id:2,name:"评价推送"}],result:0,givingSwitch:!1,payWays:[{id:1,name:"在线点单"},{id:2,name:"自助点单"},{id:3,name:"扫码支付"}],payType:[],point:"",show:!1,couponIds:[]}},methods:{openflipSwitch:function(t){this.paySwitch=t},openvironmentSwitch:function(t,e){var n=!0,i=!1,s=void 0;try{for(var a,r=this.score[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var o=a.value;o.name==e&&(o.environmentSwitch=t)}}catch(t){i=!0,s=t}finally{try{!n&&r.return&&r.return()}finally{if(i)throw s}}},opengivingSwitch:function(t){this.givingSwitch=t},saveConfig:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.payType.length<=0)){e.next=3;break}return t.$store.commit("setWin",{content:"请选择渠道",winType:"alert",title:"操作提示"}),e.abrupt("return",!1);case 3:if(!(t.point>1e5)){e.next=6;break}return t.$store.commit("setWin",{content:"积分为(1-100000)",winType:"alert",title:"操作提示"}),e.abrupt("return",!1);case 6:if(!t.givingSwitch||o.test(t.point)){e.next=9;break}return t.$store.commit("setWin",{content:"请填写积分(1-100000)",winType:"alert",title:"操作提示"}),e.abrupt("return",!1);case 9:for(n="",i=0;i<t.score.length;i++)1==t.score[i].environmentSwitch&&(n+=i+1+",");return n=n.substring(0,n.length-1),e.next=14,s.a.addCommentConfig({data:{status:Number(t.paySwitch),channels:String(t.payType),items:n,giftPoints:t.givingSwitch?t.point:0,jumpCode:t.result,giftCoupon:JSON.stringify(t.couponIds)}});case 14:e.sent&&(t.$store.commit("setWin",{content:"保存成功!",winType:"alert",title:"操作提示"}),t.getConfig());case 16:case"end":return e.stop()}},e,t)}))()},getConfig:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n,i,r,o,c,l,u,v,p,f,h,m,d,g,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getPayCommentConf({});case 2:if(!(n=e.sent)){e.next=56;break}for(t.paySwitch=Boolean(Number(n.status)),i=n.channels.split(","),t.payType=[],r=!0,o=!1,c=void 0,e.prev=10,l=i[Symbol.iterator]();!(r=(u=l.next()).done);r=!0)"1"!=(v=u.value)&&"2"!=v&&"3"!=v||t.payType.push(Number(v));e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),o=!0,c=e.t0;case 18:e.prev=18,e.prev=19,!r&&l.return&&l.return();case 21:if(e.prev=21,!o){e.next=24;break}throw c;case 24:return e.finish(21);case 25:return e.finish(18);case 26:t.payType=a.a.unique(t.payType),p=n.items.split(","),f=0;case 29:if(!(f<t.score.length)){e.next=53;break}for(t.score[f].environmentSwitch=!1,h=!0,m=!1,d=void 0,e.prev=34,g=p[Symbol.iterator]();!(h=(_=g.next()).done);h=!0)_.value==f+1&&(t.score[f].environmentSwitch=!0);e.next=42;break;case 38:e.prev=38,e.t1=e.catch(34),m=!0,d=e.t1;case 42:e.prev=42,e.prev=43,!h&&g.return&&g.return();case 45:if(e.prev=45,!m){e.next=48;break}throw d;case 48:return e.finish(45);case 49:return e.finish(42);case 50:f++,e.next=29;break;case 53:"0"==n.giftPoints?t.givingSwitch=!1:(t.givingSwitch=!0,t.point=n.giftPoints),t.result=Number(n.jumpCode),t.couponIds=n.giftCoupon;case 56:case"end":return e.stop()}},e,t,[[10,14,18,26],[19,,21,25],[34,38,42,50],[43,,45,49]])}))()},openCouponWin:function(){this.show=!0},ca:function(t){this.compareArr=t},couponChange:function(t){this.couponIds=t.selectList},winEvent:function(){this.show=!1},haveIndex:function(t){this.result=t}},components:{onOff:function(){return n.e("on_off").then(n.bind(null,"034b"))},"mul-select":function(){return n.e("mul_select").then(n.bind(null,"7d09"))},coupon:function(){return n.e("member_store_coupon").then(n.bind(null,"b9aa"))},singleSelect:function(){return n.e("mul_select").then(n.bind(null,"7231"))}},mounted:function(){this.getConfig()}},l=(n("ac11"),n("6ceb")),u=Object(l.a)(c,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"titles"},[this._v("支付评价功能")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"handle-tips"},[e("i"),this._v(" 评价推送有效期24小时,超出该时效无法评价,推送请至模版设置添加\n\t\t\t")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"titles"},[this._v("支付评价配置")]),this._v(" "),e("div",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"set-line"},[e("div",{staticClass:"titles"},[this._v("评价福利")]),this._v(" "),e("div",{staticClass:"line"})])}],!1,null,"0db08839",null);u.options.__file="src\\module\\marketing_tools\\payment_configuration.vue";e.default=u.exports},ac11:function(t,e,n){"use strict";var i=n("bdb3");n.n(i).a},bdb3:function(t,e,n){}}]);