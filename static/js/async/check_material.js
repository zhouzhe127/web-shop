(window.webpackJsonp=window.webpackJsonp||[]).push([["check_material"],{"09cb":function(t,e,a){"use strict";var i=a("bbbc");a.n(i).a},"1b1d":function(t,e,a){"use strict";var i=a("1df5");a.n(i).a},"1df5":function(t,e,a){},"86d8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"check-material"}},[t.addShow?t._e():[a("div",{staticClass:"main"},[a("div",{staticClass:"head"},[t._v("\n\t\t\t\t盘库物料列表 · 共"),a("em",[t._v(t._s(t.listLength))]),t._v("个条目\n\t\t\t")]),t._v(" "),a("div",{staticClass:"scroll-box"},[t._m(0),t._v(" "),t._l(t.list,function(e,i){return a("div",{key:i,staticClass:"list-item"},[a("div",{staticClass:"cell select-ban"},[a("em",{staticClass:"clear",on:{click:function(e){t.clearItem(i)}}},[t._v("清空输入")]),t._v(" "),a("em",{on:{click:function(e){t.openBatchWin(i)}}},[t._v("批量盘库")])]),t._v(" "),a("div",{staticClass:"cell"},[a("drop-down",{staticClass:"sel-box",attrs:{list:e.unitArr,value:e.unitIndex,width:90,noRepeat:!0},on:{emit:function(e){t.unitSel(e,i)}}})],1),t._v(" "),a("div",{staticClass:"cell wide"},[e.oneName?[a("div",{staticClass:"input-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.oneNum,expression:"item.oneNum"}],attrs:{type:"text",maxlength:"10",placeholder:"请输入数量",disabled:e.haveBatch},domProps:{value:e.oneNum},on:{input:function(a){a.target.composing||t.$set(e,"oneNum",a.target.value)}}}),t._v(" "),a("div",{staticClass:"word"},[t._v(t._s(e.oneName))])]),t._v("\n\t\t\t\t\t\t\t+\n\t\t\t\t\t\t")]:t._e(),t._v(" "),a("div",{staticClass:"input-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.twoNum,expression:"item.twoNum"}],attrs:{type:"text",maxlength:"10",placeholder:"请输入数量",disabled:e.haveBatch},domProps:{value:e.twoNum},on:{input:function(a){a.target.composing||t.$set(e,"twoNum",a.target.value)}}}),t._v(" "),a("div",{staticClass:"word"},[t._v(t._s(e.twoName))])])],2),t._v(" "),a("div",{staticClass:"cell text-ellipsis",attrs:{title:e.name}},[t._v("\n\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"cell text-ellipsis",attrs:{title:t.setSuprlus(e.surplus,e.unit)}},[t._v("\n\t\t\t\t\t\t"+t._s(t.setSuprlus(e.surplus,e.unit))+"\n\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"cell text-ellipsis",attrs:{title:e.wName+(e.aName?" / "+e.aName:"")}},[t._v("\n\t\t\t\t\t\t"+t._s(e.wName)+t._s(e.aName?" / "+e.aName:"")+"\n\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"cell"},[t._v(t._s(e.batch))]),t._v(" "),a("div",{staticClass:"cell"},[t._v(t._s(t.matTypeHash[e.type]))])])}),t._v(" "),t.list.length?t._e():a("div",{staticClass:"empty"},[t._v("- 暂无条目 -")])],2)]),t._v(" "),a("div",{staticClass:"page-box"},[a("pageBtn",{attrs:{total:t.pageTotal,page:t.page,isNoJump:!0},on:{pageNum:t.pageChange}})],1)],t._v(" "),t.addShow?a("add-material",{attrs:{selObj:t.selObj},on:{emit:t.matClose}}):t._e(),t._v(" "),t.batchShow?a("batch-win",{attrs:{material:t.batchObj,selItem:t.batchList},on:{emit:t.batchClose}}):t._e()],2)};i._withStripped=!0;var r=a("81a2"),s=a("05dd"),n=a("bbb9");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(r,s){try{var n=e[r](s),o=n.value}catch(t){return void a(t)}if(!n.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var l={data:function(){return{addShow:!1,list:[],selObj:{list:[],search:{},storeAll:!1},selMatItem:[],selMatSearch:null,listLength:0,batchShow:!1,pageTotal:0,page:1,pageShow:10,batchObj:{mid:"",wid:"",areaId:"",unitId:""},batchList:[],checkList:[],openIndex:0,useList:[],isUse:!1,pageSaveList:[],matTypeHash:{0:"成品",1:"半成品",2:"普通物料"}}},components:{addMaterial:function(){return Promise.resolve().then(a.bind(null,"c4ba"))},batchWin:function(){return a.e("material_batch_win").then(a.bind(null,"1859"))},pageBtn:function(){return a.e("page_element").then(a.bind(null,"5921"))},dropDown:function(){return a.e("drop_down").then(a.bind(null,"7e31"))}},mounted:function(){var t=this.$route.query.id;this.isUse=!!t,this.initBtn(),this.isUse?(this.initBtn(),this.setDefault(t)):this.addShow=!0},methods:{initBtn:function(){var t=this,e=[{name:"确定盘库",style:"background: #fe8d01;border: 1px solid #fe8d01;color: #fff;",fn:function(){t.checkMaterial()}},{name:"添加物料",style:"background: #29a7e1;border: 1px solid #29a7e1;color: #fff;",fn:function(){t.addShow=!0}},{name:"取消盘库",style:"background: #b3b3b3;border: 1px solid #b3b3b3;color: #fff;",fn:function(){window.history.go(-1)}}];this.$store.commit("setPageTools",e)},setDefault:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var i,s,n,o,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.getInventoryMaterialTemplate({data:{id:t}});case 2:for(l in i=a.sent,s=i.content.wids,n=i.content.aids,e.wid=s?s.join(","):"",e.areaId=n?n.join(","):"",e.cid=i.content.c2?i.content.c2:i.content.c1,e.selObj.search={cid:e.cid,sortOneId:i.content.c1,sortTwoId:i.content.c2,wid:e.wid,areaId:e.areaId},e.selObj.name=i.name,o=0,["cid","wid","areaId"])e[l]||o++;i.content.items.length&&3==o&&(e.useList=i.content.items.map(function(t){return{mid:t.mid,areaId:t.aid}}),e.getUseList(),e.selObj.storeAll=!1),!i.content.items.length&&o>0&&(e.getMatList(),e.selObj.storeAll=!0);case 14:case"end":return a.stop()}},a,e)}))()},getUseList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.getListByMidsAndAreaId({data:{param:t.useList}});case 2:a=e.sent,t.pageTotal=Math.floor(a.length/t.pageShow),t.listLength=a.length,t.selObj.list=a,t.setListData(a);case 7:case"end":return e.stop()}},e,t)}))()},unitSel:function(t,e){var a=this.list[e],i=a.unit[t.value];a.oneNum="",a.twoNum="",a.selBatchList=[],a.haveBatch=!1,a.unitIndex=t.value,1==i.isMin?(a.oneName="",a.unitValue=1):(a.oneName=i.name,a.unitValue=i.value),a.unitId=i.muId},matClose:function(t){if(this.initBtn(),t)if(this.page=1,this.selObj=t,this.pageSaveList=[],this.checkList=[],t.list.length)this.pageTotal=Math.ceil(t.list.length/this.pageShow),this.listLength=t.list.length,this.webPage();else{for(var e in this.selMatSearch=t.search,this.selMatSearch)this[e]=this.selMatSearch[e];this.getMatList()}this.addShow=!1},webPage:function(){var t=(this.page-1)*this.pageShow,e=this.page*this.pageShow,a=this.selObj.list.slice(t,e),i=n.a.deepCopy(a);this.setListData(i)},setSuprlus:function(t,e){var a="",i="",r=1,n=!0,o=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){var h=c.value;1==h.isMin?(i=h.name,1==h.isDefault&&(a=h.name,r=h.value)):1==h.isDefault&&(a=h.name,r=h.value)}}catch(t){o=!0,l=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw l}}return s.a.comUnit(t,r,a,i)},clearItem:function(t){var e=this.list[t];e.oneNum="",e.twoNum="",e.selBatchList=[],e.haveBatch=!1;for(var a=0;a++;a<this.pageSaveList.length){var i=this.pageSaveList[a];i.id==e.id&&i.areaId==e.areaId&&(this.pageSaveList.splice(a,1),a--)}},openBatchWin:function(t){var e=this.list[t];this.batchShow=!0,this.openIndex=t,this.batchObj={mid:e.id,wid:e.wid,areaId:e.areaId,unitId:e.unitId},this.batchList=e.selBatchList?e.selBatchList:[]},batchClose:function(t){if(t){var e=this.list[this.openIndex];if(t.list.length){var a;e.selBatchList=t.list,e.haveBatch=!0;var i=t.allNum,r=e.unitValue,n=e.oneName?e.oneName:e.twoName,o=e.twoName,l=s.a.comUnit(i,r,n,o,!0);e.oneNum=l.oNull,e.twoNum=l.tNull;var c=[],u=!0,h=!1,d=void 0;try{for(var m,v=e.selBatchList[Symbol.iterator]();!(u=(m=v.next()).done);u=!0){var f=m.value,p={batchId:f.batchId,wid:f.wid,areaId:f.areaId,surplus:f.totalItem,itemId:e.id,unitId:e.unitId};c.push(p)}}catch(t){h=!0,d=t}finally{try{!u&&v.return&&v.return()}finally{if(h)throw d}}this.spliceArr(this.checkList,e),(a=this.checkList).push.apply(a,c)}else e.haveBatch=!1}this.batchShow=!1},spliceArr:function(t,e){for(var a=0;a<t.length;a++){var i=t[a];i.itemId==e.id&&i.areaId==e.areaId&&(t.splice(a,1),a--)}},setSendList:function(){var t=[];t=this.pageSaveList.length?this.pageSaveList:this.list;var e=!0,a=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value,o=Number(n.oneNum)*Number(n.unitValue)+Number(n.twoNum);if(!n.haveBatch&&""!==n.oneNum||""!==n.twoNum){var l={batchId:0,wid:n.wid,areaId:n.areaId,surplus:o,itemId:n.id,unitId:n.unitId};this.spliceArr(this.checkList,n),this.checkList.push(l)}}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}},veriList:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=this.list[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;if(""!==s.oneNum||""!==s.twoNum){var n=Number(s.oneNum)*Number(s.unitValue)+Number(s.twoNum);if(isNaN(s.oneNum)||isNaN(s.twoNum))return this.myAlert("物料:"+s.name+"("+s.wName+"/"+s.aName+"),盘库数量必须为数字"),!1;if(n<0)return this.myAlert("物料:"+s.name+"("+s.wName+"/"+s.aName+"),盘库数量不能小于0"),!1;if(n>999999999)return this.myAlert("物料:"+s.name+"("+s.wName+"/"+s.aName+"),盘库数量过大!"),!1}}}catch(t){e=!0,a=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}return!0},checkMaterial:function(){var t=this;this.setSendList(),this.checkList.length?this.veriList()&&this.$store.commit("setWin",{winType:"confirm",title:"操作提示",content:"确认盘库？",callback:function(e){"ok"==e&&setTimeout(function(){t.checkMatSubmit()})}}):this.myAlert("请填写盘库数量")},checkMatSubmit:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.GoodsinventoryBatchSetMaterialInventory({data:{type:1,data:t.checkList}});case 2:e.sent.result?(t.myAlert("物料盘库成功！"),delete t.$route.query.id,t.$router.push({path:"/admin/materialCountHistory",query:t.$route.query})):t.myAlert("物料盘库失败！");case 4:case"end":return e.stop()}},e,t)}))()},getMatList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.materialGetListByArea({data:{page:t.page,num:t.pageShow,name:"",cid:t.cid,wid:t.wid,areaId:t.areaId}});case 2:a=e.sent,t.pageTotal=a.total,t.listLength=a.count,t.setListData(a.list);case 6:case"end":return e.stop()}},e,t)}))()},myAlert:function(t){this.$store.commit("setWin",{title:"操作提示",content:t})},setListData:function(t){var e=!0,a=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){for(var n=r.value,o=[],l=0,c="",u="",h=1,d="",m=0;m<n.unit.length;m++){var v=n.unit[m];o.push({value:m,label:v.name}),1==v.isMin?u=v.name:1==v.isDefault&&(c=v.name,h=v.value),1==v.isDefault&&(l=m,d=v.muId)}n.unitArr=o,n.unitIndex=l,n.unitId=d,n.oneNum="",n.twoNum="",n.oneName=c,n.twoName=u,n.unitValue=h}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}this.eachSaveList(t)},eachSaveList:function(t){if(this.pageSaveList.length){var e=!0,a=!1,i=void 0;try{for(var r,s=this.pageSaveList[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value,o=!0,l=!1,c=void 0;try{for(var u,h=t[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var d=u.value;if(d.id==n.id&&d.areaId==n.areaId){for(var m in n)this.$set(d,m,n[m]);break}}}catch(t){l=!0,c=t}finally{try{!o&&h.return&&h.return()}finally{if(l)throw c}}}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}}this.list=t},setPageSave:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=this.list[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;""===s.oneNum&&""===s.twoNum||(this.checkListRepeat(s),this.pageSaveList.push(s))}}catch(t){e=!0,a=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}},checkListRepeat:function(t){for(var e=0;e<this.pageSaveList.length;e++){var a=this.pageSaveList[e];a.id==t.id&&a.areaId==t.areaId&&(this.pageSaveList.splice(e,1),e--)}},pageChange:function(t){this.page=t.page,this.pageShow=t.num,this.setPageSave(),this.selObj.list.length?this.webPage():this.getMatList()}}},c=(a("1b1d"),a("6ceb")),u=Object(c.a)(l,i,[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("span",[t._v("操作")]),t._v(" "),a("span",[t._v("单位选择")]),t._v(" "),a("span",{staticClass:"wide"},[t._v("盘库数量")]),t._v(" "),a("span",[t._v("物料名称")]),t._v(" "),a("span",[t._v("库存数量")]),t._v(" "),a("span",[t._v("所属仓库")]),t._v(" "),a("span",[t._v("批次数量")]),t._v(" "),a("span",[t._v("类型")])])}],!1,null,"cc397de4",null);u.options.__file="src\\module\\invoicing_system\\invoicing\\check_warehouse\\check_material.vue";e.default=u.exports},bbbc:function(t,e,a){},c4ba:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bom-order"},[a("div",{staticClass:"filter"},[a("div",{staticClass:"inline-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.matName,expression:"matName"}],attrs:{type:"text",placeholder:"请输入物料名"},domProps:{value:t.matName},on:{input:function(e){e.target.composing||(t.matName=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"inline-box"},[a("select-store",{attrs:{sorts:t.sortOne,tipName:"请选择一级分类",isSingle:!0},on:{emit:t.selSortOne}})],1),t._v(" "),a("div",{staticClass:"inline-box",on:{click:function(e){t.checkSelect("sortTwo","towSortDom")}}},[a("select-store",{ref:"towSortDom",attrs:{sorts:t.sortTwo,tipName:"请选择二级分类",isSingle:!0},on:{emit:t.selSortTwo}})],1),t._v(" "),a("div",{staticClass:"inline-box"},[a("select-store",{attrs:{sorts:t.wareList,tipName:"请选择仓库"},on:{emit:t.selWare}})],1),t._v(" "),a("div",{staticClass:"inline-box",on:{click:function(e){t.checkSelect("areaList","areaDom")}}},[a("select-store",{ref:"areaDom",attrs:{sorts:t.areaList,tipName:"请选择区域"},on:{emit:t.selArea}})],1),t._v(" "),a("div",{staticClass:"inline-box"},[a("div",{staticClass:"button-box"},[a("span",{staticClass:"blue",on:{click:t.filter}},[t._v("筛选")]),t._v(" "),a("span",{staticClass:"gray",on:{click:t.reset}},[t._v("重置")])])])]),t._v(" "),a("com-table",{attrs:{listName:"物料列表",titleData:t.titleList,allTotal:t.listLength,introData:t.list,listHeight:70,listWidth:1200},scopedSlots:t._u([{key:"title-0",fn:function(e){return a("div",{staticClass:"select-all select-ban"},[a("span",{on:{click:function(e){t.radioAll("store")}}},[t._v(t._s(t.storeAll?"取消全选":"全选"))]),t._v(" "),a("i",[t._v("|")]),t._v(" "),a("span",{staticClass:"page-all",class:{ban:t.storeAll},on:{click:function(e){t.radioAll("page")}}},[t._v(t._s(t.pageAll?"取消本页":"全选本页"))])])}},{key:"con-0",fn:function(e){return a("span",{staticClass:"detail select-ban",on:{click:function(a){t.listHandle(e.index)}}},[a("i",{class:{"sel-active":e.data.selected,storeAll:t.storeAll}})])}},{key:"con-1",fn:function(e){return a("span",{},[t._v(t._s((t.page-1)*t.pageShow+e.index>=9?(t.page-1)*t.pageShow+e.index+1:"0"+((t.page-1)*t.pageShow+e.index+1)))])}},{key:"con-3",fn:function(e){return a("span",{},[t._v(t._s(t.matTypeHash[e.data.type]))])}},{key:"con-4",fn:function(e){return a("span",{},[t._v(t._s(e.data.wName)+t._s(e.data.aName?" / "+e.data.aName:""))])}},{key:"con-5",fn:function(e){return a("span",{},[t._v(t._s(t.setCate(e.data.cate)))])}},{key:"con-6",fn:function(e){return a("span",{},[t._v(t._s(t.setSuprlus(e.data.surplus,e.data.unit)))])}}])}),t._v(" "),a("div",{staticClass:"page-box"},[a("pageBtn",{attrs:{total:t.pageTotal,page:t.page,isNoJump:!0},on:{pageNum:t.pageChange}})],1),t._v(" "),t.nameWinShow?a("model-name",{attrs:{name:t.modelName,title:t.modelTitle},on:{emit:t.nameWinEmit}}):t._e()],1)};i._withStripped=!0;var r=a("f6ce"),s=a("bbb9"),n=a("81a2"),o=a("05dd");function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(r,s){try{var n=e[r](s),o=n.value}catch(t){return void a(t)}if(!n.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var c={data:function(){return{userName:"",tempId:"",shopId:"",isBrand:0,page:1,pageShow:10,pageTotal:1,list:[],listLength:0,userData:"",matName:"",cid:"",wid:"",areaId:"",modelName:"",modelTitle:"保存模板",nameWinShow:!1,titleList:[{titleName:"操作",titleStyle:{width:"200px"}},{titleName:"序号"},{titleName:"物料名称",dataName:"name"},{titleName:"类型"},{titleName:"所属仓库"},{titleName:"分类"},{titleName:"库存数量/重量"},{titleName:"批次数量",dataName:"batch"}],matTypeHash:{0:"成品",1:"半成品",2:"普通物料"},storeAll:!1,pageAll:!1,savePage:[],selectItem:[],selNum:0,wareList:[],areaList:[],selList:[],searchObj:{},sortOne:[],sortTwo:[],allSort:[],sortOneId:"",sortTwoId:"",isEdit:"",useList:[]}},props:["selObj"],components:{pageBtn:function(){return a.e("page_element").then(a.bind(null,"5921"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},selectStore:function(){return a.e("win").then(a.bind(null,"cb83"))},calendar:function(){return a.e("calendar_type").then(a.bind(null,"f2dd"))},comTable:function(){return a.e("table").then(a.bind(null,"4360"))},modelName:function(){return a.e("model_name_win").then(a.bind(null,"5338"))}},created:function(){this.userData=r.a.session("userShop"),this.userName=this.userData.user.name,this.shopId=this.userData.currentShop.id,this.isBrand="3"==this.userData.currentShop.ischain?1:0},mounted:function(){this.tempId=this.$route.query.id,this.isEdit=!!this.tempId,this.initBtn(),!this.selObj&&this.isEdit?this.editTemplate():(this.setDefault(),this.getData(),this.getCategoryList(),this.getWarehouseList())},methods:{initBtn:function(){var t=this,e=[{name:"确定",style:"background: #fe8d01;border: 1px solid #fe8d01;color: #fff;",fn:function(){t.confirmClick()}},{name:"保存模板",style:"background: none;border: 1px solid #fe8d01;color: #fe8d01;",fn:function(){t.saveModel()}},{name:"取消",style:"background: #b3b3b3;border: 1px solid #b3b3b3;color: #fff;",fn:function(){if(!t.selObj&&t.isEdit)window.history.go(-1);else{var e=JSON.stringify(t.selObj.search);t.selObj.list.length||"{}"!=e||t.selObj.storeAll?t.$emit("emit",!1):window.history.go(-1)}}}];!this.selObj&&this.isEdit&&(e.splice(0,1),e[0].style="background: #fe8d01;border: 1px solid #fe8d01;color: #fff;"),this.$store.commit("setPageTools",e)},confirmClick:function(){if(this.selList.length||this.storeAll){var t={list:this.selList,search:this.searchObj,storeAll:this.storeAll};this.$emit("emit",t)}else this.myAlert("请选择商品")},editTemplate:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.getInventoryMaterialTemplate({data:{id:t.tempId}});case 2:a=e.sent,i=a.content.wids,r=a.content.aids,t.wid=i?i.join(","):"",t.areaId=r?r.join(","):"",t.modelName=a.name,t.sortOneId=a.content.c1,t.sortTwoId=a.content.c2,t.cid=t.sortTwoId?t.sortTwoId:t.sortOneId,t.selectItem=a.content.items,t.selectItem.length?(t.useList=a.content.items.map(function(t){return{mid:t.mid,areaId:t.aid}}),t.getUseList()):t.storeAll=!0,t.getData(),t.getCategoryList(),t.getWarehouseList();case 16:case"end":return e.stop()}},e,t)}))()},getUseList:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.getListByMidsAndAreaId({data:{param:t.useList}});case 2:a=e.sent,t.selList=a;case 4:case"end":return e.stop()}},e,t)}))()},setDefault:function(){for(var t in this.selObj.search)this[t]=this.selObj.search[t];this.storeAll=this.selObj.storeAll,this.storeAll||(this.selList=this.selObj.list),this.modelName=this.selObj.name,this.selectItem=this.selList.map(function(t){return{mid:t.id,aid:t.areaId}})},formatTime:function(t){return s.a.format(new Date(1e3*t),"yyyy-MM-dd hh:mm:ss")},filter:function(){this.page=1,this.getData()},nameWinEmit:function(t,e){this.nameWinShow=!1,"ok"==t&&(this.modelName=e,this.tempId?this.editModel():this.addModel())},getCategoryList:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,i,r,s,o,l,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.invoiv_getCategoryList();case 2:for(a=e.sent,i=[],r=!0,s=!1,o=void 0,e.prev=7,l=a[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)0==(u=c.value).pid&&i.push(u);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),s=!0,o=e.t0;case 15:e.prev=15,e.prev=16,!r&&l.return&&l.return();case 18:if(e.prev=18,!s){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:t.sortOne=i,t.allSort=a,t.setDefaultSort();case 26:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22]])}))()},selSortOne:function(t,e){var a=[];e||(this.sortTwoId=""),this.cid=this.setSortId(t),this.sortOneId=this.cid;var i=!0,r=!1,s=void 0;try{for(var n,o=this.allSort[Symbol.iterator]();!(i=(n=o.next()).done);i=!0){var l=n.value;l.pid==this.cid&&a.push(l)}}catch(t){r=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw s}}this.sortTwo=a},selSortTwo:function(t){this.cid=this.setSortId(t),this.sortTwoId=this.cid},setSortId:function(t){var e="",a=!0,i=!1,r=void 0;try{for(var s,n=t[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;if(1==o.selected){e=o.id;break}}}catch(t){i=!0,r=t}finally{try{!a&&n.return&&n.return()}finally{if(i)throw r}}return e},setDefaultSort:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=this.sortOne[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;if(this.sortOneId==s.id){s.selected=!0;break}}}catch(t){e=!0,a=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}if(this.selSortOne(this.sortOne,!0),this.sortTwo.length){var n=!0,o=!1,l=void 0;try{for(var c,u=this.sortTwo[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){var h=c.value;if(this.sortTwoId==h.id){h.selected=!0;break}}}catch(t){o=!0,l=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw l}}this.selSortTwo(this.sortTwo)}},getWarehouseList:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,i,r,s,o,l,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.warehouseWarehouseList();case 2:for(a=e.sent,i=[],r=!0,s=!1,o=void 0,e.prev=7,l=a[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)u=c.value,t.isBrand?Number(u.shopId)||t.shopId!=u.brandId||i.push(u):t.shopId==u.shopId&&i.push(u);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),s=!0,o=e.t0;case 15:e.prev=15,e.prev=16,!r&&l.return&&l.return();case 18:if(e.prev=18,!s){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:t.wareList=i,t.setWareDefault();case 25:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22]])}))()},selWare:function(t,e){var a=this;this.wid="",e||(this.areaId=""),this.areaList=[];var i=[],r=function(t){if(1==t.selected){var e;i.push(t.id);var r=t.area.map(function(e){return{id:e.id,name:t.name+" / "+e.areaName}});(e=a.areaList).push.apply(e,function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}(r))}},s=!0,n=!1,o=void 0;try{for(var l,c=t[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){r(l.value)}}catch(t){n=!0,o=t}finally{try{!s&&c.return&&c.return()}finally{if(n)throw o}}this.wid=i.join(",")},selArea:function(t){this.areaId="";var e=[],a=!0,i=!1,r=void 0;try{for(var s,n=t[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;1==o.selected&&e.push(o.id)}}catch(t){i=!0,r=t}finally{try{!a&&n.return&&n.return()}finally{if(i)throw r}}this.areaId=e.join(",")},setWareDefault:function(){if(this.wid){var t=this.wid.split(","),e=s.a.deepCopy(this.wareList),a=!0,i=!1,r=void 0;try{for(var n,o=e[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value,c=!0,u=!1,h=void 0;try{for(var d,m=t[Symbol.iterator]();!(c=(d=m.next()).done);c=!0){var v=d.value;l.id==v&&(l.selected=!0)}}catch(t){u=!0,h=t}finally{try{!c&&m.return&&m.return()}finally{if(u)throw h}}}}catch(t){i=!0,r=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}this.wareList=e,this.selWare(this.wareList,!0)}if(this.areaId){var f=this.areaId.split(","),p=s.a.deepCopy(this.areaList),y=!0,g=!1,w=void 0;try{for(var b,I=p[Symbol.iterator]();!(y=(b=I.next()).done);y=!0){var S=b.value,N=!0,_=!1,L=void 0;try{for(var x,k=f[Symbol.iterator]();!(N=(x=k.next()).done);N=!0){var A=x.value;S.id==A&&(S.selected=!0)}}catch(t){_=!0,L=t}finally{try{!N&&k.return&&k.return()}finally{if(_)throw L}}}}catch(t){g=!0,w=t}finally{try{!y&&I.return&&I.return()}finally{if(g)throw w}}this.areaList=p,this.selArea(this.areaList)}},setCate:function(t){var e=[],a=!0,i=!1,r=void 0;try{for(var s,n=t[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;e.push(o.name)}}catch(t){i=!0,r=t}finally{try{!a&&n.return&&n.return()}finally{if(i)throw r}}return e.join(", ")},setSuprlus:function(t,e){var a="",i="",r=1,s=!0,n=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var h=c.value;1==h.isMin?(i=h.name,1==h.isDefault&&(a=h.name,r=h.value)):1==h.isDefault&&(a=h.name,r=h.value)}}catch(t){n=!0,l=t}finally{try{!s&&u.return&&u.return()}finally{if(n)throw l}}return o.a.comUnit(t,r,a,i)},myAlert:function(t){this.$store.commit("setWin",{title:"操作提示",content:t})},setSendObj:function(t){this.storeAll&&(this.selectItem=[]);var e={name:this.modelName,userName:this.userName,wids:this.wid?this.wid.split(","):"",aids:this.areaId?this.areaId.split(","):"",c1:this.sortOneId,c2:this.sortTwoId,items:this.selectItem};return t&&(e.id=this.tempId),e},saveModel:function(){this.selectItem.length||this.storeAll?(this.nameWinShow=!0,this.modelName?this.modelTitle="修改模板":this.modelTitle="新建模板"):this.myAlert("模板内容不能为空")},addModel:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.setSendObj(),e.next=3,n.a.addInventoryMaterialTemplate({data:a});case 3:(i=e.sent)&&(t.tempId=i,t.toModelTemplate("模板新建成功，是否直接跳转到模板列表？"));case 5:case"end":return e.stop()}},e,t)}))()},editModel:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.setSendObj(!0),e.next=3,n.a.editInventoryMaterialTemplate({data:a});case 3:e.sent&&(!t.selObj&&t.isEdit?(t.myAlert("模板修改成功！"),delete t.$route.query.id,t.$router.push({path:"/admin/materialCountTemplate",query:t.$route.query})):t.toModelTemplate("模板修改成功，是否直接跳转到模板列表？"));case 5:case"end":return e.stop()}},e,t)}))()},toModelTemplate:function(t){var e=this;this.$store.commit("setWin",{winType:"confirm",title:"操作提示",content:t,callback:function(t){"ok"==t&&(delete e.$route.query.id,e.$router.push({path:"/admin/materialCountTemplate",query:e.$route.query}))}})},getData:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.materialGetListByArea({data:{page:t.page,num:t.pageShow,name:t.matName,cid:t.cid,wid:t.wid,areaId:t.areaId}});case 2:a=e.sent,t.searchObj={cid:t.cid,sortOneId:t.sortOneId,sortTwoId:t.sortTwoId,wid:t.wid,areaId:t.areaId},t.list=t.setAlready(a.list),t.listLength=a.count,t.pageTotal=a.total,t.setSelNum();case 8:case"end":return e.stop()}},e,t)}))()},setAlready:function(t){var e=!1,a=!0,i=!1,r=void 0;try{for(var s,n=t[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;if(this.storeAll)o.selected=!0;else{var l=!0,c=!1,u=void 0;try{for(var h,d=this.savePage[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){if(h.value==this.page){e=!0;break}}}catch(t){c=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw u}}if(e)o.selected=!0;else{var m=!1,v=!0,f=!1,p=void 0;try{for(var y,g=this.selectItem[Symbol.iterator]();!(v=(y=g.next()).done);v=!0){var w=y.value;if(w.mid==o.id&&w.aid==o.areaId){m=!0;break}}}catch(t){f=!0,p=t}finally{try{!v&&g.return&&g.return()}finally{if(f)throw p}}o.selected=!!m}}}}catch(t){i=!0,r=t}finally{try{!a&&n.return&&n.return()}finally{if(i)throw r}}return this.pageAll=!!e,t},setSelNum:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=this.list[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){1==i.value.selected&&this.selNum++}}catch(t){e=!0,a=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}},checkSelect:function(t,e){this[t].length||(this.$refs[e].sortShow=!1,"towSortDom"==e?this.sortOneId?this.$message({message:"没有二级分类!",type:"error"}):this.$message({message:"请选择一级分类!",type:"error"}):this.$message({message:"请选择仓库!",type:"error"}))},reset:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=["matName","cid","wid","areaId","sortOneId","sortOneId"][Symbol.iterator]();!(t=(i=r.next()).done);t=!0){this[i.value]=""}}catch(t){e=!0,a=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}this.page=1,this.pageShow=10,this.clearListSel(this.wareList,"wareList"),this.areaList=[],this.clearListSel(this.sortOne,"sortOne"),this.sortTwo=[],this.getData()},clearListSel:function(t,e){var a=s.a.deepCopy(t),i=!0,r=!1,n=void 0;try{for(var o,l=a[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){o.value.selected=!1}}catch(t){r=!0,n=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw n}}this[e]=a},pageChange:function(t){this.page=Number(t.page),this.pageShow=Number(t.num),this.getData()},listHandle:function(t){var e=this.list[t];if(!this.storeAll)if(e.selected=!e.selected,e.selected)this.selectItem.push({mid:e.id,aid:e.areaId}),this.selList.push(e),this.selNum++,this.selNum==this.list.length&&(this.savePage.push(this.page),this.pageAll=!0);else{this.selNum--;for(var a=0;a<this.selectItem.length;a++){var i=this.selectItem[a].mid,r=this.selectItem[a].aid;if(i==e.id&&r==e.areaId){this.selectItem.splice(a,1),this.selList.splice(a,1),a--;break}}this.pageAll&&(this.removePageNum(),this.pageAll=!1)}},radioAll:function(t){if(this.list.length)if("store"==t)this.storeAll=!this.storeAll,this.pageAll=!1,this.setSelAll(this.storeAll),this.selList=[],this.selectItem=[];else if("page"==t){if(this.storeAll)return;this.pageAll=!this.pageAll,this.pageAll?(this.savePage.push(this.page),this.pageSetId("add")):(this.removePageNum(),this.pageSetId("cancel"))}},removePageNum:function(){for(var t=0;t<this.savePage.length;t++)this.savePage[t]==this.page&&(this.savePage.splice(t,1),t--)},pageSetId:function(t){if("add"==t){var e=!0,a=!1,i=void 0;try{for(var r,s=this.list[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value,o=!1,l=!0,c=!1,u=void 0;try{for(var h,d=this.selectItem[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var m=h.value;if(n.id==m.mid&&n.areaId==m.aid){o=!0;break}}}catch(t){c=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw u}}o||(this.selectItem.push({mid:n.id,aid:n.areaId}),this.selList.push(n),n.selected=!0)}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}}else if("cancel"==t){var v=!0,f=!1,p=void 0;try{for(var y,g=this.list[Symbol.iterator]();!(v=(y=g.next()).done);v=!0)for(var w=y.value,b=0;b<this.selectItem.length;b++){var I=this.selectItem[b].mid,S=this.selectItem[b].aid;if(I==w.id&&S==w.areaId){this.selectItem.splice(b,1),this.selList.splice(b,1),w.selected=!1,b--;break}}}catch(t){f=!0,p=t}finally{try{!v&&g.return&&g.return()}finally{if(f)throw p}}}},setSelAll:function(t){if(t){var e=!0,a=!1,i=void 0;try{for(var r,s=this.list[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){r.value.selected=!0}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}}else{var n=!0,o=!1,l=void 0;try{for(var c,u=this.list[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){c.value.selected=!1}}catch(t){o=!0,l=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw l}}this.selectItem=[]}}}},u=(a("09cb"),a("6ceb")),h=Object(u.a)(c,i,[],!1,null,"b3d327d6",null);h.options.__file="src\\module\\invoicing_system\\invoicing\\check_warehouse\\add_material.vue";e.default=h.exports}}]);