(window.webpackJsonp=window.webpackJsonp||[]).push([["statistics_management"],{"3b57":function(t,e,n){"use strict";n.r(e);var i=n("f6ce"),a=n("81a2"),s=n("bbb9");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,s){try{var r=e[a](s),o=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var o={data:function(){return{ischain:"",isBrand:"",sourcesList:[],hint:!1,imgHost:"",totalFansNum:null,exportUrl:"javascript:void(0);",index:null,types:"add",itemDetial:{},newItemDetial:{},showWin:!1,allTotal:0,page:1,num:10,pageTotal:10,endTotal:1,allFormList:[]}},mounted:function(){var t=i.a.session("userShop");this.ischain=t.currentShop.ischain,this.isBrand="3"!=this.ischain,"0"!=this.ischain&&"3"!=this.ischain||this.$store.commit("setPageTools",[{name:"添加来源",className:["addStaff","firstBtn"],fn:this.add,type:2},{name:"导出",className:["setTemp","export-btn"],fn:this.exportSource}]),this.getCountList()},components:{statisticsManagementWin:function(){return n.e("statistics_management_win").then(n.bind(null,"c038"))},comTable:function(){return n.e("table").then(n.bind(null,"4360"))}},methods:{getResult:function(t,e){if("ok"==t){if(""==e.name)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"请添加来源名称"}),!1;"edit"==this.types?this.editStaticId(e):"add"==this.types&&this.addStaticId(e)}this.showWin=!1},addStaticId:function(t){var e=this;return r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.addStaticId({data:t});case 2:e.getCountList();case 3:case"end":return n.stop()}},n,e)}))()},editStaticId:function(t){var e=this;return r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.editStaticId({data:t});case 2:e.getCountList();case 3:case"end":return n.stop()}},n,e)}))()},delSources:function(t,e){var n=this;this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确定要删除来源?",callback:function(t){"ok"==t&&(n.delStaticId(e),n.getCountList())}})},delStaticId:function(t){var e=this;return r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.delStaticId({data:{id:t.id}});case 2:case"end":return e.stop()}},n,e)}))()},getCountList:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var n,i,r,o,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getCountList({data:{}});case 2:if(n=e.sent,t.allFormList=n.list,0==t.allFormList.length)t.hint=!0,t.allFormList=[];else{for(i=n.count?n.count:[],r=t.allFormList?t.allFormList:[],o=0;o<r.length;o++)for(r[o].count=0,r[o].createTime=s.a.format(new Date(1e3*r[o].createTime),"yyyy-MM-dd"),c=0;c<i.length;c++)i[c].id==r[o].id&&(r[o].count=i[c].count);t.allFormList=r,t.sortSources(),t.$nextTick(function(){t.setPage()})}t.totalFansNum=n.fissionNum.count;case 6:case"end":return e.stop()}},e,t)}))()},add:function(){this.isSources("add")},isSources:function(t,e){this.showWin=!0,this.types=t,this.itemDetial=e||{count:"0",imageUrl:"",name:"",id:""}},exportSource:function(){if(0==this.sourcesList.length)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"来源列表为空，没有数据可以导出"}),!1;this.getAllSourceList()},getAllSourceList:function(){var t=this;return r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.getAllSourceList({data:{}});case 2:case"end":return t.stop()}},e,t)}))()},sortSources:function(){var t=this.allFormList;this.allFormList=t.sort(function(t,e){var n=parseInt(t.id),i=parseInt(e.id);if(n>i)return-1;if(n<i)return 1;var a=parseInt(t.createTime),s=parseInt(e.createTime);return a>s?-1:a<s?1:0})},downLoadcode:function(t){window.open(t.imageUrl)},setPage:function(){this.endTotal=Math.ceil(this.allFormList.length/this.num);var t=(this.page-1)*this.num,e=this.page*this.num,n=this.allFormList.slice(t,e);this.sourcesList=n},handleSizeChange:function(t){this.num=t,this.setPage()},pageChange:function(t){this.page=t,this.setPage()}}},c=(n("fad4"),n("d801")),l=Object(c.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"sources-stat"}},[n("div",{staticClass:"add-sources"},[n("div",{staticClass:"divisive-fans"},[t._v("\n\t\t\t\t分裂粉丝数："+t._s(t.totalFansNum)+"\n\t\t\t")])]),t._v(" "),n("div",{staticClass:"list_box",staticStyle:{width:"100%"}},[n("div",{staticClass:"list_title"},[n("div",{staticClass:"list_title_l fl"},[n("span",[t._v("来源统计")]),t._v(" "),n("span"),t._v(" "),n("span",[t._v("共\n\t\t\t\t\t\t\t\t"),n("a",{attrs:{href:"javascript:;"}},[t._v(t._s(t.allFormList.length))]),t._v("条记录")])]),t._v(" "),n("div",{staticClass:"list_title_r fr"})]),t._v(" "),n("el-table",{attrs:{data:t.sourcesList,border:"",stripe:!0,"header-cell-style":{"background-color":"#f5f7fa"},"header-row-style":{height:"40px"},"row-style":{height:"70px"}}},[n("el-table-column",{attrs:{fixed:"",label:"序号",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"名称",prop:"name",width:"200",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"count",label:"人数",width:"200",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"code",label:"二维码",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{staticStyle:{width:"60px",height:"60px"},attrs:{src:t.row.imageUrl}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticStyle:{color:"rgb(40, 168, 224)"},attrs:{size:"medium",type:"text"},on:{click:function(n){t.downLoadcode(e.row)}}},[t._v("下载二维码")]),t._v(" "),n("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),n("el-button",{staticStyle:{color:"#ff8d00"},attrs:{size:"medium",type:"text"},on:{click:function(n){t.isSources("edit",e.row)}}},[t._v("编辑")]),t._v(" "),n("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),n("el-button",{staticStyle:{color:"#fd3f1f"},attrs:{size:"medium",type:"text"},on:{click:function(n){t.delSources(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),n("div",{staticClass:"pageWrap"},[n("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.num,layout:"sizes, prev, pager, next","page-count":t.endTotal,"page-sizes":[10,20,30]},on:{"size-change":t.handleSizeChange,"current-change":t.pageChange}})],1),t._v(" "),t.showWin?n("statisticsManagementWin",{attrs:{detial:t.itemDetial,types:t.types},on:{statisticsManagementWin:t.getResult}}):t._e()],1)},[],!1,null,"2d5058b2",null);e.default=l.exports},"802b":function(t,e,n){},fad4:function(t,e,n){"use strict";var i=n("802b");n.n(i).a}}]);