(window.webpackJsonp=window.webpackJsonp||[]).push([["statistics_management"],{"0bdd":function(t,e,i){"use strict";var n=i("55ca9");i.n(n).a},"3b57":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"sources-stat"}},[i("div",{staticClass:"add-sources"},[i("div",{staticClass:"divisive-fans"},[t._v("\n\t\t\t\t分裂粉丝数："+t._s(t.totalFansNum)+"\n\t\t\t")])]),t._v(" "),i("com-table",{attrs:{listHeight:80,showHand:!1,listName:"来源统计列表",showTitle:2,listWidth:672,introData:t.sourcesList,titleData:t.titleList},scopedSlots:t._u([{key:"con-0",fn:function(e){return i("div",{},[t._v(t._s(e.index+1))])}},{key:"con-4",fn:function(t){return i("div",{staticClass:"code"},[i("img",{attrs:{src:t.data.imageUrl}})])}},{key:"con-5",fn:function(e){return"0"==t.ischain||"3"==t.ischain?i("section",{},[i("a",{staticClass:"blue",staticStyle:{width:"32%"},attrs:{href:e.data.imageUrl,target:"_blank"}},[t._v("下载二维码")]),t._v(" "),i("a",{staticClass:"yellow",staticStyle:{width:"32%"},attrs:{href:"javascript:void(0);"},on:{click:function(i){t.isSources("edit",e.data)}}},[t._v("编辑")]),t._v(" "),i("a",{staticClass:"red",staticStyle:{width:"32%"},attrs:{href:"javascript:void(0);"},on:{click:function(i){t.delSources(e.index,e.data)}}},[t._v("删除")])]):t._e()}}])},["1"==t.ischain||"2"==t.ischain?i("section",[i("a",{staticStyle:{width:"100%",height:"100%",color:"#333"},attrs:{href:"javascript:void(0);"}},[t._v("当前无权限")])]):t._e()]),t._v(" "),t.showWin?i("statisticsManagementWin",{attrs:{detial:t.itemDetial,types:t.types},on:{statisticsManagementWin:t.getResult}}):t._e()],1)};n._withStripped=!0;var s=i("f6ce"),a=i("81a2"),r=i("bbb9");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(s,a){try{var r=e[s](a),o=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}("next")})}}var c={data:function(){return{ischain:"",isBrand:"",sourcesList:[],hint:!1,imgHost:"",totalFansNum:null,exportUrl:"javascript:void(0);",index:null,types:"add",itemDetial:{},newItemDetial:{},showWin:!1,titleList:[{titleName:"序号",titleStyle:{width:"10%",flex:"none"}},{titleName:"名称",dataName:"name",titleStyle:{width:"20%",flex:"none"}},{titleName:"创建时间",dataName:"createTime",titleStyle:{width:"15%",flex:"none"}},{titleName:"人数",dataName:"count",titleStyle:{width:"5%",flex:"none"}},{titleName:"二维码",titleStyle:{width:"10%",flex:"none"}},{titleName:"操作",titleStyle:{width:"30%",flex:"none"}}],allTotal:0,page:1,pageTotal:10}},mounted:function(){var t=s.a.session("userShop");this.ischain=t.currentShop.ischain,this.isBrand="3"!=this.ischain,"0"!=this.ischain&&"3"!=this.ischain||this.$store.commit("setPageTools",[{name:"添加来源",className:["addStaff","firstBtn"],fn:this.add,type:2},{name:"导出",className:["setTemp","export-btn"],fn:this.exportSource}]),this.getCountList()},components:{statisticsManagementWin:function(){return i.e("statistics_management_win").then(i.bind(null,"c038"))},comTable:function(){return i.e("table").then(i.bind(null,"4360"))}},methods:{getResult:function(t,e){if("ok"==t){if(""==e.name)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"请添加来源名称"}),!1;"edit"==this.types?this.editStaticId(e):"add"==this.types&&this.addStaticId(e)}this.showWin=!1},addStaticId:function(t){var e=this;return o(regeneratorRuntime.mark(function i(){var n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.a.addStaticId({data:t});case 2:n=i.sent,e.sourcesList.push(n),e.getCountList();case 5:case"end":return i.stop()}},i,e)}))()},editStaticId:function(t){var e=this;return o(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.a.editStaticId({data:t});case 2:e.getCountList();case 3:case"end":return i.stop()}},i,e)}))()},delSources:function(t,e){var i=this;this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确定要删除来源?",callback:function(n){"ok"==n&&(i.delStaticId(e),i.sourcesList.splice(i.sourcesList[t],1))}})},delStaticId:function(t){var e=this;return o(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.delStaticId({data:{id:t.id}});case 2:case"end":return e.stop()}},i,e)}))()},getCountList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i,n,s,o,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getCountList({data:{}});case 2:if(i=e.sent,t.sourcesList=i.list,0==t.sourcesList.length)t.hint=!0,t.sourcesList=[];else{for(n=i.count?i.count:[],s=t.sourcesList?t.sourcesList:[],o=0;o<s.length;o++)for(s[o].count=0,s[o].createTime=r.a.format(new Date(1e3*s[o].createTime),"yyyy-MM-dd"),c=0;c<n.length;c++)n[c].id==s[o].id&&(s[o].count=n[c].count);t.sourcesList=s,t.allTotal=s.length,t.sortSources()}t.totalFansNum=i.fissionNum.count;case 6:case"end":return e.stop()}},e,t)}))()},add:function(){this.isSources("add")},isSources:function(t,e){this.showWin=!0,this.types=t,this.itemDetial=e||{count:"0",imageUrl:"",name:"",id:""}},exportSource:function(){if(0==this.sourcesList.length)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"来源列表为空，没有数据可以导出"}),!1;this.getAllSourceList()},getAllSourceList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.getAllSourceList({data:{}});case 2:case"end":return t.stop()}},e,t)}))()},sortSources:function(){var t=this.sourcesList;this.sourcesList=t.sort(function(t,e){var i=parseInt(t.id),n=parseInt(e.id);if(i>n)return-1;if(i<n)return 1;var s=parseInt(t.createTime),a=parseInt(e.createTime);return s>a?-1:s<a?1:0})}},computed:{}},u=(i("0bdd"),i("6ceb")),l=Object(u.a)(c,n,[],!1,null,"22cb299b",null);l.options.__file="src\\module\\marketing_tools\\statistics_management.vue";e.default=l.exports},"55ca9":function(t,e,i){}}]);