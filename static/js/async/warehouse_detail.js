(window.webpackJsonp=window.webpackJsonp||[]).push([["warehouse_detail"],{"016a":function(e,t,a){},bc5e:function(e,t,a){"use strict";a.r(t);var i=a("f6ce"),r=a("bbb9"),n=a("81a2"),s=a("05dd");function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function i(r,n){try{var s=t[r](n),o=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)});e(o)}("next")})}}var l=null,u={data:function(){return{id:"",detail:{area:[]},gPage:1,gShowNum:10,gLength:0,mPage:1,mShowNum:10,mLength:0,dropList:["10","20"],tabIndex:1,configIndex:0,typeNameArr:[{value:-1,label:"全部商品类型"},{value:0,label:"普通商品"},{value:1,label:"称重商品"}],goodsType:-1,goodsName:"",matTypeList:[{value:"-1",label:"全部物料类型"},{value:"0",label:"成品"},{value:"1",label:"半成品"},{value:"2",label:"普通物料"}],matType:"-1",barCode:"",secBarCode:"",veri:["goodsName","barCode","secBarCode"],mName:"",allSort:[],oneSort:[],mCid:"",mCidOne:"",cidSel:[-1],goodsData:[],goodsList:[],materialData:"",materialList:[],filterObj:{},addressShow:!1,allMids:[],allGids:[]}},components:{pageBtn:function(){return a.e("page_element").then(a.bind(null,"5921"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},selectStore:function(){return a.e("select_store").then(a.bind(null,"cb83"))}},mounted:function(){this.initBtn();var e=i.a.session("inventConfigure");this.configIndex=e,this.tabIndex=2==e?2:1,this.id=this.$route.query.id,this.getWarehouseDetail(),this.getRequest(),1!=e&&0!=e||this.getGoodsList(),2!=e&&0!=e||(this.getCategoryList(),this.getMaterialList())},methods:{initBtn:function(){var e=this,t=[{name:"返回",className:"info",type:4,fn:function(){i.a.session("warehouseListsDestroy",!0),i.a.session("warehouseDetail",null),delete e.$route.query.id,delete e.$route.query.sid,e.$router.push({path:"/admin/warehouseList",query:e.$route.query})}}];this.$store.commit("setPageTools",t)},indexMethod:function(e){return this.gShowNum*(this.gPage-1)+e+1},indexMethodMat:function(e){return this.mShowNum*(this.mPage-1)+e+1},getWarehouseDetail:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.warehouseGetWarehouse({data:{id:e.id}});case 2:a=t.sent,e.detail=a,e.getAreaCn();case 5:case"end":return t.stop()}},t,e)}))()},getGoodsList:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.whGetInventoryGoodsList({data:{wid:e.id,type:e.goodsType,page:e.gPage,num:e.gShowNum}});case 2:a=t.sent,e.goodsList=a.list,e.gLength=Number(a.count);case 5:case"end":return t.stop()}},t,e)}))()},filterGoodsNum:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.whGetGoodsExactly({data:{wid:e.id,goodsName:e.goodsName,barCode:e.barCode,secBarCode:e.secBarCode,type:e.goodsType}});case 2:a=t.sent,e.goodsList=a,e.gLength=a.length?a.length:0;case 5:case"end":return t.stop()}},t,e)}))()},getMaterialList:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.whGetInventoryMaterialList({data:{wid:e.id,page:e.mPage,num:e.mShowNum,name:e.mName,cid:e.mCid>0?e.mCid:"",type:e.matType}});case 2:a=t.sent,e.materialList=a.list,e.mLength=Number(a.count);case 5:case"end":return t.stop()}},t,e)}))()},deleteReq:function(){var e=this;return o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.warehouseDeleteWarehouse({data:{id:e.id}});case 2:t.sent&&e.$router.push({path:"/admin/warehouseList",query:e.$route.query});case 4:case"end":return t.stop()}},t,e)}))()},getCategoryList:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var a,i,r,s,o,l,u,c,d,h,v,m,p,f,b,g,y,_,x,w,C;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.invoiv_getCategoryList();case 2:for(a=t.sent,e.allSort=a,i=[],r=!0,s=!1,o=void 0,t.prev=8,l=a[Symbol.iterator]();!(r=(u=l.next()).done);r=!0)0==(c=u.value).pid&&i.push({value:c.id,label:c.name,children:[]});t.next=16;break;case 12:t.prev=12,t.t0=t.catch(8),s=!0,o=t.t0;case 16:t.prev=16,t.prev=17,!r&&l.return&&l.return();case 19:if(t.prev=19,!s){t.next=22;break}throw o;case 22:return t.finish(19);case 23:return t.finish(16);case 24:i.unshift({value:-1,label:"全部分类"}),e.oneSort=i,d=!0,h=!1,v=void 0,t.prev=29,m=e.oneSort[Symbol.iterator]();case 31:if(d=(p=m.next()).done){t.next=57;break}for(f=p.value,b=[],g=!0,y=!1,_=void 0,t.prev=37,x=a[Symbol.iterator]();!(g=(w=x.next()).done);g=!0)C=w.value,f.value==C.pid&&b.push({value:C.id,label:C.name});t.next=45;break;case 41:t.prev=41,t.t1=t.catch(37),y=!0,_=t.t1;case 45:t.prev=45,t.prev=46,!g&&x.return&&x.return();case 48:if(t.prev=48,!y){t.next=51;break}throw _;case 51:return t.finish(48);case 52:return t.finish(45);case 53:b.length?f.children=b:delete f.children;case 54:d=!0,t.next=31;break;case 57:t.next=63;break;case 59:t.prev=59,t.t2=t.catch(29),h=!0,v=t.t2;case 63:t.prev=63,t.prev=64,!d&&m.return&&m.return();case 66:if(t.prev=66,!h){t.next=69;break}throw v;case 69:return t.finish(66);case 70:return t.finish(63);case 71:case"end":return t.stop()}},t,e,[[8,12,16,24],[17,,19,23],[29,59,63,71],[37,41,45,53],[46,,48,52],[64,,66,70]])}))()},getSortSel:function(e){e.length>1?(this.mCidOne=e[0],this.mCid=e[1]):this.mCid=e[0]},getAreaCn:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.e("area_cn").then(a.bind(null,"f529"));case 2:i=t.sent,l=i.default,e.detail.provinceName=l.getNameByCode(e.detail.province),e.detail.cityName=l.getNameByCode(e.detail.city),e.detail.townName=l.getNameByCode(e.detail.town),e.addressShow=!0;case 8:case"end":return t.stop()}},t,e)}))()},dropSelect:function(e){this.matType=e},getRequest:function(){var e=i.a.session("warehouseDetailDestroy"),t=i.a.session("warehouseDetailRequest");if(e&&t)for(var a in t)this[a]=t[a];var r=!0,n=!1,s=void 0;try{for(var o,l=this.allSort[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var u=o.value;this.mCid==u.pid&&this.cidSel.push(u.id)}}catch(e){n=!0,s=e}finally{try{!r&&l.return&&l.return()}finally{if(n)throw s}}this.cidSel.push(this.mCid),i.a.session("warehouseDetailDestroy",null),i.a.session("warehouseDetailRequest",null)},setWlSort:function(e){var t=[],a=!0,i=!1,r=void 0;try{for(var n,s=e[Symbol.iterator]();!(a=(n=s.next()).done);a=!0){var o=n.value;t.push(o.name)}}catch(e){i=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}return t.join(" , ")},deleteWarehouse:function(){var e=this;this.$store.commit("setWin",{title:"提示信息",winType:"confirm",content:"确认删除该仓库？",callback:function(t){"ok"==t&&e.deleteReq()}})},tabClick:function(e){var t=e.target;if("span"==t.tagName.toLocaleLowerCase()){var a=t.getAttribute("data-index");this.tabIndex=a}},changeWarehouse:function(){delete this.$route.query.sid,this.$router.push({path:"change",query:this.$route.query})},changeArea:function(){var e={area:this.detail.area,id:this.detail.id};i.a.session("warehouseArea",e),this.$router.push({path:"changeArea",query:this.$route.query})},listHandle:function(e,t){if(1==t){var a=e;a.wid=this.id,a.id=e.gid,i.a.session("goodsneed",a),i.a.session("warehouseDetailRequest",this.filterObj),this.$router.push({path:"warehouseGoodsDetail",query:this.$route.query})}else this.$route.query.id=e.id,this.$route.query.wid=this.id,delete this.$route.query.sid,i.a.session("warehouseDetailRequest",this.filterObj),this.$router.push({path:"warehouseMaterialDetail",query:this.$route.query})},gPageChange:function(e,t){t?this.gPage=e:this.gShowNum=e,this.setGoodsFilter(),this.getGoodsList()},mPageChange:function(e,t){t?this.mPage=e:this.mShowNum=e,this.filter()},filterClick:function(){this.page=1,this.filter()},filter:function(){if(1==this.tabIndex){var e=0,t=!0,a=!1,i=void 0;try{for(var r,n=this.veri[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){""==this[r.value].trim()&&e++}}catch(e){a=!0,i=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw i}}this.setGoodsFilter(),e>=3?this.getGoodsList():this.filterGoodsNum()}else 2==this.tabIndex&&(this.setMaterialFilter(),this.getMaterialList())},setGoodsFilter:function(){var e={goodsName:this.goodsName,barCode:this.barCode,goodsType:this.goodsType};this.filterObj=r.a.deepCopy(e),this.filterObj.tabIndex=1},setMaterialFilter:function(){var e={name:this.mName,mCid:this.mCid};this.filterObj=r.a.deepCopy(e),this.filterObj.tabIndex=2},resetGoods:function(){var e=!0,t=!1,a=void 0;try{for(var i,r=this.veri[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){this[i.value]=""}}catch(e){t=!0,a=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}this.goodsType=-1,this.gPage=1,this.gShowNum=10,this.getGoodsList()},reset:function(){this.cidSel=[-1],this.matType="-1",this.mName="",this.mCid="",this.mPage=1,this.mShowNum=10,this.filter()},codeInput:function(e){var t=e.target.value;t=t.replace(/[^\d]/g,""),isNaN(t)&&(t=""),this.barCode=t,e.target.value=t},setUnit:function(e,t){var a="",i="",r=1,n=!0,o=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var d=u.value;1==d.isMin?(i=d.name,1==d.isDefault&&(a=d.name,r=d.value)):1==d.isDefault&&(a=d.name,r=d.value)}}catch(e){o=!0,l=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw l}}return s.a.comUnit(e,r,a,i)},setWlType:function(e){if(0==e)return"物料"},selectType:function(e){this.goodsType=e,this.setGoodsFilter();var t=0,a=!0,i=!1,r=void 0;try{for(var n,s=this.veri[Symbol.iterator]();!(a=(n=s.next()).done);a=!0){""==this[n.value].trim()&&t++}}catch(e){i=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}t>=3?this.getGoodsList():this.filterGoodsNum()},getAddress:function(e){this.province=e.province,this.city=e.city,this.area=e.area}}},c=(a("db1c"),a("d801")),d=Object(c.a)(u,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"warehouse-detail"},[a("div",{staticClass:"detail-box"},[a("div",{staticClass:"title"},[e._v("\n\t\t\t仓库详情\n\t\t")]),e._v(" "),a("div",{staticClass:"word"},[a("div",{staticClass:"block"},[a("div",{staticClass:"item"},[a("em",[e._v("仓库名称：")]),e._v(e._s(e.detail.name))]),e._v(" "),a("div",{staticClass:"item"},[a("em",[e._v("区域总数：")]),e._v(e._s(e.detail.area.length))]),e._v(" "),a("div",{staticClass:"item"},[a("em",[e._v("仓库地址：")]),e._v(" "),e.addressShow?[e._v(e._s(e.detail.provinceName)+" "+e._s(e.detail.cityName)+" "+e._s(e.detail.townName)+" "+e._s(e.detail.place))]:e._e()],2)]),e._v(" "),a("div",{staticClass:"block"},[a("div",{staticClass:"item"},[a("em",[e._v("仓库编号：")]),e._v(e._s(e.detail.code))]),e._v(" "),a("div",{staticClass:"item"},[a("em",[e._v("商品种类：")]),e._v(e._s(Number(e.detail.KindWeightKg||e.detail.kindWeightKg)+Number(e.detail.kindGoods)+Number(e.detail.kindWeightG)))]),e._v(" "),a("div",{staticClass:"item"},[a("em",[e._v("物料种类：")]),e._v(e._s(e.detail.kindMaterial))])]),e._v(" "),a("div",{staticClass:"block"},[a("div",{staticClass:"item"},[a("em",[e._v("仓库所属：")]),e._v(e._s(e.detail.ownerName))])]),e._v(" "),a("div",{staticClass:"item handle"},[a("el-button",{attrs:{type:"primary"},on:{click:e.changeWarehouse}},[e._v("修改仓库")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:e.changeArea}},[e._v("修改区域")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:e.deleteWarehouse}},[e._v("删除")])],1)])]),e._v(" "),0==e.configIndex?a("div",{staticClass:"tab-box"},[a("el-radio-group",{model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("商品")]),e._v(" "),a("el-radio-button",{attrs:{label:"2"}},[e._v("物料")])],1)],1):e._e(),e._v(" "),a("div",{staticClass:"filter"},[1==e.tabIndex?[a("div",{staticClass:"block-box"},[a("div",{staticClass:"inline-box"},[a("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:e.goodsName,callback:function(t){e.goodsName=t},expression:"goodsName"}})],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("el-input",{attrs:{placeholder:"请输入条形码"},model:{value:e.barCode,callback:function(t){e.barCode=t},expression:"barCode"}})],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("el-input",{attrs:{placeholder:"请输入副条形码"},model:{value:e.secBarCode,callback:function(t){e.secBarCode=t},expression:"secBarCode"}})],1)]),e._v(" "),a("div",{staticClass:"block-box inline-box"},[a("el-select",{staticClass:"el-size",attrs:{placeholder:"请选择商品类型"},on:{change:e.selectType},model:{value:e.goodsType,callback:function(t){e.goodsType=t},expression:"goodsType"}},e._l(e.typeNameArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)]:e._e(),e._v(" "),2==e.tabIndex?[a("div",{staticClass:"block-box"},[a("div",{staticClass:"inline-box"},[a("el-input",{attrs:{placeholder:"请输入物料名称"},model:{value:e.mName,callback:function(t){e.mName=t},expression:"mName"}})],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("el-select",{staticClass:"el-size",attrs:{placeholder:"请选择物料类型"},on:{change:e.dropSelect},model:{value:e.matType,callback:function(t){e.matType=t},expression:"matType"}},e._l(e.matTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("el-cascader",{staticClass:"el-size",attrs:{options:e.oneSort},on:{change:e.getSortSel},model:{value:e.cidSel,callback:function(t){e.cidSel=t},expression:"cidSel"}})],1)])]:e._e(),e._v(" "),a("div",{staticClass:"block-box inline-box button-box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.filterClick}},[e._v("筛选")]),e._v(" "),1==e.tabIndex?a("el-button",{attrs:{type:"info"},on:{click:e.resetGoods}},[e._v("重置")]):e._e(),e._v(" "),2==e.tabIndex?a("el-button",{attrs:{type:"info"},on:{click:e.reset}},[e._v("重置")]):e._e()],1)],2),e._v(" "),a("div",{staticClass:"main"},[1==e.tabIndex?[a("div",{staticClass:"list"},[a("el-table",{key:1,staticStyle:{width:"100%"},attrs:{data:e.goodsList,stripe:"",border:""}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodsName",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"barCode",label:"条形码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"售价"}}),e._v(" "),a("el-table-column",{attrs:{label:"商品类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t        \t"+e._s(e.typeNameArr[Number(t.row.type)+1].label)+"\n\t\t\t\t      \t")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"库存数量/重量"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t        \t"+e._s(t.row.surplus)+e._s(t.row.unit)+"\n\t\t\t\t      \t")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次数量"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.listHandle(t.row,1)}}},[e._v("查看详情")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"page-box"},[a("el-pagination",{attrs:{"current-page":e.gPage,background:"",layout:"sizes,total,prev, pager, next","page-sizes":[10,20,50],total:e.gLength},on:{"current-change":function(t){e.gPageChange(t,1)},"size-change":e.gPageChange}})],1)]:e._e(),e._v(" "),2==e.tabIndex?[a("div",{staticClass:"list"},[a("el-table",{key:2,staticStyle:{width:"100%"},attrs:{data:e.materialList,stripe:"",border:""}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethodMat,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"物料名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t    \t\t"+e._s(e.matTypeList[Number(t.row.type)+1].label)+"\n\t\t\t\t    \t")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t    \t\t"+e._s(e.setWlSort(t.row.cate))+"\n\t\t\t\t    \t")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"库存数量/重量"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t        \t"+e._s(e.setUnit(t.row.surplus,t.row.unit))+"\n\t\t\t\t      \t")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次数量"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.listHandle(t.row,2)}}},[e._v("查看详情")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"page-box"},[a("el-pagination",{attrs:{"current-page":e.mPage,background:"",layout:"sizes,total,prev, pager, next","page-sizes":[10,20,50],total:e.mLength},on:{"current-change":function(t){e.mPageChange(t,1)},"size-change":e.mPageChange}})],1)]:e._e()],2)])},[],!1,null,"60983132",null);t.default=d.exports},db1c:function(e,t,a){"use strict";var i=a("016a");a.n(i).a}}]);