(window.webpackJsonp=window.webpackJsonp||[]).push([["employee_manage_win"],{"2ac3":function(e,t,n){"use strict";var i=n("ec87");n.n(i).a},adf5:function(e,t,n){"use strict";n.r(t);var i=n("81a2");function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function i(s,o){try{var r=t[s](o),a=r.value}catch(e){return void n(e)}if(!r.done)return Promise.resolve(a).then(function(e){i("next",e)},function(e){i("throw",e)});e(a)}("next")})}}var o={data:function(){return{index:-1,indexCopy:-1,info:{},isWarrantCode:!1,cancelStyle:null,okStyle:null,showJobs:!1,phoneStatus:0,repeatPwd:""}},props:{employeeId:"",employeeIndex:"",list:Array,isAdd:null,jobList:Array,ischain:Number},mounted:function(){this.cancelStyle={content:"取消",style:{backgroundColor:"#a0a0a0",color:"#fff "}},this.okStyle={content:"保存",style:{backgroundColor:"orange",color:"#fff"}},this.initEmployeeInfo()},methods:{userCheckExist:function(e){var t=this;return s(regeneratorRuntime.mark(function n(){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.userCheckExist({data:{mobile:e}});case 2:(s=n.sent)?(t.info.name=s.name,t.info.id=s.id,s.isShopUser?t.phoneStatus=3:t.phoneStatus=2):t.phoneStatus=1;case 4:case"end":return n.stop()}},n,t)}))()},addShopUser:function(e){var t=this;return s(regeneratorRuntime.mark(function n(){var s,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.addShopUser({data:{roleId:t.info.roleId,mobile:t.info.mobile,name:t.info.name,password:t.info.password,warrantCode:t.info.warrantCode}});case 2:(s=n.sent)&&void 0!==s.userId?((o=t.info).roleName=t.jobList[t.index].name,o.nodeIds=t.jobList[t.index].name,o.userName=o.name,o.userId=s.userId,t.$emit("throwWinResult",e,o)):t.$store.commit("setWin",{title:"错误提示",winType:"alter",content:"数据返回为空"});case 4:case"end":return n.stop()}},n,t)}))()},editShopUser:function(e){var t=this;return s(regeneratorRuntime.mark(function n(){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s={userId:t.employeeId,roleId:t.info.roleId,userName:t.info.name},t.info.warrantCode&&(s.warrantCode=t.info.warrantCode),n.next=4,i.a.editShopUser({data:s});case 4:n.sent?t.$emit("throwWinResult",e):t.$store.commit("setWin",{title:"错误提示",winType:"alter",content:"数据返回为空"});case 6:case"end":return n.stop()}},n,t)}))()},initEmployeeInfo:function(){var e=this;return s(regeneratorRuntime.mark(function t(){var n,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isAdd)e.isAdd&&(e.info={roleId:0,roleName:"",password:"",name:"",title:"",mobile:"",sort:255,isWarrantCode:!1});else{for((n=e.list[e.employeeIndex]).name=n.userName,e.info=n,i=0;i<e.jobList.length;i++)e.jobList[i].id+""==e.info.roleId+""&&(e.index=i);s=e.jobList[e.index],e.isWarrantCode=-1!=s.nodeIds.indexOf("3051")}case 1:case"end":return t.stop()}},t,e)}))()},sdAlert:function(e){this.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:e})},clickResult:function(e){var t=/^[\s]*$/;function n(){var e=this.info.name+"";if(t.test(e))return this.sdAlert("真实姓名不能为空"),!1;if(!/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9]|-|——|—)*$/.test(e))return this.sdAlert("姓名只能有中文和英文及数字组成，请输入正确的名称"),!1;if(-1===this.index)return this.sdAlert("请选择职位"),!1;var n=this.info.warrantCode+"";if(this.isWarrantCode){if(!/^[\d]*$/.test(n)||n.split("").length<4)return this.sdAlert("授权码格式错误,必须为四位数字"),!1}else this.info.warrantCode="";return!0}if("ok"==e){if(!this.info)return!0;var i=this.info;if(this.isAdd){var s=i.password+"";if(1!=this.phoneStatus&&2!=this.phoneStatus){if(0==this.phoneStatus){var o=i.mobile+"";return t.test(o)?(this.sdAlert("手机号码不能为空"),!1):(/^1[3|4|5|7|8]\d{9}$/.test(o)||this.sdAlert("填写正确的手机号码"),!1)}return this.sdAlert("该账户已经存在"),!1}if(!n.call(this))return!1;if(1==this.phoneStatus){if(t.test(s))return this.sdAlert("密码不能为空"),!1;if(!/^[a-zA-Z0-9]*$/.test(s))return this.sdAlert("密码只能由数字和字母组成"),!1;if(s.length<6||s.length>20)return this.sdAlert("密码长度6到20位"),!1;if(s!==this.repeatPwd+"")return this.sdAlert("两次密码输入不一致"),!1}this.addShopUser(e)}else{if(!n.call(this))return!1;this.editShopUser(e)}}"cancel"==e&&this.$emit("throwWinResult",e),"close"==e&&this.$emit("throwWinResult",e)},checkMobile:function(){var e=this.info.mobile+"";11!==e.length?(this.info={roleId:0,roleName:"",roleType:"0",password:"",name:"",mobile:e,isWarrantCode:!1,sellerRole:""},this.phoneStatus=0):/^1\d{10}$/.test(e)?this.userCheckExist(e):(this.sdAlert("手机号码格式错误"),this.phoneStatus=0)},showJobFn:function(){1!=this.phoneStatus&&2!=this.phoneStatus&&0!=this.isAdd||(this.showJobs=!0)},jobWinFn:function(e,t){"ok"===e&&(this.index=t,this.info&&this.jobList&&-1!=t&&(this.info.roleId=this.jobList[t].id,this.isWarrantCode=-1!=this.jobList[t].nodeIds.indexOf("3051"))),this.showJobs=!1}},components:{win:function(){return n.e("win").then(n.bind(null,"f60a"))},SelectJob:function(){return n.e("select_job").then(n.bind(null,"96e4"))},radioBtn:function(){return n.e("radio_btn").then(n.bind(null,"4dfe"))}},computed:{mobile:{get:function(){return this.info.mobile},set:function(e){this.info.mobile=e.replace(/[^\d]/g,"")}}}},r=(n("2ac3"),n("d801")),a=Object(r.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("win",{attrs:{align:"right",width:580,height:"380",ok:e.okStyle,cancel:e.cancelStyle},on:{winEvent:e.clickResult}},[n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.isAdd?"新建员工信息":"修改员工信息"))]),e._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},[n("section",{staticStyle:{padding:"10px 20px"}},[n("el-form",{ref:"info",attrs:{model:e.info,"label-width":"120px"}},[n("el-form-item",{attrs:{required:"",label:"手机号码"}},[n("el-input",{staticStyle:{width:"280px"},attrs:{disabled:!e.isAdd,maxlength:"11",placeholder:"请输入手机号码"},on:{input:e.checkMobile},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}}),e._v(" "),3==e.phoneStatus?n("span",{staticStyle:{color:"red"}},[e._v("该账户已经存在!")]):e._e()],1),e._v(" "),n("el-form-item",{attrs:{required:"",label:"真实姓名"}},[e.isAdd?n("el-input",{staticStyle:{width:"280px"},attrs:{disabled:1!==e.phoneStatus,maxlength:"14",placeholder:"请输入姓名"},model:{value:e.info.name,callback:function(t){e.$set(e.info,"name",t)},expression:"info.name"}}):n("el-input",{staticStyle:{width:"280px"},attrs:{maxlength:"14",placeholder:"请输入姓名"},model:{value:e.info.name,callback:function(t){e.$set(e.info,"name",t)},expression:"info.name"}})],1),e._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isAdd&&2!=e.phoneStatus,expression:"isAdd && phoneStatus!= 2"}],attrs:{required:"",label:"设置登录密码"}},[n("el-input",{staticStyle:{width:"280px"},attrs:{disabled:0==e.phoneStatus||3==e.phoneStatus,type:"password",maxlength:"20",placeholder:"请输入登录密码"},model:{value:e.info.password,callback:function(t){e.$set(e.info,"password",t)},expression:"info.password"}})],1),e._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isAdd&&2!=e.phoneStatus,expression:"isAdd && phoneStatus!= 2"}],attrs:{required:"",label:"确认登录密码"}},[n("el-input",{staticStyle:{width:"280px"},attrs:{disabled:0==e.phoneStatus||3==e.phoneStatus,type:"password",maxlength:"20",placeholder:"请输入登录密码"},model:{value:e.repeatPwd,callback:function(t){e.repeatPwd=t},expression:"repeatPwd"}})],1),e._v(" "),n("el-form-item",{attrs:{required:"",label:"职位"}},[e.jobList[e.index]?[n("span",{class:0==e.ischain?"":e.jobList[e.index]&&(e.jobList[e.index].id>=1e5||0==e.jobList[e.index].id)?"sdOrange":"sdBlue"},[e._v(e._s(e.jobList[e.index]?e.jobList[e.index].name:""))]),e._v(" "),n("i",{staticClass:"el-icon-edit-outline",staticStyle:{"font-size":"23px","margin-left":"20px","line-height":"28px",color:"#a0a0a0"},on:{click:e.showJobFn}})]:n("el-button",{staticStyle:{width:"150px"},attrs:{disabled:0==e.phoneStatus||3==e.phoneStatus,type:"primary"},on:{click:e.showJobFn}},[e._v("添加职位")])],2),e._v(" "),!e.isAdd&&e.info.sellerRole?n("el-form-item",{attrs:{label:"卖手职位"}},[n("span",[e._v(e._s(e.info.sellerRole))])]):e._e(),e._v(" "),e.isWarrantCode?n("el-form-item",{attrs:{label:"授权码"}},[n("el-input",{staticStyle:{width:"180px"},attrs:{maxlength:"4",placeholder:"请输入授权码"},model:{value:e.info.warrantCode,callback:function(t){e.$set(e.info,"warrantCode",t)},expression:"info.warrantCode"}})],1):e._e()],1)],1)])]),e._v(" "),e.showJobs?n("select-job",{attrs:{jobList:e.jobList,title:"选择员工职位",index:e.index,ischain:+e.ischain},on:{winEvent:e.jobWinFn}}):e._e()],1)},[],!1,null,"00e5de14",null);t.default=a.exports},ec87:function(e,t,n){}}]);