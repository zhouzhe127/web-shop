(window.webpackJsonp=window.webpackJsonp||[]).push([["base_brand"],{"1de6":function(t,e,s){"use strict";s.r(e);var i=s("81a2"),a=s("f6ce"),n=s("bbb9");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,s){return function i(a,n){try{var o=e[a](n),r=o.value}catch(t){return void s(t)}if(!o.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var r={data:function(){return{rules:{brandName:[{required:!0,message:"请输入品牌名称",trigger:"blur"},{min:3,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],industry:[{required:!0,message:"请选择行业分类",trigger:"blur"}],contactMan:[{required:!0,message:"请输入负责人",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}],telephone:[{required:!0,message:"请输入联系方式",trigger:"blur"},{min:7,max:20,message:"长度在 7 到 20 个字符"}]},baseDetial:{},imgHost:"",logoImage:"",userData:null,status:0,shopListDel:{},brandIndex:-1,shopList:[],industryList:[],industryIndex:"1",shopId:"",inSe:"",oldShopList:[]}},mounted:function(){this.userData=a.a.session("userShop"),this.shopId=this.userData.currentShop.id;for(var t=this.userData.shopList.brand,e=0;e<t.length;e++)this.shopId==t[e].id&&(this.shopListDel=t[e],this.brandIndex=e);this.shopList=this.shopListDel.direct,this.shopList=n.a.sortByAll(this.shopList,"sort"),this.oldShopList=this.shopListDel.direct,this.oldShopList=n.a.sortByAll(this.oldShopList,"sort"),this.imgHost=this.userData.uploadUrl,this.comShopIndex(),this.baseGet()},components:{selectBtn:function(){return s.e("select_btn").then(s.bind(null,"3d41"))}},methods:{getOidList:function(){this.inSe="",this.shopList=0==this.status?this.shopListDel.direct:this.shopListDel.franchise,this.oldShopList=0==this.status?this.shopListDel.direct:this.shopListDel.franchise,this.comShopIndex()},secShop:function(){console.log(this.inSe);for(var t=[],e=0;e<this.oldShopList.length;e++)-1!=this.oldShopList[e].name.indexOf(this.inSe)&&t.push(this.oldShopList[e]);this.shopList=t},comShopIndex:function(){for(var t=0;t<this.shopList.length;t++)this.shopList[t].sort=t+1},tackUp:function(t,e){0!=e&&(this.shopList.splice(e,1),this.shopList.unshift(t),this.comShopIndex())},tackUpOne:function(t,e){0!=e&&(this.shopList.splice(e,1),this.shopList.splice(e-1,1,t,this.shopList[e-1]),this.comShopIndex())},tackDown:function(t,e){e!=this.shopList.length-1&&(this.shopList.splice(e,1),this.shopList.push(t),this.comShopIndex())},tackDownOne:function(t,e){e!=this.shopList.length-1&&(this.shopList.splice(e,1,this.shopList[e+1],t),this.shopList.splice(e+2,1),this.comShopIndex())},changeShop:function(t,e){var s=this,i="1"==t.ischain?"加盟店":"直营店",n='确认是否将 "'+t.name+'" 转换为'+i;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:n,callback:function(i){"ok"==i&&(s.updateShopType(t),s.shopList.splice(e,1),"1"==t.ischain?(t.ischain="2",t.sort=s.shopListDel.franchise.length,s.shopListDel.franchise.push(t)):(t.ischain="1",t.sort=s.shopListDel.direct.length,s.shopListDel.direct.push(t)),s.comShopIndex(),a.a.session("userShop",s.userData))}})},updateShopType:function(t){var e=this;return o(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,i.a.updateShopType({data:{id:t.id,type:"1"==t.ischain?"2":"1"}});case 2:s.sent&&e.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"切换成功"});case 4:case"end":return s.stop()}},s,e)}))()},getindustryList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.GetIndustry({data:{}});case 2:t.industryList=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},baseGet:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.GetIndustry({data:{}});case 2:return t.industryList=e.sent,e.next=5,i.a.brandgetConfig({data:{}});case 5:t.baseDetial=e.sent,t.industryIndex=t.baseDetial.industry;case 7:case"end":return e.stop()}},e,t)}))()},baseUpdate:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var s,n,o,r,l,c,p,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(s=[],n=[],o=0;o<t.shopListDel.direct.length;o++)t.shopListDel.direct[o].sort=o+1,0==t.shopListDel.direct[o].status&&((r={}).shopId=t.shopListDel.direct[o].id,r.shopName=t.shopListDel.direct[o].name,r.sort=t.shopListDel.direct[o].sort,s.push(r));for(l=0;l<t.shopListDel.franchise.length;l++)t.shopListDel.franchise[l].sort=l+1,0==t.shopListDel.franchise[l].status&&((c={}).shopId=t.shopListDel.franchise[l].id,c.shopName=t.shopListDel.franchise[l].name,c.sort=t.shopListDel.franchise[l].sort,n.push(c));return e.next=6,i.a.brandSetConfig({data:{industry:t.industryIndex,brandName:t.baseDetial.brandName,contactMan:t.baseDetial.contactMan,telephone:t.baseDetial.telephone,logoImage:t.baseDetial.logoImage,license:t.baseDetial.license,directSort:s,joinSort:n}});case 6:p=e.sent,t.baseDetial.id=t.shopId,p&&(h=t.baseDetial.brandName,t.shopListDel.name=t.baseDetial.brandName,t.shopListDel.contactMan=t.baseDetial.contactMan,t.shopListDel.logoImage=t.baseDetial.logoImage,t.shopListDel.telephone=t.baseDetial.telephone,t.shopListDel.industry=t.industryIndex,t.userData.shopList.brand.splice(t.brandIndex,1,t.shopListDel),t.userData.currentShop=t.baseDetial,t.userData.currentShop.name=h,t.userData.currentShop.newName=h,a.a.session("userShop",t.userData),t.$store.commit("setlogoName",h),t.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"店铺信息修改成功"}));case 9:case"end":return e.stop()}},e,t)}))()},send:function(){return""==this.baseDetial.brandName?(this.$store.commit("setWin",{title:"错误提示",winType:"alert",content:"品牌名称不能为空"}),!1):""==this.baseDetial.telephone?(this.$store.commit("setWin",{title:"错误提示",winType:"alert",content:"联系方式不能为空"}),!1):void this.baseUpdate()},fileNameChange:function(t){var e=this;return o(regeneratorRuntime.mark(function s(){var a;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return console.log(t),s.next=3,i.a.uploadImg({formId:"imageUpForm",data:{type:8,shopId:e.shopId}});case 3:a=s.sent,e.baseDetial.logoImage=a;case 5:case"end":return s.stop()}},s,e)}))()},fileNameChange2:function(t){var e=this;return o(regeneratorRuntime.mark(function s(){var a;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return console.log(t),s.next=3,i.a.uploadImg({formId:"imageUpForm2",data:{type:8,shopId:e.shopId}});case 3:a=s.sent,e.baseDetial.license=a;case 5:case"end":return s.stop()}},s,e)}))()}}},l=(s("7e47"),s("d801")),c=Object(l.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticStyle:{"text-align":"left","min-width":"600px"},attrs:{id:"brandBase"}},[i("el-form",{ref:"baseDetial",staticClass:"demo-ruleForm",attrs:{model:t.baseDetial,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"品牌名称",prop:"brandName"}},[i("el-input",{staticStyle:{width:"300px"},model:{value:t.baseDetial.brandName,callback:function(e){t.$set(t.baseDetial,"brandName",e)},expression:"baseDetial.brandName"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"行业分类",prop:"industryIndex"}},[i("el-select",{attrs:{placeholder:"请选择行业分类"},model:{value:t.industryIndex,callback:function(e){t.industryIndex=e},expression:"industryIndex"}},t._l(t.industryList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"负责人",prop:"contactMan",placeholder:"请输入负责人"}},[i("el-input",{staticStyle:{width:"300px"},model:{value:t.baseDetial.contactMan,callback:function(e){t.$set(t.baseDetial,"contactMan",e)},expression:"baseDetial.contactMan"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"联系方式",prop:"telephone",placeholder:"请输入联系方式"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{maxlength:"20"},model:{value:t.baseDetial.telephone,callback:function(e){t.$set(t.baseDetial,"telephone",e)},expression:"baseDetial.telephone"}})],1)],1),t._v(" "),i("div",{staticClass:"line",staticStyle:{height:"150px"}},[i("section",{staticClass:"imgBox"},[i("span",{staticClass:"ltitle req",staticStyle:{height:"150px","margin-right":"20px"}},[t._v("品牌LOGO\n\t\t\t\t")]),t._v(" "),i("form",{attrs:{id:"imageUpForm",enctype:"multipart/form-data"}},[i("input",{staticClass:"imgInput",attrs:{type:"file",accept:"image/jpeg,image/png,image/image/tiff",id:"file_upload",name:"image"},on:{change:t.fileNameChange}})]),t._v(" "),""==t.baseDetial.logoImage?i("section",{staticClass:"imgsize",staticStyle:{border:"1px solid #C0C0C0"}},[i("img",{staticStyle:{width:"47px",height:"47px","margin-left":"50px","margin-top":"25px"},attrs:{src:s("f518")}}),t._v(" "),i("section",{staticClass:"imgBottom"},[t._v("添加品牌LOGO")])]):t._e(),t._v(" "),""!=t.baseDetial.logoImage?i("section",{staticClass:"imgsize"},[i("img",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"imgs",src:t.imgHost+t.baseDetial.logoImage}}),t._v(" "),i("section",{staticClass:"imgBottom"},[t._v("更改LOGO")])]):t._e()]),t._v(" "),i("section",{staticClass:"imgBox"},[i("span",{staticClass:"ltitle",staticStyle:{height:"150px","margin-right":"20px",width:"100px"}},[t._v("商标")]),t._v(" "),i("form",{attrs:{id:"imageUpForm2",enctype:"multipart/form-data"}},[i("input",{staticClass:"imgInput",attrs:{type:"file",accept:"image/jpeg,image/png,image/image/tiff",id:"file_upload2",name:"image"},on:{change:t.fileNameChange2}})]),t._v(" "),""==t.baseDetial.license?i("section",{staticClass:"imgsize",staticStyle:{border:"1px solid #C0C0C0"}},[i("img",{staticStyle:{width:"47px",height:"47px","margin-left":"50px","margin-top":"25px"},attrs:{src:s("f518")}}),t._v(" "),i("section",{staticClass:"imgBottom"},[t._v("添加商标")])]):t._e(),t._v(" "),""!=t.baseDetial.license?i("section",{staticClass:"imgsize"},[i("img",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"imgs",src:t.imgHost+t.baseDetial.license}}),t._v(" "),i("section",{staticClass:"imgBottom"},[t._v("更改商标")])]):t._e()])]),t._v(" "),i("div",{staticClass:"line",staticStyle:{height:"auto"}},[i("div",{staticClass:"ltitle"},[t._v("门店排序:")]),t._v(" "),i("section",{staticClass:"oCont"},[i("div",{staticClass:"Box"},[i("el-radio-group",{on:{change:t.getOidList},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[i("el-radio-button",{attrs:{label:"0"}},[t._v("直营店")]),t._v(" "),i("el-radio-button",{attrs:{label:"1"}},[t._v("加盟店")])],1),t._v(" "),i("section",{staticClass:"oDe",staticStyle:{width:"200px",float:"right"}},[i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入店铺名称",clearable:""},on:{change:t.secShop},model:{value:t.inSe,callback:function(e){t.inSe=e},expression:"inSe"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.secShop},slot:"append"})],1)],1)],1),t._v(" "),i("div",{staticClass:"oBox"},[i("el-table",{attrs:{data:t.shopList,align:"center","sort-by":"sort","header-cell-style":{"background-color":"#f5f7fa"}}},[i("el-table-column",{attrs:{prop:"sort",stripe:"",label:"序号",width:"80",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"name",label:"店铺名",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"",label:"置顶",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"fi fi-arrow-up-end oSpan",on:{click:function(s){t.tackUp(e.row,e.$index)}}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"",label:"上移",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"fi fi-arrow-up oSpan",on:{click:function(s){t.tackUpOne(e.row,e.$index)}}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"",label:"下移",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"fi fi-arrow-down oSpan",on:{click:function(s){t.tackDownOne(e.row,e.$index)}}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"",label:"置底",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"fi fi-arrow-down-end oSpan",on:{click:function(s){t.tackDown(e.row,e.$index)}}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"",label:"切换门店",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{staticClass:"el-icon-sort",staticStyle:{"font-size":"20px",transform:"rotate(90deg)","font-weight":"bold"},on:{click:function(s){t.changeShop(e.row,e.$index)}}})]}}])})],1)],1)])]),t._v(" "),i("div",{staticStyle:{width:"300px","padding-left":"50px"}},[i("el-button",{staticStyle:{width:"150px"},attrs:{type:"primary"},on:{click:t.send}},[t._v("修改店铺信息")])],1)],1)},[],!1,null,"35ed570c",null);e.default=c.exports},"7e47":function(t,e,s){"use strict";var i=s("95a7");s.n(i).a},"95a7":function(t,e,s){},f518:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAvCAYAAABzJ5OsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKxJREFUeNrs2LENgzAQhWE7ygAZgQ2yApsk9S1hGMJeB7ERGzhHh+w0EXdF0P8ky9IV8BVH8Yi11mCdUsqg1/s4E5HJ+j334JMdn5qZOf4W/jjgwYMHDx48ePDgwYMHD/7XxJxzV5aNOuyrmc0eBfxbWfZIYm2ugt/XZtOzGj/3oefZzFbzD9bpj9mo13KciUhkbcCDBw8ePHjw4MGDBw8e/MkC7hGPUt/lI8AAt9oYPL6CVYkAAAAASUVORK5CYII="}}]);