(window.webpackJsonp=window.webpackJsonp||[]).push([["good_sale"],{"05cc":function(t,e,i){},"68b1":function(t,e,i){"use strict";i.r(e);var n=i("81a2"),s=i("f6ce");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(s,o){try{var a=e[s](o),l=a.value}catch(t){return void i(t)}if(!a.done)return Promise.resolve(l).then(function(t){n("next",t)},function(t){n("throw",t)});t(l)}("next")})}}var a={data:function(){return{list:[],newrecordList:[],currentList:[],userData:Object,isAdd:!1,isOpenWin:!1,item:Object,jobIndex:"",positionName:"",allGid:[],options:[{value:0,label:"全部"},{value:1,label:"单品起售"},{value:2,label:"多品联动起售"}],selectedType:"",num:10,total:0,page:1,titleData:[],bannerStyle:null,contentStyle:null}},created:function(){this.titleData=[{titleName:"操作",titleStyle:{width:"200px"}},{titleName:"起售类型",titleStyle:{width:"150px"}},{titleName:"商品名称",dataName:"goodsName"},{titleName:"起售数量",dataName:"num",titleStyle:{width:"200px"}}],this.bannerStyle={backgroundColor:"#F2F2F2",color:"#434149",fontSize:"16px"},this.contentStyle={color:"#666666",fontSize:"14px"}},mounted:function(){this.userData=s.a.session("userShop"),this.$store.commit("setPageTools",[{name:"添加起售商品",className:["addStaff","export-btn"],fn:this.openShop,type:2}]),this.getList()},watch:{currentList:{handler:function(t){0==t.length&&this.page>1&&(this.page=this.page-1,this.paging(1))}}},methods:{openShop:function(){this.item={},this.isAdd=!0,this.isOpenWin=!0},getList:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.goodsleastGetList({data:{}});case 2:(i=e.sent)&&(t.list=i,t.newrecordList=i,t.paging(),t.allGid=[],t.getAllGid());case 4:case"end":return e.stop()}},e,t)}))()},getAllGid:function(){for(var t=0;t<this.list.length;t++)this.allGid=this.allGid.concat(this.list[t].gid.split(","))},toEdit:function(t,e){this.item=t,this.jobIndex=(this.page-1)*this.num+e,this.isOpenWin=!0,this.isAdd=!1},deleteJob:function(t,e){var i=this;return o(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,n.a.GoodsleastDelete({data:{id:t.id}});case 2:s.sent&&(i.newrecordList.splice((i.page-1)*i.num+e,1),i.paging(1),i.list=i.newrecordList,i.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"删除成功"}),i.allGid=[],i.getAllGid());case 4:case"end":return s.stop()}},s,i)}))()},delJob:function(t,e){var i=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:"确定删除该商品的起售配置?",callback:function(n){"ok"==n&&i.deleteJob(t,e)}})},doThrowWinResult:function(t){"ok"==t?(this.paging(1),this.list=this.newrecordList,this.isAdd?(this.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"添加成功"}),this.allGid=[],this.getAllGid()):this.$store.commit("setWin",{title:"操作提示",winType:"alter",content:"修改成功"}),this.isOpenWin=!1):"cancel"==t?this.isOpenWin=!1:"close"==t&&(this.isOpenWin=!1)},searchPosition:function(){var t=this,e=[];e=""==this.positionName&&0==this.selectedType?this.list:""!=this.positionName&&0==this.selectedType?this.list.filter(function(e){return-1!=e.goodsName.indexOf(t.positionName)}):0!=this.selectedType&&""==this.positionName?this.list.filter(function(e){return Number(e.type)==t.selectedType}):this.list.filter(function(e){return-1!=e.goodsName.indexOf(t.positionName)&&Number(e.type)==t.selectedType}),this.newrecordList=e,this.paging()},resetSearch:function(){this.positionName="",this.selectedType=0,this.options=["全部","单品起售","多品联动起售"],this.getList()},numChange:function(t){this.num=t,this.pageChange(),console.log(t)},pageClick:function(t){this.page=t,this.pageChange(),console.log(t)},pageChange:function(){this.total=Math.ceil(this.newrecordList.length/this.num),this.currentList=this.newrecordList.slice((this.page-1)*this.num,(this.page-1)*this.num+this.num)},paging:function(t){this.total=Math.ceil(this.newrecordList.length/this.num),1!=t&&(this.page=1),this.currentList=this.newrecordList.slice((this.page-1)*this.num,(this.page-1)*this.num+this.num)}},components:{goodSaleWin:function(){return i.e("./good_sale_win").then(i.bind(null,"38a7"))}}},l=(i("d131"),i("d801")),r=Object(l.a)(a,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"joblist"}},[i("section",{staticClass:"top"},[i("section",{staticClass:"fl",staticStyle:{"margin-right":"20px"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择起售类型"},model:{value:t.selectedType,callback:function(e){t.selectedType=e},expression:"selectedType"}},t._l(t.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),i("section",{staticClass:"fl top_input"},[i("el-input",{staticStyle:{width:"220px"},attrs:{clearable:"",placeholder:"请输入起售商品名称"},model:{value:t.positionName,callback:function(e){t.positionName=e},expression:"positionName"}})],1),t._v(" "),i("a",{staticClass:"blue btn",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.searchPosition()}}},[t._v("筛选")]),t._v(" "),i("a",{staticClass:"gray btn",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.resetSearch()}}},[t._v("重置")])]),t._v(" "),i("section",[i("el-table",{ref:"multipleTable",staticStyle:{width:"90%"},attrs:{stripe:"","header-cell-style":{"background-color":"#f5f7fa"},data:t.currentList,border:""}},[i("el-table-column",{attrs:{fixed:"","min-width":"100",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"#FE8D2C",cursor:"pointer"},on:{click:function(i){t.toEdit(e.row,e.$index)}}},[t._v("编辑")]),t._v(" "),i("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),i("span",{staticStyle:{color:"#FD3F1F",cursor:"pointer"},on:{click:function(i){t.delJob(e.row,e.$index)}}},[t._v("删除")])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center","min-width":"100",label:"起售类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(1==e.row.type?"单品起售":"多品联动起售"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"goodsName",label:"商品名称"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"50",prop:"num",align:"center",label:"起售数量"}})],1)],1),t._v(" "),i("section",{staticStyle:{"margin-top":"10px"}},[i("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.num,layout:"sizes, prev, pager, next","page-count":t.total,"page-sizes":[10,20,30]},on:{"size-change":t.numChange,"current-change":t.pageClick}})],1),t._v(" "),t.isOpenWin?i("goodSaleWin",{attrs:{item:t.item,isAdd:t.isAdd,jobIndex:t.jobIndex,newrecordList:t.newrecordList,allGid:t.allGid},on:{throwWinResult:t.doThrowWinResult}}):t._e()],1)},[],!1,null,"1c8314b2",null);e.default=r.exports},d131:function(t,e,i){"use strict";var n=i("05cc");i.n(n).a}}]);