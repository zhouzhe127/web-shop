(window.webpackJsonp=window.webpackJsonp||[]).push([["coupon_management"],{"588c":function(n,t,e){},"894b":function(n,t,e){"use strict";var o=e("588c");e.n(o).a},b366:function(n,t,e){"use strict";e.r(t);var o=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[0==n.couponType?e("section",{attrs:{id:"management"}},[e("div",{attrs:{id:"test"}},[e("div",{staticClass:"oClickBox",on:{click:n.showCalendar}},[e("span",{staticClass:"oSpan"},[n._v(n._s(n.start)+" ---- "+n._s(n.end))]),n._v(" "),e("span",{staticClass:"down"})]),n._v(" "),e("a",{staticStyle:{"background-color":"#29A7E1","margin-left":"-4px"},attrs:{href:"javascript:void(0)"},on:{click:n.seachData}},[e("span",{staticClass:"search"})]),n._v(" "),n.isShowCa?e("can-multi",{attrs:{apartDays:n.days,sideStart:n.atime,sideEnd:n.btime},on:{castTime:n.getAddAlltime,closeCan:function(){n.isShowCa=!1}}}):n._e()],1),n._v(" "),e("section",{staticStyle:{width:"100%",height:"100%"},on:{click:n.closeDate}},[e("div",{staticStyle:{width:"100%",height:"50px"}},n._l(n.bannerList,function(t,o){return e("section",{key:o,staticClass:"diel",class:{on:n.indexOn==o},on:{click:function(){n.inte(o),n.page=1}}},[n._v(n._s(t.name))])})),n._v(" "),e("com-table",{attrs:{listHeight:60,showHand:!1,listName:"优惠券列表",showTitle:2,listWidth:1300,introData:n.couponList,titleData:n.titleList},scopedSlots:n._u([{key:"con-0",fn:function(t){return e("div",{},[n._v(n._s(n.returnTime(t.data.createTime)))])}},{key:"con-2",fn:function(t){return e("div",{},[n._v(n._s(n.getEndTime(t.data)))])}},{key:"con-3",fn:function(t){return e("div",{},[n._v("\n\t\t\t\t\t"+n._s(n.couponTypeList[t.data.type])+"\n\t\t\t\t")])}},{key:"con-4",fn:function(t){return e("div",{},[1==n.ischain||2==n.ischain?e("div",{staticClass:"align_item"},[e("section",{staticStyle:{"border-bottom":"1px solid #fff","background-color":"#FF9800",color:"#fff"},on:{click:function(e){n.opencoupons(t.index,t.data)}}},[n._v("查看详情")])]):e("div",{staticClass:"align_item"},[e("section",{staticStyle:{"border-bottom":"1px solid #fff","background-color":"#28A8E0",color:"#fff"},on:{click:function(e){n.unbundlingCoupon(t.data)}}},[n._v("同步")]),n._v(" "),e("section",{staticStyle:{"border-bottom":"1px solid #fff","background-color":"#FF9800",color:"#fff"},on:{click:function(e){n.opencoupons(t.index,t.data)}}},[n._v("查看详情")]),n._v(" "),e("section",{staticStyle:{"border-bottom":"1px solid #fff","background-color":"#858585",color:"#fff"},on:{click:function(e){n.modfycoupons(t.data)}}},[n._v("修改")]),n._v(" "),e("section",{staticStyle:{"border-bottom":"1px solid #fff","background-color":"#A7A7A7",color:"#fff"},on:{click:function(e){n.deletecoupons(t.data)}}},[n._v("删除")])])])}}])}),n._v(" "),e("footer",{staticClass:"worker_staff_footer"},[n.total>1?e("page",{attrs:{page:n.page,total:n.total,len:10},on:{pageNum:n.pageChange}}):n._e()],1)],1)]):n._e(),n._v(" "),1==n.couponType||2==n.couponType?e("breakCoupon",{attrs:{couponDetail:n.couponDetail},on:{changeMnage:n.getcouponResult}}):n._e(),n._v(" "),3==n.couponType||4==n.couponType?e("discountCoupon",{attrs:{couponDetail:n.couponDetail},on:{changeMnage:n.getcouponResult}}):n._e(),n._v(" "),5==n.couponType?e("giveCoupon",{attrs:{couponDetail:n.couponDetail},on:{changeMnage:n.getcouponResult}}):n._e(),n._v(" "),6==n.couponType?e("vouchersCoupon",{attrs:{couponDetail:n.couponDetail},on:{changeMnage:n.getcouponResult}}):n._e(),n._v(" "),7==n.couponType?e("intergralcardCoupon",{attrs:{couponDetail:n.couponDetail},on:{changeMnage:n.getcouponResult}}):n._e(),n._v(" "),n.showCoupon?e("coupon-manage-win",n._b({on:{changeCoupon:n.toEditCoupon}},"coupon-manage-win",n.couponInfo,!1)):n._e(),n._v(" "),n.unbindWin?e("maunBundling",{on:{getAppliedWin:n.getResult}}):n._e()],1)};o._withStripped=!0;var i=e("81a2"),a=e("f6ce"),c=e("bbb9");function u(n){return function(){var t=n.apply(this,arguments);return new Promise(function(n,e){return function o(i,a){try{var c=t[i](a),u=c.value}catch(n){return void e(n)}if(!c.done)return Promise.resolve(u).then(function(n){o("next",n)},function(n){o("throw",n)});n(u)}("next")})}}var s={data:function(){return{ischain:"",couponList:[],page:1,total:"",index:null,pageNum:10,pageCount:0,atime:c.a.getTime({time:new Date}).start,btime:c.a.getTime({time:new Date}).end,days:0,indexOn:0,bannerList:[{index:0,name:"未关联"},{index:1,name:"已关联"},{index:-1,name:"已过期"}],isShowCa:!1,changeMnage:!0,showCoupon:!1,couponInfo:"",titleList:[{titleName:"创建时间",titleStyle:{width:"200px",flex:"none",fontSize:"16px"},dataName:"createTime"},{titleName:"优惠券名称",dataName:"name",titleStyle:{fontSize:"16px"}},{titleName:"到期时间",titleStyle:{fontSize:"16px"}},{titleName:"类型",dataName:"type",titleStyle:{fontSize:"16px"}},{titleName:"操作",titleStyle:{fontSize:"16px"}}],allTotal:100,pageTotal:10,couponType:0,couponDetail:Object,couponTypeList:{1:"单品减免",2:"整单减免",3:"单品打折",4:"整单打折",5:"赠菜",6:"代金券",7:"积分卡券"},unbindWin:!1,asyncId:""}},computed:{start:{get:function(){return c.a.format(new Date(this.atime),"yyyy-MM-dd")}},end:{get:function(){return c.a.format(new Date(this.btime),"yyyy-MM-dd")}},day:{get:function(){return Math.floor((this.btime-this.atime)/864e5)}}},methods:{pageChange:function(n){this.page=n.page,this.inte(this.indexOn)},toEditCoupon:function(n){"nochange"==n?this.showCoupon=!1:(this.showCoupon=!1,this.couponDetail=n,this.couponType=n.type)},returnTime:function(n){return n-=0,n*=1e3,c.a.format(new Date(n),"yyyy-MM-dd")},getEndTime:function(n){var t=c.a.deepCopy(n);return 0==t.validityType?"领券后"+t.relativeTime+"天过期":1==t.validityType?(t.endTime-=0,t.endTime=1e3*t.endTime,c.a.format(new Date(t.endTime),"yyyy-MM-dd")+"过期"):void 0},inte:function(n){var t=this;return u(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.indexOn=n,e.next=3,i.a.getCouponList({data:{page:t.page,num:t.pageNum,status:t.indexOn,fromDate:parseInt(t.atime/1e3),toDate:parseInt(t.btime/1e3)}});case 3:o=e.sent,t.couponList=o.list,t.allTotal=o.list.length,t.total=o.total,t.pageCount=o.list.length;case 8:case"end":return e.stop()}},e,t)}))()},showCalendar:function(){this.isShowCa=!this.isShowCa},closeDate:function(){this.isShowCa=!1},seachData:function(){this.inte(this.indexOn)},modfycoupons:function(n){var t=this;if("2"==this.indexOn)return this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"过期优惠券无法编辑"}),!1;this.$store.commit("setWin",{winType:"confirm",title:"提示信息",content:"确认修改吗？",callback:function(e){"ok"==e&&t.changeCoupon(n)}})},changeCoupon:function(n){var t=this;return u(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.getCouponById({data:{couponId:n.id}});case 2:o=e.sent,t.couponDetail=o,t.couponType=o.type,t.changeMnage=!1;case 6:case"end":return e.stop()}},e,t)}))()},delCoupon:function(n){var t=this;return u(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.deleteCoupon({data:{couponId:n.id}});case 2:t.inte(t.indexOn);case 3:case"end":return e.stop()}},e,t)}))()},deletecoupons:function(n){var t=this;this.$store.commit("setWin",{winType:"confirm",title:"提示信息",content:"确认要删除吗？",callback:function(e){"ok"==e&&t.delCoupon(n)}})},opencoupons:function(n,t){this.showCoupon=!0,this.couponInfo={index:n,item:t}},getAddAlltime:function(n){this.atime=n.startTime,this.btime=n.endTime,this.days=n.days,this.isShowCa=!1},getcouponResult:function(){this.couponType=0,this.inte(this.indexOn)},syncCoupon:function(){var n=this;return u(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.syncCoupon({data:{couponId:n.asyncId}});case 2:t.sent&&n.$store.commit("setWin",{content:"同步成功",title:"操作提示",winType:"alert"});case 4:case"end":return t.stop()}},t,n)}))()},unbundlingCoupon:function(n){this.asyncId=n.id,this.unbindWin=!0},getResult:function(n){"ok"==n&&this.syncCoupon(),this.unbindWin=!1}},mounted:function(){this.inte(this.indexOn),this.ischain=a.a.session("userShop").currentShop.ischain},components:{"can-multi":function(){return e.e("can_multi").then(e.bind(null,"742e"))},breakCoupon:function(){return e.e("breaks_coupon").then(e.bind(null,"7f53"))},discountCoupon:function(){return e.e("discount_coupon").then(e.bind(null,"4e1e"))},giveCoupon:function(){return e.e("give_coupon").then(e.bind(null,"7651"))},vouchersCoupon:function(){return e.e("vouchers_coupon").then(e.bind(null,"b025"))},intergralcardCoupon:function(){return e.e("integralcard_coupon").then(e.bind(null,"ec50"))},"coupon-manage-win":function(){return e.e("coupon_manage_win").then(e.bind(null,"6aa4"))},page:function(){return e.e("page_element").then(e.bind(null,"5921"))},comTable:function(){return e.e("table").then(e.bind(null,"4360"))},maunBundling:function(){return e.e("coupon_maunbundling_win").then(e.bind(null,"1975"))}}},r=(e("894b"),e("7610")),l=Object(r.a)(s,o,[],!1,null,"f3b7a390",null);l.options.__file="src\\module\\marketing_tools\\coupon_management.vue";t.default=l.exports}}]);