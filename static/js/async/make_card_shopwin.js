(window.webpackJsonp=window.webpackJsonp||[]).push([["make_card_shopwin"],{"7b73":function(t,s,e){},dea9:function(t,s,e){"use strict";var i=e("7b73");e.n(i).a},f93e:function(t,s,e){"use strict";e.r(s);var i=e("f6ce"),a=e("bbb9"),h={data:function(){return{title:"选择店铺",shopIds:"",shopId:null,ischain:null,shopList:null,napaStores:[],napaStoresOn:"",directSalet:[],directSaletOn:"",dirCheckAll:!1,napCheckAll:!1,dirObjIndex:{},napObjIndex:{},hashopId:"",hasdirectShop:[],hasnapaShop:[],userData:null,shopData:null}},props:["onnapaStores","ondirectSalet","IshopId","shop"],mounted:function(){this.userData=i.a.session("userShop"),this.shopData=i.a.session("shopList"),this.ischain=this.userData.currentShop.ischain,this.shopId=this.userData.currentShop.id,this.napaStoresOn=a.a.deepCopy(this.onnapaStores),this.directSaletOn=a.a.deepCopy(this.ondirectSalet),this.hashopId=this.IshopId,this.shopList=this.shop,this.getShopList(),console.log(this.hashopId)},watch:{directSaletOn:"dirChange",napaStoresOn:"napChange"},methods:{dirChange:function(){this.directSaletOn.length==this.directSalet.length?this.dirCheckAll=!0:this.dirCheckAll=!1},napChange:function(){this.napaStores.length==this.napaStoresOn.length?this.napCheckAll=!0:this.napCheckAll=!1},getShopList:function(){for(var t=[],s=[],e=0;e<this.shopData.length;e++)"1"==this.shopData[e].ischain?t.push(this.shopData[e]):"2"==this.shopData[e].ischain&&s.push(this.shopData[e]);if(""==this.hashopId)this.directSalet=a.a.deepCopy(t),this.napaStores=a.a.deepCopy(s);else{for(var i=a.a.deepCopy(t),h=a.a.deepCopy(s),n=0;n<this.hashopId.length;n++)for(var l=0;l<i.length;l++)i[l].id==this.hashopId[n]&&(this.hasdirectShop.push(i[l]),i.splice(l,1));for(var r=0;r<this.hashopId.length;r++)for(var o=0;o<h.length;o++)h[o].id==this.hashopId[r]&&(this.hasnapaShop.push(h[o]),h.splice(o,1));console.log(JSON.stringify(this.hasnapaShop)),this.directSalet=i,this.napaStores=h}for(var p=0;p<this.directSalet.length;p++)this.dirObjIndex[this.directSalet[p].id]=p;for(var c=0;c<this.napaStores.length;c++)this.napObjIndex[this.napaStores[c].id]=c;this.napChange(),this.dirChange()},selectUnselect:function(t){if("1"==t){for(var s=[],e=[],i=0;i<this.directSalet.length;i++)e.push(this.directSalet[i].id);for(var h=0;h<this.napaStores.length;h++)s.push(this.napaStores[h].id);this.directSaletOn=a.a.deepCopy(e),this.napaStoresOn=a.a.deepCopy(s)}else this.napaStoresOn=[],this.directSaletOn=[],this.dirCheckAll=!1,this.napCheckAll=!1},directCheckAll:function(){if(this.dirCheckAll)this.directSaletOn=[],this.dirCheckAll=!1;else{this.directSaletOn=[],this.dirCheckAll=!1;for(var t=0;t<this.directSalet.length;t++)this.directSaletOn.push(this.directSalet[t].id);this.dirCheckAll=!0}},napaStCheckAll:function(){if(this.napCheckAll)this.napCheckAll=!1,this.napaStoresOn=[];else{this.napCheckAll=!1,this.napaStoresOn=[];for(var t=0;t<this.napaStores.length;t++)this.napaStoresOn.push(this.napaStores[t].id);this.napCheckAll=!0}},filterShopInfo:function(t){for(var s="",e=[],i=0;i<this.directSaletOn.length;i++){s+=this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].shopName+",";var h={shopId:this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].id,name:this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].shopName,shopNumber:this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].shopNumber,initCardNumber:"",num:"",type:"1",isActivate:"1"};e.push(h)}for(var n=0;n<this.napaStoresOn.length;n++){s+=this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].shopName+",";var l={shopId:this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].id,name:this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].shopName,shopNumber:this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].shopNumber,initCardNumber:"",num:"",type:"2",isActivate:"1"};e.push(l)}s=s.substring(0,s.length-1);for(var r=String(this.napaStoresOn),o=String(this.directSaletOn),p=0;p<this.shopList.length;p++)if(o.match(this.shopList[p].shopId)||r.match(this.shopList[p].shopId))for(var c=a.a.deepCopy(this.shopList[p].shopId),d=0;d<e.length;d++)if(c.match(e[d].shopId)){e.splice(d,1,a.a.deepCopy(this.shopList[p]));break}return"1"==t?e:s},save:function(t){var s={};"ok"==t&&(s.napaStoresOn=this.napaStoresOn,s.directSaletOn=this.directSaletOn,s.shopInfo=this.filterShopInfo(),s.shopList=this.filterShopInfo("1")),this.$emit("getShop",t,s)}},components:{win:function(){return e.e("win").then(e.bind(null,"f60a"))},multiselect:function(){return e.e("mul_select").then(e.bind(null,"7d09"))}}},n=(e("dea9"),e("d801")),l=Object(n.a)(h,function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("win",{attrs:{align:"center",width:740,height:400},on:{winEvent:t.save}},[e("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),e("div",{attrs:{slot:"content",id:"cardShopTan"},slot:"content"},[e("div",{staticClass:"shopList",staticStyle:{padding:"30px",overflow:"hidden"}},[e("div",{staticClass:"fl",staticStyle:{width:"100%"}},[e("a",{staticClass:"unselect fr",attrs:{href:"javascript:void(0)"},on:{click:t.selectUnselect}},[t._v("全部取消")]),t._v(" "),e("a",{staticClass:"check fr",attrs:{href:"javascript:void(0)"},on:{click:function(s){t.selectUnselect("1")}}},[t._v("全部选择")])]),t._v(" "),t.directSalet&&t.directSalet.length>=1||t.hasdirectShop&&t.hasdirectShop.length>=1?e("div",{staticClass:"fl",staticStyle:{width:"100%","margin-bottom":"20px"}},[e("div",{staticClass:"fl",staticStyle:{height:"50px",width:"100%","line-height":"50px","text-align":"left","margin-left":"0","font-size":"16px"}},[t._v("直营店")]),t._v(" "),t.directSalet&&t.directSalet.length>=1?e("div",{staticClass:"selectbtns newCard fl",staticStyle:{width:"110px"}},[e("span",{class:t.dirCheckAll?"sign fl":"fl",on:{click:t.directCheckAll}},[t._v("全部")])]):t._e(),t._v(" "),e("multiselect",{key:"id",staticClass:"newCard",staticStyle:{overflow:"visible"},attrs:{list:t.directSalet,unlist:t.hasdirectShop,selects:t.directSaletOn,name:"shopName"}})],1):t._e(),t._v(" "),t.napaStores&&t.napaStores.length>=1||t.hasnapaShop&&t.hasnapaShop.length>=1?e("div",{staticClass:"fl",staticStyle:{width:"100%"}},[e("div",{staticClass:"fl",staticStyle:{height:"50px",width:"100%","line-height":"50px","text-align":"left","margin-left":"0","font-size":"16px"}},[t._v("加盟店")]),t._v(" "),t.napaStores&&t.napaStores.length>=1?e("div",{staticClass:"selectbtns newCard fl",staticStyle:{width:"110px"}},[e("span",{class:t.napCheckAll?"sign fl":"fl",on:{click:t.napaStCheckAll}},[t._v("全部")])]):t._e(),t._v(" "),e("multiselect",{key:"id",staticClass:"newCard",staticStyle:{width:"570px"},attrs:{list:t.napaStores,unlist:t.hasnapaShop,selects:t.napaStoresOn,name:"shopName"}})],1):t._e()])])])],1)},[],!1,null,"257af7bf",null);s.default=l.exports}}]);