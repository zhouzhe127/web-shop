(window.webpackJsonp=window.webpackJsonp||[]).push([["make_card_shopwin"],{"613e":function(t,e,s){},de61:function(t,e,s){"use strict";var i=s("613e");s.n(i).a},f93e:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("win",{attrs:{align:"center",width:740,height:400},on:{winEvent:t.save}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),s("div",{attrs:{slot:"content",id:"cardShopTan"},slot:"content"},[s("div",{staticClass:"shopList",staticStyle:{padding:"30px",overflow:"hidden"}},[s("div",{staticClass:"fl",staticStyle:{width:"100%"}},[s("a",{staticClass:"unselect fr",attrs:{href:"javascript:void(0)"},on:{click:t.selectUnselect}},[t._v("全部取消")]),t._v(" "),s("a",{staticClass:"check fr",attrs:{href:"javascript:void(0)"},on:{click:function(e){t.selectUnselect("1")}}},[t._v("全部选择")])]),t._v(" "),t.directSalet&&t.directSalet.length>=1||t.hasdirectShop&&t.hasdirectShop.length>=1?s("div",{staticClass:"fl",staticStyle:{width:"100%","margin-bottom":"20px"}},[s("div",{staticClass:"fl",staticStyle:{height:"50px",width:"100%","line-height":"50px","text-align":"left","margin-left":"0","font-size":"16px"}},[t._v("直营店")]),t._v(" "),t.directSalet&&t.directSalet.length>=1?s("div",{staticClass:"selectbtns newCard fl",staticStyle:{width:"110px"}},[s("span",{class:t.dirCheckAll?"sign fl":"fl",on:{click:t.directCheckAll}},[t._v("全部")])]):t._e(),t._v(" "),s("multiselect",{key:"id",staticClass:"newCard",staticStyle:{overflow:"visible"},attrs:{list:t.directSalet,unlist:t.hasdirectShop,selects:t.directSaletOn,name:"shopName"}})],1):t._e(),t._v(" "),t.napaStores&&t.napaStores.length>=1||t.hasnapaShop&&t.hasnapaShop.length>=1?s("div",{staticClass:"fl",staticStyle:{width:"100%"}},[s("div",{staticClass:"fl",staticStyle:{height:"50px",width:"100%","line-height":"50px","text-align":"left","margin-left":"0","font-size":"16px"}},[t._v("加盟店")]),t._v(" "),t.napaStores&&t.napaStores.length>=1?s("div",{staticClass:"selectbtns newCard fl",staticStyle:{width:"110px"}},[s("span",{class:t.napCheckAll?"sign fl":"fl",on:{click:t.napaStCheckAll}},[t._v("全部")])]):t._e(),t._v(" "),s("multiselect",{key:"id",staticClass:"newCard",staticStyle:{width:"570px"},attrs:{list:t.napaStores,unlist:t.hasnapaShop,selects:t.napaStoresOn,name:"shopName"}})],1):t._e()])])])],1)};i._withStripped=!0;var a=s("f6ce"),h=s("bbb9"),n={data:function(){return{title:"选择店铺",shopIds:"",shopId:null,ischain:null,shopList:null,napaStores:[],napaStoresOn:"",directSalet:[],directSaletOn:"",dirCheckAll:!1,napCheckAll:!1,dirObjIndex:{},napObjIndex:{},hashopId:"",hasdirectShop:[],hasnapaShop:[],userData:null,shopData:null}},props:["onnapaStores","ondirectSalet","IshopId","shop"],mounted:function(){this.userData=a.a.session("userShop"),this.shopData=a.a.session("shopList"),this.ischain=this.userData.currentShop.ischain,this.shopId=this.userData.currentShop.id,this.napaStoresOn=h.a.deepCopy(this.onnapaStores),this.directSaletOn=h.a.deepCopy(this.ondirectSalet),this.hashopId=this.IshopId,this.shopList=this.shop,this.getShopList(),console.log(this.hashopId)},watch:{directSaletOn:"dirChange",napaStoresOn:"napChange"},methods:{dirChange:function(){this.directSaletOn.length==this.directSalet.length?this.dirCheckAll=!0:this.dirCheckAll=!1},napChange:function(){this.napaStores.length==this.napaStoresOn.length?this.napCheckAll=!0:this.napCheckAll=!1},getShopList:function(){for(var t=[],e=[],s=0;s<this.shopData.length;s++)"1"==this.shopData[s].ischain?t.push(this.shopData[s]):"2"==this.shopData[s].ischain&&e.push(this.shopData[s]);if(""==this.hashopId)this.directSalet=h.a.deepCopy(t),this.napaStores=h.a.deepCopy(e);else{for(var i=h.a.deepCopy(t),a=h.a.deepCopy(e),n=0;n<this.hashopId.length;n++)for(var l=0;l<i.length;l++)i[l].id==this.hashopId[n]&&(this.hasdirectShop.push(i[l]),i.splice(l,1));for(var r=0;r<this.hashopId.length;r++)for(var o=0;o<a.length;o++)a[o].id==this.hashopId[r]&&(this.hasnapaShop.push(a[o]),a.splice(o,1));console.log(JSON.stringify(this.hasnapaShop)),this.directSalet=i,this.napaStores=a}for(var p=0;p<this.directSalet.length;p++)this.dirObjIndex[this.directSalet[p].id]=p;for(var c=0;c<this.napaStores.length;c++)this.napObjIndex[this.napaStores[c].id]=c;this.napChange(),this.dirChange()},selectUnselect:function(t){if("1"==t){for(var e=[],s=[],i=0;i<this.directSalet.length;i++)s.push(this.directSalet[i].id);for(var a=0;a<this.napaStores.length;a++)e.push(this.napaStores[a].id);this.directSaletOn=h.a.deepCopy(s),this.napaStoresOn=h.a.deepCopy(e)}else this.napaStoresOn=[],this.directSaletOn=[],this.dirCheckAll=!1,this.napCheckAll=!1},directCheckAll:function(){if(this.dirCheckAll)this.directSaletOn=[],this.dirCheckAll=!1;else{this.directSaletOn=[],this.dirCheckAll=!1;for(var t=0;t<this.directSalet.length;t++)this.directSaletOn.push(this.directSalet[t].id);this.dirCheckAll=!0}},napaStCheckAll:function(){if(this.napCheckAll)this.napCheckAll=!1,this.napaStoresOn=[];else{this.napCheckAll=!1,this.napaStoresOn=[];for(var t=0;t<this.napaStores.length;t++)this.napaStoresOn.push(this.napaStores[t].id);this.napCheckAll=!0}},filterShopInfo:function(t){for(var e="",s=[],i=0;i<this.directSaletOn.length;i++){e+=this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].shopName+",";var a={shopId:this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].id,name:this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].shopName,shopNumber:this.directSalet[this.dirObjIndex[this.directSaletOn[i]]].shopNumber,initCardNumber:"",num:"",type:"1",isActivate:"1"};s.push(a)}for(var n=0;n<this.napaStoresOn.length;n++){e+=this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].shopName+",";var l={shopId:this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].id,name:this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].shopName,shopNumber:this.napaStores[this.napObjIndex[this.napaStoresOn[n]]].shopNumber,initCardNumber:"",num:"",type:"2",isActivate:"1"};s.push(l)}e=e.substring(0,e.length-1);for(var r=String(this.napaStoresOn),o=String(this.directSaletOn),p=0;p<this.shopList.length;p++)if(o.match(this.shopList[p].shopId)||r.match(this.shopList[p].shopId))for(var c=h.a.deepCopy(this.shopList[p].shopId),d=0;d<s.length;d++)if(c.match(s[d].shopId)){s.splice(d,1,h.a.deepCopy(this.shopList[p]));break}return"1"==t?s:e},save:function(t){var e={};"ok"==t&&(e.napaStoresOn=this.napaStoresOn,e.directSaletOn=this.directSaletOn,e.shopInfo=this.filterShopInfo(),e.shopList=this.filterShopInfo("1")),this.$emit("getShop",t,e)}},components:{win:function(){return s.e("win").then(s.bind(null,"f60a"))},multiselect:function(){return s.e("mul_select").then(s.bind(null,"7d09"))}}},l=(s("de61"),s("7610")),r=Object(l.a)(n,i,[],!1,null,"e861ea54",null);r.options.__file="src\\module\\member_system\\make_card_shopwin.vue";e.default=r.exports}}]);