(window.webpackJsonp=window.webpackJsonp||[]).push([["integral_withdrawal"],{"760c":function(t,e,i){"use strict";i.r(e);var n=i("81a2"),a=i("f6ce");function s(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(a,s){try{var l=e[a](s),c=l.value}catch(t){return void i(t)}if(!l.done)return Promise.resolve(c).then(function(t){n("next",t)},function(t){n("throw",t)});t(c)}("next")})}}var l={data:function(){return{userData:Object,update:!1,open:!1,canalList:[{name:"pos收银",index:"1"},{name:"微店",index:"2"},{name:"扫码支付",index:"3"}],selectCanal:"1,2,3",point:null,pointCash:null,maxList:["无条件","按百分比","按现金消费"],maxSelect:0,maxDate:{money:null,percentage:null},maxPointRate:null,computerWay:["打折前","打折后"],selectComputerWay:0,conditionList:["无条件","人均消费","总消费"],selectConditionList:0,minCash:null,userWay:["手动输入","自动计算"],selectUserWay:0}},mounted:function(){this.userData=a.a.session("userShop"),this.userData.currentShop&&3==this.userData.currentShop.ischain&&(this.update=!0),this.userData.currentShop&&0==this.userData.currentShop.ischain&&(this.update=!0),this.getPointConfig()},methods:{getIsDiscountToggle:function(t){this.open=t},doMore:function(t){-1!=this.selectCanal.indexOf(t)?this.selectCanal=this.selectCanal.replace(t,""):this.selectCanal=1==t?t.concat(this.selectCanal):this.selectCanal.concat(t)},getPointConfig:function(){var t=this;return s(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.getPointConf({data:{shopId:t.userData.currentShop.id}});case 2:(i=e.sent)&&t.init(i);case 4:case"end":return e.stop()}},e,t)}))()},init:function(t){"0"==t.status?this.open=!1:"1"==t.status&&(this.open=!0),"0"==t.channel&&(t.channel=""),t.channel+="",this.selectCanal=t.channel,this.point=t.point,this.pointCash=t.pointCash,0==t.maxRule?this.maxSelect=0:1==t.maxRule?(this.maxSelect=1,this.selectComputerWay=0,this.maxDate.percentage=t.maxRuleValue):2==t.maxRule?(this.maxSelect=1,this.selectComputerWay=1,this.maxDate.percentage=t.maxRuleValue):3==t.maxRule&&(this.maxSelect=2,this.maxDate.money=t.maxRuleValue),this.maxPointRate=t.maxPointRate,this.selectConditionList=t.pointUseRule,this.minCash=t.minCash,this.selectUserWay=t.useMode},updatePointConfig:function(){var t=this;return s(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.testInfo()){e.next=17;break}return(i={}).channel=t.selectCanal,i.maxPointRate=t.maxPointRate,i.point=t.point,i.pointCash=t.pointCash,1==t.maxSelect?0==t.selectComputerWay?(i.maxRule=1,i.maxRuleValue=t.maxDate.percentage):1==t.selectComputerWay&&(i.maxRule=2,i.maxRuleValue=t.maxDate.percentage):2==t.maxSelect?(i.maxRule=3,i.maxRuleValue=t.maxDate.money):i.maxRule=0,i.pointUseRule=t.selectConditionList,i.minCash=t.minCash,i.useMode=t.selectUserWay,i.status=t.open?"1":"0",i.updateUid=t.userData.user.id,i.shopId=t.userData.currentShop.id,e.next=15,n.a.updatePointConf({data:i});case 15:e.sent&&t.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"保存成功"});case 17:case"end":return e.stop()}},e,t)}))()},testInfo:function(){var t=/^[0-9]+$/;if(0==this.point)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"基本设置中,积分抵扣比例中积分不能为0"}),!1;if(0==this.pointCash)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"基本设置中,积分抵扣比例中金额不能为0"}),!1;if(!t.test(this.point))return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"基本设置中,积分抵扣比例中积分只能是正整数"}),!1;if(0==this.selectCanal.length)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"基本设置中,抵扣渠道至少要有一个"}),!1;if(!t.test(this.pointCash))return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"基本设置中,积分抵扣比例中金额只能是正整数"}),!1;var e=!1;if(this.point%this.pointCash!=0&&this.pointCash%this.point!=0||(e=!0),!e)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"基本设置中,积分抵扣 积分和金额需要满足相互整除"}),!1;if(1==this.maxSelect){if(!t.test(this.maxDate.percentage)||this.maxDate.percentage-0>100||this.maxDate.percentage-0==0)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"设置规则中,按百分比比例只能是(1-100)正整数"}),!1}else if(2==this.maxSelect&&(!t.test(this.maxDate.money)||0==this.maxDate.money))return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"设置规则中,按现金消费抵扣金额只能是大于0的正整数"}),!1;if(!t.test(this.maxPointRate)||this.maxPointRate-0>100||this.maxPointRate-0==0)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"积分使用上限中,最多使用总积分只能是(1-100)正整数"}),!1;if(0!=this.selectConditionList){var i=1==this.selectConditionList?"人均消费额度":"总消费额度";if(0==this.minCash)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"积分抵扣条件中,"+i+"不能为0"}),!1;if(!t.test(this.minCash))return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"积分抵扣条件中,"+i+"最多使用总积分只能是大于0的整数"}),!1}return!0},changeSelect:function(t,e){this[t]=e}},components:{onOff:function(){return i.e("on_off").then(i.bind(null,"034b"))}}},c=(i("f321"),i("d801")),o=Object(c.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"integral-consume"}},[t._m(0),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text"},[t._v("\n\t\t\t开启积分抵扣\n\t\t")]),t._v(" "),n("on-off",{attrs:{status:t.open},on:{statusChange:t.getIsDiscountToggle}})],1),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text required",staticStyle:{"margin-left":"158px"}},[t._v("\n\t\t\t抵扣渠道\n\t\t")]),t._v(" "),n("div",{staticClass:"fl selectbtns"},t._l(t.canalList,function(e,i){return n("span",{key:i,class:{sign:-1!=t.selectCanal.indexOf(e.index)},on:{click:function(i){t.doMore(e.index)}}},[t._v(t._s(e.name))])}))]),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text required",staticStyle:{"margin-left":"130px"}},[t._v("\n\t\t\t积分抵扣比例\n\t\t")]),t._v(" "),n("div",{staticClass:"integralDiv"},[t._v("\n\t\t\t积分\n\t\t")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.point,expression:"point"}],staticClass:"input fl inputOne",attrs:{type:"text",maxlength:"8"},domProps:{value:t.point},on:{input:function(e){e.target.composing||(t.point=e.target.value)}}}),t._v(" "),n("div",{staticClass:"text fl",staticStyle:{margin:"0 10px"}},[t._v("\n\t\t\t:\n\t\t")]),t._v(" "),n("div",{staticClass:"integralNum"},[t._v("\n\t\t\t元\n\t\t")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.pointCash,expression:"pointCash"}],staticClass:"input fl inputTwo",attrs:{type:"text",maxlength:"8"},domProps:{value:t.pointCash},on:{input:function(e){e.target.composing||(t.pointCash=e.target.value)}}})]),t._v(" "),t._m(1),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text"},[t._v("\n\t\t\t积分抵扣上限\n\t\t")]),t._v(" "),t._l(t.maxList,function(e,i){return[n("div",{key:i,staticClass:"fl integralTop",class:{icSelect:i==t.maxSelect},on:{click:function(e){t.changeSelect("maxSelect",i)}}},[t._v("\n\t\t\t\t"+t._s(e)+"\n\t\t\t")])]})],2),t._v(" "),1==t.maxSelect?[n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text",staticStyle:{"margin-left":"168px"}},[t._v("\n\t\t\t\t计算方式\n\t\t\t")]),t._v(" "),t._l(t.computerWay,function(e,i){return[n("div",{key:i,staticClass:"fl computeStyle",class:{icSelect:i==t.selectComputerWay},on:{click:function(e){t.changeSelect("selectComputerWay",i)}}},[t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])]})],2),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text",staticStyle:{"margin-left":"154px"}},[t._v("\n\t\t\t\t最多为订单\n\t\t\t")]),t._v(" "),n("div",{staticClass:"maxOrder"},[t._v("\n\t\t\t\t%\n\t\t\t")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.maxDate.percentage,expression:"maxDate.percentage"}],staticClass:"input orderInput",attrs:{type:"text",maxlength:"3",placeholder:"请输入百分比"},domProps:{value:t.maxDate.percentage},on:{input:function(e){e.target.composing||t.$set(t.maxDate,"percentage",e.target.value)}}})])]:t._e(),t._v(" "),2==t.maxSelect?n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text",staticStyle:{"margin-left":"154px"}},[t._v("\n\t\t\t最多金额为\n\t\t")]),t._v(" "),n("div",{staticClass:"maxNumber"},[t._v("\n\t\t\t元\n\t\t")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.maxDate.money,expression:"maxDate.money"}],staticClass:"input numInput",attrs:{type:"text",maxlength:"10",placeholder:"请输入金额"},domProps:{value:t.maxDate.money},on:{input:function(e){e.target.composing||t.$set(t.maxDate,"money",e.target.value)}}})]):t._e(),t._v(" "),t._m(2),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text required",staticStyle:{"margin-left":"116px"}},[t._v("\n\t\t\t最多使用总积分\n\t\t")]),t._v(" "),n("div",{staticClass:"useIntegral"},[t._v("\n\t\t\t%\n\t\t")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.maxPointRate,expression:"maxPointRate"}],staticClass:"input useInput",attrs:{type:"text",maxlength:"3",placeholder:"请输入百分比"},domProps:{value:t.maxPointRate},on:{input:function(e){e.target.composing||(t.maxPointRate=e.target.value)}}})]),t._v(" "),t._m(3),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text",staticStyle:{"margin-left":"168px"}},[t._v("\n\t\t\t计算方式\n\t\t")]),t._v(" "),t._l(t.conditionList,function(e,i){return[n("div",{key:i,staticClass:"fl numStyleOne",class:{icSelect:i==t.selectConditionList},on:{click:function(e){t.changeSelect("selectConditionList",i)}}},[t._v("\n\t\t\t\t"+t._s(e)+"\n\t\t\t")])]})],2),t._v(" "),0!=t.selectConditionList?n("div",{staticClass:"ic-line"},[1==t.selectConditionList?n("div",{staticClass:"text required",staticStyle:{"margin-left":"144px"}},[t._v("\n\t\t\t人均消费满\n\t\t")]):t._e(),t._v(" "),2==t.selectConditionList?n("div",{staticClass:"text required",staticStyle:{"margin-left":"158px"}},[t._v("\n\t\t\t总消费满\n\t\t")]):t._e(),t._v(" "),n("div",{staticClass:"totalNumber"},[t._v("\n\t\t\t元\n\t\t")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.minCash,expression:"minCash"}],staticClass:"input fl totalInput",attrs:{type:"text",maxlength:"10",placeholder:"请输入金额"},domProps:{value:t.minCash},on:{input:function(e){e.target.composing||(t.minCash=e.target.value)}}}),t._v(" "),n("div",{staticClass:"fl",staticStyle:{"margin-left":"10px"}},[t._v("\n\t\t\t允许使用\n\t\t")])]):t._e(),t._v(" "),t._m(4),t._v(" "),n("div",{staticClass:"ic-line"},[n("div",{staticClass:"text",staticStyle:{"margin-left":"168px"}},[t._v("\n\t\t\t使用方式\n\t\t")]),t._v(" "),t._l(t.userWay,function(e,i){return[n("div",{key:i,staticClass:"fl useStyleOne",class:{icSelect:i==t.selectUserWay},on:{click:function(e){t.changeSelect("selectUserWay",i)}}},[t._v("\n\t\t\t\t"+t._s(e)+"\n\t\t\t")])]}),t._v(" "),n("img",{staticClass:"useImg",attrs:{src:i("fa5e")}}),t._v(" "),n("div",{staticClass:"text",staticStyle:{"margin-left":"4px"}},[t._v("\n\t\t\t最大限度使用\n\t\t")])],2),t._v(" "),t.update?n("a",{staticClass:"yellow useA",attrs:{href:"javascript:void(0);"},on:{click:t.updatePointConfig}},[t._v("保存")]):t._e()],2)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ic-title"},[e("div",{staticClass:"text"},[this._v("\n\t\t\t基本设置\n\t\t")]),this._v(" "),e("div",{staticClass:"dashed"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ic-title"},[e("div",{staticClass:"text"},[this._v("\n\t\t\t设置规则\n\t\t")]),this._v(" "),e("div",{staticClass:"dashed"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ic-title"},[e("div",{staticClass:"text"},[this._v("\n\t\t\t积分使用上限\n\t\t")]),this._v(" "),e("div",{staticClass:"dashed"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ic-title",staticStyle:{"margin-top":"10px"}},[e("div",{staticClass:"text"},[this._v("\n\t\t\t积分抵扣条件\n\t\t")]),this._v(" "),e("div",{staticClass:"dashed"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ic-title",staticStyle:{"margin-top":"10px"}},[e("div",{staticClass:"text"},[this._v("\n\t\t\t使用方式\n\t\t")]),this._v(" "),e("div",{staticClass:"dashed"})])}],!1,null,"1a89152e",null);e.default=o.exports},d7d4:function(t,e,i){},f321:function(t,e,i){"use strict";var n=i("d7d4");i.n(n).a},fa5e:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MkRGMUU4RTkxRTZBMTFFN0I5QzE5OURBRDRBNUNBMDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MkRGMUU4RUExRTZBMTFFN0I5QzE5OURBRDRBNUNBMDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyREYxRThFNzFFNkExMUU3QjlDMTk5REFENEE1Q0EwNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyREYxRThFODFFNkExMUU3QjlDMTk5REFENEE1Q0EwNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvmW/yEAAAGXSURBVHjajJRNKERRFMfnTWNIPooFGxYPNZpENlIyYcpGKfnIxkYpC2VlJbGyUhR7GwvERpHPmrBRMthIvZckGx9JESXjf/R/9Vz3vZlTv+7pnnv/79x7zzuGZVkBjbWCPo7lnLsFB2AF7DsLTdP8HUOKQAQsggaNeCUZAknQD66cYNC1MAbOPERUqwPn3PNHSDLZBDk+mydBFwXEwmDbtu2IczQDLIFcH5EjMEU/CyzTzwbrEItKRm2gPs1RmkA3Mx9TYtUgLhn1+gi8gQ3wAEZAs8e60RCfWGe74JR3d8i5R1CsWdsoRyvTBO5YM8OglHN5vB+dFYrQpyZQBKbBMVjl3Cwo8LoDEbrXzDsvOMCxBAz63OWrCJ14BOfAE/35NK96EWQNqfYBJui38OkXwIuH0IwI7YBLJbAm6dJ/B+P08zUitpSIPH+KtZRkpYpVgQreYRT0gFqNyBfoQAdIGa42EmN24UBmJiJxiCTUvz/Br15nIHIDarjnXxsJsL/I/9QOtsAz+ObXpar3QKf0M3cvEvsRYAC5I1K3pGPeDQAAAABJRU5ErkJggg=="}}]);