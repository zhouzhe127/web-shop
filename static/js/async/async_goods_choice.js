(window.webpackJsonp=window.webpackJsonp||[]).push([["async_goods_choice"],{"0236":function(t,e,n){"use strict";var r=n("0cc8");n.n(r).a},"0cc8":function(t,e,n){},b22c:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("win",{attrs:{align:"center",width:600,height:200,ok:t.okStyle},on:{winEvent:t.goodListWin}},[r("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("section",{attrs:{id:"configTan"}},[r("section",{staticStyle:{"border-bottom":"1px solid #ccc"}},[r("span",{staticClass:"aLi",class:{"shoName-select":t.isAll},on:{click:t.choseAll}},[t._v(t._s("goods"==t.goIncom?"商品":"套餐")+"完整信息")]),t._v(" "),r("span",{staticStyle:{display:"inline-block",color:"#b3aeae"}},[r("img",{staticStyle:{margin:"-4px 5px"},attrs:{src:n("fa5e")}}),t._v("\n\t\t\t\t\t如需同步门店尚未同步过的"+t._s("goods"==t.goIncom?"商品":"套餐")+"必须选择'"+t._s("goods"==t.goIncom?"商品":"套餐")+"完整信息'\n\t\t\t\t")])]),t._v(" "),r("section",t._l(t.typeArr,function(e,n){return r("span",{key:n,staticClass:"aLi",class:{"shoName-select":e.selected},on:{click:function(n){t.choseGood(e)}}},[t._v(t._s(e.name))])}))])])]),t._v(" "),t.showTan?r("goodListWin",{attrs:{goodsIds:[],isGoods:!0,goInName:t.goInName,isOnlyGoods:!0,asyncGoods:t.asyncGoods,isAllOrOther:4==t.selectArr.length,categoryList:t.categoryList},on:{goodListWin:t.doThrowTanResult}}):t._e()],1)};r._withStripped=!0;var o=n("81a2"),s=n("f6ce");function i(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(o,s){try{var i=e[o](s),a=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})}}var a={data:function(){return{okStyle:{content:"下一步",style:"background-color:#f8941f"},typeArr:[{name:"商品名称",selected:!1,type:"1"},{name:"商品价格",selected:!1,type:"2"},{name:"商品图片",selected:!1,type:"3"},{name:"其他信息",selected:!1,type:"4"}],selectArr:[],allSelect:!0,showTan:!1,brandId:"",asyncGoods:[],title:"同步商品",isAll:!1,goodArr:[],categoryList:[],goInName:"goodsChoice",packArr:[]}},mounted:function(){var t=this,e=s.a.session("userShop");this.brandId=e.currentShop.brandId,"goods"==this.goIncom?(this.goInName="goodsChoice",this.title="同步商品",this.typeArr=[{name:"商品名称",selected:!1,type:"1"},{name:"商品价格",selected:!1,type:"2"},{name:"商品图片",selected:!1,type:"3"},{name:"其他信息",selected:!1,type:"4"}],this.getGoodsStatus().then(function(e){var n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var a=s.value;a.selected=!1,a.isSynOk=!1,t.asyncGoods.push(a)}}catch(t){r=!0,o=t}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}t.asyncGoods=t.filterGoodsByGroup(t.asyncGoods)}),this.getBrandCategory()):"packs"==this.goIncom&&(this.goInName="packsChoice",this.title="同步套餐",this.typeArr=[{name:"套餐名称",selected:!1,type:"1"},{name:"套餐价格",selected:!1,type:"2"},{name:"套餐图片",selected:!1,type:"3"},{name:"其他信息",selected:!1,type:"4"}],this.getPacksStatus().then(function(e){var n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var a=s.value;a.selected=!1,a.isSynOk=!1,t.asyncGoods.push(a)}}catch(t){r=!0,o=t}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}}))},props:{goIncom:String},methods:{choseAll:function(){if(this.isAll=!this.isAll,this.isAll)for(var t=0;t<this.typeArr.length;t++)this.typeArr[t].selected=!0;else for(var e=0;e<this.typeArr.length;e++)this.typeArr[e].selected=!1},isAllSec:function(){for(var t=0;t<this.typeArr.length;t++)if(!this.typeArr[t].selected)return!1;return!0},getGoodsStatus:function(){var t=this;return i(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.GetGoodsStatus({data:{brandId:t.brandId}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,t)}))()},getPacksStatus:function(){var t=this;return i(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.newGetBrandPackage({data:{brandId:t.brandId}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,t)}))()},filterGoodsByGroup:function(t){return t.filter(function(t){return!(Number(t.groupId)>0)})},choseGood:function(t){t.selected=!t.selected,this.isAll=!!this.isAllSec()},goodListWin:function(t){if("ok"==t){if(0==this.selectArr.length)return void this.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"至少选择一项"});this.showTan=!0}else"goods"==this.goIncom?this.$emit("throwAddGoodsWin",t):"packs"==this.goIncom&&this.$emit("throwSyncWin",t)},doThrowTanResult:function(t,e){"ok"==t&&(this.goodArr=e.goodArr,this.packArr=e.packArr,this.synchronousGoods()),this.showTan=!1},synchronousGoods:function(){var t=this;return i(regeneratorRuntime.mark(function e(){var n,r,s,a,c,d,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n="",r=0;r<t.typeArr.length;r++)t.typeArr[r].selected&&(n=n+t.typeArr[r].type+",");if(s="",a=void 0,"goods"!=t.goIncom){e.next=14;break}if(0!=t.goodArr.length){e.next=8;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"所要同步的商品为空，至少选择一项"}),e.abrupt("return",!1);case 8:for(c=0;c<t.goodArr.length;c++)s=s+t.goodArr[c]+",";return e.next=11,o.a.SynchronousGoods({data:{brandId:t.brandId,type:n,gids:s}});case 11:a=e.sent,e.next=22;break;case 14:if("packs"!=t.goIncom){e.next=22;break}if(0!=t.packArr.length){e.next=18;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"所要同步的套餐为空，至少选择一项"}),e.abrupt("return",!1);case 18:for(d=0;d<t.packArr.length;d++)s=s+t.packArr[d]+",";return e.next=21,o.a.synchronousPackage({data:{brandId:t.brandId,type:n,pids:s}});case 21:a=e.sent;case 22:l=a.taskId,u=0,t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"同步中，请稍候！"}),window.timer=setInterval(i(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u++,e.next=3,o.a.taskInfoGoods({data:{taskId:l}});case 3:n=e.sent,"3"==n.status&&(t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"同步成功,请刷新页面获取最新商品数据！"}),t.$emit("throwSyncWin","ok"),clearInterval(window.timer)),u>=60&&(t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"同步超时"}),clearInterval(window.timer));case 7:case"end":return e.stop()}},e,t)})),1e3);case 26:case"end":return e.stop()}},e,t)}))()},taskInfoGoods:function(t){var e=this;return i(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.taskInfoGoods({data:{taskId:t}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},n,e)}))()},getBrandCategory:function(){var t=this;return i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.getBrandCategory({data:{}});case 2:t.categoryList=e.sent;case 3:case"end":return e.stop()}},e,t)}))()}},watch:{typeArr:{deep:!0,handler:function(t){this.selectArr=t.filter(function(t){return t.selected})}}},components:{win:function(){return n.e("win").then(n.bind(null,"f60a"))},goodListWin:function(){return n.e("good_list_win").then(n.bind(null,"8bf4"))}}},c=(n("0236"),n("6ceb")),d=Object(c.a)(a,r,[],!1,null,"23b121a5",null);d.options.__file="src\\module\\goods_config\\goods_manager_coms\\async_goods_choice.vue";e.default=d.exports},fa5e:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MkRGMUU4RTkxRTZBMTFFN0I5QzE5OURBRDRBNUNBMDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MkRGMUU4RUExRTZBMTFFN0I5QzE5OURBRDRBNUNBMDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyREYxRThFNzFFNkExMUU3QjlDMTk5REFENEE1Q0EwNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyREYxRThFODFFNkExMUU3QjlDMTk5REFENEE1Q0EwNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvmW/yEAAAGXSURBVHjajJRNKERRFMfnTWNIPooFGxYPNZpENlIyYcpGKfnIxkYpC2VlJbGyUhR7GwvERpHPmrBRMthIvZckGx9JESXjf/R/9Vz3vZlTv+7pnnv/79x7zzuGZVkBjbWCPo7lnLsFB2AF7DsLTdP8HUOKQAQsggaNeCUZAknQD66cYNC1MAbOPERUqwPn3PNHSDLZBDk+mydBFwXEwmDbtu2IczQDLIFcH5EjMEU/CyzTzwbrEItKRm2gPs1RmkA3Mx9TYtUgLhn1+gi8gQ3wAEZAs8e60RCfWGe74JR3d8i5R1CsWdsoRyvTBO5YM8OglHN5vB+dFYrQpyZQBKbBMVjl3Cwo8LoDEbrXzDsvOMCxBAz63OWrCJ14BOfAE/35NK96EWQNqfYBJui38OkXwIuH0IwI7YBLJbAm6dJ/B+P08zUitpSIPH+KtZRkpYpVgQreYRT0gFqNyBfoQAdIGa42EmN24UBmJiJxiCTUvz/Br15nIHIDarjnXxsJsL/I/9QOtsAz+ObXpar3QKf0M3cvEvsRYAC5I1K3pGPeDQAAAABJRU5ErkJggg=="}}]);