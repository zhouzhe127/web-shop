(window.webpackJsonp=window.webpackJsonp||[]).push([["enter_goods"],{"6af0":function(t,e,s){},cd0c:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"output-shipper"}},[s("div",{staticClass:"scroll-box"},[s("div",{staticClass:"head-line"},[t._v("入货")]),t._v(" "),s("div",{staticClass:"detail"},[s("div",{staticClass:"block"},[s("div",{staticClass:"item"},[s("span",[t._v("调度单号：")]),t._v(t._s(t.details.receiptNumber)+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"item"},[s("span",[t._v("调度状态：")]),t._v(t._s(t.allStatus[t.details.dynamic])+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"item ware"},[s("span",[t._v("入货仓库：")]),t._v(" "),s("p",[t._v(t._s(t.details.intoWname)),s("em",{on:{click:function(e){t.openWareWin(t.details.intoWarehouse)}}})])]),t._v(" "),s("div",{staticClass:"item ware"},[s("span",[t._v("出货仓库：")]),t._v(" "),s("p",[t._v(t._s(t.details.outWname)),s("em",{on:{click:function(e){t.openWareWin(t.details.outWarehouse)}}})])])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"item"},[s("span",[t._v("创建时间：")]),t._v(t._s(t.timeConversion(t.details.createTime,1))+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"item"},[s("span",[t._v("创建人：")]),t._v(t._s(t.details.createName)+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"item narrow"},[s("span",[t._v("原因：")]),t._v(t._s(t.details.cause||"--")+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"item narrow"},[s("span",[t._v("备注：")]),t._v(t._s(t.details.remark||"--")+"\n\t\t\t\t\t")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"item"},[s("span",[t._v("出货时间：")]),t._v(t._s(t.operate.time)+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"item"},[s("span",[t._v("出货人：")]),t._v(t._s(t.operate.name)+"\n\t\t\t\t\t")])])]),t._v(" "),s("div",{staticClass:"tab-box"},[s("span",{class:{active:0==t.tabIndex},on:{click:function(e){t.tabIndex=0}}},[t._v("商品")]),t._v(" "),s("span",{class:{active:1==t.tabIndex},on:{click:function(e){t.tabIndex=1}}},[t._v("物料")])]),t._v(" "),0==t.tabIndex?s("div",{staticClass:"consume-list"},[s("div",{staticClass:"head"},[t._v("商品列表 · 共 "),s("em",[t._v(t._s(t.enterGoods.success.list.length))]),t._v(" 个条目")]),t._v(" "),s("div",{staticClass:"list"},[s("div",{staticClass:"scroll-box"},[s("div",{staticClass:"title"},[s("span",{staticClass:"narrow"},[t._v("操作")]),t._v(" "),s("span",[t._v("商品名称")]),t._v(" "),s("span",[t._v("出货数量")]),t._v(" "),s("span",[t._v("已入货")]),t._v(" "),s("span",[t._v("已耗损")]),t._v(" "),s("span",[t._v("入货"),s("em",{staticClass:"select-ban",on:{click:function(e){t.surplusAll("goods","into")}}},[t._v("剩余全部")])]),t._v(" "),s("span",[t._v("耗损"),s("em",{staticClass:"select-ban",on:{click:function(e){t.surplusAll("goods","consume")}}},[t._v("剩余全部")])]),t._v(" "),s("span",{staticClass:"ware"},[t._v("入货仓库")])]),t._v(" "),t._l(t.enterGoods.success.list,function(e,n){return s("div",{key:n,staticClass:"item",attrs:{"data-index":n},on:{click:t.goodsHandle}},[s("div",{staticClass:"unit narrow"},[e.isSurplus?[s("em",{staticClass:"handle-btn sel-batch select-ban"},[t._v("选择批次")])]:[s("em",{staticClass:"handle-btn init-end select-ban"},[t._v("入货完毕")])]],2),t._v(" "),s("div",{staticClass:"unit",attrs:{title:e.name}},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(e.outNum)+t._s(e.unit))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(e.overIntoNum)+t._s(e.unit))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(e.overConsumeNum)+t._s(e.unit))]),t._v(" "),s("div",{staticClass:"unit"},[e.isSurplus?[s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.intoNum,expression:"item.intoNum"}],attrs:{type:"text",placeholder:"输入数字",disabled:e.haveBatch,maxlength:"10"},domProps:{value:e.intoNum},on:{input:[function(s){s.target.composing||t.$set(e,"intoNum",s.target.value)},function(s){t.intoInput(e,"into")}]}}),t._v(" "),s("em",[t._v(t._s(e.unit))])])]:[t._v("--")]],2),t._v(" "),s("div",{staticClass:"unit"},[e.isSurplus?[s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.consumeNum,expression:"item.consumeNum"}],attrs:{type:"text",placeholder:"输入数字",disabled:e.haveBatch,maxlength:"10"},domProps:{value:e.consumeNum},on:{input:[function(s){s.target.composing||t.$set(e,"consumeNum",s.target.value)},function(s){t.intoInput(e,"consume")}]}}),t._v(" "),s("em",[t._v(t._s(e.unit))])])]:[t._v("--")]],2),t._v(" "),s("div",{staticClass:"unit ware"},[s("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.warehouse)),e.wArea?[t._v("-"+t._s(e.wArea))]:t._e(),t._v(" "),e.isSurplus?[s("em",{staticClass:"change-ware"})]:t._e()],2)])])}),t._v(" "),t._l(t.enterGoods.error,function(e,n){return s("div",{key:n,staticClass:"item error"},[t._m(0,!0),t._v(" "),s("div",{staticClass:"unit",attrs:{title:e.itemName}},[t._v(t._s(e.itemName))]),t._v(" "),s("div",{staticClass:"unit reason",attrs:{title:e.reason}},[t._v("\n\t\t\t\t\t\t\t\t失败原因：\n\t\t\t\t\t\t\t\t"),s("div",{staticClass:"error-icon"},[t._v("!")]),t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.reason)+"\n\t\t\t\t\t\t\t")])])}),t._v(" "),t.enterGoods.success.list.length||t.enterGoods.error.length?t._e():s("div",{staticClass:"empty"},[t._v("- 暂无条目 -")])],2)])]):t._e(),t._v(" "),1==t.tabIndex?s("div",{staticClass:"consume-list"},[s("div",{staticClass:"head"},[t._v("物料列表 · 共 "),s("em",[t._v(t._s(t.enterMaterial.success.list.length))]),t._v(" 个条目")]),t._v(" "),s("div",{staticClass:"list"},[s("div",{staticClass:"scroll-box"},[s("div",{staticClass:"title"},[s("span",{staticClass:"narrow"},[t._v("操作")]),t._v(" "),s("span",[t._v("物料名称")]),t._v(" "),s("span",[t._v("出货数量")]),t._v(" "),s("span",[t._v("已入货")]),t._v(" "),s("span",[t._v("已耗损")]),t._v(" "),s("span",[t._v("入货"),s("em",{staticClass:"select-ban",on:{click:function(e){t.surplusAll("mat","into")}}},[t._v("剩余全部")])]),t._v(" "),s("span",[t._v("耗损"),s("em",{staticClass:"select-ban",on:{click:function(e){t.surplusAll("mat","consume")}}},[t._v("剩余全部")])]),t._v(" "),s("span",{staticClass:"ware"},[t._v("入货仓库")])]),t._v(" "),t._l(t.enterMaterial.success.list,function(e,n){return s("div",{key:n,staticClass:"item",attrs:{"data-index":n},on:{click:t.materialHandle}},[s("div",{staticClass:"unit narrow"},[e.isSurplus?[s("em",{staticClass:"handle-btn sel-batch select-ban"},[t._v("选择批次")])]:[s("em",{staticClass:"handle-btn init-end select-ban"},[t._v("入货完毕")])]],2),t._v(" "),s("div",{staticClass:"unit",attrs:{title:e.name}},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(e.outNumShow)+t._s(e.unit))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(e.overIntoNumShow)+t._s(e.unit))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(e.overConsumeNumShow)+t._s(e.unit))]),t._v(" "),s("div",{staticClass:"unit"},[e.isSurplus?[s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.intoNum,expression:"item.intoNum"}],attrs:{type:"text",placeholder:"输入数字",disabled:e.haveBatch,maxlength:"10"},domProps:{value:e.intoNum},on:{input:[function(s){s.target.composing||t.$set(e,"intoNum",s.target.value)},function(s){t.intoInput(e,"into")}]}}),t._v(" "),s("em",[t._v(t._s(e.unit))])])]:[t._v("--")]],2),t._v(" "),s("div",{staticClass:"unit"},[e.isSurplus?[s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.consumeNum,expression:"item.consumeNum"}],attrs:{type:"text",placeholder:"输入数字",disabled:e.haveBatch,maxlength:"10"},domProps:{value:e.consumeNum},on:{input:[function(s){s.target.composing||t.$set(e,"consumeNum",s.target.value)},function(s){t.intoInput(e,"consume")}]}}),t._v(" "),s("em",[t._v(t._s(e.unit))])])]:[t._v("--")]],2),t._v(" "),s("div",{staticClass:"unit ware"},[s("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.warehouse)),e.wArea?[t._v("-"+t._s(e.wArea))]:t._e(),t._v(" "),e.isSurplus?[s("em",{staticClass:"change-ware"})]:t._e()],2)])])}),t._v(" "),t._l(t.enterMaterial.error,function(e,n){return s("div",{key:n,staticClass:"item error"},[t._m(1,!0),t._v(" "),s("div",{staticClass:"unit",attrs:{title:e.name}},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"unit reason",attrs:{title:e.reason}},[t._v("\n\t\t\t\t\t\t\t\t失败原因：\n\t\t\t\t\t\t\t\t"),s("div",{staticClass:"error-icon"},[t._v("!")]),t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.reason)+"\n\t\t\t\t\t\t\t")])])}),t._v(" "),t.enterMaterial.success.list.length||t.enterMaterial.error.length?t._e():s("div",{staticClass:"empty"},[t._v("- 暂无条目 -")])],2)])]):t._e(),t._v(" "),s(t.showWareWin,{tag:"component",attrs:{wid:t.wareId,width:500,height:200,errorList:t.errorList},on:{winEvent:t.wareWin,errorEmit:t.errorEmit}})],1),t._v(" "),t.wareShow?s("warehouse-win",{attrs:{title:"选择仓库-区域",wid:t.chooseWare,shopId:t.intoShopId,isBrand:t.intoIsBrand,areaId:t.chooseArea},on:{wareEvent:t.wareEvent}}):t._e(),t._v(" "),t.batchShow?s("goods-batch",{attrs:{goods:t.goodsItem,material:t.materialItem,selGoods:t.selGoodsBatch,selMat:t.selMatBatch,type:t.batchType},on:{goods:t.goodsWinClose,mat:t.materialWinClose}}):t._e()],1)};n._withStripped=!0;var a=s("81a2"),r=s("f6ce"),i=s("bbb9"),o=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var s=[],n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done)&&(s.push(i.value),!e||s.length!==e);n=!0);}catch(t){a=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return s}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function u(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,s){return function n(a,r){try{var i=e[a](r),o=i.value}catch(t){return void s(t)}if(!i.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}("next")})}}function c(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return Array.from(t)}var l={data:function(){return{showWareWin:null,details:{},allStatus:{1:"未出货",2:"待入货",3:"调度中",4:"已取消",5:"已完成",6:"已完成(异常)"},outWareId:"",detailObj:{},outGoods:[],outMaterial:[],enterList:[],enterGoods:{error:[],success:{list:[]}},enterMaterial:{error:[],success:{list:[]}},selGoodsBatch:[],selMatBatch:[],goodsItem:{},materialItem:{},batchType:0,listIndex:0,operate:{name:"",time:""},wareId:"",tabIndex:0,dispatchId:"",batchShow:!1,wareShow:!1,chooseWare:"",chooseArea:"",handleType:1,exportShopId:"",eachProps:["intoNum","consumeNum"],intoShopId:"",intoIsBrand:!1,isClick:!1,errorList:{goods:[],material:[]}}},components:{warehouseDetail:function(){return s.e("waremessage_win").then(s.bind(null,"39f2"))},goodsBatch:function(){return s.e("enter_goods_batch").then(s.bind(null,"500a6"))},errorWin:function(){return s.e("enter_goods_batch").then(s.bind(null,"d2b4"))},warehouseWin:function(){return s.e("warehouse_win_enter").then(s.bind(null,"11fb"))}},mounted:function(){this.initBtn(),this.dispatchId=this.$route.query.id,this.init(),this.getGoods(),this.getMaterial()},methods:{initBtn:function(){var t=this;this.btnArr=[{name:"确认",style:"background: #f8931f;border: 1px solid #f8931f;color: #fff;",fn:function(){t.confirm()}},{name:"取消",style:"background: #B3B3B3;border: 1px solid #B3B3B3;color: #fff;",fn:function(){r.a.session("operationRequestDestroy",!0),t.$router.go(-1)}}],this.$store.commit("setPageTools",this.btnArr)},openWareWin:function(t){this.wareId=t,this.showWareWin="warehouseDetail"},wareWin:function(){this.showWareWin=null},surplusAll:function(t,e){if("goods"==t){this.goodsItem.haveBatch=!1;var s=i.a.deepCopy(this.enterGoods.success.list);this.enterGoods.success.list=this.surplusAllCom(s,e,"goods")}else{this.materialItem.haveBatch=!1;var n=i.a.deepCopy(this.enterMaterial.success.list);this.enterMaterial.success.list=this.surplusAllCom(n,e,"mat")}},surplusAllCom:function(t,e,s){for(var n in t){var a=t[n],r=0;"goods"==s?r=Number(a.outNum)-Number(a.overIntoNum)-Number(a.overConsumeNum):"mat"==s&&(r=Number(a.outNumShow)-Number(a.overIntoNumShow)-Number(a.overConsumeNumShow)),"into"==e?(a.intoNum=r-a.consumeNum,this.autoGoodsBatch(a,a.intoNum,"intoNum","consumeNum")):(a.consumeNum=r-a.intoNum,this.autoGoodsBatch(a,a.consumeNum,"consumeNum","intoNum"))}return t},autoGoodsBatch:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];var n=o(e,4),a=n[0],r=n[1],i=n[2],u=n[3],c=!0,l=!1,m=void 0;try{for(var v,d=a.batchInfo[Symbol.iterator]();!(c=(v=d.next()).done);c=!0){v.value[i]=""}}catch(t){l=!0,m=t}finally{try{!c&&d.return&&d.return()}finally{if(l)throw m}}var h=!0,p=!1,_=void 0;try{for(var f,b=a.batchInfo[Symbol.iterator]();!(h=(f=b.next()).done);h=!0){var N=f.value,w=Number(N.num)-Number(N[u]);if(!(r>w)){N[i]=r;break}N[i]=w,r-=w}}catch(t){p=!0,_=t}finally{try{!h&&b.return&&b.return()}finally{if(p)throw _}}},intoInput:function(t,e){"into"==e?this.autoGoodsBatch(t,t.intoNum,"intoNum","consumeNum"):this.autoGoodsBatch(t,t.consumeNum,"consumeNum","intoNum")},setUnit:function(t,e,s){var n="",a=!0,r=!1,i=void 0;try{for(var o,u=s[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var c=o.value;if(e==c.name){n=Number(t)/Number(c.value);break}}}catch(t){r=!0,i=t}finally{try{!a&&u.return&&u.return()}finally{if(r)throw i}}return n},confirmVeri:function(t){var e="",s=/^[0-9]*$/,n=/^[0-9]*\.?[0-9]{0,3}$/;return-1==t.gType?e="物料":0==t.gType?e="普通商品":1!=t.gType&&2!=t.gType||(e="称重商品"),isNaN(t.intoNum)||isNaN(t.consumeNum)?(this.myAlert(e+"（"+t.name+"）只能输入数字"),!1):"普通商品"!=e||s.test(t.intoNum)?"普通商品"!=e||s.test(t.consumeNum)?"称重商品"!=e||n.test(t.intoNum)?"称重商品"!=e||n.test(t.consumeNum)?!(t.intoNum+t.consumeNum>t.outNum-t.overIntoNum-t.overConsumeNum)||(this.myAlert(e+"（"+t.name+"）可入货数量不足"),!1):(this.myAlert(e+"（"+t.name+"）耗损量只能输入小数点后三位"),!1):(this.myAlert(e+"（"+t.name+"）入货量只能输入小数点后三位"),!1):(this.myAlert(e+"（"+t.name+"）耗损量只能输入整数"),!1):(this.myAlert(e+"（"+t.name+"）入货量只能输入整数"),!1)},confirmVeriMat:function(t){var e=/^[0-9]*\.?[0-9]{0,3}$/;return e.test(t.intoNum)?!!e.test(t.consumeNum)||(this.myAlert("物料（"+t.name+"）耗损量只能输入小数点后三位"),!1):(this.myAlert("物料（"+t.name+"）入货量只能输入小数点后三位"),!1)},confirm:function(){if(this.enterGoods.success.list.length||this.enterMaterial.success.list.length){var t=[],e=0,s=i.a.deepCopy(this.enterGoods.success.list),n=!0,a=!1,r=void 0;try{for(var o,u=s[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var l=o.value;l.intoNum=Number(l.intoNum),l.consumeNum=Number(l.consumeNum);var m=!0,v=!1,d=void 0;try{for(var h,p=l.batchInfo[Symbol.iterator]();!(m=(h=p.next()).done);m=!0){var _=h.value;_.intoNum=Number(_.intoNum),_.consumeNum=Number(_.consumeNum)}}catch(t){v=!0,d=t}finally{try{!m&&p.return&&p.return()}finally{if(v)throw d}}if(!this.confirmVeri(l))return;e+=l.intoNum+l.consumeNum}}catch(t){a=!0,r=t}finally{try{!n&&u.return&&u.return()}finally{if(a)throw r}}t.push.apply(t,c(s));var f=i.a.deepCopy(this.enterMaterial.success.list),b=!0,N=!1,w=void 0;try{for(var y,C=f[Symbol.iterator]();!(b=(y=C.next()).done);b=!0){var g=y.value,x=i.a.deepCopy(g);if(!this.confirmVeriMat(x))return;g.intoNum=Number(g.intoNum)*g.unitValue,g.consumeNum=Number(g.consumeNum)*g.unitValue;var I=!0,S=!1,k=void 0;try{for(var W,A=g.batchInfo[Symbol.iterator]();!(I=(W=A.next()).done);I=!0){var B=W.value;B.intoNum=Number(B.intoNum)*g.unitValue,B.consumeNum=Number(B.consumeNum)*g.unitValue}}catch(t){S=!0,k=t}finally{try{!I&&A.return&&A.return()}finally{if(S)throw k}}if(!this.confirmVeri(g))return;e+=g.intoNum+g.consumeNum}}catch(t){N=!0,w=t}finally{try{!b&&C.return&&C.return()}finally{if(N)throw w}}t.push.apply(t,c(f)),e<=0?this.myAlert("入货/耗损 数量不能为空"):this.confirmSubmit(t)}else this.myAlert("没有可入货列表")},confirmSubmit:function(t){var e=this;return u(regeneratorRuntime.mark(function s(){var n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!e.isClick){s.next=3;break}return e.$store.commit("setWin",{title:"温馨提示",content:"请勿重复点击"}),s.abrupt("return");case 3:return e.isClick=!0,n=null,s.prev=5,s.next=8,a.a.DispatchrecordItemSubmit({data:{id:e.dispatchId,exportShopId:e.exportShopId,importShopId:e.intoShopId,list:t}},!0);case 8:n=s.sent,s.next=15;break;case 11:s.prev=11,s.t0=s.catch(5),e.$store.commit("setWin",{title:"错误提示",content:s.t0.error.message}),e.isClick=!1;case 15:"OK"==n?e.$store.commit("setWin",{title:"操作提示",content:"入货成功",callback:function(){r.a.session("operationRequestDestroy",!0),window.history.go(-1)}}):(e.showWareWin="errorWin",e.errorList.goods=n.goodsError,e.errorList.material=n.materialError);case 16:case"end":return s.stop()}},s,e,[[5,11]])}))()},init:function(){var t=this;return u(regeneratorRuntime.mark(function e(){var s,n,r,i,o,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getDispatchRecordDetailList({data:{id:t.dispatchId}});case 2:for(s=e.sent,n=!0,r=!1,i=void 0,e.prev=6,o=s.invoiceList[Symbol.iterator]();!(n=(u=o.next()).done);n=!0)1==(c=u.value).type&&(t.operate.name=c.operateUname,t.operate.time=t.timeConversion(c.operateTime,1));e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),r=!0,i=e.t0;case 14:e.prev=14,e.prev=15,!n&&o.return&&o.return();case 17:if(e.prev=17,!r){e.next=20;break}throw i;case 20:return e.finish(17);case 21:return e.finish(14);case 22:t.details=s,t.outWareId=s.outWarehouse,t.getWareDetail(t.details.intoWarehouse);case 25:case"end":return e.stop()}},e,t,[[6,10,14,22],[15,,17,21]])}))()},getGoods:function(){var t=this;return u(regeneratorRuntime.mark(function e(){var s,n,r,i,o,u,c,l,m,v,d,h,p,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.DispatchrecordGetGoodsList({data:{id:t.dispatchId}});case 2:s=e.sent,n=!0,r=!1,i=void 0,e.prev=6,o=s.success.list[Symbol.iterator]();case 8:if(n=(u=o.next()).done){e.next=36;break}for((c=u.value).intoNum="",c.consumeNum="",l=!0,m=!1,v=void 0,e.prev=15,d=c.batchInfo[Symbol.iterator]();!(l=(h=d.next()).done);l=!0)(p=h.value).numShow=p.num,p.intoNum="",p.consumeNum="";e.next=23;break;case 19:e.prev=19,e.t0=e.catch(15),m=!0,v=e.t0;case 23:e.prev=23,e.prev=24,!l&&d.return&&d.return();case 26:if(e.prev=26,!m){e.next=29;break}throw v;case 29:return e.finish(26);case 30:return e.finish(23);case 31:_=c.outNum-c.overIntoNum-c.overConsumeNum,c.isSurplus=_>0;case 33:n=!0,e.next=8;break;case 36:e.next=42;break;case 38:e.prev=38,e.t1=e.catch(6),r=!0,i=e.t1;case 42:e.prev=42,e.prev=43,!n&&o.return&&o.return();case 45:if(e.prev=45,!r){e.next=48;break}throw i;case 48:return e.finish(45);case 49:return e.finish(42);case 50:t.enterGoods=s,s.success.exportShopId&&(t.exportShopId=s.success.exportShopId);case 52:case"end":return e.stop()}},e,t,[[6,38,42,50],[15,19,23,31],[24,,26,30],[43,,45,49]])}))()},getMaterial:function(){var t=this;return u(regeneratorRuntime.mark(function e(){var s,n,r,i,o,u,c,l,m,v,d,h,p,_,f,b,N,w,y,C;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.DispatchrecordGetMaterialList({data:{id:t.dispatchId}});case 2:s=e.sent,n=!0,r=!1,i=void 0,e.prev=6,o=s.success.list[Symbol.iterator]();case 8:if(n=(u=o.next()).done){e.next=66;break}for((c=u.value).outNumShow=t.setUnit(c.outNum,c.unit,c.unitData),c.overIntoNumShow=t.setUnit(c.overIntoNum,c.unit,c.unitData),c.overConsumeNumShow=t.setUnit(c.overConsumeNum,c.unit,c.unitData),c.intoNum="",c.consumeNum="",l=!0,m=!1,v=void 0,e.prev=18,d=c.batchInfo[Symbol.iterator]();!(l=(h=d.next()).done);l=!0)(p=h.value).numShow=t.setUnit(p.num,c.unit,c.unitData),p.intoNum="",p.consumeNum="";e.next=26;break;case 22:e.prev=22,e.t0=e.catch(18),m=!0,v=e.t0;case 26:e.prev=26,e.prev=27,!l&&d.return&&d.return();case 29:if(e.prev=29,!m){e.next=32;break}throw v;case 32:return e.finish(29);case 33:return e.finish(26);case 34:_=!0,f=!1,b=void 0,e.prev=37,N=c.unitData[Symbol.iterator]();case 39:if(_=(w=N.next()).done){e.next=47;break}if(y=w.value,c.unit!=y.name){e.next=44;break}return c.unitValue=Number(y.value),e.abrupt("break",47);case 44:_=!0,e.next=39;break;case 47:e.next=53;break;case 49:e.prev=49,e.t1=e.catch(37),f=!0,b=e.t1;case 53:e.prev=53,e.prev=54,!_&&N.return&&N.return();case 56:if(e.prev=56,!f){e.next=59;break}throw b;case 59:return e.finish(56);case 60:return e.finish(53);case 61:C=c.outNum-c.overIntoNum-c.overConsumeNum,c.isSurplus=C>0;case 63:n=!0,e.next=8;break;case 66:e.next=72;break;case 68:e.prev=68,e.t2=e.catch(6),r=!0,i=e.t2;case 72:e.prev=72,e.prev=73,!n&&o.return&&o.return();case 75:if(e.prev=75,!r){e.next=78;break}throw i;case 78:return e.finish(75);case 79:return e.finish(72);case 80:t.enterMaterial=s,s.success.exportShopId&&(t.exportShopId=s.success.exportShopId);case 82:case"end":return e.stop()}},e,t,[[6,68,72,80],[18,22,26,34],[27,,29,33],[37,49,53,61],[54,,56,60],[73,,75,79]])}))()},getWareDetail:function(t){var e=this;return u(regeneratorRuntime.mark(function s(){var n,r,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,a.a.warehouseGetWarehouse({data:{id:t}});case 2:n=s.sent,r=n.owner.split(",")[0],0!=(i=n.owner.split(",")[1])?(e.intoShopId=i,e.intoIsBrand=!1):(e.intoShopId=r,e.intoIsBrand=!0);case 6:case"end":return s.stop()}},s,e)}))()},errorEmit:function(t){t&&(this.showWareWin=null,this.$store.commit("setWin",{title:"操作提示",content:"匹配成功的商品或物料，入货成功",callback:function(){r.a.session("operationRequestDestroy",!0),window.history.go(-1)}}))},goodsHandle:function(t){var e=t.target,s=t.currentTarget.getAttribute("data-index"),n=this.enterGoods.success.list[s];e.className.includes("sel-batch")?this.openBatchWinGoods(n,"goods"):e.className.includes("change-ware")&&(this.chooseWare=n.wid,this.chooseArea=n.areaId,this.handleType=1,this.goodsItem=n,this.wareShow=!0),"input"==e.tagName.toLocaleLowerCase()&&"disabled"==e.getAttribute("disabled")&&this.myAlert("请先清空该批次数据,再进行修改")},materialHandle:function(t){var e=t.target,s=t.currentTarget.getAttribute("data-index"),n=this.enterMaterial.success.list[s];e.className.includes("sel-batch")?this.openBatchWinGoods(n,"mat"):e.className.includes("change-ware")&&(this.chooseWare=n.wid,this.chooseArea=n.areaId,this.handleType=2,this.materialItem=n,this.wareShow=!0)},openBatchWinGoods:function(t,e){"goods"==e?(this.batchType=0,this.goodsItem=t,this.selGoodsBatch=i.a.deepCopy(this.goodsItem.batchInfo)):(this.batchType=1,this.materialItem=t,this.selMatBatch=i.a.deepCopy(this.materialItem.batchInfo)),this.batchShow=!0},goodsWinClose:function(t,e){if("ok"==t){this.goodsItem.batchInfo=e;var s=0,n=0,a=!0,r=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var c=o.value;s+=Number(c.intoNum),n+=Number(c.consumeNum)}}catch(t){r=!0,i=t}finally{try{!a&&u.return&&u.return()}finally{if(r)throw i}}this.goodsItem.intoNum=s,this.goodsItem.consumeNum=n,this.goodsItem.haveBatch=s>0||n>0,this.numberVeri(this.goodsItem)}this.batchShow=!1},materialWinClose:function(t,e){if("ok"==t){this.materialItem.batchInfo=e;var s=0,n=0,a=!0,r=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var c=o.value;s+=Number(c.intoNum),n+=Number(c.consumeNum)}}catch(t){r=!0,i=t}finally{try{!a&&u.return&&u.return()}finally{if(r)throw i}}if(this.materialItem.intoNum=s,this.materialItem.consumeNum=n,this.materialItem.haveBatch=s>0||n>0,!this.numberVeri(this.materialItem))return}this.batchShow=!1},numberVeri:function(t){var e=Number(t.outNum)-Number(t.overIntoNum)-Number(t.overConsumeNum);if(Number(t.intoNum)+Number(t.consumeNum)>e){t.noPass=!0;var s="("+t.name+") 剩余可入货数量不足";return this.myAlert(s),!1}return!0},wareEvent:function(t,e){if("ok"==t)if(1==this.handleType)for(var s in e)this.goodsItem[s]=e[s];else for(var n in e)this.materialItem[n]=e[n];this.wareShow=!1},myAlert:function(t){this.$store.commit("setWin",{title:"操作提示",content:t})},listClick:function(t){this.listIndex=t},timeConversion:function(t,e){return e?i.a.format(new Date(1e3*t),"yyyy-MM-dd hh:mm:ss"):i.a.format(new Date(1e3*t),"yyyy年MM月dd日")}}},m=(s("eddc"),s("7610")),v=Object(m.a)(l,n,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"unit narrow"},[e("em",{staticClass:"handle-btn error select-ban"},[this._v("匹配失败")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"unit narrow"},[e("em",{staticClass:"handle-btn error select-ban"},[this._v("匹配失败")])])}],!1,null,"589b28c2",null);v.options.__file="src\\module\\invoicing_system\\warehouse_manage\\enter_goods.vue";e.default=v.exports},eddc:function(t,e,s){"use strict";var n=s("6af0");s.n(n).a}}]);