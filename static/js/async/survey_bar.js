(window.webpackJsonp=window.webpackJsonp||[]).push([["survey_bar"],{"06b0":function(t,a,e){"use strict";e.r(a);var r=e("81a2");var s={props:["bar","echarts","shopList","shopIds"],data:function(){return{dataBar:{xAxis:{business:[],amount:[],orderNumber:[],discount:[]},total:{business:[],amount:[],orderNumber:[],discount:[]},eatIn:{business:[],amount:[],orderNumber:[],discount:[]},takeOut:{business:[],amount:[],discount:[],orderNumber:[]},selfTakeOut:{business:[],amount:[],discount:[],orderNumber:[]},quickPayment:{business:[],amount:[],orderNumber:[],discount:[]}},tabList:[{type:"business",name:"营业总额"},{type:"discount",name:"优惠总额"},{type:"amount",name:"入账金额"},{type:"orderNumber",name:"订单量"}],barType:"business",tabIndex:0,checkList:[{name:"总值",className:"total",color:"#ff9800"},{name:"堂吃",className:"eatIn",color:"#fcd030"},{name:"外卖",className:"takeOut",color:"#1b88ee"},{name:"自营外卖",className:"selfTakeOut",color:"#ee2125"},{name:"快捷支付",className:"quickPayment",color:"#a16bff"}],barSelect:{"总值":!0,"堂吃":!0,"外卖":!0,"自营外卖":!0,"快捷支付":!0},sliderBarEnd:100,barDom:null,seriesData:[],isAll:!1,isSuc:!1}},mounted:function(){this.analytic(),this.echarts&&this.initEchart()},methods:{getMore:function(){var t,a=this;return(t=regeneratorRuntime.mark(function t(){var e,s,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a.isAll){t.next=3;break}return a.$store.commit("setWin",{title:"提示信息",winType:"alter",content:"正在加载，请勿重复点击"}),t.abrupt("return");case 3:a.isAll=!0,e=1;case 5:if(!(e<a.shopIds.length)){t.next=13;break}return t.next=8,r.a.turnoverGetMoreShopStat({data:{shopIds:a.shopIds[e],type:1}});case 8:for(i in s=t.sent)a.bar[i]={},a.bar[i].eatIn={},a.bar[i].quickPayment={},a.bar[i].takeOut={},a.bar[i].total={},a.bar[i].selfTakeOut={},a.bar[i].eatIn.business=s[i].ePrice,a.bar[i].eatIn.amount=s[i].eRealPrice,a.bar[i].eatIn.orderNumber=s[i].eOrderNum,a.bar[i].eatIn.discount=s[i].eDiscount,a.bar[i].quickPayment.business=s[i].kPrice,a.bar[i].quickPayment.amount=s[i].kRealPrice,a.bar[i].quickPayment.orderNumber=s[i].kOrderNum,a.bar[i].quickPayment.discount=s[i].kDiscount,a.bar[i].takeOut.business=s[i].tPrice,a.bar[i].takeOut.amount=s[i].tRealPrice,a.bar[i].takeOut.orderNumber=s[i].tOrderNum,a.bar[i].takeOut.discount=s[i].tDiscount,a.bar[i].total.business=s[i].Price,a.bar[i].total.amount=s[i].RealPrice,a.bar[i].total.orderNumber=s[i].OrderNum,a.bar[i].total.discount=s[i].Discount,a.bar[i].selfTakeOut.business=s[i].sPrice,a.bar[i].selfTakeOut.amount=s[i].sRealPrice,a.bar[i].selfTakeOut.orderNumber=s[i].sOrderNum,a.bar[i].selfTakeOut.discount=s[i].sOrderNum;case 10:e++,t.next=5;break;case 13:a.analytic(),a.echarts&&a.initEchart(),a.isSuc=!0;case 16:case"end":return t.stop()}},t,a)}),function(){var a=t.apply(this,arguments);return new Promise(function(t,e){return function r(s,i){try{var n=a[s](i),o=n.value}catch(t){return void e(t)}if(!n.done)return Promise.resolve(o).then(function(t){r("next",t)},function(t){r("throw",t)});t(o)}("next")})})()},analytic:function(){var t=this.bar,a=[];for(var e in t){var r=!0,s=!1,i=void 0;try{for(var n,o=this.shopList[Symbol.iterator]();!(r=(n=o.next()).done);r=!0){var c=n.value;c.id==e&&a.push(c.name)}}catch(t){s=!0,i=t}finally{try{!r&&o.return&&o.return()}finally{if(s)throw i}}for(var u in this.dataBar.xAxis)this.dataBar.xAxis[u]=a;for(var l in t[e])for(var b in t[e][l])this.dataBar[l][b].push(t[e][l][b])}if(a.length>10){var d=10/a.length;(d=d.toFixed(2)-0)>1&&(d=1),this.sliderBarEnd=100*d}},initEchart:function(){this.barDom=this.echarts.init(document.getElementById("bar-charts")),this.setBarListData(this.dataBar,this.barType),this.barDom.setOption(this.getBarData(this.dataBar,this.barType))},setBarListData:function(t,a){var e=[],r=!0,s=!1,i=void 0;try{for(var n,o=this.checkList[Symbol.iterator]();!(r=(n=o.next()).done);r=!0){var c=n.value,u={name:c.name,type:"bar",animation:!0,barWidth:15,barGap:"20%",itemStyle:{normal:{color:c.color}},data:t[c.className][a]};e.push(u)}}catch(t){s=!0,i=t}finally{try{!r&&o.return&&o.return()}finally{if(s)throw i}}this.seriesData=e},getBarData:function(t,a){return{legend:{selected:this.barSelect},grid:{top:30,left:80,right:70,bottom:70},tooltip:{trigger:"axis",axisPointer:{type:"cross",animation:!1,label:{backgroundColor:"#505765"}}},xAxis:[{name:"店铺名称",axisTick:{show:!1},data:t.xAxis[a]}],yAxis:[{name:this.tabList[this.tabIndex].name,type:"value",axisTick:{show:!1}}],dataZoom:[{type:"slider",show:!0,start:0,end:this.sliderBarEnd}],series:this.seriesData}},chartSelect:function(t){var a=t.currentTarget,e=parseInt(a.getAttribute("data-index")),r=this.checkList[e].name;this.barSelect[r]=!this.barSelect[r],this.setBarListData(this.dataBar,this.barType),this.barDom.setOption(this.getBarData(this.dataBar,this.barType))},tabBtn:function(){var t=event.target;if("li"==t.tagName.toLocaleLowerCase()){var a=parseInt(t.getAttribute("data-index"));this.tabIndex=a,this.barType=this.tabList[a].type,this.setBarListData(this.dataBar,this.barType),this.barDom.setOption(this.getBarData(this.dataBar,this.barType))}}}},i=(e("e357"),e("d801")),n=Object(i.a)(s,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"line"},[e("div",{staticClass:"head"},[e("span",{staticClass:"name"},[t._v("店铺统计")]),t._v(" "),e("div",{staticClass:"tab"},[e("ul",{staticClass:"select-ban",on:{click:t.tabBtn}},t._l(t.tabList,function(a,r){return e("li",{key:r,class:{active:t.tabIndex==r},attrs:{"data-index":r}},[t._v(t._s(a.name))])}))])]),t._v(" "),t._m(0),t._v(" "),e("div",{staticClass:"chart-select select-ban"},[t._l(t.checkList,function(a,r){return e("div",{key:r,staticClass:"check-div",class:[{active:t.barSelect[a.name]},a.className],attrs:{"data-index":r},on:{click:t.chartSelect}},[e("i"),t._v(t._s(a.name)+"\n\t\t")])}),t._v(" "),!t.isAll&&this.shopIds.length>1&&!t.isSuc?e("span",{staticClass:"get-more",on:{click:t.getMore}},[t._v("\n\t\t\t加载所有店铺\n\t\t")]):t._e()],2)])},[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"chart-box"},[a("div",{attrs:{id:"bar-charts"}})])}],!1,null,"6764607c",null);a.default=n.exports},"5a6f":function(t,a,e){},e357:function(t,a,e){"use strict";var r=e("5a6f");e.n(r).a}}]);