(window.webpackJsonp=window.webpackJsonp||[]).push([["add_goods_win"],{"7ea0":function(t,e,i){},b6e5:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"detail-addgoods"}},[o("win",{attrs:{height:650,width:700,align:"right",ok:t.btnOk,cancel:t.btnCancel},on:{winEvent:t.closeSelfWin}},[o("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),o("div",{staticClass:"win-content",attrs:{slot:"content"},slot:"content"},[o("section",{staticClass:"commodity-form"},[o("section",{staticClass:"titleTop",staticStyle:{width:"100%",height:"40px"}},[o("div",{staticClass:"good-baseInfo"},[o("i"),t._v(" "),o("h3",[t._v("基本信息")]),t._v(" "),o("div",{staticClass:"dian"}),t._v(" "),t.good.id?o("span",[t._v("商品ID:"+t._s(t.good.id))]):t._e()])]),t._v(" "),o("section",{staticClass:"good-type"},[o("label",{staticClass:"commodity-name required fl"},[t._v("类型")]),t._v(" "),o("label",{staticClass:"fl commodity-type"},[t._l(t.goodsType,function(e,i){return[o("span",{key:i,class:{signa:e.type==t.good.type},staticStyle:{"margin-right":"15px",border:"1px solid #BDBDBD",cursor:"default"},on:{click:function(i){t.toggleGoodType(e.type)}}},[t._v(t._s(e.name))])]})],2)]),t._v(" "),o("section",{staticClass:"good-sort"},[o("label",{staticClass:"commodity-name required fl"},[t._v("排序")])]),t._v(" "),o("div",[o("sub-add",{attrs:{minnum:1,bindnum:t.good.sort,sign:!1},on:{toClick:function(e){t.switchFn(e,"sort")}}})],1),t._v(" "),2==t.good.type?o("section",[o("label",{staticClass:"commodity-name required fl"},[t._v("分类")]),t._v(" "),o("label",{staticClass:"commodity-type fl",staticStyle:{width:"600px"}},[t._l(t.selectCategory,function(e,i){return o("span",{key:i,staticClass:"signa",on:{click:function(o){t.deleteSelectCategory(e,i)}}},[t._v(t._s(e.name))])}),t._v(" "),o("a",{staticClass:"addclassify fl",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加分类")])],2)]):t._e(),t._v(" "),1==t.good.type||0==t.good.type?o("section",{staticStyle:{width:"100%"}},[o("section",{staticClass:"fl",staticStyle:{width:"65%","margin-top":"0"}},[o("section",{staticStyle:{"margin-top":"0","margin-bottom":"15px"}},[o("label",{staticClass:"commodity-name required fl"},[t._v("名称")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.goodsName,expression:"good.goodsName"}],attrs:{type:"text",placeholder:"输入名称",maxlength:"45"},domProps:{value:t.good.goodsName},on:{input:function(e){e.target.composing||t.$set(t.good,"goodsName",e.target.value)}}})])]),t._v(" "),o("section",{staticStyle:{"margin-top":"0","margin-bottom":"15px"}},[o("label",{staticClass:"commodity-name fl"},[t._v("简码")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.BC,expression:"good.BC"}],attrs:{type:"text",placeholder:"输入简码",maxlength:"20"},domProps:{value:t.good.BC},on:{input:function(e){e.target.composing||t.$set(t.good,"BC",e.target.value)}}})])]),t._v(" "),1!=t.good.isGroup&&0==t.good.type?o("section",{staticStyle:{margin:"0"}},[o("label",{staticClass:"commodity-name required fl"},[t._v("售价")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.price,expression:"good.price"}],staticStyle:{width:"106px"},attrs:{type:"text",placeholder:"输入售价",maxlength:"7"},domProps:{value:t.good.price},on:{input:function(e){e.target.composing||t.$set(t.good,"price",e.target.value)}}}),t._v(" "),o("div",{staticClass:"good-price"},[t._v("元")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.unit,expression:"good.unit"}],staticStyle:{width:"75px","margin-right":"1px"},attrs:{type:"text",placeholder:"输入单位",maxlength:"5"},domProps:{value:t.good.unit},on:{input:function(e){e.target.composing||t.$set(t.good,"unit",e.target.value)}}})]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.cost,expression:"good.cost"}],staticStyle:{width:"63px"},attrs:{type:"text",placeholder:"输入成本",maxlength:"10"},domProps:{value:t.good.cost},on:{input:function(e){e.target.composing||t.$set(t.good,"cost",e.target.value)}}}),t._v(" "),o("div",{staticClass:"good-cost"},[t._v("元")])])]):t._e(),t._v(" "),1==t.good.type?o("section",{staticStyle:{margin:"0"}},[o("label",{staticClass:"commodity-name required fl"},[t._v("售价")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.price,expression:"good.price"}],staticStyle:{width:"70px"},attrs:{type:"text",placeholder:"输入售价",maxlength:"7"},domProps:{value:t.good.price},on:{input:function(e){e.target.composing||t.$set(t.good,"price",e.target.value)}}}),t._v(" "),o("div",{staticClass:"good-price"},[t._v("元")]),t._v(" "),o("label",[o("div",{staticClass:"weight",on:{click:function(t){t.stopPropagation()}}},[o("div",{staticClass:"sList fl",staticStyle:{border:"1px solid #ccc","margin-left":"10px",position:"relative"}},[o("div",{staticClass:"tableListInp",on:{click:t.funToggleUnit}},[o("span",[t._v(t._s(t.good.unit))]),t._v(" "),o("div",{staticClass:"fl",staticStyle:{"background-color":"#fff"}},[o("i")])]),t._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:t.showUnit,expression:"showUnit"}],staticClass:"tableListUl",on:{click:function(e){t.funGetUnit(e)}}},t._l(t.unitArr,function(e,i){return o("li",{key:i},[t._v(t._s(e.name))])}))]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.cost,expression:"good.cost"}],staticStyle:{width:"63px","margin-left":"10px"},attrs:{type:"text",placeholder:"输入成本",maxlength:"10"},domProps:{value:t.good.cost},on:{input:function(e){e.target.composing||t.$set(t.good,"cost",e.target.value)}}}),t._v(" "),o("div",{staticClass:"good-cost"},[t._v("元")])])])]):t._e()]),t._v(" "),o("div",{staticClass:"good-image"},[o("div",{staticClass:"good-image-div",attrs:{id:"image"}},[t.good.imageName?o("img",{attrs:{src:t.good.imageName.indexOf("http")>-1?t.good.imageName:t.imgHost+t.good.imageName,width:"225",height:"150"}}):o("img",{attrs:{src:i("b7c2"),width:"225",height:"150",alt:"商品"}}),t._v(" "),o("a",{staticClass:"gray good-image-delete",on:{click:t.deleteGoodImg}},[t._v("删除图片")]),t._v(" "),o("a",{staticClass:"yellow good-image-edit"},[t._v("编辑图片")]),t._v(" "),o("form",{attrs:{enctype:"multipart/form-data",id:"img_upload"}},[o("input",{staticClass:"good-image-file",attrs:{type:"file",accept:"image/jpeg,image/png,image/gif,image/tiff",name:"image"},on:{change:t.uploadGoodsImg}})])])]),t._v(" "),o("section",[0==t.good.type&&1==t.good.isInvoicing?[o("section",{staticStyle:{"margin-top":"0","margin-bottom":"15px",width:"350px"}},[o("label",{staticClass:"commodity-name fl"},[t._v("品牌")]),t._v(" "),o("label",{staticClass:"commodity-type fl"},[o("a",{staticClass:"addclassify fl",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.openCommonWin("brand")}}},[t._v("选择品牌")]),t._v(" "),t.selectBrandObj.name?o("span",{staticClass:"sign",staticStyle:{width:"120px",padding:"0 10px"}},[t._v(t._s(t.selectBrandObj.name))]):t._e()])]),t._v(" "),o("section",{directives:[{name:"show",rawName:"v-show",value:1!=t.good.isGroup,expression:"good.isGroup!=1"}],staticStyle:{"margin-top":"0","margin-bottom":"15px",float:"left",width:"320px"}},[o("label",{staticClass:"commodity-name required fl"},[t._v("条码")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.barCode,expression:"good.barCode"}],staticStyle:{width:"140px"},attrs:{type:"text",placeholder:"输入条码",maxlength:"13"},domProps:{value:t.good.barCode},on:{input:function(e){e.target.composing||t.$set(t.good,"barCode",e.target.value)}}}),t._v(" "),o("a",{staticClass:"yellow",staticStyle:{width:"80px",height:"40px","line-height":"40px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.setBarCode("barCode",null,null)}}},[t._v("获取条码")])])]),t._v(" "),o("section",{directives:[{name:"show",rawName:"v-show",value:1!=t.good.isGroup,expression:"good.isGroup!=1"}],staticClass:"good-invalidity"},[o("label",{staticClass:"commodity-name fl"},[t._v("保质期")]),t._v(" "),o("label",{staticStyle:{width:"250px"}},[o("div",{staticClass:"weight",on:{click:function(t){t.stopPropagation()}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.validity,expression:"good.validity"}],staticClass:"good-invalidity-input",attrs:{type:"text",placeholder:"输入保质期",maxlength:"3"},domProps:{value:t.good.validity},on:{input:function(e){e.target.composing||t.$set(t.good,"validity",e.target.value)}}}),t._v(" "),o("div",{staticClass:"sList fl",staticStyle:{"margin-left":"10px"}},[o("div",{staticClass:"tableListInp",on:{click:function(e){t.showValidity=!t.showValidity}}},[o("span",{staticStyle:{border:"1px solid #ccc"}},[t._v(t._s(t.good.validityType))]),t._v(" "),o("div",{staticClass:"fl",staticStyle:{"background-color":"#fff",border:"1px solid #ccc","border-left":"none"}},[o("i")])]),t._v(" "),t.showValidity?o("ul",{staticClass:"tableListUl",on:{click:function(e){t.funGetGoodValidityType(e)}}},t._l(t.validityTypeArr,function(e,i){return o("li",{key:i},[t._v(t._s(e.name))])})):t._e()])])])]),t._v(" "),o("section",{directives:[{name:"show",rawName:"v-show",value:1!=t.good.isGroup,expression:"good.isGroup!=1"}],staticStyle:{"margin-top":"0","margin-bottom":"15px",float:"left",width:"320px"}},[o("label",{staticClass:"commodity-name fl"},[t._v("副条码")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.secBarCode,expression:"good.secBarCode"}],staticStyle:{width:"140px"},attrs:{type:"text",placeholder:"输入副条码",maxlength:"13"},domProps:{value:t.good.secBarCode},on:{input:function(e){e.target.composing||t.$set(t.good,"secBarCode",e.target.value)}}}),t._v(" "),o("a",{staticClass:"yellow",staticStyle:{width:"80px",height:"40px","line-height":"40px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.setBarCode("secBarCode",null,null)}}},[t._v("获取条码")])])]),t._v(" "),o("section",{directives:[{name:"show",rawName:"v-show",value:1!=t.good.isGroup,expression:"good.isGroup!=1"}],staticClass:"good-speci"},[o("label",{staticClass:"commodity-name required fl"},[t._v("规格")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.specifications,expression:"good.specifications"}],staticStyle:{width:"228px"},attrs:{type:"text",placeholder:"输入规格",maxlength:"21"},domProps:{value:t.good.specifications},on:{input:function(e){e.target.composing||t.$set(t.good,"specifications",e.target.value)}}})])])]:t._e(),t._v(" "),1==t.good.type&&1==t.good.isCode?[o("section",{staticClass:"good-brand"},[o("label",{staticClass:"commodity-name fl"},[t._v("品牌")]),t._v(" "),o("label",{staticClass:"commodity-type fl"},[o("a",{staticClass:"addclassify fl",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.openCommonWin("brand")}}},[t._v("选择品牌")]),t._v(" "),t.selectBrandObj.name?o("span",{staticClass:"sign",staticStyle:{width:"120px",padding:"0 10px"}},[t._v(t._s(t.selectBrandObj.name))]):t._e()])]),t._v(" "),o("section",{staticClass:"good-code"},[o("label",{staticClass:"commodity-name required fl",staticStyle:{width:"90px"}},[t._v("类别(识别码)")]),t._v(" "),o("div",{staticClass:"weight"},[o("div",{staticClass:"sList fl"},[o("div",{staticClass:"tableListInp",on:{click:function(e){return e.stopPropagation(),t.funShowList(e)}}},[o("span",{staticStyle:{width:"180px",border:"1px solid #ccc"}},[t._v(t._s(t.identifyName))]),t._v(" "),o("div",{staticClass:"fl",staticStyle:{"background-color":"#fff",border:"1px solid #ccc","border-left":"none"}},[o("i")])]),t._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:t.showBarList,expression:"showBarList"}],staticClass:"tableListUl",staticStyle:{"max-height":"300px",overflow:"auto"}},t._l(t.barList,function(e,i){return o("li",{key:i,on:{click:function(o){t.funSelectList(e,i)}}},[t._v(t._s(e.name))])}))])])]),t._v(" "),o("section",{staticClass:"good-invalidity"},[o("label",{staticClass:"commodity-name fl"},[t._v("保质期")]),t._v(" "),o("label",{staticStyle:{width:"250px"}},[o("div",{staticClass:"weight",on:{click:function(t){t.stopPropagation()}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.validity,expression:"good.validity"}],staticStyle:{width:"120px","margin-left":"1px",float:"left"},attrs:{type:"text",placeholder:"输入保质期",maxlength:"3"},domProps:{value:t.good.validity},on:{input:function(e){e.target.composing||t.$set(t.good,"validity",e.target.value)}}}),t._v(" "),o("div",{staticClass:"sList fl",staticStyle:{"margin-left":"10px"}},[o("div",{staticClass:"tableListInp",on:{click:function(e){t.showValidity=!t.showValidity}}},[o("span",{staticStyle:{border:"1px solid #ccc"}},[t._v(t._s(t.good.validityType))]),t._v(" "),o("div",{staticClass:"fl",staticStyle:{"background-color":"#fff",border:"1px solid #ccc","border-left":"none"}},[o("i")])]),t._v(" "),t.showValidity?o("ul",{staticClass:"tableListUl",on:{click:function(e){t.funGetGoodValidityType(e)}}},t._l(t.validityTypeArr,function(e,i){return o("li",{key:i},[t._v(t._s(e.name))])})):t._e()])])])]),t._v(" "),o("section",{staticStyle:{"margin-top":"0","margin-bottom":"15px",float:"left",width:"320px"}},[o("label",{staticClass:"commodity-name required fl",staticStyle:{width:"90px"}},[t._v("商品识别码")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.identifyCode,expression:"good.identifyCode"}],staticStyle:{width:"135px"},attrs:{type:"text",placeholder:"输入商品识别码",maxlength:"5"},domProps:{value:t.good.identifyCode},on:{input:function(e){e.target.composing||t.$set(t.good,"identifyCode",e.target.value)}}}),t._v(" "),o("a",{staticClass:"yellow",staticStyle:{width:"80px",height:"40px","line-height":"40px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.setBarCode("identifyCode",null,null)}}},[t._v("生成识别码")])])])]:t._e()],2),t._v(" "),o("section",[o("label",{staticClass:"commodity-name required fl"},[t._v("分类")]),t._v(" "),o("label",{staticClass:"commodity-type fl",staticStyle:{width:"600px"}},[t._l(t.selectCategory,function(e,i){return o("span",{key:i,staticClass:"sign",on:{click:function(o){t.deleteSelectCategory(e,i)}}},[t._v(t._s(e.name))])}),t._v(" "),o("a",{staticClass:"addclassify fl",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加分类")])],2)]),t._v(" "),1==t.ischain||2==t.ischain?o("section",[t.good.id?o("label",{staticClass:"commodity-name fl"},[t._v("来源")]):t._e(),t._v(" "),t.good.id?o("label",{staticStyle:{width:"600px"},attrs:{id:"cids"}},[t.good.id>1e5?o("span",[t._v("门店自建")]):t._e(),t._v(" "),t.good.id>1&&t.good.id<1e5?o("span",[t._v("品牌同步")]):t._e()]):t._e()]):t._e(),t._v(" "),1!=t.good.isGroup&&1!=t.good.isCode?o("section",[o("label",{staticClass:"commodity-name  fl"},[t._v("口味")]),t._v(" "),o("label",{staticClass:"commodity-type fl",staticStyle:{width:"600px"},attrs:{id:"attrs"}},[t._l(t.selectAttr,function(e,i){return o("span",{key:i,staticClass:"sign",on:{click:function(o){t.deleteSelectAttr(e,i)}}},[t._v(t._s(e.name))])}),t._v(" "),o("a",{staticClass:"addclassify fl",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.openCommonWin("attr")}}},[t._v("添加口味")])],2)]):t._e(),t._v(" "),0==t.good.type?o("section",[o("label",{staticClass:"commodity-name  fl"},[t._v("多规格")]),t._v(" "),o("span",{staticClass:"on check-span fl",staticStyle:{display:"inline-block"}},[o("on-off",{attrs:{status:1==t.good.isGroup},on:{statusChange:t.toggleIsGroup}})],1),t._v(" "),o("a",{directives:[{name:"show",rawName:"v-show",value:1==t.good.isGroup,expression:"good.isGroup==1"}],staticClass:"addclassify fl",staticStyle:{"margin-left":"20px",display:"inline-block"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.addGroup(1)}}},[t._v("添加规格")])]):t._e(),t._v(" "),1==t.good.isGroup&&0==t.good.type?o("section",t._l(t.groupData,function(e,i){return o("div",{key:i},[o("div",{staticClass:"good-group"},[0==i?o("label",{staticClass:"commodity-name required fl"},[t._v("规格\n\t\t\t\t\t\t\t\t一\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),1==i?o("label",{staticClass:"commodity-name required fl"},[t._v("规格\n\t\t\t\t\t\t\t\t二\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),2==i?o("label",{staticClass:"commodity-name required fl"},[t._v("规格\n\t\t\t\t\t\t\t\t三\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.goodsName,expression:"group.goodsName"}],staticStyle:{width:"76px"},attrs:{type:"text",placeholder:"规格名称",maxlength:"6"},domProps:{value:e.goodsName},on:{input:function(i){i.target.composing||t.$set(e,"goodsName",i.target.value)}}}),t._v(" "),o("label",{staticClass:"commodity-name required fl",staticStyle:{width:"60px"}},[t._v("售价")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"group.price"}],staticStyle:{width:"40px"},attrs:{type:"text",placeholder:"售价",maxlength:"10"},domProps:{value:e.price},on:{input:function(i){i.target.composing||t.$set(e,"price",i.target.value)}}}),t._v(" "),o("div",{staticClass:"price"},[t._v("元")])]),t._v(" "),o("label",{staticClass:"commodity-name fl",staticStyle:{width:"60px"}},[t._v("成本")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.cost,expression:"group.cost"}],staticStyle:{width:"40px"},attrs:{type:"text",placeholder:"成本",maxlength:"10"},domProps:{value:e.cost},on:{input:function(i){i.target.composing||t.$set(e,"cost",i.target.value)}}}),t._v(" "),o("div",{staticClass:"cost"},[t._v("元")])]),t._v(" "),o("label",{staticClass:"commodity-name required fl",staticStyle:{width:"80px"}},[t._v("单位")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.unit,expression:"group.unit"}],staticStyle:{width:"40px"},attrs:{type:"text",placeholder:"单位",maxlength:"10"},domProps:{value:e.unit},on:{input:function(i){i.target.composing||t.$set(e,"unit",i.target.value)}}})]),t._v(" "),t._e(),t._v(" "),o("div",{staticClass:"relative-div",on:{click:function(o){t.deleteGroup(e,i)}}},[o("div",{staticClass:"blue release-relative"},[t._v("解除关联")])])]),t._v(" "),1==t.good.isInvoicing?o("section",{staticClass:"good-group-invoicing",staticStyle:{width:"475px"}},[o("label",{staticClass:"commodity-name required fl"},[t._v("条码")]),t._v(" "),o("label",{staticStyle:{"margin-right":"15px",float:"left"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.barCode,expression:"group.barCode"}],staticStyle:{width:"80px"},attrs:{type:"text",placeholder:"输入条码",maxlength:"13"},domProps:{value:e.barCode},on:{input:function(i){i.target.composing||t.$set(e,"barCode",i.target.value)}}}),t._v(" "),o("a",{staticClass:"yellow getBarCode",attrs:{href:"javascript:void(0);"},on:{click:function(o){t.setBarCode("groupBarCode",e,i)}}},[t._v("获取条码")])]),t._v(" "),o("label",{staticClass:"fl",staticStyle:{"margin-right":"15px"}},[t._v("副条码")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.secBarCode,expression:"group.secBarCode"}],staticStyle:{width:"80px"},attrs:{type:"text",placeholder:"输入副条码",maxlength:"13"},domProps:{value:e.secBarCode},on:{input:function(i){i.target.composing||t.$set(e,"secBarCode",i.target.value)}}}),t._v(" "),o("a",{staticClass:"yellow getBarCode",attrs:{href:"javascript:void(0);"},on:{click:function(o){t.setBarCode("groupSecBarCode",e,i,!0)}}},[t._v("获取副条码")])])]):t._e(),t._v(" "),1==t.good.isInvoicing?o("section",{staticClass:"good-group-validity"},[o("label",{staticClass:"commodity-name fl",staticStyle:{width:"60px"}},[t._v("保质期")]),t._v(" "),o("label",{staticStyle:{width:"250px"}},[o("div",{staticClass:"weight",on:{click:function(t){t.stopPropagation()}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.validity,expression:"group.validity"}],staticClass:"input",staticStyle:{width:"40px"},attrs:{type:"text",maxlength:"3"},domProps:{value:e.validity},on:{input:function(i){i.target.composing||t.$set(e,"validity",i.target.value)}}}),t._v(" "),o("div",{staticClass:"sList fl",staticStyle:{"margin-left":"10px"}},[o("div",{staticClass:"tableListInp",on:{click:function(o){t.toggleGroupShowValidityTyep(e,i,o)}}},[o("span",{staticStyle:{width:"30px",border:"1px solid #ccc"}},[t._v(t._s(e.validityType))]),t._v(" "),o("div",{staticClass:"fl",staticStyle:{"background-color":"#fff",width:"15px",border:"1px solid #ccc","border-left":"none"}},[o("i")])]),t._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:e.showValidity,expression:"group.showValidity"}],staticClass:"tableListUl",on:{click:function(o){t.funSelectValidityType(o,e,i)}}},t._l(t.validityTypeArr,function(e,i){return o("li",{key:i},[t._v(t._s(e.name))])}))])])])]):t._e(),t._v(" "),1==t.good.isVip?o("div",{staticClass:"good-group-vipPrice"},[o("label",{staticClass:"commodity-name required fl",staticStyle:{width:"80px"}},[t._v("会员价格")]),t._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.vipPrice,expression:"group.vipPrice"}],staticStyle:{width:"70px"},attrs:{type:"text",placeholder:"会员价格",maxlength:"10"},domProps:{value:e.vipPrice},on:{input:function(i){i.target.composing||t.$set(e,"vipPrice",i.target.value)}}}),t._v(" "),o("div",{staticClass:"vip-div"},[t._v("元")])])]):t._e(),t._v(" "),o("div",{staticClass:"good-add-relative"},[e.id?t._e():o("label",{staticClass:"commodity-type fl",staticStyle:{width:"600px","margin-bottom":"10px"}},[o("a",{staticClass:"addclassify fl",attrs:{href:"javascript:void(0);"},on:{click:function(o){t.openMultipleAddRelativeGoodWin(e,i)}}},[t._v("添加关联商品")]),t._v(" "),o("h3",{directives:[{name:"show",rawName:"v-show",value:!!e.relativeGood.goodsName,expression:"!!group.relativeGood.goodsName"}],staticClass:"relative-good"},[t._v("已关联商品：")]),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!!e.relativeGood.goodsName,expression:"!!group.relativeGood.goodsName"}],staticClass:"sign",on:{click:function(o){t.deleteRelativeGood(e,i)}}},[t._v(t._s(e.relativeGood.goodsName))])]),t._v(" "),o("label",{staticClass:"commodity-type fl",staticStyle:{width:"600px"}},[t._v("\n\t\t\t\t\t\t\t\t口味\n\t\t\t\t\t\t\t\t"),o("a",{staticClass:"addclassify fl",attrs:{href:"javascript:void(0);"},on:{click:function(o){t.openMultipleAttrWin(e,i)}}},[t._v("添加口味")]),t._v(" "),t._l(e.attr,function(i,s){return o("span",{key:s,staticClass:"sign",on:{click:function(o){t.deleteSelectAttrMul(e.attr,s,i)}}},[t._v(t._s(i.name))])})],2)])])})):t._e(),t._v(" "),o("section",{staticClass:"titleTop",staticStyle:{width:"100%",height:"40px"}},[o("div",{staticClass:"relative-info"},[o("i"),t._v(" "),o("h3",[t._v("关联信息")]),t._v(" "),o("div",{staticClass:"dian"})])]),t._v(" "),o("section",[o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("参与优惠")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.isDiscount},on:{statusChange:function(e){t.switchFn(e,"isDiscount")}}})],1),t._v(" "),o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("服务费")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.serviceCharge},on:{statusChange:function(e){t.switchFn(e,"serviceCharge")}}})],1),t._v(" "),o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("推荐菜")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.isRecommend},on:{statusChange:function(e){t.switchFn(e,"isRecommend")}}})],1)]),t._v(" "),o("section",[o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("开启进销存")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.isInvoicing},on:{statusChange:t.toggleIsInvoicing}})],1),t._v(" "),0==t.good.type?o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("自取")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.isSelf},on:{statusChange:function(e){t.switchFn(e,"isSelf")}}})],1):t._e(),t._v(" "),1==t.good.type?o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("识别码")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.isCode},on:{statusChange:t.toggleIsCode}})],1):t._e(),t._v(" "),"3"!=t.ischain?o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("开启库存")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.isStock},on:{statusChange:t.toggleIsStock}})],1):t._e()]),t._v(" "),o("section",{staticClass:"fl",staticStyle:{width:"33%"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("时价菜")]),t._v(" "),o("on-off",{attrs:{status:1==t.good.isSeasonal},on:{statusChange:function(e){t.switchFn(e,"isSeasonal")}}})],1),t._v(" "),o("section",{staticClass:"fl",staticStyle:{width:"auto"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("参与会员")]),t._v(" "),o("span",{staticClass:"on check-span",staticStyle:{display:"inline-block"}},[o("on-off",{attrs:{status:0!=t.good.isVip},on:{statusChange:function(e){t.switchFn(e,"isVip")}}})],1)]),t._v(" "),0!=t.good.isVip?o("section",{staticClass:"fl relative-vip"},[o("section",{staticStyle:{width:"50%",margin:"0"}},[o("span",{class:{fl:!0,sign:1==t.good.isVip,vip:!0},on:{click:function(e){t.good.isVip=1}}},[t._v("会员价格")]),t._v(" "),o("span",{class:{fl:!0,sign:2==t.good.isVip,vip:!0},on:{click:function(e){t.good.isVip=2}}},[t._v("会员折扣")])]),t._v(" "),o("section",{directives:[{name:"show",rawName:"v-show",value:1==t.good.isVip&&1!=t.good.isGroup,expression:"good.isVip==1 && good.isGroup!=1"}],staticClass:"vipPrice",staticStyle:{width:"50%",float:"right",margin:"0"}},[o("label",{staticClass:"commodity-name  fl"},[t._v("会员价格")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.good.vipPrice,expression:"good.vipPrice"}],staticStyle:{width:"120px"},attrs:{type:"text",placeholder:"输入会员价格"},domProps:{value:t.good.vipPrice},on:{input:function(e){e.target.composing||t.$set(t.good,"vipPrice",e.target.value)}}})])]):t._e(),t._v(" "),o("section",[o("section",[o("label",{staticClass:"commodity-name fl"},[t._v("描述")]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.good.description,expression:"good.description"}],staticClass:"describe fl",attrs:{placeholder:"请输入描述",maxlength:"100"},domProps:{value:t.good.description},on:{input:function(e){e.target.composing||t.$set(t.good,"description",e.target.value)}}})])])]):t._e()])])]),t._v(" "),o(t.showCom,{tag:"component",attrs:{pObj:t.comObj,pGoodsList:t.comObj},on:{throwCommonWin:t.closeCommonWin,throwGoodListWin:t.closeMultipleAddRelativeGoodWin}})],1)};o._withStripped=!0;var s=i("81a2"),a=i("05dd"),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function o(s,a){try{var n=e[s](a),r=n.value}catch(t){return void i(t)}if(!n.done)return Promise.resolve(r).then(function(t){o("next",t)},function(t){o("throw",t)});t(r)}("next")})}}var d={data:function(){return{goodsType:[{type:0,name:"普通菜品"},{type:1,name:"称重菜品"},{type:2,name:"自定义菜品"}],validityTypeArr:[{id:0,name:"月"},{id:1,name:"日"},{id:2,name:"年"}],unitArr:[{id:0,name:"斤"},{id:1,name:"两"},{id:2,name:"g"},{id:3,name:"Kg"},{id:4,name:"币"}],btnOk:{},btnCancel:{},shopId:null,brandId:null,title:"",editGoodsId:null,ischain:null,imgHost:null,goodsList:[],category:[],status:null,good:{id:"",attr:[],type:0,sort:1,goodsName:"",brandId:"",BC:"",price:"",unit:"",cost:"",barCode:"",secBarCode:"",description:"",validity:"",validityType:"月",isGroup:0,isDiscount:0,serviceCharge:0,isRecommend:0,isInvoicing:0,isSelf:0,isStock:0,isSeasonal:0,isVip:0,isBom:0,isCode:0,imageName:"",specifications:"",vipPrice:"",vipDiscount:"",identifyCode:"",code:""},identifyCodeMax:null,identifyName:"选择类别识别码",attr:[],brandList:[],barList:[],showCom:null,comObj:{},showBarList:!1,showValidity:!1,showUnit:!1,selectAttr:[],selectBrandObj:{},selectCategory:[],groupData:[],nowGroupIndex:{},flag:"",test:{},mapHttp:{uploadImg:"uploadImg",downChildGoods:"downChildGoods",getAttr:"getAttr",getGoodsDetail:"getGoodsDetail",goodEdit:"goodEdit",createGood:"createGood",brandList:"brandList",GoodWeighgoodsGetList:"GoodWeighgoodsGetList",goodUpOrDownShelf:"goodUpOrDownShelf"}}},props:{pObj:null},methods:{toggleGoodType:function(t){if(!this.editGoodsId)switch(this.good.isInvoicing=0,this.good.isStock=0,this.good.isCode=0,this.good.isGroup=0,this.good.type=t,""+this.good.type){case"0":this.good.unit="",this.good.validityType="月";break;case"1":this.good.unit="斤",this.good.validityType="月";break;case"2":this.selectCategory=[]}},uploadGoodsImg:function(){var t=this;return r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getHttp(t.mapHttp.uploadImg,{data:{type:5,shopId:t.shopId},formId:"img_upload"});case 2:t.good.imageName=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},deleteGoodImg:function(){var t=this;this.good.imageName?this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确认删除图片?",callback:function(e){"ok"==e&&(t.good.imageName="")}}):this.alertWin("此商品无图片!")},generatorBarCode:function(){return"90"+(9e7*Math.random()|1e7)},writeBarCode:function(t,e,i){t[e]=String(t[e]),t[e]&&t[e].trim().length>0?this.$store.commit("setWin",{title:"温馨提示",content:t.tips,winType:"confirm",callback:function(o){"ok"==o&&(t[e]=i())}}):t[e]=i()},setBarCode:function(t,e,i){var o=null;switch(t){case"barCode":case"secBarCode":this.good.tips="确认重新设置"+("barCode"==t?"主":"副")+"条码?",this.writeBarCode(this.good,t,this.generatorBarCode);break;case"groupBarCode":case"groupSecBarCode":o="groupBarCode"==t?"barCode":"secBarCode",e.tips="确认重新设置"+("groupBarCode"==t?"主":"副")+"条码?",this.writeBarCode(e,o,this.generatorBarCode),this.groupData.splice(i,1,e);break;case"identifyCode":this.good.tips="确认重新设置识条码?",this.writeBarCode(this.good,t,this.generatorCode)}},deleteSelectAttr:function(t){this.selectAttr.splice(t,1)},deleteSelectAttrMul:function(t,e){t.splice(e,1)},deleteSelectCategory:function(t,e){2==this.good.type&&this.editGoodsId||this.selectCategory.splice(e,1)},funGetGoodValidityType:function(t){this.good.validityType=t.target.innerHTML,this.showValidity=!1},toggleGroupShowValidityTyep:function(t,e){this.groupData.forEach(function(i,o){e==o?t.showValidity=!t.showValidity:i.showValidity=!1}),this.groupData.splice(e,1,t)},funSelectValidityType:function(t,e,i){var o=t.target.innerHTML;e.validityType=o,e.showValidity=!1,this.groupData.splice(i,1,e)},addGroup:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;e++){if(!(this.groupData.length<3)){this.alertWin("商品规格不能超过三个!");break}var i={showValidity:!1,relativeGood:{},attr:[]};this.assignObj(i),i.validityType="月",this.groupData.push(i)}},deleteGroup:function(t,e){var i=this;2!=this.groupData.length?this.editGoodsId&&t.id?this.$store.commit("setWin",{winType:"confirm",title:"温馨提示",content:"确认解除此种规格的关联？，若取消则此规格商品重新变为单独的普通商品！",callback:function(o){if("ok"==o){var s={shopId:i.shopId,brandId:i.brandId,goodsId:t.id};i.getHttp(i.mapHttp.downChildGoods,{data:s}).then(function(t){t&&(i.groupData.splice(e,1),i.$emit("throwAddGoodsWin","releaserelation"))})}}}):this.groupData.splice(e,1):this.alertWin("多规格商品最少添加两种规格!")},funToggleUnit:function(){1==this.good.type&&1==this.good.isCode?(this.showUnit=!1,this.alertWin("请先选择类别识别码!")):this.showUnit=!this.showUnit},funGetUnit:function(t){this.editGoodsId&&1==this.good.isCode||(this.good.unit=t.target.innerHTML,this.showUnit=!1)},funShowList:function(){if(this.barList||(this.barList=[]),0==this.barList.length)return this.showBarList=!1,void this.alertWin("类别识别码列表为空，请在进销存管理中称重商品配置中添加");this.showBarList=!this.showBarList},funSelectList:function(t){this.identifyName=t.name,this.good.unit=t.weightCompany,this.good.code=t.code,this.showBarList=!1},generatorCode:function(){if(this.identifyCodeMax)this.identifyCodeMax++;else{var t=1e4,e=!0,i=!1,o=void 0;try{for(var s,a=this.goodsList[Symbol.iterator]();!(e=(s=a.next()).done);e=!0){var n=s.value;if(n.barCode&&7==n.barCode.length){n.barCode=n.barCode.trim();var r=n.barCode.slice(2);t=t>(r=parseInt(r))?t:r}}}catch(t){i=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(i)throw o}}this.identifyCodeMax=t+1}return this.identifyCodeMax>99999&&(this.identifyCodeMax=1e4),this.identifyCodeMax},openCommonWin:function(t){var e=this;return r(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e.flag=t,i.t0=t,i.next="attr"===i.t0?4:"category"===i.t0?11:"brand"===i.t0?16:18;break;case 4:if(0!=e.attr.length){i.next=8;break}return i.next=7,e.getHttp(e.mapHttp.getAttr);case 7:e.attr=i.sent;case 8:return e.showCom="addAttr",e.comObj={radio:!0,selectAttr:e.selectAttr,attr:e.attr,title:"选择口味",height:650,width:765},i.abrupt("break",18);case 11:if(2!=e.good.type||!e.editGoodsId){i.next=13;break}return i.abrupt("return");case 13:return e.showCom="addCategory",e.comObj={category:e.category,selectCategory:e.selectCategory,radio:2!=e.good.type},i.abrupt("break",18);case 16:e.showCom="addAttr",e.comObj={radio:!1,selectAttr:[e.selectBrandObj.id],attr:e.brandList,title:"选择品牌",height:650,width:765};case 18:case"end":return i.stop()}},i,e)}))()},closeCommonWin:function(t,e){if(this.showCom="","ok"==e)switch(this.flag){case"attr":this.selectAttr=t;break;case"category":this.selectCategory=t;break;case"brand":t[0]?this.selectBrandObj=t[0]:this.selectBrandObj={};break;case"multipleAttr":this.groupData[this.nowGroupIndex].attr=t}},openMultipleAttrWin:function(t,e){var i=this;return r(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(0!=i.attr.length){o.next=4;break}return o.next=3,i.getHttp(i.mapHttp.getAttr);case 3:i.attr=o.sent;case 4:i.showCom="addAttr",i.flag="multipleAttr",i.nowGroupIndex=e,i.comObj={radio:!0,selectAttr:t.attr,attr:i.attr,title:"选择口味",height:650,width:765};case 8:case"end":return o.stop()}},o,i)}))()},openMultipleAddRelativeGoodWin:function(t,e){var i=this;this.showCom="addRelative";var o=this.goodsList.filter(function(t){if(!(0!=t.status&&1!=t.status||0!=t.type||Number(t.groupId)||Number(t.isGroup)||i.editGoodsId==t.id||i.good.isInvoicing!=t.isInvoicing))return!0});1==this.good.isInvoicing&&(o=o.filter(function(t){return 1!=t.isBom}));var s=[];t.id?s.push(t.id):s.push(t.relativeGood.id),this.nowGroupIndex=e,this.comObj={title:"关联商品",type:1,goodsList:o,selGoods:s,goodRadio:!0,showSelectAll:2}},closeMultipleAddRelativeGoodWin:function(t,e){var i=this;if(this.showCom="","ok"==t){var o=e.goodArr[0];if("object"==(void 0===o?"undefined":n(o)))o.name=o.goodsName,this.groupData[this.nowGroupIndex].relativeGood=o,this.groupData[this.nowGroupIndex].price=o.price,this.groupData[this.nowGroupIndex].cost=o.cost,this.groupData[this.nowGroupIndex].unit=o.unit,o.attr.forEach(function(t){var e={id:t.attrId,name:t.name,options:t.options};i.groupData[i.nowGroupIndex].attr.push(e)})}},deleteRelativeGood:function(t){var e=this;this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"是否删除该关联商品?",callback:function(i){if("ok"==i){t.relativeGood={},t.price="",t.cost="",t.unit="",t.attr=[];var o=e.groupData.pop();e.groupData.push(o)}}})},closeSelfWin:function(t){var e=this;if("close"!=t)if(this.editGoodsId){if("ok"==t){if(!this.checkForm())return;var i=this.formatData();this.getHttp(this.mapHttp.goodEdit,{data:i}).then(function(t){e.alertWin("保存商品成功!"),e.$emit("throwAddGoodsWin","edit",t)})}if("cancel"==t){var o="确定"+(2==this.status?"上":"下")+"架该商品?";this.$store.commit("setWin",{winType:"confirm",title:"温馨提示",content:o,callback:function(t){if("ok"==t){if(o=e.editGoodsId+",",e.groupData.length>0){var i=[];e.groupData.forEach(function(t){i.push(t.id)}),o+=i.join(",")}e.getHttp(e.mapHttp.goodUpOrDownShelf,{data:{goodsId:o,shopId:e.shopId,status:2==e.status?0:2}}).then(function(){o=2==e.status?"上架成功!":"下架成功!",e.alertWin(o),e.$emit("throwAddGoodsWin","updown")})}}})}}else if("ok"==t){if(!this.checkForm())return;var s=this.formatData();this.getHttp(this.mapHttp.createGood,{data:s}).then(function(t){s&&(e.alertWin("添加商品成功!"),e.$emit("throwAddGoodsWin","add",t))})}else this.$emit("throwAddGoodsWin","cancel");else this.$emit("throwAddGoodsWin","close")},alertWin:function(t){this.$store.commit("setWin",{title:"温馨提示",content:t})},formatData:function(){var t=this,e={},i=void 0,o=[],s=[],a=[];this.validityTypeArr.some(function(e){if(e.name==t.good.validityType)return i=e.id,!0});var n=!0,r=!1,d=void 0;try{for(var l,c=this.selectCategory[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var p=l.value;o.push(p.id)}}catch(t){r=!0,d=t}finally{try{!n&&c.return&&c.return()}finally{if(r)throw d}}var g=!0,u=!1,v=void 0;try{for(var h,m=this.selectAttr[Symbol.iterator]();!(g=(h=m.next()).done);g=!0){var f=h.value;s.push(f.id)}}catch(t){u=!0,v=t}finally{try{!g&&m.return&&m.return()}finally{if(u)throw v}}(1==this.good.isInvoicing&&0==this.good.type&&this.selectBrandObj.id||1==this.good.isCode&&1==this.good.type&&this.selectBrandObj.id)&&(e.brandId=this.selectBrandObj.id),0==this.good.type&&1==this.good.isGroup&&this.groupData.forEach(function(e){var i={goodsName:e.goodsName,price:e.price,cost:e.cost,unit:e.unit,groupAttrs:"",id:""};1==t.good.isVip&&(i.vipPrice=e.vipPrice),2==t.good.isVip&&(i.vipDiscount=e.vipDiscount);var o=e.relativeGood;o&&(i.id=o.id),i.groupAttrs="";var s=[];e.attr||(e.attr=[]),e.attr.forEach(function(t){s.push(t.id)}),i.groupAttrs=s.join(","),1==t.good.isInvoicing&&(i.barCode=e.barCode,i.secBarCode=e.secBarCode,i.validity=parseInt(e.validity),t.validityTypeArr.some(function(t){if(t.name==e.validityType)return i.validityType=t.id,!0})),a.push(i)}),1==this.good.type&&1==this.good.isCode&&(this.good.barCode=this.good.code+this.good.identifyCode),1==this.good.type&&0==this.good.isCode&&(this.good.barCode=""),this.editGoodsId&&(e.goodsId=this.editGoodsId),e.shopId=this.shopId;var y=!0,C=!1,_=void 0;try{for(var b,w=["sort","type","goodsName","BC","price","unit","cost","imageName","validity","isInvoicing","isStock","isDiscount","serviceCharge","isRecommend","isSelf","isCode","isVip","isSeasonal","isGroup","vipPrice","vipDiscount","description","specifications","barCode","secBarCode"][Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var x=b.value;e[x]=this.good[x]}}catch(t){C=!0,_=t}finally{try{!y&&w.return&&w.return()}finally{if(C)throw _}}return e.cids=o.join(","),e.validityType=i,e.attrs=s.join(","),0==this.good.type&&1==this.good.isGroup&&(e.groupData=a),e},checkForm:function(){var t=this;if(0==this.selectCategory.length)return this.alertWin("请选择分类!"),!1;if((0==this.good.type||1==this.good.type)&&!a.a.checkData({goodsName:{cond:"$$.length>0 && $$.length<45 && ((/^[^!@#$%&*]+$/).test($$))",pro:"请输入45字以内的名称且不能含有特殊字符!"},BC:{reg:/^[0-9A-Za-z]{0,20}$/,pro:"简码由英文,数字组成!"},description:{cond:"$$.length<=100",pro:"描述内容不能超过100字哦!"}},this.good))return!1;if(0==this.good.type&&!Number(this.good.isGroup)||1==this.good.type){if(!a.a.checkData({price:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的售价!"},cost:{reg:/(((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$)|(^((\s)*(\t)*)?$)/,pro:"请输入正确的成本格式!"}},this.good))return!1;if(Number(this.good.price)>1e5)return this.alertWin("售价超过10万!"),!1;var e="";if(1==this.good.type&&(e="请输入单位且不能超过5个字符!"),0!=this.good.type||Number(this.good.isCode)||(e="请选择单位!"),!a.a.checkData({unit:{cond:"$$.length>0 && $$.length<6",pro:e}},this.good))return!1;if(Number(this.good.cost)>1e5)return this.alertWin("成本超过10万!"),!1;if(1==this.good.isVip){if(!a.a.checkData({vipPrice:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的会员价格!"}},this.good))return!1;if(Number(this.good.vipPrice)>Number(this.good.price))return this.alertWin("会员价格不能大于售价!"),!1;if(Number(this.good.vipPrice)>1e5)return this.alertWin("会员价格超过10万!"),!1}}if(0==this.good.type&&1!=this.good.isGroup&&1==this.good.isInvoicing&&!a.a.checkData({barCode:{cond:"$$.length>0 && (/^\\d{10,13}$/).test($$)",pro:"请输入条码,条码由10-13位数字组成!"},specifications:{cond:"$$.length>0 && ((/^[^!@#$%&*/\\s]+$/).test($$))",pro:"请输入规格且不含特殊字符!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"},secBarCode:{reg:/(^\d{10,13}$)|(^((\s)*(\t)*)?$)/,pro:"副条码由10-13位数字组成!"}},this.good))return!1;if(1==this.good.type){if(1==this.good.isCode&&(this.good.identifyCode+="",!a.a.checkData({code:{cond:"$$.length>0",pro:"请选择类别识别码!"},unit:{cond:"$$.length>0",pro:"请选择类别识别码!"},identifyCode:{reg:/^\d{5}$/,pro:"请输入商品识别码,识别码由5位数字组成!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"}},this.good)))return!1;if(!Number(this.good.isCode)&&0==this.good.unit.trim().length)return this.alertWin("请选择单位!"),!1}if(0==this.good.type&&1==this.good.isGroup&&1==this.good.isInvoicing&&this.groupData.some(function(e){if(1==e.relativeGood.isBom){var i="所关联的"+e.relativeGood.name+" 商品已关联BOM单,请选择其它商品!";return t.alertWin(i),!0}}))return!1;if(0==this.good.type&&1==this.good.isGroup){var i=this.groupData.some(function(e){if(t.test=e,!a.a.checkData({goodsName:{reg:/^[^<>\s]+$/,pro:"请输入不含特殊字符的规格名!"},price:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的售价格式!"},unit:{cond:"$$.length>0 && $$.length<6",pro:"请输入1-5个字符组成的单位!"},cost:{reg:/(((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$)|(^((\s)*(\t)*)?$)/,pro:"请输入正确的成本格式!"}},t.test))return!0;if(Number(e.price)>1e5)return t.alertWin("售价超过10万!"),!0;if(Number(e.cost)>1e5)return t.alertWin("成本超过10万!"),!0;if(1==t.good.isInvoicing&&!a.a.checkData({barCode:{reg:/^\d{10,13}$/,pro:"主条码由10-13位数字组成!"},secBarCode:{reg:/(^\d{10,13}$)|(^((\s)*(\t)*)?$)/,pro:"副条码由10-13位数字组成!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"}},t.test))return!0;if(1==t.good.isVip){if(!a.a.checkData({vipPrice:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的会员价格!"}},t.test))return!0;if(Number(e.vipPrice)>1e5)return t.$store.commit("setWin",{title:"温馨提示",content:"会员价格超过10万!"}),!0;if(1==t.good.isVip){var i=e.price,o=e.vipPrice;if(Number(o)>Number(i))return t.alertWin("会员价格不能大于售价!"),!0}}});if(i)return!1;if(i=this.groupData.some(function(e,i){for(var o=e.goodsName,s=i+1,a=t.groupData.length;s<a;s++){if(o==t.groupData[s].goodsName)return t.alertWin("规格名称不能相同!"),!0}}))return!1}return!this.checkGoodsName(this.goodsList,this.good.name,this.editGoodsId)},checkGoodsName:function(t,e,i){var o=this;return 2!=this.good.type&&(i&&(t=t.filter(function(t){return t.id!=i})),t.some(function(t){if(t.goodsName==e)return o.alertWin("商品名重名!"),!0}))},switchFn:function(t,e){switch(e){case"sort":this.good[e]=parseInt(t);break;case"isDiscount":case"isRecommend":case"serviceCharge":case"isSelf":case"isSeasonal":case"isVip":this.good[e]=t?1:0}},toggleIsGroup:function(t){return!t&&this.editGoodsId&&1==this.good.isInvoicing&&1==this.good.isGroup?(this.alertWin("商品已参与进销存核销,多规格不能取消!"),void(this.good.isGroup=1)):t&&this.editGoodsId&&1==this.good.isInvoicing?(this.$set(this.good,"isGroup",0),void this.alertWin("商品已参与进销存核销,不能开启多规格!")):(this.good.isGroup=t?1:0,void(1==this.good.isGroup&&this.groupData.length<2&&this.addGroup(2)))},toggleIsInvoicing:function(t){var e=this;if(t&&1==this.good.isStock)this.alertWin("进销存和库存只能开启一个!");else if(0==this.good.type&&this.editGoodsId&&1==this.good.isBom&&t)this.alertWin("该商品已经关联BOM单,不能开启进销存!");else{if(0==this.good.type&&1==this.good.isGroup&&t){var i="",o="";if(this.groupData.some(function(t){if(1==t.relativeGood.isBom)return i=t.relativeGood.name,!0}))return o="所关联的 "+i+" 商品已关联BOM单,不可开启进销存!",void this.alertWin(o)}this.good.isInvoicing=t?1:0,1==this.good.type&&0==this.good.isCode&&1==this.good.isInvoicing&&(this.good.isCode=1,1==this.good.type&&1==this.good.isCode&&0==this.barList.length&&this.getHttp(this.mapHttp.GoodWeighgoodsGetList,{data:{shopId:this.shopId,brandId:this.brandId}}).then(function(t){e.barList=t}))}},toggleIsStock:function(t){t&&1==this.good.isInvoicing?this.alertWin("进销存和库存只能开启一个!"):this.good.isStock=t?1:0},toggleIsCode:function(t){var e=this;return r(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e.good.isCode=t?1:0,1==e.good.type&&0==e.good.isCode&&1==e.good.isInvoicing&&(e.good.isInvoicing=0),1==e.good.isCode&&(e.selectAttr=[]),1!=e.good.type||1!=e.good.isCode||0!=e.barList.length){i.next=7;break}return i.next=6,e.getHttp(e.mapHttp.GoodWeighgoodsGetList,{data:{shopId:e.shopId,brandId:e.brandId}});case 6:e.barList=i.sent;case 7:case"end":return i.stop()}},i,e)}))()},initData:function(){for(var t in this.pObj)this[t]=this.pObj[t]},initWinBtn:function(){this.btnOk={content:"确定",style:null},this.btnCancel={content:"取消",style:null},this.editGoodsId&&(2==this.status?this.btnCancel={content:"上架",style:"background-color:#22aae0"}:this.btnCancel={content:"下架",style:"background-color:#22aae0"},this.btnOk={content:"保存",style:"background-color:#f8941f"})},assignObj:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},i=["barCode","secBarCode","cost","goodsName","price","unit","validity","validityType","vipPrice"],o=!0,s=!1,a=void 0;try{for(var n,r=i[Symbol.iterator]();!(o=(n=r.next()).done);o=!0){e[n.value]=""}}catch(t){s=!0,a=t}finally{try{!o&&r.return&&r.return()}finally{if(s)throw a}}return Object.assign(t,e),i},initGoods:function(t){var e=this;return r(regeneratorRuntime.mark(function i(){var o,s,a,n,r,d,l,c,p,g,u,v,h;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e.$set(e.good,"code",""),e.$set(e.good,"identifyCode",""),e.good.secBarCode||e.$set(e.good,"secBarCode",""),0!=t.type&&1!=t.type){i.next=31;break}o=!0,s=!1,a=void 0,i.prev=7,n=e.validityTypeArr[Symbol.iterator]();case 9:if(o=(r=n.next()).done){i.next=17;break}if((d=r.value).id!=t.validityType){i.next=14;break}return e.good.validityType=d.name,i.abrupt("break",17);case 14:o=!0,i.next=9;break;case 17:i.next=23;break;case 19:i.prev=19,i.t0=i.catch(7),s=!0,a=i.t0;case 23:i.prev=23,i.prev=24,!o&&n.return&&n.return();case 26:if(i.prev=26,!s){i.next=29;break}throw a;case 29:return i.finish(26);case 30:return i.finish(23);case 31:if(1!=e.good.type||1!=e.good.isCode){i.next=39;break}return i.next=34,e.getHttp(e.mapHttp.GoodWeighgoodsGetList,{data:{shopId:e.shopId,brandId:e.brandId}});case 34:e.barList=i.sent,e.good.barCode+="",e.good.code=e.good.barCode.substr(0,2),e.good.identifyCode=e.good.barCode.slice(2),e.barList.some(function(t){if(t.code==e.good.code)return e.identifyName=t.name,!0});case 39:if(0!=e.good.type||1!=e.good.isGroup){i.next=61;break}for(e.groupData=t.groupData,l=function(t){t.showValidity=!1,t.relativeGood={},t.barCode||(t.barCode=""),t.secBarCode||(t.secBarCode=""),t.validity||(t.validity=""),t.validityType||(t.validityType="0"),e.goodsList.some(function(e){if(t.id==e.id)return t.relativeGood={id:e.id,name:e.goodsName,goodsName:e.goodsName,isBom:e.isBom},!0}),e.validityTypeArr.some(function(e){if(e.id==t.validityType)return t.validityType=e.name,!0})||(t.validityType="月")},c=!0,p=!1,g=void 0,i.prev=45,u=e.groupData[Symbol.iterator]();!(c=(v=u.next()).done);c=!0)h=v.value,l(h);i.next=53;break;case 49:i.prev=49,i.t1=i.catch(45),p=!0,g=i.t1;case 53:i.prev=53,i.prev=54,!c&&u.return&&u.return();case 56:if(i.prev=56,!p){i.next=59;break}throw g;case 59:return i.finish(56);case 60:return i.finish(53);case 61:2!=e.good.type&&e.brandList.some(function(t){if(t.id==e.good.brandId)return e.selectBrandObj=t,!0}),t.attr||(t.attr=[]),e.selectAttr=t.attr,t.cate||(t.cate=[]),e.selectCategory=t.cate;case 66:case"end":return i.stop()}},i,e,[[7,19,23,31],[24,,26,30],[45,49,53,61],[54,,56,60]])}))()},asyncRequest:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.editGoodsId||1!=t.good.type||1!=t.good.isCode){e.next=4;break}return e.next=3,t.getHttp(t.mapHttp.GoodWeighgoodsGetList,{data:{shopId:t.shopId,brandId:t.brandId}});case 3:t.barList=e.sent;case 4:return e.next=6,t.getHttp(t.mapHttp.brandList);case 6:if(t.brandList=e.sent,i=null,!t.editGoodsId){e.next=12;break}return e.next=11,t.getHttp(t.mapHttp.getGoodsDetail,{data:{goodsId:t.editGoodsId,shopId:t.shopId}});case 11:i=e.sent;case 12:i&&(t.good=i,t.initGoods(i));case 13:case"end":return e.stop()}},e,t)}))()},getHttp:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(regeneratorRuntime.mark(function o(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a[t](i);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},o,e)}))()},winCancelBubble:function(){0==this.good.type&&(1==this.good.isGroup&&1==this.good.isInvoicing&&(this.groupData=this.groupData.map(function(t){return t.showValidity=!1,t})),1!=this.good.isGroup&&1==this.good.isInvoicing&&(this.showValidity=!1)),1==this.good.type&&(1==this.good.isCode&&(this.showValidity=!1),this.showUnit=!1),1==this.good.type&&1==this.good.isCode&&(this.showBarList=!1)}},mounted:function(){this.initData(),this.initWinBtn(),this.asyncRequest(),document.addEventListener("click",this.winCancelBubble,!1)},beforeDestroy:function(){document.removeEventListener("click",this.winCancelBubble)},components:{win:function(){return i.e("win").then(i.bind(null,"f60a"))},subAdd:function(){return i.e("subadd").then(i.bind(null,"e7ea"))},onOff:function(){return i.e("on_off").then(i.bind(null,"034b"))},addAttr:function(){return i.e("add_attr_win").then(i.bind(null,"0858"))},addCategory:function(){return i.e("add_category_win").then(i.bind(null,"f89b"))},addRelative:function(){return Promise.all([i.e("goods_package_win"),i.e("good_package_win")]).then(i.bind(null,"f163"))}}},l=(i("d875"),i("7610")),c=Object(l.a)(d,o,[],!1,null,"77895f6d",null);c.options.__file="src\\module\\goods_config\\goods_manager_coms\\add_goods_win.vue";e.default=c.exports},d875:function(t,e,i){"use strict";var o=i("7ea0");i.n(o).a}}]);