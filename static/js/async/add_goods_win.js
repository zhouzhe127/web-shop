(window.webpackJsonp=window.webpackJsonp||[]).push([["add_goods_win"],{1811:function(t,e,o){"use strict";o.r(e);var i=o("81a2"),a=o("05dd"),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,o){return function i(a,s){try{var n=e[a](s),r=n.value}catch(t){return void o(t)}if(!n.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var r={data:function(){return{goodsType:[{type:0,name:"普通菜品"},{type:1,name:"称重菜品"},{type:2,name:"自定义菜品"}],validityTypeArr:[{id:0,name:"月"},{id:1,name:"日"},{id:2,name:"年"}],unitArr:[{id:0,name:"斤"},{id:1,name:"两"},{id:2,name:"g"},{id:3,name:"Kg"},{id:4,name:"币"}],btnOk:{},btnCancel:{},shopId:null,brandId:null,title:"",editGoodsId:null,ischain:null,imgHost:null,goodsList:[],category:[],status:null,good:{id:"",attr:[],type:0,sort:1,goodsName:"",brandId:"",BC:"",price:"",unit:"",cost:"",barCode:"",secBarCode:"",description:"",validity:"",validityType:0,isGroup:0,isDiscount:!1,serviceCharge:!1,isRecommend:!1,isInvoicing:!1,isSelf:!1,isStock:!1,isSeasonal:!1,isVip:!1,isBom:0,isCode:!1,imageName:"",specifications:"",vipPrice:"",vipDiscount:"",identifyCode:"",code:""},identifyCodeMax:null,identifyName:"选择类别识别码",attr:[],brandList:[],barList:[],showCom:null,comObj:{},showBarList:!1,showValidity:!1,showUnit:!1,selectAttr:[],selectBrandObj:{},selectCategory:[],groupData:[],nowGroupIndex:{},flag:"",test:{},mapHttp:{uploadImg:"uploadImg",downChildGoods:"downChildGoods",getAttr:"getAttr",getGoodsDetail:"getGoodsDetail",goodEdit:"goodEdit",createGood:"createGood",brandList:"brandList",GoodWeighgoodsGetList:"GoodWeighgoodsGetList",goodUpOrDownShelf:"goodUpOrDownShelf"},isVipShow:!1}},props:{pObj:null},methods:{back:function(){this.$emit("throwAddGoodsWin","this.config")},getVipRadio:function(t){this.good.isVip=t},openVipRadio:function(t){this.isVipShow=t,this.isVipShow?this.good.isVip="1":this.good.isVip="0"},toggleGoodType:function(t){if(!this.editGoodsId)switch(this.good.isInvoicing=0,this.good.isStock=0,this.good.isCode=0,this.good.isGroup=0,this.good.type=t,""+this.good.type){case"0":this.good.unit="";break;case"1":this.good.unit="斤";break;case"2":this.selectCategory=[]}},uploadGoodsImg:function(){var t=this;return n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getHttp(t.mapHttp.uploadImg,{data:{type:5,shopId:t.shopId},formId:"img_upload"});case 2:t.good.imageName=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},deleteGoodImg:function(){var t=this;this.good.imageName?this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确认删除图片?",callback:function(e){"ok"==e&&(t.good.imageName="")}}):this.alertWin("此商品无图片!")},generatorBarCode:function(){return"90"+(9e7*Math.random()|1e7)},writeBarCode:function(t,e,o){t[e]=String(t[e]),t[e]&&t[e].trim().length>0?this.$store.commit("setWin",{title:"温馨提示",content:t.tips,winType:"confirm",callback:function(i){"ok"==i&&(t[e]=o())}}):t[e]=o()},setBarCode:function(t,e,o){var i=null;switch(t){case"barCode":case"secBarCode":this.good.tips="确认重新设置"+("barCode"==t?"主":"副")+"条码?",this.writeBarCode(this.good,t,this.generatorBarCode);break;case"groupBarCode":case"groupSecBarCode":i="groupBarCode"==t?"barCode":"secBarCode",e.tips="确认重新设置"+("groupBarCode"==t?"主":"副")+"条码?",this.writeBarCode(e,i,this.generatorBarCode),this.groupData.splice(o,1,e);break;case"identifyCode":this.good.tips="确认重新设置识条码?",this.writeBarCode(this.good,t,this.generatorCode)}},deleteSelectAttr:function(t){this.selectAttr.splice(t,1)},deleteSelectAttrMul:function(t,e){t.splice(e,1)},deleteSelectCategory:function(t,e){2==this.good.type&&this.editGoodsId||this.selectCategory.splice(e,1)},addGroup:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;e++){if(console.log(this.groupData),!(this.groupData.length<3)){this.alertWin("商品规格不能超过三个!");break}var o={showValidity:!1,relativeGood:{},attr:[]};this.assignObj(o),o.validityType=0,this.groupData.push(o)}},deleteGroup:function(t,e){var o=this;2!=this.groupData.length?this.editGoodsId&&t.id?this.$store.commit("setWin",{winType:"confirm",title:"温馨提示",content:"确认解除此种规格的关联？，若取消则此规格商品重新变为单独的普通商品！",callback:function(i){if("ok"==i){var a={shopId:o.shopId,brandId:o.brandId,goodsId:t.id};o.getHttp(o.mapHttp.downChildGoods,{data:a}).then(function(t){t&&(o.groupData.splice(e,1),o.$emit("throwAddGoodsWin","releaserelation"))})}}}):this.groupData.splice(e,1):this.alertWin("多规格商品最少添加两种规格!")},funSelectList:function(t){this.identifyName=this.barList[t].name,this.good.unit=this.barList[t].weightCompany,this.good.code=this.barList[t].code,this.showBarList=!1},generatorCode:function(){if(this.identifyCodeMax)this.identifyCodeMax++;else{var t=1e4,e=!0,o=!1,i=void 0;try{for(var a,s=this.goodsList[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var n=a.value;if(n.barCode&&7==n.barCode.length){n.barCode=n.barCode.trim();var r=n.barCode.slice(2);t=t>(r=parseInt(r))?t:r}}}catch(t){o=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(o)throw i}}this.identifyCodeMax=t+1}return this.identifyCodeMax>99999&&(this.identifyCodeMax=1e4),this.identifyCodeMax},openCommonWin:function(t){var e=this;return n(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e.flag=t,o.t0=t,o.next="attr"===o.t0?4:"category"===o.t0?11:"brand"===o.t0?16:18;break;case 4:if(0!=e.attr.length){o.next=8;break}return o.next=7,e.getHttp(e.mapHttp.getAttr);case 7:e.attr=o.sent;case 8:return e.showCom="addAttr",e.comObj={radio:!0,selectAttr:e.selectAttr,attr:e.attr,title:"选择口味",height:650,width:765},o.abrupt("break",18);case 11:if(2!=e.good.type||!e.editGoodsId){o.next=13;break}return o.abrupt("return");case 13:return e.showCom="addCategory",e.comObj={category:e.category,selectCategory:e.selectCategory,radio:2!=e.good.type},o.abrupt("break",18);case 16:e.showCom="addAttr",e.comObj={radio:!1,selectAttr:[e.selectBrandObj.id],attr:e.brandList,title:"选择品牌",height:650,width:765};case 18:case"end":return o.stop()}},o,e)}))()},closeCommonWin:function(t,e){if(this.showCom="","ok"==e)switch(this.flag){case"attr":this.selectAttr=t;break;case"category":this.selectCategory=t;break;case"brand":t[0]?this.selectBrandObj=t[0]:this.selectBrandObj={};break;case"multipleAttr":this.groupData[this.nowGroupIndex].attr=t}},openMultipleAttrWin:function(t,e){var o=this;return n(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(0!=o.attr.length){i.next=4;break}return i.next=3,o.getHttp(o.mapHttp.getAttr);case 3:o.attr=i.sent;case 4:o.showCom="addAttr",o.flag="multipleAttr",o.nowGroupIndex=e,o.comObj={radio:!0,selectAttr:t.attr,attr:o.attr,title:"选择口味",height:650,width:765};case 8:case"end":return i.stop()}},i,o)}))()},openMultipleAddRelativeGoodWin:function(t,e){var o=this;this.showCom="addRelative";var i=this.goodsList.filter(function(t){if(!(0!=t.status&&1!=t.status||0!=t.type||Number(t.groupId)||Number(t.isGroup)||o.editGoodsId==t.id||o.good.isInvoicing!=t.isInvoicing))return!0});1==this.good.isInvoicing&&(i=i.filter(function(t){return 1!=t.isBom}));var a=[];t.id?a.push(t.id):a.push(t.relativeGood.id),this.nowGroupIndex=e,this.comObj={title:"关联商品",type:1,goodsList:i,selGoods:a,goodRadio:!0,showSelectAll:2}},closeMultipleAddRelativeGoodWin:function(t,e){var o=this;if(this.showCom="","ok"==t){var i=e.goodArr[0];if("object"==(void 0===i?"undefined":s(i)))i.name=i.goodsName,this.groupData[this.nowGroupIndex].relativeGood=i,this.groupData[this.nowGroupIndex].price=i.price,this.groupData[this.nowGroupIndex].cost=i.cost,this.groupData[this.nowGroupIndex].unit=i.unit,i.attr.forEach(function(t){var e={id:t.attrId,name:t.name,options:t.options};o.groupData[o.nowGroupIndex].attr.push(e)})}},deleteRelativeGood:function(t){var e=this;this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"是否删除该关联商品?",callback:function(o){if("ok"==o){t.relativeGood={},t.price="",t.cost="",t.unit="",t.attr=[];var i=e.groupData.pop();e.groupData.push(i)}}})},closeSelfWin:function(t){var e=this;if("close"!=t)if(this.editGoodsId){if("ok"==t){if(!this.checkForm())return;var o=this.formatData();this.getHttp(this.mapHttp.goodEdit,{data:o}).then(function(t){e.alertWin("保存商品成功!"),e.$emit("throwAddGoodsWin","edit",t)})}if("cancel"==t){var i="确定"+(2==this.status?"上":"下")+"架该商品?";this.$store.commit("setWin",{winType:"confirm",title:"温馨提示",content:i,callback:function(t){if("ok"==t){if(i=e.editGoodsId+",",e.groupData.length>0){var o=[];e.groupData.forEach(function(t){o.push(t.id)}),i+=o.join(",")}e.getHttp(e.mapHttp.goodUpOrDownShelf,{data:{goodsId:i,shopId:e.shopId,status:2==e.status?0:2}}).then(function(){i=2==e.status?"上架成功!":"下架成功!",e.alertWin(i),e.$emit("throwAddGoodsWin","updown")})}}})}}else if("ok"==t){if(!this.checkForm())return;var a=this.formatData();this.getHttp(this.mapHttp.createGood,{data:a}).then(function(t){a&&(e.alertWin("添加商品成功!"),e.$emit("throwAddGoodsWin","add",t))})}else this.$emit("throwAddGoodsWin","cancel");else this.$emit("throwAddGoodsWin","close")},alertWin:function(t){this.$store.commit("setWin",{title:"温馨提示",content:t})},formatData:function(){var t=this,e={},o=[],i=[],a=[];console.log(this.good.validityType),console.log(this.good.validityType);var s=!0,n=!1,r=void 0;try{for(var d,l=this.selectCategory[Symbol.iterator]();!(s=(d=l.next()).done);s=!0){var c=d.value;o.push(c.id)}}catch(t){n=!0,r=t}finally{try{!s&&l.return&&l.return()}finally{if(n)throw r}}var p=!0,u=!1,g=void 0;try{for(var h,v=this.selectAttr[Symbol.iterator]();!(p=(h=v.next()).done);p=!0){var m=h.value;i.push(m.id)}}catch(t){u=!0,g=t}finally{try{!p&&v.return&&v.return()}finally{if(u)throw g}}(1==this.good.isInvoicing&&0==this.good.type&&this.selectBrandObj.id||1==this.good.isCode&&1==this.good.type&&this.selectBrandObj.id)&&(e.brandId=this.selectBrandObj.id),0==this.good.type&&1==this.good.isGroup&&this.groupData.forEach(function(e){var o={goodsName:e.goodsName,price:e.price,cost:e.cost,unit:e.unit,groupAttrs:"",id:""};1==t.good.isVip&&(o.vipPrice=e.vipPrice),2==t.good.isVip&&(o.vipDiscount=e.vipDiscount);var i=e.relativeGood;i&&(o.id=i.id),o.groupAttrs="";var s=[];e.attr||(e.attr=[]),e.attr.forEach(function(t){s.push(t.id)}),o.groupAttrs=s.join(","),1==t.good.isInvoicing&&(o.barCode=e.barCode,o.secBarCode=e.secBarCode,o.validity=parseInt(e.validity),o.validityType=1*e.validityType),a.push(o)}),1==this.good.type&&1==this.good.isCode&&(this.good.barCode=this.good.code+this.good.identifyCode),1==this.good.type&&0==this.good.isCode&&(this.good.barCode=""),this.editGoodsId&&(e.goodsId=this.editGoodsId),e.shopId=this.shopId;var f=!0,y=!1,b=void 0;try{for(var _,x=["sort","type","goodsName","BC","price","unit","cost","imageName","validity","isInvoicing","isStock","isDiscount","serviceCharge","isRecommend","isSelf","isCode","isVip","isSeasonal","isGroup","vipPrice","vipDiscount","description","specifications","barCode","secBarCode"][Symbol.iterator]();!(f=(_=x.next()).done);f=!0){var w=_.value;e[w]=this.good[w]}}catch(t){y=!0,b=t}finally{try{!f&&x.return&&x.return()}finally{if(y)throw b}}return e.cids=o.join(","),e.validityType=this.good.validityType,e.attrs=i.join(","),0==this.good.type&&1==this.good.isGroup&&(e.groupData=a),e},checkForm:function(){var t=this;if(0==this.selectCategory.length)return this.alertWin("请选择分类!"),!1;if((0==this.good.type||1==this.good.type)&&!a.a.checkData({goodsName:{cond:"$$.length>0 && $$.length<45 && ((/^[^!@#$%&*]+$/).test($$))",pro:"请输入45字以内的名称且不能含有特殊字符!"},BC:{reg:/^[0-9A-Za-z]{0,20}$/,pro:"简码由英文,数字组成!"},description:{cond:"$$.length<=100",pro:"描述内容不能超过100字哦!"}},this.good))return!1;if(0==this.good.type&&!Number(this.good.isGroup)||1==this.good.type){if(!a.a.checkData({price:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的售价!"},cost:{reg:/(((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$)|(^((\s)*(\t)*)?$)/,pro:"请输入正确的成本格式!"}},this.good))return!1;if(Number(this.good.price)>1e5)return this.alertWin("售价超过10万!"),!1;var e="";if(1==this.good.type&&(e="请输入单位且不能超过5个字符!"),0!=this.good.type||Number(this.good.isCode)||(e="请选择单位!"),!a.a.checkData({unit:{cond:"$$.length>0 && $$.length<6",pro:e}},this.good))return!1;if(Number(this.good.cost)>1e5)return this.alertWin("成本超过10万!"),!1;if(1==this.good.isVip){if(!a.a.checkData({vipPrice:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的会员价格!"}},this.good))return!1;if(Number(this.good.vipPrice)>Number(this.good.price))return this.alertWin("会员价格不能大于售价!"),!1;if(Number(this.good.vipPrice)>1e5)return this.alertWin("会员价格超过10万!"),!1}}if(0==this.good.type&&1!=this.good.isGroup&&1==this.good.isInvoicing&&!a.a.checkData({barCode:{cond:"$$.length>0 && (/^\\d{10,13}$/).test($$)",pro:"请输入条码,条码由10-13位数字组成!"},specifications:{cond:"$$.length>0 && ((/^[^!@#$%&*/\\s]+$/).test($$))",pro:"请输入规格且不含特殊字符!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"},secBarCode:{reg:/(^\d{10,13}$)|(^((\s)*(\t)*)?$)/,pro:"副条码由10-13位数字组成!"}},this.good))return!1;if(1==this.good.type){if(1==this.good.isCode&&(this.good.identifyCode+="",!a.a.checkData({code:{cond:"$$.length>0",pro:"请选择类别识别码!"},unit:{cond:"$$.length>0",pro:"请选择类别识别码!"},identifyCode:{reg:/^\d{5}$/,pro:"请输入商品识别码,识别码由5位数字组成!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"}},this.good)))return!1;if(!Number(this.good.isCode)&&0==this.good.unit.trim().length)return this.alertWin("请选择单位!"),!1}if(0==this.good.type&&1==this.good.isGroup&&1==this.good.isInvoicing&&this.groupData.some(function(e){if(1==e.relativeGood.isBom){var o="所关联的"+e.relativeGood.name+" 商品已关联BOM单,请选择其它商品!";return t.alertWin(o),!0}}))return!1;if(0==this.good.type&&1==this.good.isGroup){var o=this.groupData.some(function(e){if(t.test=e,!a.a.checkData({goodsName:{reg:/^[^<>\s]+$/,pro:"请输入不含特殊字符的规格名!"},price:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的售价格式!"},unit:{cond:"$$.length>0 && $$.length<6",pro:"请输入1-5个字符组成的单位!"},cost:{reg:/(((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$)|(^((\s)*(\t)*)?$)/,pro:"请输入正确的成本格式!"}},t.test))return!0;if(Number(e.price)>1e5)return t.alertWin("售价超过10万!"),!0;if(Number(e.cost)>1e5)return t.alertWin("成本超过10万!"),!0;if(1==t.good.isInvoicing&&!a.a.checkData({barCode:{reg:/^\d{10,13}$/,pro:"主条码由10-13位数字组成!"},secBarCode:{reg:/(^\d{10,13}$)|(^((\s)*(\t)*)?$)/,pro:"副条码由10-13位数字组成!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"}},t.test))return!0;if(1==t.good.isVip){if(!a.a.checkData({vipPrice:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的会员价格!"}},t.test))return!0;if(Number(e.vipPrice)>1e5)return t.$store.commit("setWin",{title:"温馨提示",content:"会员价格超过10万!"}),!0;if(1==t.good.isVip){var o=e.price,i=e.vipPrice;if(Number(i)>Number(o))return t.alertWin("会员价格不能大于售价!"),!0}}});if(o)return!1;if(o=this.groupData.some(function(e,o){for(var i=e.goodsName,a=o+1,s=t.groupData.length;a<s;a++){if(i==t.groupData[a].goodsName)return t.alertWin("规格名称不能相同!"),!0}}))return!1}return!this.checkGoodsName(this.goodsList,this.good.name,this.editGoodsId)},checkGoodsName:function(t,e,o){var i=this;return 2!=this.good.type&&(o&&(t=t.filter(function(t){return t.id!=o})),t.some(function(t){if(t.goodsName==e)return i.alertWin("商品名重名!"),!0}))},toggleIsGroup:function(t){return console.log(t),0==t&&this.editGoodsId&&1==this.good.isInvoicing&&1==this.good.isGroup?(this.alertWin("商品已参与进销存核销,多规格不能取消!"),void(this.good.isGroup=1)):1==t&&this.editGoodsId&&1==this.good.isInvoicing?(this.$set(this.good,"isGroup",0),void this.alertWin("商品已参与进销存核销,不能开启多规格!")):(this.good.isGroup=t,void(1==this.good.isGroup&&this.groupData.length<2&&this.addGroup(2)))},toggleIsInvoicing:function(t){var e=this;if(console.log(t),1!=t||1!=this.good.isStock)if(0==this.good.type&&this.editGoodsId&&1==this.good.isBom&&1==t)this.alertWin("该商品已经关联BOM单,不能开启进销存!");else{if(0==this.good.type&&1==this.good.isGroup&&1==t){var o="",i="";if(this.groupData.some(function(t){if(1==t.relativeGood.isBom)return o=t.relativeGood.name,!0}))return i="所关联的 "+o+" 商品已关联BOM单,不可开启进销存!",void this.alertWin(i)}this.good.isInvoicing=t,1==this.good.type&&0==this.good.isCod&&1==this.good.isInvoicing&&(this.good.isCode=1,1==this.good.type&&1==this.good.isCode&&0==this.barList.length&&this.getHttp(this.mapHttp.GoodWeighgoodsGetList,{data:{shopId:this.shopId,brandId:this.brandId}}).then(function(t){e.barList=t}))}else this.alertWin("进销存和库存只能开启一个!")},toggleIsStock:function(t){t&&1==this.good.isInvoicing?this.alertWin("进销存和库存只能开启一个!"):this.good.isStock=t},toggleIsCode:function(t){var e=this;return n(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.good.isCode=t,1==e.good.type&&0==e.good.isCode&&1==e.good.isInvoicing&&(e.good.isInvoicing=0),1==e.good.isCode&&(e.selectAttr=[]),1!=e.good.type||1!=e.good.isCode||0!=e.barList.length){o.next=7;break}return o.next=6,e.getHttp(e.mapHttp.GoodWeighgoodsGetList,{data:{shopId:e.shopId,brandId:e.brandId}});case 6:e.barList=o.sent;case 7:case"end":return o.stop()}},o,e)}))()},initData:function(){for(var t in this.pObj)this[t]=this.pObj[t]},initWinBtn:function(){this.btnOk={content:"确定",style:null},this.btnCancel={content:"取消",style:null},this.editGoodsId&&(2==this.status?this.btnCancel={content:"上架",style:"background-color:#22aae0"}:this.btnCancel={content:"下架",style:"background-color:#22aae0"},this.btnOk={content:"保存",style:"background-color:#f8941f"})},assignObj:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},o=["barCode","secBarCode","cost","goodsName","price","unit","validity","validityType","vipPrice"],i=!0,a=!1,s=void 0;try{for(var n,r=o[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){e[n.value]=""}}catch(t){a=!0,s=t}finally{try{!i&&r.return&&r.return()}finally{if(a)throw s}}return Object.assign(t,e),o},initGoods:function(t){var e=this;return n(regeneratorRuntime.mark(function o(){var i,a,s,n,r,d,l;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(1*e.good.isVip>0&&(e.isVipShow=!0),e.$set(e.good,"code",""),e.$set(e.good,"identifyCode",""),e.good.secBarCode||e.$set(e.good,"secBarCode",""),e.good.validityType=+e.good.validityType,1!=e.good.type||1!=e.good.isCode){o.next=13;break}return o.next=8,e.getHttp(e.mapHttp.GoodWeighgoodsGetList,{data:{shopId:e.shopId,brandId:e.brandId}});case 8:e.barList=o.sent,e.good.barCode+="",e.good.code=e.good.barCode.substr(0,2),e.good.identifyCode=e.good.barCode.slice(2),e.barList.some(function(t){if(t.code==e.good.code)return e.identifyName=t.name,!0});case 13:if(0!=e.good.type||1!=e.good.isGroup){o.next=35;break}for(e.groupData=t.groupData,i=function(t){t.showValidity=!1,t.relativeGood={},t.barCode||(t.barCode=""),t.secBarCode||(t.secBarCode=""),t.validity||(t.validity=""),t.validityType||(t.validityType=0),t.validityType=+t.validityType,e.goodsList.some(function(e){if(t.id==e.id)return t.relativeGood={id:e.id,name:e.goodsName,goodsName:e.goodsName,isBom:e.isBom},!0})},a=!0,s=!1,n=void 0,o.prev=19,r=e.groupData[Symbol.iterator]();!(a=(d=r.next()).done);a=!0)l=d.value,i(l);o.next=27;break;case 23:o.prev=23,o.t0=o.catch(19),s=!0,n=o.t0;case 27:o.prev=27,o.prev=28,!a&&r.return&&r.return();case 30:if(o.prev=30,!s){o.next=33;break}throw n;case 33:return o.finish(30);case 34:return o.finish(27);case 35:2!=e.good.type&&e.brandList.some(function(t){if(t.id==e.good.brandId)return e.selectBrandObj=t,!0}),t.attr||(t.attr=[]),e.selectAttr=t.attr,t.cate||(t.cate=[]),e.selectCategory=t.cate;case 40:case"end":return o.stop()}},o,e,[[19,23,27,35],[28,,30,34]])}))()},asyncRequest:function(){var t=this;return n(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.editGoodsId||1!=t.good.type||1!=t.good.isCode){e.next=4;break}return e.next=3,t.getHttp(t.mapHttp.GoodWeighgoodsGetList,{data:{shopId:t.shopId,brandId:t.brandId}});case 3:t.barList=e.sent;case 4:return e.next=6,t.getHttp(t.mapHttp.brandList);case 6:if(t.brandList=e.sent,o=null,!t.editGoodsId){e.next=12;break}return e.next=11,t.getHttp(t.mapHttp.getGoodsDetail,{data:{goodsId:t.editGoodsId,shopId:t.shopId}});case 11:o=e.sent;case 12:o&&(t.good=o,t.initGoods(o));case 13:case"end":return e.stop()}},e,t)}))()},getHttp:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(regeneratorRuntime.mark(function a(){var s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a[t](o);case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}},a,e)}))()},winCancelBubble:function(){0==this.good.type&&(1==this.good.isGroup&&1==this.good.isInvoicing&&(this.groupData=this.groupData.map(function(t){return t.showValidity=!1,t})),1!=this.good.isGroup&&1==this.good.isInvoicing&&(this.showValidity=!1)),1==this.good.type&&(1==this.good.isCode&&(this.showValidity=!1),this.showUnit=!1),1==this.good.type&&1==this.good.isCode&&(this.showBarList=!1)}},mounted:function(){this.initData(),this.initWinBtn(),this.asyncRequest(),document.addEventListener("click",this.winCancelBubble,!1)},beforeDestroy:function(){document.removeEventListener("click",this.winCancelBubble)},components:{win:function(){return o.e("win").then(o.bind(null,"f60a"))},addAttr:function(){return o.e("add_attr_win").then(o.bind(null,"0858"))},addCategory:function(){return o.e("add_category_win").then(o.bind(null,"f89b"))},addRelative:function(){return o.e("good_package_win").then(o.bind(null,"f163"))}}},d=(o("2a5e"),o("d801")),l=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"detail-addgoods"}},[i("div",{staticClass:"win-content",attrs:{slot:"content"},slot:"content"},[i("section",[i("section",{staticClass:"titleTop",staticStyle:{width:"100%",height:"40px"}},[i("div",{staticClass:"good-baseInfo"},[i("i"),t._v(" "),i("h3",[t._v("基本信息")]),t._v(" "),i("div",{staticClass:"dian"}),t._v(" "),t.good.id?i("span",[t._v("商品ID:"+t._s(t.good.id))]):t._e()])]),t._v(" "),i("section",{staticStyle:{width:"100%",overflow:"hidden"}},[i("el-form",{ref:"good",attrs:{model:t.good,"label-width":"80px"}},[i("el-form-item",{attrs:{required:"",label:"商品名称"}},[i("el-input",{staticStyle:{width:"270px"},attrs:{maxlength:"45",placeholder:"请输入商品名称"},model:{value:t.good.goodsName,callback:function(e){t.$set(t.good,"goodsName",e)},expression:"good.goodsName"}})],1),t._v(" "),i("el-form-item",{attrs:{required:"",label:"商品单位"}},[i("el-input",{staticStyle:{width:"270px"},attrs:{maxlength:"5",placeholder:"请输入商品单位"},model:{value:t.good.unit,callback:function(e){t.$set(t.good,"unit",e)},expression:"good.unit"}})],1),t._v(" "),i("el-form-item",{attrs:{required:"",label:"排序"}},[i("el-input-number",{staticStyle:{width:"150px"},attrs:{min:1,max:255},model:{value:t.good.sort,callback:function(e){t.$set(t.good,"sort",e)},expression:"good.sort"}})],1),t._v(" "),i("el-form-item",{attrs:{required:"",label:"商品品牌"}},[i("el-button",{staticStyle:{margin:"0 10px"},attrs:{type:"primary"}},[t._v("添加商品品牌")])],1),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{attrs:{required:"",label:"商品条码"}},[i("el-input",{staticStyle:{width:"270px"},attrs:{maxlength:"13",placeholder:"输入条码"},model:{value:t.good.barCode,callback:function(e){t.$set(t.good,"barCode",e)},expression:"good.barCode"}}),t._v(" "),i("el-button",{staticStyle:{width:"82px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){t.setBarCode("barCode",null,null)}}},[t._v("条码生成")])],1):t._e(),t._v(" "),i("el-form-item",{attrs:{required:"",label:"分类"}},[t._l(t.selectCategory,function(e,o){return i("span",{key:o,staticClass:"sign",on:{click:function(i){t.deleteSelectCategory(e,o)}}},[t._v(t._s(e.name))])}),t._v(" "),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加分类")])],2),t._v(" "),i("el-form-item",{attrs:{required:"",label:"商品图片"}},[i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加商品")]),t._v(" "),i("section",{staticStyle:{width:"100%",overflow:"auto"}},[i("div",{staticClass:"good-image"},[i("div",{staticClass:"good-image-div",attrs:{id:"image"}},[t.good.imageName?i("img",{attrs:{src:t.good.imageName.indexOf("http")>-1?t.good.imageName:t.imgHost+t.good.imageName,width:"225",height:"150"}}):i("img",{attrs:{src:o("b7c2"),width:"225",height:"150",alt:"商品"}}),t._v(" "),i("a",{staticClass:"gray good-image-delete",on:{click:t.deleteGoodImg}},[t._v("删除图片")]),t._v(" "),i("a",{staticClass:"good-image-edit"},[t._v("编辑图片")]),t._v(" "),i("form",{attrs:{enctype:"multipart/form-data",id:"img_upload"}},[i("input",{staticClass:"good-image-file",attrs:{type:"file",accept:"image/jpeg,image/png,image/gif,image/tiff",name:"image"},on:{change:t.uploadGoodsImg}})])])])])],1),t._v(" "),i("el-form-item",{attrs:{label:"副条码"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isDiscount,callback:function(e){t.$set(t.good,"isDiscount",e)},expression:"good.isDiscount"}}),t._v(" "),i("span",[t._v("商品唯一码")]),t._v(" "),i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isDiscount,callback:function(e){t.$set(t.good,"isDiscount",e)},expression:"good.isDiscount"}}),t._v(" "),i("span",[t._v("生产日期")]),t._v(" "),i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isDiscount,callback:function(e){t.$set(t.good,"isDiscount",e)},expression:"good.isDiscount"}}),t._v(" "),i("span",[t._v("保质期")]),t._v(" "),i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isDiscount,callback:function(e){t.$set(t.good,"isDiscount",e)},expression:"good.isDiscount"}})],1)],1)],1),t._v(" "),2!=t.good.type?i("section",{staticStyle:{width:"100%"}},[i("el-form",{ref:"good",attrs:{model:t.good,inline:!0,"label-width":"105px"}},[0==t.good.type&&1==t.good.isInvoicing?["0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"品牌"}},[i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("brand")}}},[t._v("选择品牌")]),t._v(" "),t.selectBrandObj.name?i("span",{staticClass:"sign",staticStyle:{width:"120px",padding:"0 10px"}},[t._v(t._s(t.selectBrandObj.name))]):t._e()],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"310px"},attrs:{required:"",label:"条码"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入条码"},model:{value:t.good.barCode,callback:function(e){t.$set(t.good,"barCode",e)},expression:"good.barCode"}},[i("el-button",{staticStyle:{width:"82px",padding:"0"},attrs:{slot:"append"},on:{click:function(e){t.setBarCode("barCode",null,null)}},slot:"append"},[t._v("获取条码")])],1)],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"保质期"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"3",placeholder:"输入保质期"},model:{value:t.good.validity,callback:function(e){t.$set(t.good,"validity",e)},expression:"good.validity"}}),t._v(" "),i("el-select",{staticStyle:{width:"60px"},model:{value:t.good.validityType,callback:function(e){t.$set(t.good,"validityType",e)},expression:"good.validityType"}},t._l(t.validityTypeArr,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}},[t._v(t._s(e.name)+" ")])}))],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"310px"},attrs:{label:"副条码"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入副条码"},model:{value:t.good.secBarCode,callback:function(e){t.$set(t.good,"secBarCode",e)},expression:"good.secBarCode"}},[i("el-button",{staticStyle:{width:"82px",padding:"0"},attrs:{slot:"append"},on:{click:function(e){t.setBarCode("secBarCode",null,null)}},slot:"append"},[t._v("获取副条码")])],1)],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{attrs:{required:"",label:"规格"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{maxlength:"21",placeholder:"输入规格"},model:{value:t.good.specifications,callback:function(e){t.$set(t.good,"specifications",e)},expression:"good.specifications"}})],1):t._e()]:t._e(),t._v(" "),1==t.good.type&&1==t.good.isCode?[i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"品牌"}},[i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("brand")}}},[t._v("选择品牌")]),t._v(" "),t.selectBrandObj.name?i("span",{staticClass:"sign",staticStyle:{width:"120px",padding:"0 10px"}},[t._v(t._s(t.selectBrandObj.name))]):t._e()],1),t._v(" "),i("el-form-item",{staticStyle:{width:"310px"},attrs:{required:"",label:"类别(识别码)"}},[i("el-select",{staticStyle:{width:"200px"},on:{change:t.funSelectList},model:{value:t.identifyName,callback:function(e){t.identifyName=e},expression:"identifyName"}},t._l(t.barList,function(e,o){return i("el-option",{key:o,attrs:{value:o,label:e.name}},[t._v(t._s(e.name)+" ")])}))],1),t._v(" "),i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"保质期"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"3",placeholder:"输入保质期"},model:{value:t.good.validity,callback:function(e){t.$set(t.good,"validity",e)},expression:"good.validity"}}),t._v(" "),i("el-select",{staticStyle:{width:"60px"},model:{value:t.good.validityType,callback:function(e){t.$set(t.good,"validityType",e)},expression:"good.validityType"}},t._l(t.validityTypeArr,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}},[t._v(t._s(e.name)+" ")])}))],1),t._v(" "),i("el-form-item",{attrs:{required:"",label:"商品识别码"}},[i("el-input",{staticStyle:{width:"213px"},attrs:{maxlength:"5",placeholder:"输入商品识别码"},model:{value:t.good.identifyCode,callback:function(e){t.$set(t.good,"identifyCode",e)},expression:"good.identifyCode"}},[i("el-button",{staticStyle:{width:"82px",padding:"0"},attrs:{slot:"append"},on:{click:function(e){t.setBarCode("identifyCode",null,null)}},slot:"append"},[t._v("生成识别码")])],1)],1)]:t._e()],2)],1):t._e(),t._v(" "),2!=t.good.type?i("section",{staticStyle:{width:"100%"}},[i("el-form",{ref:"good",attrs:{model:t.good,"label-width":"80px"}},[i("el-form-item",{attrs:{required:"",label:"分类"}},[t._l(t.selectCategory,function(e,o){return i("span",{key:o,staticClass:"sign",on:{click:function(i){t.deleteSelectCategory(e,o)}}},[t._v(t._s(e.name))])}),t._v(" "),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加分类")])],2),t._v(" "),t.good.id?i("el-form-item",{attrs:{label:"来源"}},[t.good.id>1e5?i("span",[t._v("门店自建")]):t._e(),t._v(" "),t.good.id>0&&t.good.id<1e5?i("span",[t._v("品牌同步")]):t._e()]):t._e(),t._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"0"==t.good.isGroup&&1!=t.good.isCode,expression:"good.isGroup=='0' && good.isCode!=1"}],attrs:{label:"口味"}},[t._l(t.selectAttr,function(e,o){return i("span",{key:o,staticClass:"sign",on:{click:function(e){t.deleteSelectAttr(o)}}},[t._v(t._s(e.name))])}),t._v(" "),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("attr")}}},[t._v("添加口味")])],2),t._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==t.good.type,expression:"good.type==0"}],attrs:{label:"多规格"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsGroup},model:{value:t.good.isGroup,callback:function(e){t.$set(t.good,"isGroup",e)},expression:"good.isGroup"}}),t._v(" "),1==t.good.isGroup?i("el-button",{staticStyle:{width:"140px"},attrs:{type:"primary"},on:{click:function(e){t.addGroup(1)}}},[t._v("添加规格")]):t._e()],1),t._v(" "),t._l(t.groupData,function(e,o){return"1"==t.good.isGroup&&0==t.good.type?[i("section",{key:o},[i("el-form-item",{attrs:{required:"",label:"规格"+(o+1)}},[i("el-input",{staticStyle:{width:"90px"},attrs:{maxlength:"6",placeholder:"规格名称"},model:{value:e.goodsName,callback:function(o){t.$set(e,"goodsName",o)},expression:"group.goodsName"}}),t._v(" "),i("span",{staticClass:"required",staticStyle:{color:"#606266"}},[t._v("售价")]),t._v(" "),i("el-input",{staticStyle:{width:"90px"},attrs:{maxlength:"10",placeholder:"售价"},model:{value:e.price,callback:function(o){t.$set(e,"price",o)},expression:"group.price"}}),t._v(" "),i("span",{staticStyle:{color:"#606266"}},[t._v("元")]),t._v(" "),i("span",{staticStyle:{color:"#606266"}},[t._v("成本")]),t._v(" "),i("el-input",{staticStyle:{width:"90px"},attrs:{maxlength:"10",placeholder:"成本"},model:{value:e.cost,callback:function(o){t.$set(e,"cost",o)},expression:"group.cost"}}),t._v(" "),i("span",{staticStyle:{color:"#606266"}},[t._v("元")]),t._v(" "),i("span",{staticClass:"required",staticStyle:{color:"#606266"}},[t._v("单位")]),t._v(" "),i("el-input",{staticStyle:{width:"60px"},attrs:{maxlength:"10",placeholder:"单位"},model:{value:e.unit,callback:function(o){t.$set(e,"unit",o)},expression:"group.unit"}}),t._v(" "),i("el-button",{staticStyle:{width:"80px"},attrs:{size:"mini",round:"",type:"primary"},on:{click:function(i){t.deleteGroup(e,o)}}},[t._v("解除关联")])],1),t._v(" "),1==t.good.isInvoicing?i("el-form-item",{attrs:{required:"",label:"条码"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入条码"},model:{value:e.barCode,callback:function(o){t.$set(e,"barCode",o)},expression:"group.barCode"}},[i("el-button",{staticStyle:{width:"70px",padding:"0"},attrs:{slot:"append"},on:{click:function(i){t.setBarCode("groupBarCode",e,o)}},slot:"append"},[t._v("获取条码")])],1),t._v(" "),i("span",{staticStyle:{"margin-left":"10px",color:"#606266"}},[t._v("副条码")]),t._v(" "),i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入副条码"},model:{value:e.secBarCode,callback:function(o){t.$set(e,"secBarCode",o)},expression:"group.secBarCode"}},[i("el-button",{staticStyle:{width:"80px",padding:"0"},attrs:{slot:"append"},on:{click:function(i){t.setBarCode("groupSecBarCode",e,o)}},slot:"append"},[t._v("获取副条码")])],1)],1):t._e(),t._v(" "),1==t.good.isInvoicing?i("el-form-item",{attrs:{label:"保质期"}},[i("el-input",{staticStyle:{width:"105px"},attrs:{maxlength:"3",placeholder:"输入保质期"},model:{value:e.validity,callback:function(o){t.$set(e,"validity",o)},expression:"group.validity"}}),t._v(" "),i("el-select",{staticStyle:{width:"60px"},model:{value:e.validityType,callback:function(o){t.$set(e,"validityType",o)},expression:"group.validityType"}},t._l(t.validityTypeArr,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}},[t._v(t._s(e.name))])})),t._v(" "),"1"==t.good.isVip?i("span",{staticClass:"required"},[t._v("会员价格")]):t._e(),t._v(" "),"1"==t.good.isVip?i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"10",placeholder:"输入会员价"},model:{value:e.vipPrice,callback:function(o){t.$set(e,"vipPrice",o)},expression:"group.vipPrice"}}):t._e()],1):t._e(),t._v(" "),"1"==t.good.isVip&&0==t.good.isInvoicing?i("el-form-item",{staticStyle:{width:"300px"},attrs:{required:"",label:"会员价格"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"10",placeholder:"输入会员价"},model:{value:e.vipPrice,callback:function(o){t.$set(e,"vipPrice",o)},expression:"group.vipPrice"}})],1):t._e(),t._v(" "),e.id?t._e():i("el-form-item",{attrs:{label:""}},[i("el-button",{staticStyle:{width:"140px"},attrs:{type:"primary"},on:{click:function(i){t.openMultipleAddRelativeGoodWin(e,o)}}},[t._v("添加关联商品")]),t._v(" "),e.relativeGood.goodsName?i("span",{staticStyle:{width:"120px",padding:"0 10px"}},[t._v("已关联商品：")]):t._e(),t._v(" "),e.relativeGood.goodsName?i("span",{staticClass:"sign",staticStyle:{padding:"0 10px"},on:{click:function(i){t.deleteRelativeGood(e,o)}}},[t._v(t._s(e.relativeGood.goodsName))]):t._e()],1),t._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{staticStyle:{width:"140px"},attrs:{type:"primary"},on:{click:function(i){t.openMultipleAttrWin(e,o)}}},[t._v("添加口味")]),t._v(" "),t._l(e.attr,function(o,a){return i("span",{key:a,staticClass:"sign",on:{click:function(i){t.deleteSelectAttrMul(e.attr,a,o)}}},[t._v(t._s(o.name))])})],2)],1)]:t._e()})],2)],1):t._e(),t._v(" "),2!=t.good.type?i("section",{staticClass:"titleTop",staticStyle:{width:"100%"}},[t._m(0),t._v(" "),i("el-form",{ref:"good",attrs:{model:t.good,inline:!0,"label-width":"100px"}},[i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"参与优惠"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isDiscount,callback:function(e){t.$set(t.good,"isDiscount",e)},expression:"good.isDiscount"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"服务费"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.serviceCharge,callback:function(e){t.$set(t.good,"serviceCharge",e)},expression:"good.serviceCharge"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"推荐菜"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isRecommend,callback:function(e){t.$set(t.good,"isRecommend",e)},expression:"good.isRecommend"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"开启进销存"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsInvoicing},model:{value:t.good.isInvoicing,callback:function(e){t.$set(t.good,"isInvoicing",e)},expression:"good.isInvoicing"}})],1),t._v(" "),0==t.good.type?i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"自取"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isSelf,callback:function(e){t.$set(t.good,"isSelf",e)},expression:"good.isSelf"}})],1):t._e(),t._v(" "),1==t.good.type?i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"识别码"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsCode},model:{value:t.good.isCode,callback:function(e){t.$set(t.good,"isCode",e)},expression:"good.isCode"}})],1):t._e(),t._v(" "),"3"!=t.ischain?i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"开启库存"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsStock},model:{value:t.good.isStock,callback:function(e){t.$set(t.good,"isStock",e)},expression:"good.isStock"}})],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:"参与会员 "}},[i("el-switch",{attrs:{"active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.openVipRadio},model:{value:t.isVipShow,callback:function(e){t.isVipShow=e},expression:"isVipShow"}}),t._v(" "),t.isVipShow?[i("el-radio",{staticStyle:{"margin-left":"10px"},attrs:{label:"1",border:""},on:{click:function(e){t.getVipRadio("1")}},model:{value:t.good.isVip,callback:function(e){t.$set(t.good,"isVip",e)},expression:"good.isVip"}},[t._v("会员价格")]),t._v(" "),i("el-radio",{attrs:{label:"2",border:""},on:{click:function(e){t.getVipRadio("2")}},model:{value:t.good.isVip,callback:function(e){t.$set(t.good,"isVip",e)},expression:"good.isVip"}},[t._v("会员折扣")])]:t._e(),t._v(" "),"1"==t.good.isVip&&0==t.good.isGroup?[i("span",{staticStyle:{color:"#606266",margin:"0 20px"}},[t._v("会员价格")]),t._v(" "),i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"10",placeholder:"输入会员价"},model:{value:t.good.vipPrice,callback:function(e){t.$set(t.good,"vipPrice",e)},expression:"good.vipPrice"}})]:t._e()],2),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"时价菜"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isSeasonal,callback:function(e){t.$set(t.good,"isSeasonal",e)},expression:"good.isSeasonal"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"描述",prop:"description"}},[i("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"请输入描述",maxlength:"100",autosize:{minRows:3,maxRows:6}},model:{value:t.good.description,callback:function(e){t.$set(t.good,"description",e)},expression:"good.description"}})],1)],1)],1):t._e()]),t._v(" "),2==t.good.type?i("section",[i("el-form",{ref:"good",attrs:{model:t.good,inline:!0,"label-width":"100px"}},[i("el-form-item",{attrs:{required:"",label:"分类"}},[t._l(t.selectCategory,function(e,o){return i("span",{key:o,staticClass:"sign",on:{click:function(i){t.deleteSelectCategory(e,o)}}},[t._v(t._s(e.name))])}),t._v(" "),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加分类")])],2)],1)],1):t._e(),t._v(" "),i("section",[i("el-button",{attrs:{type:"info"},on:{click:t.back}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.back}},[t._v("保存")])],1)]),t._v(" "),i(t.showCom,{tag:"component",attrs:{pObj:t.comObj,pGoodsList:t.comObj},on:{throwCommonWin:t.closeCommonWin,throwGoodListWin:t.closeMultipleAddRelativeGoodWin}})],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"relative-info"},[e("i"),this._v(" "),e("h3",[this._v("关联信息")]),this._v(" "),e("div",{staticClass:"dian"})])}],!1,null,"792ff82a",null);e.default=l.exports},"2a5e":function(t,e,o){"use strict";var i=o("a703");o.n(i).a},5065:function(t,e,o){},"538c":function(t,e,o){"use strict";var i=o("5065");o.n(i).a},a703:function(t,e,o){},b6e5:function(t,e,o){"use strict";o.r(e);var i=o("81a2"),a=o("05dd"),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,o){return function i(a,s){try{var n=e[a](s),r=n.value}catch(t){return void o(t)}if(!n.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var r={data:function(){return{goodsType:[{type:0,name:"普通菜品"},{type:1,name:"称重菜品"},{type:2,name:"自定义菜品"}],validityTypeArr:[{id:0,name:"月"},{id:1,name:"日"},{id:2,name:"年"}],unitArr:[{id:0,name:"斤"},{id:1,name:"两"},{id:2,name:"g"},{id:3,name:"Kg"},{id:4,name:"币"}],btnOk:{},btnCancel:{},shopId:null,brandId:null,title:"",editGoodsId:null,ischain:null,imgHost:null,goodsList:[],category:[],status:null,good:{id:"",attr:[],type:0,sort:1,goodsName:"",brandId:"",BC:"",price:"",unit:"",cost:"",barCode:"",secBarCode:"",description:"",validity:"",validityType:0,isGroup:0,isDiscount:!1,serviceCharge:!1,isRecommend:!1,isInvoicing:!1,isSelf:!1,isStock:!1,isSeasonal:!1,isVip:!1,isBom:0,isCode:!1,imageName:"",specifications:"",vipPrice:"",vipDiscount:"",identifyCode:"",code:""},identifyCodeMax:null,identifyName:"选择类别识别码",attr:[],brandList:[],barList:[],showCom:null,comObj:{},showBarList:!1,showValidity:!1,showUnit:!1,selectAttr:[],selectBrandObj:{},selectCategory:[],groupData:[],nowGroupIndex:{},flag:"",test:{},mapHttp:{uploadImg:"uploadImg",downChildGoods:"downChildGoods",getAttr:"getAttr",getGoodsDetail:"getGoodsDetail",goodEdit:"goodEdit",createGood:"createGood",brandList:"brandList",GoodWeighgoodsGetList:"GoodWeighgoodsGetList",goodUpOrDownShelf:"goodUpOrDownShelf"},isVipShow:!1}},props:{pObj:null},methods:{getVipRadio:function(t){this.good.isVip=t},openVipRadio:function(t){this.isVipShow=t,this.isVipShow?this.good.isVip="1":this.good.isVip="0"},toggleGoodType:function(t){if(!this.editGoodsId)switch(this.good.isInvoicing=0,this.good.isStock=0,this.good.isCode=0,this.good.isGroup=0,this.good.type=t,""+this.good.type){case"0":this.good.unit="";break;case"1":this.good.unit="斤";break;case"2":this.selectCategory=[]}},uploadGoodsImg:function(){var t=this;return n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getHttp(t.mapHttp.uploadImg,{data:{type:5,shopId:t.shopId},formId:"img_upload"});case 2:t.good.imageName=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},deleteGoodImg:function(){var t=this;this.good.imageName?this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"确认删除图片?",callback:function(e){"ok"==e&&(t.good.imageName="")}}):this.alertWin("此商品无图片!")},generatorBarCode:function(){return"90"+(9e7*Math.random()|1e7)},writeBarCode:function(t,e,o){t[e]=String(t[e]),t[e]&&t[e].trim().length>0?this.$store.commit("setWin",{title:"温馨提示",content:t.tips,winType:"confirm",callback:function(i){"ok"==i&&(t[e]=o())}}):t[e]=o()},setBarCode:function(t,e,o){var i=null;switch(t){case"barCode":case"secBarCode":this.good.tips="确认重新设置"+("barCode"==t?"主":"副")+"条码?",this.writeBarCode(this.good,t,this.generatorBarCode);break;case"groupBarCode":case"groupSecBarCode":i="groupBarCode"==t?"barCode":"secBarCode",e.tips="确认重新设置"+("groupBarCode"==t?"主":"副")+"条码?",this.writeBarCode(e,i,this.generatorBarCode),this.groupData.splice(o,1,e);break;case"identifyCode":this.good.tips="确认重新设置识条码?",this.writeBarCode(this.good,t,this.generatorCode)}},deleteSelectAttr:function(t){this.selectAttr.splice(t,1)},deleteSelectAttrMul:function(t,e){t.splice(e,1)},deleteSelectCategory:function(t,e){2==this.good.type&&this.editGoodsId||this.selectCategory.splice(e,1)},addGroup:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;e++){if(console.log(this.groupData),!(this.groupData.length<3)){this.alertWin("商品规格不能超过三个!");break}var o={showValidity:!1,relativeGood:{},attr:[]};this.assignObj(o),o.validityType=0,this.groupData.push(o)}},deleteGroup:function(t,e){var o=this;2!=this.groupData.length?this.editGoodsId&&t.id?this.$store.commit("setWin",{winType:"confirm",title:"温馨提示",content:"确认解除此种规格的关联？，若取消则此规格商品重新变为单独的普通商品！",callback:function(i){if("ok"==i){var a={shopId:o.shopId,brandId:o.brandId,goodsId:t.id};o.getHttp(o.mapHttp.downChildGoods,{data:a}).then(function(t){t&&(o.groupData.splice(e,1),o.$emit("throwAddGoodsWin","releaserelation"))})}}}):this.groupData.splice(e,1):this.alertWin("多规格商品最少添加两种规格!")},funSelectList:function(t){this.identifyName=this.barList[t].name,this.good.unit=this.barList[t].weightCompany,this.good.code=this.barList[t].code,this.showBarList=!1},generatorCode:function(){if(this.identifyCodeMax)this.identifyCodeMax++;else{var t=1e4,e=!0,o=!1,i=void 0;try{for(var a,s=this.goodsList[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var n=a.value;if(n.barCode&&7==n.barCode.length){n.barCode=n.barCode.trim();var r=n.barCode.slice(2);t=t>(r=parseInt(r))?t:r}}}catch(t){o=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(o)throw i}}this.identifyCodeMax=t+1}return this.identifyCodeMax>99999&&(this.identifyCodeMax=1e4),this.identifyCodeMax},openCommonWin:function(t){var e=this;return n(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e.flag=t,o.t0=t,o.next="attr"===o.t0?4:"category"===o.t0?11:"brand"===o.t0?16:18;break;case 4:if(0!=e.attr.length){o.next=8;break}return o.next=7,e.getHttp(e.mapHttp.getAttr);case 7:e.attr=o.sent;case 8:return e.showCom="addAttr",e.comObj={radio:!0,selectAttr:e.selectAttr,attr:e.attr,title:"选择口味",height:650,width:765},o.abrupt("break",18);case 11:if(2!=e.good.type||!e.editGoodsId){o.next=13;break}return o.abrupt("return");case 13:return e.showCom="addCategory",e.comObj={category:e.category,selectCategory:e.selectCategory,radio:2!=e.good.type},o.abrupt("break",18);case 16:e.showCom="addAttr",e.comObj={radio:!1,selectAttr:[e.selectBrandObj.id],attr:e.brandList,title:"选择品牌",height:650,width:765};case 18:case"end":return o.stop()}},o,e)}))()},closeCommonWin:function(t,e){if(this.showCom="","ok"==e)switch(this.flag){case"attr":this.selectAttr=t;break;case"category":this.selectCategory=t;break;case"brand":t[0]?this.selectBrandObj=t[0]:this.selectBrandObj={};break;case"multipleAttr":this.groupData[this.nowGroupIndex].attr=t}},openMultipleAttrWin:function(t,e){var o=this;return n(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(0!=o.attr.length){i.next=4;break}return i.next=3,o.getHttp(o.mapHttp.getAttr);case 3:o.attr=i.sent;case 4:o.showCom="addAttr",o.flag="multipleAttr",o.nowGroupIndex=e,o.comObj={radio:!0,selectAttr:t.attr,attr:o.attr,title:"选择口味",height:650,width:765};case 8:case"end":return i.stop()}},i,o)}))()},openMultipleAddRelativeGoodWin:function(t,e){var o=this;this.showCom="addRelative";var i=this.goodsList.filter(function(t){if(!(0!=t.status&&1!=t.status||0!=t.type||Number(t.groupId)||Number(t.isGroup)||o.editGoodsId==t.id||o.good.isInvoicing!=t.isInvoicing))return!0});1==this.good.isInvoicing&&(i=i.filter(function(t){return 1!=t.isBom}));var a=[];t.id?a.push(t.id):a.push(t.relativeGood.id),this.nowGroupIndex=e,this.comObj={title:"关联商品",type:1,goodsList:i,selGoods:a,goodRadio:!0,showSelectAll:2}},closeMultipleAddRelativeGoodWin:function(t,e){var o=this;if(this.showCom="","ok"==t){var i=e.goodArr[0];if("object"==(void 0===i?"undefined":s(i)))i.name=i.goodsName,this.groupData[this.nowGroupIndex].relativeGood=i,this.groupData[this.nowGroupIndex].price=i.price,this.groupData[this.nowGroupIndex].cost=i.cost,this.groupData[this.nowGroupIndex].unit=i.unit,i.attr.forEach(function(t){var e={id:t.attrId,name:t.name,options:t.options};o.groupData[o.nowGroupIndex].attr.push(e)})}},deleteRelativeGood:function(t){var e=this;this.$store.commit("setWin",{title:"温馨提示",winType:"confirm",content:"是否删除该关联商品?",callback:function(o){if("ok"==o){t.relativeGood={},t.price="",t.cost="",t.unit="",t.attr=[];var i=e.groupData.pop();e.groupData.push(i)}}})},closeSelfWin:function(t){var e=this;if("close"!=t)if(this.editGoodsId){if("ok"==t){if(!this.checkForm())return;var o=this.formatData();this.getHttp(this.mapHttp.goodEdit,{data:o}).then(function(t){e.alertWin("保存商品成功!"),e.$emit("throwAddGoodsWin","edit",t)})}if("cancel"==t){var i="确定"+(2==this.status?"上":"下")+"架该商品?";this.$store.commit("setWin",{winType:"confirm",title:"温馨提示",content:i,callback:function(t){if("ok"==t){if(i=e.editGoodsId+",",e.groupData.length>0){var o=[];e.groupData.forEach(function(t){o.push(t.id)}),i+=o.join(",")}e.getHttp(e.mapHttp.goodUpOrDownShelf,{data:{goodsId:i,shopId:e.shopId,status:2==e.status?0:2}}).then(function(){i=2==e.status?"上架成功!":"下架成功!",e.alertWin(i),e.$emit("throwAddGoodsWin","updown")})}}})}}else if("ok"==t){if(!this.checkForm())return;var a=this.formatData();this.getHttp(this.mapHttp.createGood,{data:a}).then(function(t){a&&(e.alertWin("添加商品成功!"),e.$emit("throwAddGoodsWin","add",t))})}else this.$emit("throwAddGoodsWin","cancel");else this.$emit("throwAddGoodsWin","close")},alertWin:function(t){this.$store.commit("setWin",{title:"温馨提示",content:t})},formatData:function(){var t=this,e={},o=[],i=[],a=[];console.log(this.good.validityType),console.log(this.good.validityType);var s=!0,n=!1,r=void 0;try{for(var d,l=this.selectCategory[Symbol.iterator]();!(s=(d=l.next()).done);s=!0){var c=d.value;o.push(c.id)}}catch(t){n=!0,r=t}finally{try{!s&&l.return&&l.return()}finally{if(n)throw r}}var p=!0,u=!1,g=void 0;try{for(var h,v=this.selectAttr[Symbol.iterator]();!(p=(h=v.next()).done);p=!0){var m=h.value;i.push(m.id)}}catch(t){u=!0,g=t}finally{try{!p&&v.return&&v.return()}finally{if(u)throw g}}(1==this.good.isInvoicing&&0==this.good.type&&this.selectBrandObj.id||1==this.good.isCode&&1==this.good.type&&this.selectBrandObj.id)&&(e.brandId=this.selectBrandObj.id),0==this.good.type&&1==this.good.isGroup&&this.groupData.forEach(function(e){var o={goodsName:e.goodsName,price:e.price,cost:e.cost,unit:e.unit,groupAttrs:"",id:""};1==t.good.isVip&&(o.vipPrice=e.vipPrice),2==t.good.isVip&&(o.vipDiscount=e.vipDiscount);var i=e.relativeGood;i&&(o.id=i.id),o.groupAttrs="";var s=[];e.attr||(e.attr=[]),e.attr.forEach(function(t){s.push(t.id)}),o.groupAttrs=s.join(","),1==t.good.isInvoicing&&(o.barCode=e.barCode,o.secBarCode=e.secBarCode,o.validity=parseInt(e.validity),o.validityType=1*e.validityType),a.push(o)}),1==this.good.type&&1==this.good.isCode&&(this.good.barCode=this.good.code+this.good.identifyCode),1==this.good.type&&0==this.good.isCode&&(this.good.barCode=""),this.editGoodsId&&(e.goodsId=this.editGoodsId),e.shopId=this.shopId;var f=!0,y=!1,b=void 0;try{for(var _,x=["sort","type","goodsName","BC","price","unit","cost","imageName","validity","isInvoicing","isStock","isDiscount","serviceCharge","isRecommend","isSelf","isCode","isVip","isSeasonal","isGroup","vipPrice","vipDiscount","description","specifications","barCode","secBarCode"][Symbol.iterator]();!(f=(_=x.next()).done);f=!0){var w=_.value;e[w]=this.good[w]}}catch(t){y=!0,b=t}finally{try{!f&&x.return&&x.return()}finally{if(y)throw b}}return e.cids=o.join(","),e.validityType=this.good.validityType,e.attrs=i.join(","),0==this.good.type&&1==this.good.isGroup&&(e.groupData=a),e},checkForm:function(){var t=this;if(0==this.selectCategory.length)return this.alertWin("请选择分类!"),!1;if((0==this.good.type||1==this.good.type)&&!a.a.checkData({goodsName:{cond:"$$.length>0 && $$.length<45 && ((/^[^!@#$%&*]+$/).test($$))",pro:"请输入45字以内的名称且不能含有特殊字符!"},BC:{reg:/^[0-9A-Za-z]{0,20}$/,pro:"简码由英文,数字组成!"},description:{cond:"$$.length<=100",pro:"描述内容不能超过100字哦!"}},this.good))return!1;if(0==this.good.type&&!Number(this.good.isGroup)||1==this.good.type){if(!a.a.checkData({price:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的售价!"},cost:{reg:/(((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$)|(^((\s)*(\t)*)?$)/,pro:"请输入正确的成本格式!"}},this.good))return!1;if(Number(this.good.price)>1e5)return this.alertWin("售价超过10万!"),!1;var e="";if(1==this.good.type&&(e="请输入单位且不能超过5个字符!"),0!=this.good.type||Number(this.good.isCode)||(e="请选择单位!"),!a.a.checkData({unit:{cond:"$$.length>0 && $$.length<6",pro:e}},this.good))return!1;if(Number(this.good.cost)>1e5)return this.alertWin("成本超过10万!"),!1;if(1==this.good.isVip){if(!a.a.checkData({vipPrice:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的会员价格!"}},this.good))return!1;if(Number(this.good.vipPrice)>Number(this.good.price))return this.alertWin("会员价格不能大于售价!"),!1;if(Number(this.good.vipPrice)>1e5)return this.alertWin("会员价格超过10万!"),!1}}if(0==this.good.type&&1!=this.good.isGroup&&1==this.good.isInvoicing&&!a.a.checkData({barCode:{cond:"$$.length>0 && (/^\\d{10,13}$/).test($$)",pro:"请输入条码,条码由10-13位数字组成!"},specifications:{cond:"$$.length>0 && ((/^[^!@#$%&*/\\s]+$/).test($$))",pro:"请输入规格且不含特殊字符!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"},secBarCode:{reg:/(^\d{10,13}$)|(^((\s)*(\t)*)?$)/,pro:"副条码由10-13位数字组成!"}},this.good))return!1;if(1==this.good.type){if(1==this.good.isCode&&(this.good.identifyCode+="",!a.a.checkData({code:{cond:"$$.length>0",pro:"请选择类别识别码!"},unit:{cond:"$$.length>0",pro:"请选择类别识别码!"},identifyCode:{reg:/^\d{5}$/,pro:"请输入商品识别码,识别码由5位数字组成!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"}},this.good)))return!1;if(!Number(this.good.isCode)&&0==this.good.unit.trim().length)return this.alertWin("请选择单位!"),!1}if(0==this.good.type&&1==this.good.isGroup&&1==this.good.isInvoicing&&this.groupData.some(function(e){if(1==e.relativeGood.isBom){var o="所关联的"+e.relativeGood.name+" 商品已关联BOM单,请选择其它商品!";return t.alertWin(o),!0}}))return!1;if(0==this.good.type&&1==this.good.isGroup){var o=this.groupData.some(function(e){if(t.test=e,!a.a.checkData({goodsName:{reg:/^[^<>\s]+$/,pro:"请输入不含特殊字符的规格名!"},price:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的售价格式!"},unit:{cond:"$$.length>0 && $$.length<6",pro:"请输入1-5个字符组成的单位!"},cost:{reg:/(((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$)|(^((\s)*(\t)*)?$)/,pro:"请输入正确的成本格式!"}},t.test))return!0;if(Number(e.price)>1e5)return t.alertWin("售价超过10万!"),!0;if(Number(e.cost)>1e5)return t.alertWin("成本超过10万!"),!0;if(1==t.good.isInvoicing&&!a.a.checkData({barCode:{reg:/^\d{10,13}$/,pro:"主条码由10-13位数字组成!"},secBarCode:{reg:/(^\d{10,13}$)|(^((\s)*(\t)*)?$)/,pro:"副条码由10-13位数字组成!"},validity:{reg:/(^\d{0,3}$)|(^((\s)*(\t)*)?$)/,pro:"保质期由1-3位数字组成!"}},t.test))return!0;if(1==t.good.isVip){if(!a.a.checkData({vipPrice:{reg:/((^[1-9]\d{0,9})|^0)(\.\d{1,2})?$/,pro:"请输入正确的会员价格!"}},t.test))return!0;if(Number(e.vipPrice)>1e5)return t.$store.commit("setWin",{title:"温馨提示",content:"会员价格超过10万!"}),!0;if(1==t.good.isVip){var o=e.price,i=e.vipPrice;if(Number(i)>Number(o))return t.alertWin("会员价格不能大于售价!"),!0}}});if(o)return!1;if(o=this.groupData.some(function(e,o){for(var i=e.goodsName,a=o+1,s=t.groupData.length;a<s;a++){if(i==t.groupData[a].goodsName)return t.alertWin("规格名称不能相同!"),!0}}))return!1}return!this.checkGoodsName(this.goodsList,this.good.name,this.editGoodsId)},checkGoodsName:function(t,e,o){var i=this;return 2!=this.good.type&&(o&&(t=t.filter(function(t){return t.id!=o})),t.some(function(t){if(t.goodsName==e)return i.alertWin("商品名重名!"),!0}))},toggleIsGroup:function(t){return console.log(t),0==t&&this.editGoodsId&&1==this.good.isInvoicing&&1==this.good.isGroup?(this.alertWin("商品已参与进销存核销,多规格不能取消!"),void(this.good.isGroup=1)):1==t&&this.editGoodsId&&1==this.good.isInvoicing?(this.$set(this.good,"isGroup",0),void this.alertWin("商品已参与进销存核销,不能开启多规格!")):(this.good.isGroup=t,void(1==this.good.isGroup&&this.groupData.length<2&&this.addGroup(2)))},toggleIsInvoicing:function(t){var e=this;if(console.log(t),1!=t||1!=this.good.isStock)if(0==this.good.type&&this.editGoodsId&&1==this.good.isBom&&1==t)this.alertWin("该商品已经关联BOM单,不能开启进销存!");else{if(0==this.good.type&&1==this.good.isGroup&&1==t){var o="",i="";if(this.groupData.some(function(t){if(1==t.relativeGood.isBom)return o=t.relativeGood.name,!0}))return i="所关联的 "+o+" 商品已关联BOM单,不可开启进销存!",void this.alertWin(i)}this.good.isInvoicing=t,1==this.good.type&&0==this.good.isCod&&1==this.good.isInvoicing&&(this.good.isCode=1,1==this.good.type&&1==this.good.isCode&&0==this.barList.length&&this.getHttp(this.mapHttp.GoodWeighgoodsGetList,{data:{shopId:this.shopId,brandId:this.brandId}}).then(function(t){e.barList=t}))}else this.alertWin("进销存和库存只能开启一个!")},toggleIsStock:function(t){t&&1==this.good.isInvoicing?this.alertWin("进销存和库存只能开启一个!"):this.good.isStock=t},toggleIsCode:function(t){var e=this;return n(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.good.isCode=t,1==e.good.type&&0==e.good.isCode&&1==e.good.isInvoicing&&(e.good.isInvoicing=0),1==e.good.isCode&&(e.selectAttr=[]),1!=e.good.type||1!=e.good.isCode||0!=e.barList.length){o.next=7;break}return o.next=6,e.getHttp(e.mapHttp.GoodWeighgoodsGetList,{data:{shopId:e.shopId,brandId:e.brandId}});case 6:e.barList=o.sent;case 7:case"end":return o.stop()}},o,e)}))()},initData:function(){for(var t in this.pObj)this[t]=this.pObj[t]},initWinBtn:function(){this.btnOk={content:"确定",style:null},this.btnCancel={content:"取消",style:null},this.editGoodsId&&(2==this.status?this.btnCancel={content:"上架",style:"background-color:#22aae0"}:this.btnCancel={content:"下架",style:"background-color:#22aae0"},this.btnOk={content:"保存",style:"background-color:#f8941f"})},assignObj:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},o=["barCode","secBarCode","cost","goodsName","price","unit","validity","validityType","vipPrice"],i=!0,a=!1,s=void 0;try{for(var n,r=o[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){e[n.value]=""}}catch(t){a=!0,s=t}finally{try{!i&&r.return&&r.return()}finally{if(a)throw s}}return Object.assign(t,e),o},initGoods:function(t){var e=this;return n(regeneratorRuntime.mark(function o(){var i,a,s,n,r,d,l;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(1*e.good.isVip>0&&(e.isVipShow=!0),e.$set(e.good,"code",""),e.$set(e.good,"identifyCode",""),e.good.secBarCode||e.$set(e.good,"secBarCode",""),e.good.validityType=+e.good.validityType,1!=e.good.type||1!=e.good.isCode){o.next=13;break}return o.next=8,e.getHttp(e.mapHttp.GoodWeighgoodsGetList,{data:{shopId:e.shopId,brandId:e.brandId}});case 8:e.barList=o.sent,e.good.barCode+="",e.good.code=e.good.barCode.substr(0,2),e.good.identifyCode=e.good.barCode.slice(2),e.barList.some(function(t){if(t.code==e.good.code)return e.identifyName=t.name,!0});case 13:if(0!=e.good.type||1!=e.good.isGroup){o.next=35;break}for(e.groupData=t.groupData,i=function(t){t.showValidity=!1,t.relativeGood={},t.barCode||(t.barCode=""),t.secBarCode||(t.secBarCode=""),t.validity||(t.validity=""),t.validityType||(t.validityType=0),t.validityType=+t.validityType,e.goodsList.some(function(e){if(t.id==e.id)return t.relativeGood={id:e.id,name:e.goodsName,goodsName:e.goodsName,isBom:e.isBom},!0})},a=!0,s=!1,n=void 0,o.prev=19,r=e.groupData[Symbol.iterator]();!(a=(d=r.next()).done);a=!0)l=d.value,i(l);o.next=27;break;case 23:o.prev=23,o.t0=o.catch(19),s=!0,n=o.t0;case 27:o.prev=27,o.prev=28,!a&&r.return&&r.return();case 30:if(o.prev=30,!s){o.next=33;break}throw n;case 33:return o.finish(30);case 34:return o.finish(27);case 35:2!=e.good.type&&e.brandList.some(function(t){if(t.id==e.good.brandId)return e.selectBrandObj=t,!0}),t.attr||(t.attr=[]),e.selectAttr=t.attr,t.cate||(t.cate=[]),e.selectCategory=t.cate;case 40:case"end":return o.stop()}},o,e,[[19,23,27,35],[28,,30,34]])}))()},asyncRequest:function(){var t=this;return n(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.editGoodsId||1!=t.good.type||1!=t.good.isCode){e.next=4;break}return e.next=3,t.getHttp(t.mapHttp.GoodWeighgoodsGetList,{data:{shopId:t.shopId,brandId:t.brandId}});case 3:t.barList=e.sent;case 4:return e.next=6,t.getHttp(t.mapHttp.brandList);case 6:if(t.brandList=e.sent,o=null,!t.editGoodsId){e.next=12;break}return e.next=11,t.getHttp(t.mapHttp.getGoodsDetail,{data:{goodsId:t.editGoodsId,shopId:t.shopId}});case 11:o=e.sent;case 12:o&&(t.good=o,t.initGoods(o));case 13:case"end":return e.stop()}},e,t)}))()},getHttp:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(regeneratorRuntime.mark(function a(){var s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a[t](o);case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}},a,e)}))()},winCancelBubble:function(){0==this.good.type&&(1==this.good.isGroup&&1==this.good.isInvoicing&&(this.groupData=this.groupData.map(function(t){return t.showValidity=!1,t})),1!=this.good.isGroup&&1==this.good.isInvoicing&&(this.showValidity=!1)),1==this.good.type&&(1==this.good.isCode&&(this.showValidity=!1),this.showUnit=!1),1==this.good.type&&1==this.good.isCode&&(this.showBarList=!1)}},mounted:function(){this.initData(),this.initWinBtn(),this.asyncRequest(),document.addEventListener("click",this.winCancelBubble,!1)},beforeDestroy:function(){document.removeEventListener("click",this.winCancelBubble)},components:{win:function(){return o.e("win").then(o.bind(null,"f60a"))},addAttr:function(){return o.e("add_attr_win").then(o.bind(null,"0858"))},addCategory:function(){return o.e("add_category_win").then(o.bind(null,"f89b"))},addRelative:function(){return o.e("good_package_win").then(o.bind(null,"f163"))}}},d=(o("538c"),o("d801")),l=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"detail-addgoods"}},[i("win",{attrs:{height:650,width:700,align:"right",ok:t.btnOk,cancel:t.btnCancel},on:{winEvent:t.closeSelfWin}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{staticClass:"win-content",attrs:{slot:"content"},slot:"content"},[i("section",[i("section",{staticClass:"titleTop",staticStyle:{width:"100%",height:"40px"}},[i("div",{staticClass:"good-baseInfo"},[i("i"),t._v(" "),i("h3",[t._v("基本信息")]),t._v(" "),i("div",{staticClass:"dian"}),t._v(" "),t.good.id?i("span",[t._v("商品ID:"+t._s(t.good.id))]):t._e()])]),t._v(" "),i("section",{staticStyle:{width:"100%",overflow:"hidden"}},[i("section",{staticStyle:{width:"430px",float:"left"}},[i("el-form",{ref:"good",attrs:{model:t.good,"label-width":"80px"}},[i("el-form-item",{attrs:{required:"",label:"类型",prop:"type"}},[t.editGoodsId?t._e():[i("el-radio-group",{on:{change:t.toggleGoodType},model:{value:t.good.type,callback:function(e){t.$set(t.good,"type",e)},expression:"good.type"}},[i("el-radio-button",{attrs:{label:"0"}},[t._v("普通菜品")]),t._v(" "),i("el-radio-button",{attrs:{label:"1"}},[t._v("称重菜品")]),t._v(" "),i("el-radio-button",{attrs:{label:"2"}},[t._v("自定义菜品")])],1)],t._v(" "),t.editGoodsId?[i("el-radio-group",{model:{value:t.good.type,callback:function(e){t.$set(t.good,"type",e)},expression:"good.type"}},[i("el-radio-button",{attrs:{label:t.good.type}},[0==t.good.type?i("span",[t._v("普通菜品")]):t._e(),t._v(" "),1==t.good.type?i("span",[t._v("称重菜品")]):t._e(),t._v(" "),2==t.good.type?i("span",[t._v("自定义菜品")]):t._e()])],1)]:t._e()],2),t._v(" "),1==t.good.type||0==t.good.type?[i("el-form-item",{attrs:{required:"",label:"名称"}},[i("el-input",{staticStyle:{width:"270px"},attrs:{maxlength:"45",placeholder:"请输入商品名称"},model:{value:t.good.goodsName,callback:function(e){t.$set(t.good,"goodsName",e)},expression:"good.goodsName"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"简码",prop:"BC"}},[i("el-input",{staticStyle:{width:"270px"},attrs:{maxlength:"20",placeholder:"请输入商品简码"},model:{value:t.good.BC,callback:function(e){t.$set(t.good,"BC",e)},expression:"good.BC"}})],1),t._v(" "),0==t.good.type&&"1"!==t.good.isGroup?i("el-form-item",{attrs:{required:"",label:"售价"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"7",placeholder:"请输入售价"},model:{value:t.good.price,callback:function(e){t.$set(t.good,"price",e)},expression:"good.price"}},[i("i",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("元")])]),t._v(" "),i("el-input",{staticStyle:{width:"80px"},attrs:{maxlength:"5",placeholder:"单位"},model:{value:t.good.unit,callback:function(e){t.$set(t.good,"unit",e)},expression:"good.unit"}}),t._v(" "),i("el-input",{staticStyle:{width:"110px"},attrs:{maxlength:"10",placeholder:"输入成本"},model:{value:t.good.cost,callback:function(e){t.$set(t.good,"cost",e)},expression:"good.cost"}},[i("i",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("元")])])],1):t._e(),t._v(" "),1==t.good.type?i("el-form-item",{attrs:{required:"",label:"售价"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"7",placeholder:"请输入售价"},model:{value:t.good.price,callback:function(e){t.$set(t.good,"price",e)},expression:"good.price"}},[i("i",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("元")])]),t._v(" "),i("el-select",{staticStyle:{width:"80px"},attrs:{disabled:1==t.good.isCode,placeholder:"选择单位"},model:{value:t.good.unit,callback:function(e){t.$set(t.good,"unit",e)},expression:"good.unit"}},t._l(t.unitArr,function(t){return i("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),t._v(" "),i("el-input",{staticStyle:{width:"110px"},attrs:{maxlength:"10",placeholder:"输入成本"},model:{value:t.good.cost,callback:function(e){t.$set(t.good,"cost",e)},expression:"good.cost"}},[i("i",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("元")])])],1):t._e()]:t._e()],2)],1),t._v(" "),i("section",{staticStyle:{width:"220px",float:"right","margin-right":"25px"}},[i("el-form",{ref:"good",attrs:{model:t.good,"label-width":"80px"}},[i("el-form-item",{attrs:{required:"",label:"排序"}},[i("el-input-number",{staticStyle:{width:"150px"},attrs:{min:1,max:255},model:{value:t.good.sort,callback:function(e){t.$set(t.good,"sort",e)},expression:"good.sort"}})],1)],1),t._v(" "),1==t.good.type||0==t.good.type?i("div",{staticClass:"good-image"},[i("div",{staticClass:"good-image-div",attrs:{id:"image"}},[t.good.imageName?i("img",{attrs:{src:t.good.imageName.indexOf("http")>-1?t.good.imageName:t.imgHost+t.good.imageName,width:"225",height:"150"}}):i("img",{attrs:{src:o("b7c2"),width:"225",height:"150",alt:"商品"}}),t._v(" "),i("a",{staticClass:"gray good-image-delete",on:{click:t.deleteGoodImg}},[t._v("删除图片")]),t._v(" "),i("a",{staticClass:"good-image-edit"},[t._v("编辑图片")]),t._v(" "),i("form",{attrs:{enctype:"multipart/form-data",id:"img_upload"}},[i("input",{staticClass:"good-image-file",attrs:{type:"file",accept:"image/jpeg,image/png,image/gif,image/tiff",name:"image"},on:{change:t.uploadGoodsImg}})])])]):t._e()],1)]),t._v(" "),2!=t.good.type?i("section",{staticStyle:{width:"100%"}},[i("el-form",{ref:"good",attrs:{model:t.good,inline:!0,"label-width":"105px"}},[0==t.good.type&&1==t.good.isInvoicing?["0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"品牌"}},[i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("brand")}}},[t._v("选择品牌")]),t._v(" "),t.selectBrandObj.name?i("span",{staticClass:"sign",staticStyle:{width:"120px",padding:"0 10px"}},[t._v(t._s(t.selectBrandObj.name))]):t._e()],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"310px"},attrs:{required:"",label:"条码"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入条码"},model:{value:t.good.barCode,callback:function(e){t.$set(t.good,"barCode",e)},expression:"good.barCode"}},[i("el-button",{staticStyle:{width:"82px",padding:"0"},attrs:{slot:"append"},on:{click:function(e){t.setBarCode("barCode",null,null)}},slot:"append"},[t._v("获取条码")])],1)],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"保质期"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"3",placeholder:"输入保质期"},model:{value:t.good.validity,callback:function(e){t.$set(t.good,"validity",e)},expression:"good.validity"}}),t._v(" "),i("el-select",{staticStyle:{width:"60px"},model:{value:t.good.validityType,callback:function(e){t.$set(t.good,"validityType",e)},expression:"good.validityType"}},t._l(t.validityTypeArr,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}},[t._v(t._s(e.name)+" ")])}))],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{staticStyle:{width:"310px"},attrs:{label:"副条码"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入副条码"},model:{value:t.good.secBarCode,callback:function(e){t.$set(t.good,"secBarCode",e)},expression:"good.secBarCode"}},[i("el-button",{staticStyle:{width:"82px",padding:"0"},attrs:{slot:"append"},on:{click:function(e){t.setBarCode("secBarCode",null,null)}},slot:"append"},[t._v("获取副条码")])],1)],1):t._e(),t._v(" "),"0"==t.good.isGroup?i("el-form-item",{attrs:{required:"",label:"规格"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{maxlength:"21",placeholder:"输入规格"},model:{value:t.good.specifications,callback:function(e){t.$set(t.good,"specifications",e)},expression:"good.specifications"}})],1):t._e()]:t._e(),t._v(" "),1==t.good.type&&1==t.good.isCode?[i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"品牌"}},[i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("brand")}}},[t._v("选择品牌")]),t._v(" "),t.selectBrandObj.name?i("span",{staticClass:"sign",staticStyle:{width:"120px",padding:"0 10px"}},[t._v(t._s(t.selectBrandObj.name))]):t._e()],1),t._v(" "),i("el-form-item",{staticStyle:{width:"310px"},attrs:{required:"",label:"类别(识别码)"}},[i("el-select",{staticStyle:{width:"200px"},on:{change:t.funSelectList},model:{value:t.identifyName,callback:function(e){t.identifyName=e},expression:"identifyName"}},t._l(t.barList,function(e,o){return i("el-option",{key:o,attrs:{value:o,label:e.name}},[t._v(t._s(e.name)+" ")])}))],1),t._v(" "),i("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"保质期"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"3",placeholder:"输入保质期"},model:{value:t.good.validity,callback:function(e){t.$set(t.good,"validity",e)},expression:"good.validity"}}),t._v(" "),i("el-select",{staticStyle:{width:"60px"},model:{value:t.good.validityType,callback:function(e){t.$set(t.good,"validityType",e)},expression:"good.validityType"}},t._l(t.validityTypeArr,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}},[t._v(t._s(e.name)+" ")])}))],1),t._v(" "),i("el-form-item",{attrs:{required:"",label:"商品识别码"}},[i("el-input",{staticStyle:{width:"213px"},attrs:{maxlength:"5",placeholder:"输入商品识别码"},model:{value:t.good.identifyCode,callback:function(e){t.$set(t.good,"identifyCode",e)},expression:"good.identifyCode"}},[i("el-button",{staticStyle:{width:"82px",padding:"0"},attrs:{slot:"append"},on:{click:function(e){t.setBarCode("identifyCode",null,null)}},slot:"append"},[t._v("生成识别码")])],1)],1)]:t._e()],2)],1):t._e(),t._v(" "),2!=t.good.type?i("section",{staticStyle:{width:"100%"}},[i("el-form",{ref:"good",attrs:{model:t.good,"label-width":"80px"}},[i("el-form-item",{attrs:{required:"",label:"分类"}},[t._l(t.selectCategory,function(e,o){return i("span",{key:o,staticClass:"sign",on:{click:function(i){t.deleteSelectCategory(e,o)}}},[t._v(t._s(e.name))])}),t._v(" "),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加分类")])],2),t._v(" "),t.good.id?i("el-form-item",{attrs:{label:"来源"}},[t.good.id>1e5?i("span",[t._v("门店自建")]):t._e(),t._v(" "),t.good.id>0&&t.good.id<1e5?i("span",[t._v("品牌同步")]):t._e()]):t._e(),t._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"0"==t.good.isGroup&&1!=t.good.isCode,expression:"good.isGroup=='0' && good.isCode!=1"}],attrs:{label:"口味"}},[t._l(t.selectAttr,function(e,o){return i("span",{key:o,staticClass:"sign",on:{click:function(e){t.deleteSelectAttr(o)}}},[t._v(t._s(e.name))])}),t._v(" "),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("attr")}}},[t._v("添加口味")])],2),t._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==t.good.type,expression:"good.type==0"}],attrs:{label:"多规格"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsGroup},model:{value:t.good.isGroup,callback:function(e){t.$set(t.good,"isGroup",e)},expression:"good.isGroup"}}),t._v(" "),1==t.good.isGroup?i("el-button",{staticStyle:{width:"140px"},attrs:{type:"primary"},on:{click:function(e){t.addGroup(1)}}},[t._v("添加规格")]):t._e()],1),t._v(" "),t._l(t.groupData,function(e,o){return"1"==t.good.isGroup&&0==t.good.type?[i("section",{key:o},[i("el-form-item",{attrs:{required:"",label:"规格"+(o+1)}},[i("el-input",{staticStyle:{width:"90px"},attrs:{maxlength:"6",placeholder:"规格名称"},model:{value:e.goodsName,callback:function(o){t.$set(e,"goodsName",o)},expression:"group.goodsName"}}),t._v(" "),i("span",{staticClass:"required",staticStyle:{color:"#606266"}},[t._v("售价")]),t._v(" "),i("el-input",{staticStyle:{width:"90px"},attrs:{maxlength:"10",placeholder:"售价"},model:{value:e.price,callback:function(o){t.$set(e,"price",o)},expression:"group.price"}}),t._v(" "),i("span",{staticStyle:{color:"#606266"}},[t._v("元")]),t._v(" "),i("span",{staticStyle:{color:"#606266"}},[t._v("成本")]),t._v(" "),i("el-input",{staticStyle:{width:"90px"},attrs:{maxlength:"10",placeholder:"成本"},model:{value:e.cost,callback:function(o){t.$set(e,"cost",o)},expression:"group.cost"}}),t._v(" "),i("span",{staticStyle:{color:"#606266"}},[t._v("元")]),t._v(" "),i("span",{staticClass:"required",staticStyle:{color:"#606266"}},[t._v("单位")]),t._v(" "),i("el-input",{staticStyle:{width:"60px"},attrs:{maxlength:"10",placeholder:"单位"},model:{value:e.unit,callback:function(o){t.$set(e,"unit",o)},expression:"group.unit"}}),t._v(" "),i("el-button",{staticStyle:{width:"80px"},attrs:{size:"mini",round:"",type:"primary"},on:{click:function(i){t.deleteGroup(e,o)}}},[t._v("解除关联")])],1),t._v(" "),1==t.good.isInvoicing?i("el-form-item",{attrs:{required:"",label:"条码"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入条码"},model:{value:e.barCode,callback:function(o){t.$set(e,"barCode",o)},expression:"group.barCode"}},[i("el-button",{staticStyle:{width:"70px",padding:"0"},attrs:{slot:"append"},on:{click:function(i){t.setBarCode("groupBarCode",e,o)}},slot:"append"},[t._v("获取条码")])],1),t._v(" "),i("span",{staticStyle:{"margin-left":"10px",color:"#606266"}},[t._v("副条码")]),t._v(" "),i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"13",placeholder:"输入副条码"},model:{value:e.secBarCode,callback:function(o){t.$set(e,"secBarCode",o)},expression:"group.secBarCode"}},[i("el-button",{staticStyle:{width:"80px",padding:"0"},attrs:{slot:"append"},on:{click:function(i){t.setBarCode("groupSecBarCode",e,o)}},slot:"append"},[t._v("获取副条码")])],1)],1):t._e(),t._v(" "),1==t.good.isInvoicing?i("el-form-item",{attrs:{label:"保质期"}},[i("el-input",{staticStyle:{width:"105px"},attrs:{maxlength:"3",placeholder:"输入保质期"},model:{value:e.validity,callback:function(o){t.$set(e,"validity",o)},expression:"group.validity"}}),t._v(" "),i("el-select",{staticStyle:{width:"60px"},model:{value:e.validityType,callback:function(o){t.$set(e,"validityType",o)},expression:"group.validityType"}},t._l(t.validityTypeArr,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}},[t._v(t._s(e.name))])})),t._v(" "),"1"==t.good.isVip?i("span",{staticClass:"required"},[t._v("会员价格")]):t._e(),t._v(" "),"1"==t.good.isVip?i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"10",placeholder:"输入会员价"},model:{value:e.vipPrice,callback:function(o){t.$set(e,"vipPrice",o)},expression:"group.vipPrice"}}):t._e()],1):t._e(),t._v(" "),"1"==t.good.isVip&&0==t.good.isInvoicing?i("el-form-item",{staticStyle:{width:"300px"},attrs:{required:"",label:"会员价格"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"10",placeholder:"输入会员价"},model:{value:e.vipPrice,callback:function(o){t.$set(e,"vipPrice",o)},expression:"group.vipPrice"}})],1):t._e(),t._v(" "),e.id?t._e():i("el-form-item",{attrs:{label:""}},[i("el-button",{staticStyle:{width:"140px"},attrs:{type:"primary"},on:{click:function(i){t.openMultipleAddRelativeGoodWin(e,o)}}},[t._v("添加关联商品")]),t._v(" "),e.relativeGood.goodsName?i("span",{staticStyle:{width:"120px",padding:"0 10px"}},[t._v("已关联商品：")]):t._e(),t._v(" "),e.relativeGood.goodsName?i("span",{staticClass:"sign",staticStyle:{padding:"0 10px"},on:{click:function(i){t.deleteRelativeGood(e,o)}}},[t._v(t._s(e.relativeGood.goodsName))]):t._e()],1),t._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{staticStyle:{width:"140px"},attrs:{type:"primary"},on:{click:function(i){t.openMultipleAttrWin(e,o)}}},[t._v("添加口味")]),t._v(" "),t._l(e.attr,function(o,a){return i("span",{key:a,staticClass:"sign",on:{click:function(i){t.deleteSelectAttrMul(e.attr,a,o)}}},[t._v(t._s(o.name))])})],2)],1)]:t._e()})],2)],1):t._e(),t._v(" "),2!=t.good.type?i("section",{staticClass:"titleTop",staticStyle:{width:"100%"}},[i("div",{staticClass:"relative-info"},[i("i"),t._v(" "),i("h3",[t._v("关联信息")]),t._v(" "),i("div",{staticClass:"dian"})]),t._v(" "),i("el-form",{ref:"good",attrs:{model:t.good,inline:!0,"label-width":"100px"}},[i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"参与优惠"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isDiscount,callback:function(e){t.$set(t.good,"isDiscount",e)},expression:"good.isDiscount"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"服务费"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.serviceCharge,callback:function(e){t.$set(t.good,"serviceCharge",e)},expression:"good.serviceCharge"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"推荐菜"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isRecommend,callback:function(e){t.$set(t.good,"isRecommend",e)},expression:"good.isRecommend"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"开启进销存"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsInvoicing},model:{value:t.good.isInvoicing,callback:function(e){t.$set(t.good,"isInvoicing",e)},expression:"good.isInvoicing"}})],1),t._v(" "),0==t.good.type?i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"自取"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isSelf,callback:function(e){t.$set(t.good,"isSelf",e)},expression:"good.isSelf"}})],1):t._e(),t._v(" "),1==t.good.type?i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"识别码"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsCode},model:{value:t.good.isCode,callback:function(e){t.$set(t.good,"isCode",e)},expression:"good.isCode"}})],1):t._e(),t._v(" "),"3"!=t.ischain?i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"开启库存"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.toggleIsStock},model:{value:t.good.isStock,callback:function(e){t.$set(t.good,"isStock",e)},expression:"good.isStock"}})],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:"参与会员 "}},[i("el-switch",{attrs:{"active-color":"#E1BB4A","inactive-color":"#e6e6e6"},on:{change:t.openVipRadio},model:{value:t.isVipShow,callback:function(e){t.isVipShow=e},expression:"isVipShow"}}),t._v(" "),t.isVipShow?[i("el-radio",{staticStyle:{"margin-left":"10px"},attrs:{label:"1",border:""},on:{click:function(e){t.getVipRadio("1")}},model:{value:t.good.isVip,callback:function(e){t.$set(t.good,"isVip",e)},expression:"good.isVip"}},[t._v("会员价格")]),t._v(" "),i("el-radio",{attrs:{label:"2",border:""},on:{click:function(e){t.getVipRadio("2")}},model:{value:t.good.isVip,callback:function(e){t.$set(t.good,"isVip",e)},expression:"good.isVip"}},[t._v("会员折扣")])]:t._e(),t._v(" "),"1"==t.good.isVip&&0==t.good.isGroup?[i("span",{staticStyle:{color:"#606266",margin:"0 20px"}},[t._v("会员价格")]),t._v(" "),i("el-input",{staticStyle:{width:"120px"},attrs:{maxlength:"10",placeholder:"输入会员价"},model:{value:t.good.vipPrice,callback:function(e){t.$set(t.good,"vipPrice",e)},expression:"good.vipPrice"}})]:t._e()],2),t._v(" "),i("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"时价菜"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#E1BB4A","inactive-color":"#e6e6e6"},model:{value:t.good.isSeasonal,callback:function(e){t.$set(t.good,"isSeasonal",e)},expression:"good.isSeasonal"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"描述",prop:"description"}},[i("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"请输入描述",maxlength:"100",autosize:{minRows:3,maxRows:6}},model:{value:t.good.description,callback:function(e){t.$set(t.good,"description",e)},expression:"good.description"}})],1)],1)],1):t._e()]),t._v(" "),2==t.good.type?i("section",[i("el-form",{ref:"good",attrs:{model:t.good,inline:!0,"label-width":"100px"}},[i("el-form-item",{attrs:{required:"",label:"分类"}},[t._l(t.selectCategory,function(e,o){return i("span",{key:o,staticClass:"sign",on:{click:function(i){t.deleteSelectCategory(e,o)}}},[t._v(t._s(e.name))])}),t._v(" "),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){t.openCommonWin("category")}}},[t._v("添加分类")])],2)],1)],1):t._e()])]),t._v(" "),i(t.showCom,{tag:"component",attrs:{pObj:t.comObj,pGoodsList:t.comObj},on:{throwCommonWin:t.closeCommonWin,throwGoodListWin:t.closeMultipleAddRelativeGoodWin}})],1)},[],!1,null,"30cf7adc",null);e.default=l.exports}}]);