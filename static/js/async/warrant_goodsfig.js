(window.webpackJsonp=window.webpackJsonp||[]).push([["warrant_goodsfig"],{3100:function(e,t,i){"use strict";var n=i("acf0");i.n(n).a},a6fa:function(e,t,i){"use strict";i.r(t);var n=i("81a2"),s=i("f6ce"),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(s,a){try{var o=t[s](a),r=o.value}catch(e){return void i(e)}if(!o.done)return Promise.resolve(r).then(function(e){n("next",e)},function(e){n("throw",e)});e(r)}("next")})}}var r=s.a.session("goodList");if(r)for(var c=0;c<r.length;c++)1!=r[c].type&&2!=r[c].type&&2!=r[c].status&&1!=r[c].isGroup||(r.splice(c,1),c--);else r=[];var d=s.a.session("packageList"),l={data:function(){return{goodsList:[],allGoods:"",mtConfig:"",allList:"",allNum:0,relNum:0,item:"",addWin:{width:600,height:800,title:"添加商品",winshow:!1,type:""},relationWin:{width:1e3,height:500,title:"关联商品",winshow:!1,addClassify:"",seloneAir:{},seltwoAir:{},changeConfig:1},checkEide:!1,relationItem:""}},methods:{init:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i,s,a,o,r,c,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.allNum=0,e.relNum=0,t.next=4,n.a.getMeituntGoods({data:{}});case 4:for(i=t.sent,s=[],a=0;a<i.length;a++){for(r=!0,(o={}).categoryName=i[a].categoryName,e.allNum+=i[a].waiMaiDishSkuBases.length,c=0;c<i[a].waiMaiDishSkuBases.length;c++)i[a].waiMaiDishSkuBases[c].dishId=i[a].dishId,i[a].waiMaiDishSkuBases[c].eDishCode=i[a].eDishCode,i[a].waiMaiDishSkuBases[c].eDishSkuCode&&(e.relNum+=1);for(d=0;d<s.length;d++)i[a].categoryName==s[d].categoryName&&(s[d].list=s[d].list.concat(i[a].waiMaiDishSkuBases),r=!1);r&&(o.list=i[a].waiMaiDishSkuBases,s.push(o))}e.goodsList=s;case 8:case"end":return t.stop()}},t,e)}))()},showGoods:function(e){this.item=e,this.checkEide=!1,this.relationWin.winshow=!0,this.relationItem=e},editMain:function(e){this.item=e,this.addWin.type=2,this.addWin.winshow=!0},editGoods:function(e){this.showGoods(e),this.checkEide=!0},deleteGoods:function(e,t,i){var s,a=this;this.$store.commit("setWin",{title:"提示",content:"确定删除外卖商品?",winType:"confirm",callback:(s=o(regeneratorRuntime.mark(function s(o){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if("ok"!=o){s.next=9;break}return s.next=3,n.a.meituanDeleteSku({data:{eDishCode:e.eDishCode,eDishSkuCode:e.eDishSkuCode,takeOutGoodsId:e.dishId,specId:e.dishSkuId}});case 3:if(s.sent){s.next=6;break}return s.abrupt("return");case 6:t.list.splice(i,1),a.relNum-=1,a.allNum-=1;case 9:case"end":return s.stop()}},s,a)})),function(e){return s.apply(this,arguments)})})},addFood:function(){this.addWin.type=1,this.addWin.winshow=!0},addfoodwin:function(e){this.addWin.winshow=!1,"ok"==e&&this.addfoodClose()},addfoodClose:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i,s,a,o,r,c,d,l,u,h,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.$refs.addwin,s=e.check(i.packageName,"商品名称不能为空"),a=void 0,o=void 0,r=void 0,c=void 0,d=void 0,l=void 0,s&&(a=e.check(i.mealboxNum,"餐盒数量不能为空")),a&&(+i.mealboxNum>100||+i.mealboxNum<0)&&(a=!1,e.alert("提示","餐盒数量0~100")),a&&(o=e.check(i.mealUnit,"餐盒价格不能为空")),o&&(+i.mealUnit>100||+i.mealUnit<0)&&(o=!1,e.alert("提示","餐盒价格0~100")),o&&(r=e.check(i.minBuy,"最小购买数量不能为空")),r&&(+i.minBuy>50||+i.minBuy<0)&&(r=!1,e.alert("提示","最小购买数量0~50")),r&&(c=e.check(i.packagePice,"商品价格不能为空")),c&&(+i.packagePice>500||+i.packagePice<0)&&(c=!1,e.alert("提示","商品价格0~500")),c&&(d=e.check(i.classifyname,"请选择分类")),d&&(l=e.check(i.releSel,"请选关联菜品")),u=e.check(i.mealboxNum,"餐盒数量输入错误",1),h=e.check(i.minBuy,"最小购买数量输入错误",1),f=e.check(i.packagePice,"餐盒价格输入错误",1),s&&a&&o&&r&&c&&d&&l&&u&&h&&f){t.next=24;break}return e.addWin.winshow=!0,t.abrupt("return",!1);case 24:return t.next=26,n.a.uploadGoods({data:{boxNum:i.mealboxNum,boxPrice:i.mealUnit,categoryName:i.classifyname,description:i.description,dishName:i.packageName,EDishCode:i.releSel.id,minOrderCount:i.minBuy,picture:i.imgupData,price:i.packagePice,isPackage:i.releSel.isPackage}});case 26:if(t.sent){t.next=29;break}return t.abrupt("return");case 29:e.init();case 30:case"end":return t.stop()}},t,e)}))()},previous:function(){window.history.go(-1)},success:function(){this.relNum<this.allNum?this.alert("提示","您还有商品未关联请继续关联"):window.close()},relationevn:function(e){this.relationWin.winshow=!1,"ok"==e&&this.relationClose()},relationClose:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i,s,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=e.$refs.relationwin.selected){t.next=4;break}return e.alert("提示","请关联商品"),e.relationWin.winshow=!0,t.abrupt("return",!1);case 4:i=!1,s=0;case 6:if(!(s<e.goodsList.length)){t.next=18;break}a=0;case 8:if(!(a<e.goodsList[s].list.length)){t.next=15;break}if(e.goodsList[s].list[a].eDishSkuCode!=e.$refs.relationwin.selected.id){t.next=12;break}return i=!0,t.abrupt("break",15);case 12:a++,t.next=8;break;case 15:s++,t.next=6;break;case 18:if(!i){t.next=22;break}return e.alert("提示","该商品已经被关联请重新关联"),e.relationWin.winshow=!0,t.abrupt("return",!1);case 22:return o=e.$refs.relationwin,/^(0)/.test(o.selected.id)&&(o.selected.id=o.selected.id.substr(1,o.selected.id.length-1)),t.next=26,n.a.bindgoods({data:{specId:e.item.dishSkuId,takeOutGoodsId:e.item.dishId,isPackage:o.isPackage?1:0,goodsId:o.selected.id}});case 26:if(t.sent){t.next=29;break}return t.abrupt("return");case 29:e.checkEide||(e.relNum+=1),e.item.eDishSkuCode=o.isPackage?"0"+o.selected.id:o.selected.id;case 31:case"end":return t.stop()}},t,e)}))()},check:function(e,t,i){var n=/\S/;return"object"==(void 0===e?"undefined":a(e))&&(e=JSON.stringify(e)),1==i&&(n=/^[\d.]*$/),!!n.test(e)||(this.alert("错误提示",t),!1)},alert:function(e,t){this.$store.commit("setWin",{title:e,content:t})},getGoodsName:function(e){if(/^(0)/.test(e)){e=e.substr(1,e.length-1);for(var t=0;t<d.length;t++)if(e==d[t].id)return d[t].packageName}else for(var i=0;i<r.length;i++)if(e==r[i].id)return r[i].goodsName;return!1}},mounted:function(){document.querySelector("#warrant").style.height="100%",this.init()},components:{addfoodWin:function(){return i.e("addfood_win").then(i.bind(null,"2025"))},relationWin:function(){return i.e("relation_win").then(i.bind(null,"596b"))}}},u=(i("3100"),i("d801")),h=Object(u.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"shopList",attrs:{id:"releGoods"}},[i("div",{staticClass:"shopList"},[i("p",[e._v("请关联商品\n\t\t\t"),i("span",{staticClass:"outaddGoods blue",on:{click:e.addFood}},[i("span",[e._v("+")]),e._v(" "),i("span",[e._v("添加商品")])])]),e._v(" "),i("ul",{staticClass:"shopTitle title"},[i("li",{staticStyle:{width:"230px"}}),e._v(" "),i("li",{staticStyle:{width:"560px"}},[e._v("外卖商品")]),e._v(" "),i("li",{staticStyle:{width:"600px"}},[e._v("闪店系统(已关联"+e._s(e.relNum)+"/"+e._s(e.allNum)+")")])]),e._v(" "),i("div",{staticClass:"contentBox"},e._l(e.goodsList,function(t,n){return t.list.length>0?i("div",{key:n,staticClass:"content"},[i("div",{staticClass:"category"},[e._v(e._s(t.categoryName))]),e._v(" "),i("div",{staticClass:"sdgoods"},e._l(t.list,function(n,s){return i("ul",{key:s},[i("li",{staticStyle:{"border-left":"5px solid #F7F7F7","text-align":"left"}},[i("span",{staticClass:"namestyle",staticStyle:{"text-align":"center"}},[e._v(e._s(n.dishSkuName)+"\n\t\t\t\t\t\t\t\t"),n.spec?i("span",[e._v("("+e._s(n.spec)+")")]):e._e()]),e._v(" "),n.eDishSkuCode?i("i",{staticClass:"edit",on:{click:function(t){e.editMain(n)}}}):e._e(),e._v(" "),n.eDishSkuCode?i("i",{staticClass:"delete",on:{click:function(i){e.deleteGoods(n,t,s)}}}):e._e()]),e._v(" "),n.eDishSkuCode&&e.getGoodsName(n.eDishSkuCode)?i("li",[i("span",{staticClass:"goodsName"},[e._v(e._s(e.getGoodsName(n.eDishSkuCode)))]),e._v(" "),i("i",{staticClass:"edit",on:{click:function(t){e.editGoods(n)}}})]):i("li",[i("span",{staticClass:"goodsicon"}),e._v(" "),i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){e.showGoods(n)}}},[e._v("选择关联菜品")])])])}))]):e._e()}))]),e._v(" "),e._m(0),e._v(" "),i("div",[i("a",{staticClass:"gray",staticStyle:{"margin-top":"20px"},attrs:{href:"javascript:void(0);"},on:{click:e.previous}},[e._v("上一步")]),e._v(" "),i("a",{staticClass:"yellow",staticStyle:{"margin-top":"20px"},attrs:{href:"javascript:void(0);"},on:{click:e.success}},[e._v("完成")])]),e._v(" "),e.addWin.winshow?i("addfood-win",{ref:"addwin",attrs:{item:e.item,type:e.addWin.type,goodsList:e.goodsList,width:e.addWin.width,height:e.addWin.height,title:e.addWin.title},on:{winEvent:e.addfoodwin}}):e._e(),e._v(" "),e.relationWin.winshow?i("relationWin",{ref:"relationwin",attrs:{width:e.relationWin.width,item:e.relationItem,changeConfig:e.relationWin.changeConfig,seloneAir:e.relationWin.seloneAir,seltwoAir:e.relationWin.seltwoAir,height:e.relationWin.height,title:e.relationWin.title},on:{relationEvent:e.relationevn}}):e._e()],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tip-icon"},[t("i"),this._v(" "),t("span",{staticStyle:{color:"#999999","font-size":"16px"}},[this._v("请确保关联所有商品，否则在外卖渠道统计中未关联部分数据将不显示")])])}],!1,null,"24707d36",null);t.default=h.exports},acf0:function(e,t,i){}}]);