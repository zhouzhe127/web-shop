(window.webpackJsonp=window.webpackJsonp||[]).push([["free_store"],{"0c4a":function(t,e,a){},4772:function(t,e,a){"use strict";var s=a("0c4a");a.n(s).a},9678:function(t,e,a){"use strict";a.r(e);var s=a("81a2"),i=a("bbb9"),r=a("f6ce");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function s(i,r){try{var o=e[i](r),n=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(n).then(function(t){s("next",t)},function(t){s("throw",t)});t(n)}("next")})}}var n={props:["store","order","otherData","step","loading"],data:function(){return{returnData:"",returnList:[],returnOrderList:[],returnDetailList:[],orderStoreList:"",shopId:"",dayData:"",dayList:[],sendData:{},total:{freeNum:0,freePrice:0,orderNum:0,totalDay:1,recordNum:0},orderTotal:{totalNum:0,totalPrice:0,totalDay:1},dayTotal:{freeNum:0,freePrice:0},detailTotal:{oid:"",freeNum:0,createTime:"",freePrice:0,areaName:"",tableName:""},page:1,pageNum:1,pageShow:10,showStep:"",showPageList:[10,20],showDetail:!1,loadShow:!1,listIndex:0,returnListGoodsName:"",singleTime:"",titleList1:[{titleName:"操作",titleStyle:{width:"150px"}},{titleName:"订单号",titleStyle:{width:"190px"}},{titleName:"订单时间",dataName:"createTime"},{titleName:"区域",dataName:"areaName"},{titleName:"桌台",dataName:"tableName"},{titleName:"赠品数量",dataName:"freeNum"},{titleName:"赠品金额(元)",dataName:"freePrice"}],titleList2:[{titleName:"商品类型",dataName:"typeName"},{titleName:"商品名称",dataName:"itemName"},{titleName:"赠品数量",dataName:"totalNum"},{titleName:"赠品金额",dataName:"totalPrice"},{titleName:"赠品时间",dataName:"time"},{titleName:"操作人",dataName:"staffName"}],mainBox:{"margin-top":0}}},watch:{store:"setStore",step:"setStep",order:"setOrder",loading:"setLoad",pageShow:"initData",otherData:{deep:!0,handler:function(){this.setSingleStore()}}},mounted:function(){this.orderStoreList=this.store?this.store:[],this.returnList=this.order.list?this.order.list:[],this.sendData=this.otherData,this.showStep=this.step,this.setStore(),this.setOrder(),this.getOrderListCache()},components:{selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},pageBtn:function(){return a.e("page_element").then(a.bind(null,"5921"))},tableCom:function(){return a.e("table").then(a.bind(null,"4360"))}},methods:{toDay:function(t){var e=t.target;e.className.indexOf("light")>=0&&(this.orderTotal.totalDay<=1?(this.shopId=e.getAttribute("data-id"),this.singleTime=this.sendData.brand.startTime/1e3,r.a.session("deleteSingleTime",this.singleTime),this.getMoreShop()):(this.shopId=e.getAttribute("data-id"),this.page=1,this.pageNum=1,this.getDayData(),r.a.session("deleteShopId",this.shopId)))},toSingle:function(t){var e=t.target;e.className.indexOf("light")>=0&&(this.singleTime=e.getAttribute("data-time"),r.a.session("deleteSingleTime",this.singleTime),this.getMoreShop())},getMoreShop:function(){this.showStep=3,this.page=1,this.pageNum=1;var t={step:this.showStep,id:this.shopId,pageShow:this.pageShow,time:1e3*this.singleTime,isOneDay:this.orderTotal.totalDay<=1};this.$emit("emit",t)},getDayData:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.moreFree({data:{startTime:parseInt(t.sendData.brand.startTime/1e3),endTime:parseInt(t.sendData.brand.endTime/1e3),isOpenTime:t.sendData.brand.openTime,page:t.page,num:t.pageShow,trueShopId:t.shopId}});case 2:(a=e.sent).pageShow=t.pageShow,t.setDayData(a,!1),r.a.session("dayData",a),t.showStep=2,i={step:t.showStep},t.$emit("emit",i);case 9:case"end":return e.stop()}},e,t)}))()},toDetail:function(t,e,a){var i=this;return o(regeneratorRuntime.mark(function r(){var o,n,l,d,h,p,c,v,u,_,m,g,f,N,S,w,D,y;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(2==a&&(o={step:0,id:t.oid},i.$emit("emit",o)),1!=a){r.next=51;break}return r.next=4,s.a.getFreeDetail({data:{oid:i.returnOrderList[e].oid,trueShopId:i.sendData.store.shopId}});case 4:for(n=r.sent,l=!0,d=!1,h=void 0,r.prev=8,p=n[Symbol.iterator]();!(l=(c=p.next()).done);l=!0)(v=c.value).totalPrice=i.toFloatStr(v.totalPrice);r.next=16;break;case 12:r.prev=12,r.t0=r.catch(8),d=!0,h=r.t0;case 16:r.prev=16,r.prev=17,!l&&p.return&&p.return();case 19:if(r.prev=19,!d){r.next=22;break}throw h;case 22:return r.finish(19);case 23:return r.finish(16);case 24:for(m in i.returnDetailList=n,u=0,_=0,i.returnOrderList[e])"freeNum"==m&&"freePrice"==m||(i.detailTotal[m]=i.returnOrderList[e][m]);for(g=!0,f=!1,N=void 0,r.prev=30,S=n[Symbol.iterator]();!(g=(w=S.next()).done);g=!0)D=w.value,u+=parseInt(D.totalNum),_+=parseInt(D.totalPrice);r.next=38;break;case 34:r.prev=34,r.t1=r.catch(30),f=!0,N=r.t1;case 38:r.prev=38,r.prev=39,!g&&S.return&&S.return();case 41:if(r.prev=41,!f){r.next=44;break}throw N;case 44:return r.finish(41);case 45:return r.finish(38);case 46:i.detailTotal.freeNum=u,i.detailTotal.freePrice=_,i.showStep=5,y={step:i.showStep},i.$emit("emit",y);case 51:case"end":return r.stop()}},r,i,[[8,12,16,24],[17,,19,23],[30,34,38,46],[39,,41,45]])}))()},showOrderDetail:function(t){var e=t.target;e.className.indexOf("show-order")>=0&&(this.listIndex=e.getAttribute("data-index"),this.page=1,this.showOrder())},showOrder:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getFreeList({data:{startTime:parseInt(t.sendData.store.startTime/1e3),endTime:parseInt(t.sendData.store.endTime/1e3),isOpenTime:t.sendData.store.openTime,page:t.page,num:t.pageShow,trueShopId:t.sendData.store.shopId,areaId:t.sendData.store.areaId,tableId:t.sendData.store.tableId,goodsName:t.returnList[t.listIndex].goodsName,gid:t.returnList[t.listIndex].gid,packageId:t.returnList[t.listIndex].packageId}});case 2:for(i in a=e.sent,t.showStep=4,t.returnOrderList=a.list?a.list:[],t.pageNum=a.pageNum?a.pageNum:1,a.total)a.total?t.total[i]=a.total[i]:t.total[i]=0;t.returnListGoodsName=t.returnList[t.listIndex].goodsName,a.listIndex=t.listIndex,r.a.session("orderListCache",a),r.a.session("returnListGoodsName",t.returnListGoodsName),o={step:t.showStep,goodsName:t.returnList[t.listIndex].goodsName,gid:t.returnList[t.listIndex].gid,packageId:t.returnList[t.listIndex].packageId},t.$emit("emit",o);case 13:case"end":return e.stop()}},e,t)}))()},getOrderListCache:function(){var t=r.a.session("orderListCache");if(t)for(var e in this.page=t.page,this.pageNum=t.pageNum,this.listIndex=t.listIndex,this.returnListGoodsName=r.a.session("returnListGoodsName"),this.returnOrderList=t.list?t.list:[],t.total)t.total?this.total[e]=t.total[e]:(this.total[e]=0,this.total.totalDay=1)},pageChange:function(t){var e=this.page;this.page=t.page,this.pageShow=t.num,e!=t.page&&this.initData()},showPageChange:function(t){this.page=1,this.pageShow=this.showPageList[t]},initData:function(){var t=r.a.session("deleteShopId"),e=void 0;switch(t&&(this.shopId=t),this.showStep){case 2:this.getDayData();break;case 3:this.showStep=3,e={step:this.showStep,id:this.shopId,page:this.page,pageShow:this.pageShow,time:1e3*this.singleTime},this.$emit("emit",e);break;case 4:this.showOrder()}},setSingleStore:function(){this.sendData.store.isRequest&&this.showOrder()},setDayData:function(t,e){t&&(e&&(this.page=t.page,this.pageShow=t.pageShow),this.pageNum=t.pageNum,this.dayList=t.list?t.list:[],this.dayTotal.freeNum=t.total.freeNum,this.dayTotal.freePrice=t.total.freePrice)},setStep:function(){this.showStep=this.step,2==this.showStep&&this.setDayData(r.a.session("dayData"),!0)},setStore:function(){if(this.store){this.orderStoreList=this.store,this.sendData=this.otherData;for(var t=0,e=0,a=0;a<this.orderStoreList.length;a++)t+=this.orderStoreList[a].totalNum,e+=this.orderStoreList[a].totalPrice;this.orderTotal.totalNum=t,this.orderTotal.totalPrice=e,this.orderTotal.totalDay=Math.ceil((this.sendData.brand.endTime-this.sendData.brand.startTime)/864e5)}},setOrder:function(){for(var t in this.returnList=this.order.list?this.order.list:[],this.pageNum=this.order.pageNum?this.order.pageNum:1,this.page=this.order.page?this.order.page:1,this.total)this.order.total?this.total[t]=this.order.total[t]:(this.total[t]=0,this.total.totalDay=1)},toFloatStr:function(t){var e=t+"";return i.a.toFloatStr(e,2)},setLoad:function(){this.loadShow=this.loading},formatTime:function(t){return i.a.format(new Date(1e3*t),"yyyy年MM月dd日")}}},l=(a("4772"),a("d801")),d=Object(l.a)(n,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"step-container"},[1!=t.showStep||t.loadShow?t._e():[s("div",{staticClass:"total"},[t._m(0),t._v(" "),s("div",{staticClass:"total-data"},[s("span",[t._v(t._s(t.orderTotal.totalDay))]),t._v(" "),s("span",[t._v(t._s(t.orderTotal.totalNum))]),t._v(" "),s("span",[t._v(t._s(t.orderTotal.totalPrice))])])]),t._v(" "),s("div",{staticClass:"store-list"},[s("div",{staticClass:"length"},[t._v("\n\t\t\t\t赠品统计 · 共\n\t\t\t\t"),s("span",[t._v(" "+t._s(t.orderStoreList.length)+" ")]),t._v("条记录\n\t\t\t")]),t._v(" "),t._m(1),t._v(" "),s("ul",{on:{click:t.toDay}},[t._l(t.orderStoreList,function(e,a){return s("li",{key:a},[s("span",{staticClass:"light",attrs:{"data-id":e.shopId}},[t._v(t._s(e.shopName))]),t._v(" "),s("span",[t._v(t._s(e.totalNum))]),t._v(" "),s("span",[t._v(t._s(e.totalPrice))])])}),t._v(" "),t.orderStoreList.length?t._e():s("li",{staticClass:"list-empty"},[t._v("- 暂无条目 -")])],2)])],t._v(" "),t.loadShow?s("div",{staticClass:"loading"},[s("img",{attrs:{src:a("b8bc")}})]):t._e(),t._v(" "),2==t.showStep?[s("div",{staticClass:"total"},[t._m(2),t._v(" "),s("div",{staticClass:"total-data"},[s("span",[t._v(t._s(t.orderTotal.totalDay))]),t._v(" "),s("span",[t._v(t._s(t.dayTotal.freeNum))]),t._v(" "),s("span",[t._v(t._s(t.dayTotal.freePrice))])])]),t._v(" "),s("div",{staticClass:"store-list"},[t._m(3),t._v(" "),s("ul",{on:{click:t.toSingle}},[t._l(t.dayList,function(e,a){return s("li",{key:a,staticClass:"day"},[s("span",{staticClass:"light",attrs:{"data-time":e.date}},[t._v("查看详情")]),t._v(" "),s("span",[t._v(t._s(t.formatTime(e.date)))]),t._v(" "),s("span",[t._v(t._s(e.freeNum))]),t._v(" "),s("span",[t._v(t._s(e.freePrice))])])}),t._v(" "),t.dayList.length?t._e():s("li",{staticClass:"list-empty"},[t._v("- 暂无条目 -")])],2)])]:t._e(),t._v(" "),3==t.showStep?[s("div",{staticClass:"total goods"},[t._m(4),t._v(" "),s("div",{staticClass:"total-data"},[s("span",[t._v(t._s(t.total.totalDay))]),t._v(" "),s("span",[t._v(t._s(t.total.orderNum))]),t._v(" "),s("span",[t._v(t._s(t.total.freeNum))]),t._v(" "),s("span",[t._v(t._s(t.total.freePrice))])])]),t._v(" "),s("div",{staticClass:"list goods"},[s("div",{staticClass:"length"},[t._v("\n\t\t\t\t赠品统计 · 共\n\t\t\t\t"),s("span",[t._v(" "+t._s(t.total.recordNum)+" ")]),t._v("条记录\n\t\t\t")]),t._v(" "),t._m(5),t._v(" "),s("ul",{on:{click:t.showOrderDetail}},[t._l(t.returnList,function(e,a){return s("li",{key:a},[s("span",{staticClass:"show-order light",attrs:{"data-index":a}},[t._v("查看详情")]),t._v(" "),s("span",[t._v(t._s(e.goodsName))]),t._v(" "),s("span",[t._v(t._s(e.freeNum))]),t._v(" "),s("span",[t._v(t._s(e.freePrice))])])}),t._v(" "),t.returnList.length?t._e():s("li",{staticClass:"list-empty"},[t._v("- 暂无条目 -")])],2)])]:t._e(),t._v(" "),4==t.showStep?[s("div",{staticClass:"total goods"},[t._m(6),t._v(" "),s("div",{staticClass:"total-data"},[s("span",[t._v(t._s(t.total.totalDay))]),t._v(" "),s("span",[t._v(t._s(t.total.orderNum))]),t._v(" "),s("span",[t._v(t._s(t.total.freeNum))]),t._v(" "),s("span",[t._v(t._s(t.total.freePrice))])])]),t._v(" "),s("tableCom",{attrs:{listHeight:50,listName:t.returnListGoodsName,allTotal:t.total.orderNum,fixed:2,introData:t.returnOrderList,titleData:t.titleList1,listWidth:1200},scopedSlots:t._u([{key:"con-0",fn:function(e){return s("div",{staticStyle:{color:"#f8941f",cursor:"pointer"},on:{click:function(a){t.toDetail(e.data,e.index,1)}}},[t._v("\n\t\t\t\t查看详情\n\t\t\t")])}},{key:"con-1",fn:function(e){return s("div",{staticStyle:{color:"#29abe2",cursor:"pointer"},on:{click:function(a){t.toDetail(e.data,e.index,2)}}},[t._v("\n\t\t\t\t"+t._s(e.data.oid)+"\n\t\t\t")])}}])})]:t._e(),t._v(" "),5==t.showStep?[s("div",{staticClass:"detail"},[s("div",{staticClass:"detail-head"},[s("span",[t._v("订单详情")]),t._v(" "),s("ul",[s("li",[s("em",[t._v("订单号：")]),t._v(t._s(t.detailTotal.oid))]),t._v(" "),s("li",[s("em",[t._v("订单时间：")]),t._v(t._s(t.detailTotal.createTime))]),t._v(" "),s("li",[s("em",[t._v("桌台号：")]),t._v(t._s(t.detailTotal.areaName)+" -- "+t._s(t.detailTotal.tableName))])]),t._v(" "),s("ul",[s("li",[s("em",[t._v("赠品数量：")]),t._v(t._s(t.detailTotal.freeNum))]),t._v(" "),s("li",[s("em",[t._v("赠品总额：")]),t._v(t._s(t.detailTotal.freePrice))])])]),t._v(" "),s("tableCom",{attrs:{listHeight:50,showHand:!1,fixed:0,mainBox:t.mainBox,introData:t.returnDetailList,titleData:t.titleList2,listWidth:1200}})],1)]:t._e(),t._v(" "),1!=t.step&&5!=t.step?s("div",{staticClass:"page-box"},[s("pageBtn",{attrs:{total:t.pageNum,page:t.page,isNoJump:!0},on:{pageNum:t.pageChange}})],1):t._e()],2)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("天数")]),this._v(" "),e("span",[this._v("赠品总数")]),this._v(" "),e("span",[this._v("赠品总额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("店铺名称")]),this._v(" "),e("span",[this._v("赠品总数")]),this._v(" "),e("span",[this._v("赠品总额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("天数")]),this._v(" "),e("span",[this._v("赠品总数")]),this._v(" "),e("span",[this._v("赠品总额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title day"},[e("span",[this._v("查看详情")]),this._v(" "),e("span",[this._v("时间")]),this._v(" "),e("span",[this._v("赠品数量")]),this._v(" "),e("span",[this._v("赠品金额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("天数")]),this._v(" "),e("span",[this._v("订单数")]),this._v(" "),e("span",[this._v("赠品总数")]),this._v(" "),e("span",[this._v("赠品总额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("操作")]),this._v(" "),e("span",[this._v("商品名称")]),this._v(" "),e("span",[this._v("赠品数量")]),this._v(" "),e("span",[this._v("赠品金额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",[this._v("天数")]),this._v(" "),e("span",[this._v("订单数")]),this._v(" "),e("span",[this._v("赠品总数")]),this._v(" "),e("span",[this._v("赠品总额")])])}],!1,null,"17c3f164",null);e.default=d.exports},b8bc:function(t,e,a){t.exports=a.p+"images/preloader.3e54c692.gif"}}]);