(window.webpackJsonp=window.webpackJsonp||[]).push([["add_material"],{"09cb":function(t,e,r){"use strict";var a=r("672f");r.n(a).a},"672f":function(t,e,r){},c4ba:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"bom-order"},[r("div",{staticClass:"filter"},[r("div",{staticClass:"inline-box"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.matName,expression:"matName"}],attrs:{type:"text",placeholder:"请输入物料名"},domProps:{value:t.matName},on:{input:function(e){e.target.composing||(t.matName=e.target.value)}}})]),t._v(" "),r("div",{staticClass:"inline-box"},[r("select-store",{attrs:{sorts:t.sortOne,tipName:"请选择一级分类",isSingle:!0},on:{emit:t.selSortOne}})],1),t._v(" "),r("div",{staticClass:"inline-box",on:{click:function(e){t.checkSelect("sortTwo","towSortDom")}}},[r("select-store",{ref:"towSortDom",attrs:{sorts:t.sortTwo,tipName:"请选择二级分类",isSingle:!0},on:{emit:t.selSortTwo}})],1),t._v(" "),r("div",{staticClass:"inline-box"},[r("select-store",{attrs:{sorts:t.wareList,tipName:"请选择仓库"},on:{emit:t.selWare}})],1),t._v(" "),r("div",{staticClass:"inline-box",on:{click:function(e){t.checkSelect("areaList","areaDom")}}},[r("select-store",{ref:"areaDom",attrs:{sorts:t.areaList,tipName:"请选择区域"},on:{emit:t.selArea}})],1),t._v(" "),r("div",{staticClass:"inline-box"},[r("div",{staticClass:"button-box"},[r("span",{staticClass:"blue",on:{click:t.filter}},[t._v("筛选")]),t._v(" "),r("span",{staticClass:"gray",on:{click:t.reset}},[t._v("重置")])])])]),t._v(" "),r("com-table",{attrs:{listName:"物料列表",titleData:t.titleList,allTotal:t.listLength,introData:t.list,listHeight:70,listWidth:1200},scopedSlots:t._u([{key:"title-0",fn:function(e){return r("div",{staticClass:"select-all select-ban"},[r("span",{on:{click:function(e){t.radioAll("store")}}},[t._v(t._s(t.storeAll?"取消全选":"全选"))]),t._v(" "),r("i",[t._v("|")]),t._v(" "),r("span",{staticClass:"page-all",class:{ban:t.storeAll},on:{click:function(e){t.radioAll("page")}}},[t._v(t._s(t.pageAll?"取消本页":"全选本页"))])])}},{key:"con-0",fn:function(e){return r("span",{staticClass:"detail select-ban",on:{click:function(r){t.listHandle(e.index)}}},[r("i",{class:{"sel-active":e.data.selected,storeAll:t.storeAll}})])}},{key:"con-1",fn:function(e){return r("span",{},[t._v(t._s((t.page-1)*t.pageShow+e.index>=9?(t.page-1)*t.pageShow+e.index+1:"0"+((t.page-1)*t.pageShow+e.index+1)))])}},{key:"con-3",fn:function(e){return r("span",{},[t._v("物料")])}},{key:"con-4",fn:function(e){return r("span",{},[t._v(t._s(e.data.wName)+t._s(e.data.aName?" / "+e.data.aName:""))])}},{key:"con-5",fn:function(e){return r("span",{},[t._v(t._s(t.setCate(e.data.cate)))])}},{key:"con-6",fn:function(e){return r("span",{},[t._v(t._s(t.setSuprlus(e.data.surplus,e.data.unit)))])}}])}),t._v(" "),r("div",{staticClass:"page-box"},[r("pageBtn",{attrs:{total:t.pageTotal,page:t.page,isNoJump:!0},on:{pageNum:t.pageChange}})],1),t._v(" "),t.nameWinShow?r("model-name",{attrs:{name:t.modelName,title:t.modelTitle},on:{emit:t.nameWinEmit}}):t._e()],1)};a._withStripped=!0;var i=r("f6ce"),s=r("bbb9"),n=r("81a2"),o=r("05dd");function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){return function a(i,s){try{var n=e[i](s),o=n.value}catch(t){return void r(t)}if(!n.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var c={data:function(){return{userName:"",tempId:"",shopId:"",isBrand:0,page:1,pageShow:10,pageTotal:1,list:[],listLength:0,userData:"",matName:"",cid:"",wid:"",areaId:"",modelName:"",modelTitle:"保存模板",nameWinShow:!1,titleList:[{titleName:"操作",titleStyle:{width:"200px"}},{titleName:"序号"},{titleName:"物料名称",dataName:"name"},{titleName:"类型"},{titleName:"所属仓库"},{titleName:"分类"},{titleName:"库存数量/重量"},{titleName:"批次数量",dataName:"batch"}],goodsTypeObj:{0:"普通商品",1:"称重商品"},storeAll:!1,pageAll:!1,savePage:[],selectItem:[],selNum:0,wareList:[],areaList:[],selList:[],searchObj:{},sortOne:[],sortTwo:[],allSort:[],sortOneId:"",sortTwoId:""}},props:["selObj"],components:{pageBtn:function(){return r.e("page_element").then(r.bind(null,"5921"))},selectBtn:function(){return r.e("select_btn").then(r.bind(null,"3d41"))},selectStore:function(){return r.e("win").then(r.bind(null,"cb83"))},calendar:function(){return r.e("calendar_type").then(r.bind(null,"f2dd"))},comTable:function(){return r.e("table").then(r.bind(null,"4360"))},modelName:function(){return r.e("model_name_win").then(r.bind(null,"5338"))}},created:function(){this.userData=i.a.session("userShop"),this.userName=this.userData.user.name,this.shopId=this.userData.currentShop.id},mounted:function(){this.initBtn(),this.setDefault(),this.getData(),this.getCategoryList(),this.getWarehouseList()},methods:{initBtn:function(){var t=this,e=[{name:"确定",style:"background: #fe8d01;border: 1px solid #fe8d01;color: #fff;",fn:function(){t.confirmClick()}},{name:"保存模板",style:"background: none;border: 1px solid #fe8d01;color: #fe8d01;",fn:function(){t.saveModel()}},{name:"取消",style:"background: #b3b3b3;border: 1px solid #b3b3b3;color: #fff;",fn:function(){t.$emit("emit",!1)}}];this.$store.commit("setPageTools",e)},confirmClick:function(){if(this.selList.length||this.storeAll){var t={list:this.selList,search:this.searchObj,storeAll:this.storeAll};this.$emit("emit",t)}else this.myAlert("请选择商品")},setDefault:function(){for(var t in this.selObj.search)this[t]=this.selObj.search[t];this.storeAll=this.selObj.storeAll,this.selList=this.selObj.list,this.selectItem=this.selList.map(function(t){return{mid:t.id,aid:t.areaId}})},formatTime:function(t){return s.a.format(new Date(1e3*t),"yyyy-MM-dd hh:mm:ss")},filter:function(){this.page=1,this.getData()},nameWinEmit:function(t,e){this.nameWinShow=!1,"ok"==t&&(this.modelName=e,this.tempId?this.editModel():this.addModel())},getCategoryList:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var r,a,i,s,o,l,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.invoiv_getCategoryList();case 2:for(r=e.sent,a=[],i=!0,s=!1,o=void 0,e.prev=7,l=r[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)0==(h=c.value).pid&&a.push(h);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),s=!0,o=e.t0;case 15:e.prev=15,e.prev=16,!i&&l.return&&l.return();case 18:if(e.prev=18,!s){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:t.sortOne=a,t.allSort=r,t.setDefaultSort();case 26:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22]])}))()},selSortOne:function(t,e){var r=[];e||(this.sortTwoId=""),this.cid=this.setSortId(t),this.sortOneId=this.cid;var a=!0,i=!1,s=void 0;try{for(var n,o=this.allSort[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value;l.pid==this.cid&&r.push(l)}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}this.sortTwo=r},selSortTwo:function(t){this.cid=this.setSortId(t),this.sortTwoId=this.cid},setSortId:function(t){var e="",r=!0,a=!1,i=void 0;try{for(var s,n=t[Symbol.iterator]();!(r=(s=n.next()).done);r=!0){var o=s.value;if(1==o.selected){e=o.id;break}}}catch(t){a=!0,i=t}finally{try{!r&&n.return&&n.return()}finally{if(a)throw i}}return e},setDefaultSort:function(){var t=!0,e=!1,r=void 0;try{for(var a,i=this.sortOne[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=a.value;if(this.sortOneId==s.id){s.selected=!0;break}}}catch(t){e=!0,r=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw r}}if(this.selSortOne(this.sortOne,!0),this.sortTwo.length){var n=!0,o=!1,l=void 0;try{for(var c,h=this.sortTwo[Symbol.iterator]();!(n=(c=h.next()).done);n=!0){var u=c.value;if(this.sortTwoId==u.id){u.selected=!0;break}}}catch(t){o=!0,l=t}finally{try{!n&&h.return&&h.return()}finally{if(o)throw l}}this.selSortTwo(this.sortTwo)}},getWarehouseList:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var r,a,i,s,o,l,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.warehouseWarehouseList();case 2:for(r=e.sent,a=[],i=!0,s=!1,o=void 0,e.prev=7,l=r[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)(h=c.value).shopId?t.shopId==h.shopId&&a.push(h):t.shopId==h.brandId&&a.push(h);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),s=!0,o=e.t0;case 15:e.prev=15,e.prev=16,!i&&l.return&&l.return();case 18:if(e.prev=18,!s){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:t.wareList=a,t.setWareDefault();case 25:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22]])}))()},selWare:function(t,e){var r=this;this.wid="",e||(this.areaId=""),this.areaList=[];var a=[],i=function(t){if(1==t.selected){var e;a.push(t.id);var i=t.area.map(function(e){return{id:e.id,name:t.name+" / "+e.areaName}});(e=r.areaList).push.apply(e,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(i))}},s=!0,n=!1,o=void 0;try{for(var l,c=t[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){i(l.value)}}catch(t){n=!0,o=t}finally{try{!s&&c.return&&c.return()}finally{if(n)throw o}}this.wid=a.join(",")},selArea:function(t){this.areaId="";var e=[],r=!0,a=!1,i=void 0;try{for(var s,n=t[Symbol.iterator]();!(r=(s=n.next()).done);r=!0){var o=s.value;1==o.selected&&e.push(o.id)}}catch(t){a=!0,i=t}finally{try{!r&&n.return&&n.return()}finally{if(a)throw i}}this.areaId=e.join(",")},setWareDefault:function(){var t=this.wid.split(","),e=s.a.deepCopy(this.wareList),r=!0,a=!1,i=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done);r=!0){var l=n.value,c=!0,h=!1,u=void 0;try{for(var d,f=t[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var m=d.value;l.id==m&&(l.selected=!0)}}catch(t){h=!0,u=t}finally{try{!c&&f.return&&f.return()}finally{if(h)throw u}}}}catch(t){a=!0,i=t}finally{try{!r&&o.return&&o.return()}finally{if(a)throw i}}this.wareList=e,this.selWare(this.wareList,!0);var v=this.areaId.split(","),p=s.a.deepCopy(this.areaList),y=!0,g=!1,w=void 0;try{for(var b,S=p[Symbol.iterator]();!(y=(b=S.next()).done);y=!0){var I=b.value,x=!0,N=!1,A=void 0;try{for(var _,k=v[Symbol.iterator]();!(x=(_=k.next()).done);x=!0){var L=_.value;I.id==L&&(I.selected=!0)}}catch(t){N=!0,A=t}finally{try{!x&&k.return&&k.return()}finally{if(N)throw A}}}}catch(t){g=!0,w=t}finally{try{!y&&S.return&&S.return()}finally{if(g)throw w}}this.areaList=p,this.selArea(this.areaList)},setCate:function(t){var e=[],r=!0,a=!1,i=void 0;try{for(var s,n=t[Symbol.iterator]();!(r=(s=n.next()).done);r=!0){var o=s.value;e.push(o.name)}}catch(t){a=!0,i=t}finally{try{!r&&n.return&&n.return()}finally{if(a)throw i}}return e.join(", ")},setSuprlus:function(t,e){var r="",a="",i=1,s=!0,n=!1,l=void 0;try{for(var c,h=e[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var u=c.value;1==u.isMin?(a=u.name,1==u.isDefault&&(r=u.name,i=u.value)):1==u.isDefault&&(r=u.name,i=u.value)}}catch(t){n=!0,l=t}finally{try{!s&&h.return&&h.return()}finally{if(n)throw l}}return o.a.comUnit(t,i,r,a)},myAlert:function(t){this.$store.commit("setWin",{title:"操作提示",content:t})},setSendObj:function(t){this.storeAll&&(this.selectItem=[]);var e={name:this.modelName,userName:this.userName,wid:this.wid.split(","),aid:this.areaId.split(","),c1:this.sortOneId,c2:this.sortTwoId,items:this.selectItem};return t&&(e.id=this.tempId),e},saveModel:function(){this.selectItem.length||this.storeAll?(this.nameWinShow=!0,this.modelName?this.modelTitle="修改模板":this.modelTitle="新建模板"):this.myAlert("模板内容不能为空")},addModel:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.setSendObj(),e.next=3,n.a.addInventoryGoodsTemplate({data:r});case 3:(a=e.sent)&&(t.tempId=a,t.myAlert("模板保存成功！"));case 5:case"end":return e.stop()}},e,t)}))()},editModel:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.setSendObj(!0),e.next=3,n.a.editInventoryGoodsTemplate({data:r});case 3:e.sent&&t.myAlert("模板修改成功！");case 5:case"end":return e.stop()}},e,t)}))()},getData:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.materialGetListByArea({data:{page:t.page,num:t.pageShow,name:t.matName,cid:t.cid,wid:t.wid,areaId:t.areaId}});case 2:r=e.sent,t.searchObj={cid:t.cid,sortOneId:t.sortOneId,sortTwoId:t.sortTwoId,wid:t.wid,areaId:t.areaId},t.list=t.setAlready(r.list),t.listLength=r.count,t.pageTotal=r.total,t.setSelNum();case 8:case"end":return e.stop()}},e,t)}))()},setAlready:function(t){var e=!1,r=!0,a=!1,i=void 0;try{for(var s,n=t[Symbol.iterator]();!(r=(s=n.next()).done);r=!0){var o=s.value;if(this.storeAll)o.selected=!0;else{var l=!0,c=!1,h=void 0;try{for(var u,d=this.savePage[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){if(u.value==this.page){e=!0;break}}}catch(t){c=!0,h=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw h}}if(e)o.selected=!0;else{var f=!1,m=!0,v=!1,p=void 0;try{for(var y,g=this.selectItem[Symbol.iterator]();!(m=(y=g.next()).done);m=!0){var w=y.value;if(w.mid==o.id&&w.aid==o.areaId){f=!0;break}}}catch(t){v=!0,p=t}finally{try{!m&&g.return&&g.return()}finally{if(v)throw p}}o.selected=!!f}}}}catch(t){a=!0,i=t}finally{try{!r&&n.return&&n.return()}finally{if(a)throw i}}return this.pageAll=!!e,t},setSelNum:function(){var t=!0,e=!1,r=void 0;try{for(var a,i=this.list[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){1==a.value.selected&&this.selNum++}}catch(t){e=!0,r=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw r}}},checkSelect:function(t,e){this[t].length||(this.$refs[e].sortShow=!1,"towSortDom"==e?this.myAlert("请选择一级分类"):this.myAlert("请选择仓库"))},reset:function(){var t=!0,e=!1,r=void 0;try{for(var a,i=["matName","cid","wid","areaId"][Symbol.iterator]();!(t=(a=i.next()).done);t=!0){this[a.value]=""}}catch(t){e=!0,r=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw r}}this.page=1,this.pageShow=10;var n=s.a.deepCopy(this.wareList),o=!0,l=!1,c=void 0;try{for(var h,u=n[Symbol.iterator]();!(o=(h=u.next()).done);o=!0){h.value.selected=!1}}catch(t){l=!0,c=t}finally{try{!o&&u.return&&u.return()}finally{if(l)throw c}}this.wareList=n,this.areaList=[],this.getData()},pageChange:function(t){this.page=Number(t.page),this.pageShow=Number(t.num),this.getData()},listHandle:function(t){var e=this.list[t];if(!this.storeAll)if(e.selected=!e.selected,e.selected)this.selectItem.push({mid:e.id,aid:e.areaId}),this.selList.push(e),this.selNum++,this.selNum==this.list.length&&(this.savePage.push(this.page),this.pageAll=!0);else{this.selNum--;for(var r=0;r<this.selectItem.length;r++){var a=this.selectItem[r].mid,i=this.selectItem[r].aid;if(a==e.id&&i==e.areaId){this.selectItem.splice(r,1),this.selList.splice(r,1),r--;break}}this.pageAll&&(this.removePageNum(),this.pageAll=!1)}},radioAll:function(t){if(this.list.length)if("store"==t)this.storeAll=!this.storeAll,this.pageAll=!1,this.setSelAll(this.storeAll),this.selList=[];else if("page"==t){if(this.storeAll)return;this.pageAll=!this.pageAll,this.pageAll?(this.savePage.push(this.page),this.pageSetId("add")):(this.removePageNum(),this.pageSetId("cancel"))}},removePageNum:function(){for(var t=0;t<this.savePage.length;t++)this.savePage[t]==this.page&&(this.savePage.splice(t,1),t--)},pageSetId:function(t){if("add"==t){var e=!0,r=!1,a=void 0;try{for(var i,s=this.list[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){var n=i.value,o=!1,l=!0,c=!1,h=void 0;try{for(var u,d=this.selectItem[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;if(n.id==f.mid&&n.areaId==f.aid){o=!0;break}}}catch(t){c=!0,h=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw h}}o||(this.selectItem.push({mid:n.id,aid:n.areaId}),this.selList.push(n),n.selected=!0)}}catch(t){r=!0,a=t}finally{try{!e&&s.return&&s.return()}finally{if(r)throw a}}}else if("cancel"==t){var m=!0,v=!1,p=void 0;try{for(var y,g=this.list[Symbol.iterator]();!(m=(y=g.next()).done);m=!0)for(var w=y.value,b=0;b<this.selectItem.length;b++){var S=this.selectItem[b].mid,I=this.selectItem[b].aid;if(S==w.id&&I==w.areaId){this.selectItem.splice(b,1),this.selList.splice(b,1),w.selected=!1,b--;break}}}catch(t){v=!0,p=t}finally{try{!m&&g.return&&g.return()}finally{if(v)throw p}}}},setSelAll:function(t){if(t){var e=!0,r=!1,a=void 0;try{for(var i,s=this.list[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){i.value.selected=!0}}catch(t){r=!0,a=t}finally{try{!e&&s.return&&s.return()}finally{if(r)throw a}}}else{var n=!0,o=!1,l=void 0;try{for(var c,h=this.list[Symbol.iterator]();!(n=(c=h.next()).done);n=!0){c.value.selected=!1}}catch(t){o=!0,l=t}finally{try{!n&&h.return&&h.return()}finally{if(o)throw l}}this.selectItem=[]}}}},h=(r("09cb"),r("7610")),u=Object(h.a)(c,a,[],!1,null,"b3d327d6",null);u.options.__file="src\\module\\invoicing_system\\invoicing\\check_warehouse\\add_material.vue";e.default=u.exports}}]);