(window.webpackJsonp=window.webpackJsonp||[]).push([["payment_way"],{"4fa3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{attrs:{num:"app",id:"paymentWay"}},[e.showZX?e._e():a("section",{staticStyle:{"max-width":"1240px"}},[a("section",{staticStyle:{"margin-bottom":"15px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addpay}},[e._v("添加支付方式")]),e._v(" "),1==e.ischain||2==e.ischain?a("div",{staticClass:"topBox"},[e._m(0),e._v(" "),e._m(1)]):e._e()],1),e._v(" "),a("el-table",{staticStyle:{width:"100%",margin:"20px 0"},attrs:{data:e.payNameList,border:"",stripe:""}},[a("el-table-column",{staticStyle:{"text-aline":"center"},attrs:{label:"操作",align:"center",width:220,fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.isOperation?a("div",{staticClass:"btn"},[a("span",{staticClass:"isBrandColor",on:{click:function(a){e.modifyBtn(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),0==t.row.isOpen?a("span",{staticClass:"line isBrandColor",on:{click:function(a){e.isOpenDetial(t.$index,t.row)}}},[e._v("开启")]):e._e(),e._v(" "),1==t.row.isOpen?a("span",{staticClass:"line isBrandColor",on:{click:function(a){e.isOpenDetial(t.$index,t.row)}}},[e._v("关闭")]):e._e(),e._v(" "),t.row.id>=1e4?a("span",{staticClass:"line",staticStyle:{color:"#F56C6C"},on:{click:function(a){e.deletePayment(t.row,t.$index)}}},[e._v("删除")]):e._e()]):a("section",["会员支付"==t.row.paymentName?a("div",[e._v("不可操作")]):a("div",{staticClass:"btn"},["微信"==t.row.paymentName||"支付宝"==t.row.paymentName||"中信银行"==t.row.paymentName||"中信银行(上海)"==t.row.paymentName||"点佰趣"==t.row.paymentName||"农行支付"==t.row.paymentName||"网易严选支付"==t.row.paymentName||"旺POS支付"==t.row.paymentName?[a("span",{staticClass:"isBrandColor",on:{click:function(a){e.modifyBtn(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),0==t.row.isOpen?a("span",{staticClass:"line isBrandColor",on:{click:function(a){e.isOpenDetial(t.$index,t.row)}}},[e._v("开启")]):e._e(),e._v(" "),1==t.row.isOpen?a("span",{staticClass:"line isBrandColor",on:{click:function(a){e.isOpenDetial(t.$index,t.row)}}},[e._v("关闭")]):e._e()]:e._e(),e._v(" "),"现金"==t.row.paymentName||"银行卡"==t.row.paymentName?[0==t.row.isOpen?a("span",{staticClass:"isBrandColor",on:{click:function(a){e.isOpenDetial(t.$index,t.row)}}},[e._v("开启")]):e._e(),e._v(" "),1==t.row.isOpen?a("span",{staticClass:"isBrandColor",on:{click:function(a){e.isOpenDetial(t.$index,t.row)}}},[e._v("关闭")]):e._e()]:e._e()],2)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.isOpen?a("span",[e._v("已关闭")]):e._e(),e._v(" "),"1"==t.row.isOpen?a("span",[e._v("已开启")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"支付方式",align:"center",prop:"paymentName"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==e.ischain?[a("span",[e._v(e._s(t.row.paymentName))])]:e._e(),e._v(" "),"0"!=e.ischain?["1"==t.row.isAssign?a("span",{staticStyle:{color:"#f8931f"}},[e._v(e._s(t.row.paymentName))]):e._e(),e._v(" "),"0"==t.row.isAssign?a("span",{staticStyle:{color:"#2ea7e0"}},[e._v(e._s(t.row.paymentName))]):e._e()]:e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"入实收账",align:"center",prop:"creator"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.isBill?a("span",[e._v("是")]):a("span",[e._v("否")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序",align:"center",prop:"sort"}})],1),e._v(" "),e.showWin?a("payWayWin",{attrs:{detial:e.detial,types:e.types},on:{payWayWin:e.getResult}}):e._e()],1),e._v(" "),e.showZX?a("zxBandWin",{attrs:{config:e.detial.payConfig,types:e.types},on:{zxBandWin:e.newGetResult}}):e._e()],1)};n._withStripped=!0;var i=a("f6ce"),r=a("05dd"),s=a("81a2");function p(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(i,r){try{var s=t[i](r),p=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(p).then(function(e){n("next",e)},function(e){n("throw",e)});e(p)}("next")})}}var o={data:function(){return{payNameList:[],num:1,payNameId:"",payName:"",isBill:1,isOperation:!0,merId:"",isIndependent:"",showWin:!1,types:"add",detial:{paymentName:"",isBill:!0,sort:"1"},showZX:!1,userId:"",index:-1,ischain:0}},components:{payWayWin:function(){return a.e("pay_way_win").then(a.bind(null,"c646"))},zxBandWin:function(){return a.e("zx_band_win").then(a.bind(null,"daf2"))}},mounted:function(){var e=i.a.session("userShop");this.ischain=e.currentShop.ischain,this.userId=e.user.id,this.inte()},methods:{getResult:function(e,t){if("ok"==e){if(!this.isOk(t))return void(this.showWin=!0);var a={};a.createUid=this.userId,a.isOpen="1",a.paymentId=t.id,a.paymentName=t.paymentName,"支付宝"==t.paymentName&&3==this.index?(a.alipayrsaPublicKey=t.payConfig.alipayrsaPublicKey,a.rsaPrivateKey=t.payConfig.rsaPrivateKey,a.appId=t.payConfig.appId,a.signType=t.payConfig.signType,this.editPayConfig(a)):"微信"==t.paymentName&&2==this.index?(a.appid=t.payConfig.appid,a.minAppId=t.payConfig.minAppId,a.mchid=t.payConfig.mchid,a.key=t.payConfig.key,a.appSecret=t.payConfig.appSecret,a.apiclient_key=t.payConfig.apiclient_key,a.apiclient_cert=t.payConfig.apiclient_cert,this.editPayConfig(a)):"中信银行"==t.paymentName&&5==this.index?this.showZX=!0:"点佰趣"==t.paymentName&&6==this.index?(a.businessNum=t.payConfig.businessNum,this.editPayConfig(a)):"网易严选支付"==t.paymentName&&7==this.index?(a.appId=t.payConfig.appId,a.productId=t.payConfig.productId,a.key=t.payConfig.key,this.editPayConfig(a)):"农行支付"==t.paymentName&&8==this.index?(a.mid=t.payConfig.mid,a.tid=t.payConfig.tid,a.instMid=t.payConfig.instMid,a.msgSrc=t.payConfig.msgSrc,a.msgSrcId=t.payConfig.msgSrcId,a.md5Key=t.payConfig.md5Key,this.editPayConfig(a)):"中信银行(上海)"==t.paymentName&&9==this.index?(a.mchId=t.payConfig.mchId,a.privateRsaKey=t.payConfig.privateRsaKey,a.publicRsaKey=t.payConfig.publicRsaKey,this.editPayConfig(a)):"旺POS支付"==t.paymentName&&10==this.index?(a.mcode=t.payConfig.mcode,a.appKey=t.payConfig.appKey,a.appSecret=t.payConfig.appSecret,this.editPayConfig(a)):(a.sort=t.sort,a.isBill=t.isBill?1:0,"add"==this.types?this.addPayment(a):this.editPayment(a)),this.showWin=!1}else this.showWin=!1},newGetResult:function(){this.showWin=!1,this.showZX=!1,this.$store.commit("setPageTools",[]),this.inte()},inte:function(){var e=this;return p(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.getPaymentList({data:{}});case 2:e.payNameList=t.sent;case 3:case"end":return t.stop()}},t,e)}))()},editPayConfig:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.editPayConfig({data:e});case 2:return a.next=4,s.a.getPaymentList({data:{}});case 4:t.payNameList=a.sent;case 5:case"end":return a.stop()}},a,t)}))()},addPayment:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.addPayment({data:e});case 2:return a.next=4,s.a.getPaymentList({data:{}});case 4:t.payNameList=a.sent;case 5:case"end":return a.stop()}},a,t)}))()},editPayment:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.editPayment({data:e});case 2:return a.next=4,s.a.getPaymentList({data:{}});case 4:t.payNameList=a.sent;case 5:case"end":return a.stop()}},a,t)}))()},deletePayment:function(e,t){var a=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:'是否删除"'+e.paymentName+'"',callback:function(n){"ok"==n&&a.delPayment(e.id,t)}})},delPayment:function(e,t){var a=this;return p(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.deletePayment({data:{paymentId:e}});case 2:a.payNameList.splice(t,1);case 3:case"end":return n.stop()}},n,a)}))()},addpay:function(){this.types="add",this.detial={paymentName:"",isBill:!0,sort:"1"},this.showWin=!0},modifyBtn:function(e,t){var a=this;return p(regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a.index=e,i={paymentId:t.trueId?t.trueId:t.id},"中信银行"!=t.paymentName||"6"!=t.id||5!=e){n.next=10;break}return n.next=5,s.a.getWeixinAlipay({data:i});case 5:a.detial=n.sent,a.detial.payConfig?a.detial.payConfig.secMerId&&(a.detial.payConfig=a.detial.payConfig):(a.detial.payConfig={},a.detial.payConfig.merId="",a.detial.payConfig.isIndependent=""),a.types="zxBand",n.next=70;break;case 10:if("微信"!=t.paymentName||2!=e){n.next=18;break}return n.next=13,s.a.getWeixinAlipay({data:i});case 13:a.detial=n.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.mchid="",a.detial.payConfig.key="",a.detial.payConfig.appSecret="",a.detial.payConfig.apiclient_key="",a.detial.payConfig.apiclient_cert="",a.detial.payConfig.appid=""),a.types="wx",n.next=70;break;case 18:if("支付宝"!=t.paymentName||3!=e){n.next=26;break}return n.next=21,s.a.getWeixinAlipay({data:i});case 21:a.detial=n.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.alipayrsaPublicKey="",a.detial.payConfig.rsaPrivateKey="",a.detial.payConfig.appId="",a.detial.payConfig.signType="RSA"),a.types="zfb",n.next=70;break;case 26:if("点佰趣"!=t.paymentName||6!=e){n.next=34;break}return n.next=29,s.a.getWeixinAlipay({data:i});case 29:a.detial=n.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.businessNum="",a.detial.payConfig.organizationNum=""),a.types="dbq",n.next=70;break;case 34:if("网易严选支付"!=t.paymentName||7!=e){n.next=42;break}return n.next=37,s.a.getWeixinAlipay({data:i});case 37:a.detial=n.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.appId="",a.detial.payConfig.productId="",a.detial.payConfig.key=""),a.types="wyyx",n.next=70;break;case 42:if("农行支付"!=t.paymentName||8!=e){n.next=50;break}return n.next=45,s.a.getWeixinAlipay({data:i});case 45:a.detial=n.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.mid="",a.detial.payConfig.tid="",a.detial.payConfig.instMid="",a.detial.payConfig.msgSrc="",a.detial.payConfig.msgSrcId="",a.detial.payConfig.md5Key=""),a.types="nhzf",n.next=70;break;case 50:if("中信银行(上海)"!=t.paymentName||9!=e){n.next=58;break}return n.next=53,s.a.getWeixinAlipay({data:i});case 53:a.detial=n.sent,a.detial.payConfig&&0!=a.detial.payConfig.length?a.detial.payConfig.secMerId&&(a.detial.payConfig=a.detial.payConfig):(a.detial.payConfig={},a.detial.payConfig.mchId="",a.detial.payConfig.privateRsaKey="",a.detial.payConfig.publicRsaKey=""),a.types="SHzxBand",n.next=70;break;case 58:if("旺POS支付"!=t.paymentName||10!=e){n.next=66;break}return n.next=61,s.a.getWeixinAlipay({data:i});case 61:a.detial=n.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.mcode="",a.detial.payConfig.appKey="",a.detial.payConfig.appSecret=""),a.types="wPos",n.next=70;break;case 66:return n.next=68,s.a.getPaymentById({data:i});case 68:a.detial=n.sent,a.types="edit";case 70:a.showWin=!0;case 71:case"end":return n.stop()}},n,a)}))()},getWeixinAlipay:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){var n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n={paymentId:e.id},a.next=3,s.a.getWeixinAlipay({data:n});case 3:t.detial=a.sent;case 4:case"end":return a.stop()}},a,t)}))()},getPaymentById:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){var n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n={paymentId:e.id},a.next=3,s.a.getPaymentById({data:n});case 3:t.detial=a.sent;case 4:case"end":return a.stop()}},a,t)}))()},updatePaymentStatus:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){var n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n={paymentId:e.trueId?e.trueId:e.id,isOpen:0==e.isOpen?1:0},a.next=3,s.a.updatePaymentStatus({data:n});case 3:if(a.sent){a.next=7;break}return t.$store.commit("setWin",{title:"提示",winType:"alert",content:"请先配置此支付方式信息！"}),a.abrupt("return",!1);case 7:return a.next=9,s.a.getPaymentList({data:{}});case 9:t.payNameList=a.sent;case 10:case"end":return a.stop()}},a,t)}))()},isOpenDetial:function(e,t){var a=this,n=0==t.isOpen?"确认开启":"确认关闭";this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:n,callback:function(e){"ok"==e&&a.updatePaymentStatus(t)}})},isOk:function(e){if("微信"==e.paymentName&&2==this.index){if(!r.a.checkData({appid:"微信APPID不能为空"},e.payConfig))return!1;if(!r.a.checkData({mchid:"商户号不能为空"},e.payConfig))return!1;if(!r.a.checkData({key:"商户支付密钥不能为空"},e.payConfig))return!1;if(!r.a.checkData({appSecret:"微信appSecret不能为空"},e.payConfig))return!1;var t=e.payConfig.apiclient_cert;if(!r.a.checkData({apiclient_cert:"证书（cert）不能为空"},e.payConfig))return!1;if(""!==t&&"BEGIN CERTIFICATE"!=i(t))return this.$store.commit("setWin",{title:"提示",winType:"alert",content:"证书cert传错了"}),!1;var a=e.payConfig.apiclient_key;if(!r.a.checkData({apiclient_key:"证书密钥（key）不能为空"},e.payConfig))return!1;if(""!==a&&("BEGIN PRIVATE KEY"!=i(a)||void 0==i(a)))return this.$store.commit("setWin",{title:"提示",winType:"alert",content:"证书密钥（key）传错了"}),!1}else if("支付宝"==e.paymentName&&3==this.index){if(!r.a.checkData({alipayrsaPublicKey:"支付宝公钥不能为空"},e.payConfig))return!1;if(!r.a.checkData({rsaPrivateKey:"RSA私钥不能为空"},e.payConfig))return!1;if(!r.a.checkData({appId:"支付宝应用ID不能为空"},e.payConfig))return!1}else if("点佰趣"==e.paymentName&&6==this.index){if(!r.a.checkData({businessNum:"商户编号不能为空"},e.payConfig))return!1}else if("网易严选支付"==e.paymentName&&7==this.index){if(!r.a.checkData({appId:"产品appId不能为空"},e.payConfig))return!1;if(!r.a.checkData({productId:"产品号不能为空"},e.payConfig))return!1;if(!r.a.checkData({key:"产品密钥key不能为空"},e.payConfig))return!1}else if("农行支付"==e.paymentName&&8==this.index){if(!r.a.checkData({mid:"商户号不能为空"},e.payConfig))return!1;if(!r.a.checkData({tid:"终端号不能为空"},e.payConfig))return!1;if(!r.a.checkData({instMid:"机构商户号不能为空"},e.payConfig))return!1;if(!r.a.checkData({msgSrc:"消息来源不能为空"},e.payConfig))return!1;if(!r.a.checkData({msgSrcId:"来源编号不能为空"},e.payConfig))return!1;if(!r.a.checkData({md5Key:"MD5密钥不能为空"},e.payConfig))return!1}else if("中信银行(上海)"==e.paymentName&&9==this.index){if(!r.a.checkData({mchId:"商户号不能为空"},e.payConfig))return!1;if(!r.a.checkData({privateRsaKey:"客户私钥不能为空"},e.payConfig))return!1;if(!r.a.checkData({publicRsaKey:"中信公钥不能为空"},e.payConfig))return!1}else if("旺POS支付"==e.paymentName&&10==this.index){if(!r.a.checkData({mcode:"旺POS门店编号不能为空"},e.payConfig))return!1;if(!r.a.checkData({appKey:"appKey不能为空"},e.payConfig))return!1;if(!r.a.checkData({appSecret:"appSecret不能为空"},e.payConfig))return!1}else{if(!r.a.checkData({paymentName:"支付名称不能为空不能为空"},e))return!1;for(var n=0;n<this.payNameList.length;n++)if("中信银行"==e.paymentName&&5==this.index)return!0}function i(e){if(""!=e&&void 0!=e){for(var t=e.split("-"),a=0;a<t.length;a++)""!=t[a]&&void 0!==t[a]||(t.splice(a,1),a-=1);return t[0]}}return!0}}},c=(a("6e6d"),a("6ceb")),y=Object(c.a)(o,n,[function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("i"),this._v("品牌指派")])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("i"),this._v("门店自建")])}],!1,null,"af4b7aca",null);y.options.__file="src\\module\\shop_config\\payment_way.vue";t.default=y.exports},"6e6d":function(e,t,a){"use strict";var n=a("d255");a.n(n).a},d255:function(e,t,a){}}]);