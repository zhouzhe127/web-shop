(window.webpackJsonp=window.webpackJsonp||[]).push([["payment_way"],{3230:function(t,e,a){},"4fa3":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{attrs:{num:"app",id:"paymentWay"}},[t.showZX?t._e():a("section",[a("section",{staticStyle:{"margin-bottom":"15px"}},[a("div",{staticClass:"btn-concent",staticStyle:{width:"200px",display:"inline-block"},on:{click:t.addpay}},[a("button",{staticClass:"increase",staticStyle:{width:"100%"}},[t._v("添加支付方式")])]),t._v(" "),1==t.ischain||2==t.ischain?a("div",{staticClass:"topBox"},[t._m(0),t._v(" "),t._m(1)]):t._e()]),t._v(" "),a("section",{staticStyle:{width:"100%","min-width":"710px"}},[t._m(2),t._v(" "),a("section",[0==t.payNameList.length?a("section",{staticStyle:{width:"100%",height:"50px","line-height":"50px","text-align":"center",color:"orange"}},[t._v("暂时无支付")]):t._l(t.payNameList,function(e,i){return a("section",{key:i,staticClass:"paymentWayContent commonLi"},[a("ul",[a("li",[1==e.isOperation?a("span",{staticClass:"blue editInfo"},[a("a",{staticClass:"blue fl",staticStyle:{width:"50%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.modifyBtn(i,e)}}},[t._v("编辑")]),t._v(" "),0==e.isOpen?a("a",{staticClass:"gray",staticStyle:{width:"50%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.isOpenDetial(i,e)}}},[t._v("已关闭")]):t._e(),t._v(" "),1==e.isOpen?a("a",{staticClass:"yellow",staticStyle:{width:"50%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.isOpenDetial(i,e)}}},[t._v("已开启")]):t._e()]):a("section",["微信"==e.paymentName||"支付宝"==e.paymentName||"中信银行"==e.paymentName||"点佰趣"==e.paymentName||"农行支付"==e.paymentName||"网易严选支付"==e.paymentName?a("div",{staticClass:"editInfo"},[a("a",{staticClass:"blue",staticStyle:{width:"50%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.modifyBtn(i,e)}}},[t._v("编辑")]),t._v(" "),0==e.isOpen?a("a",{staticClass:"gray",staticStyle:{width:"50%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.isOpenDetial(i,e)}}},[t._v("已关闭")]):t._e(),t._v(" "),1==e.isOpen?a("a",{staticClass:"yellow",staticStyle:{width:"50%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.isOpenDetial(i,e)}}},[t._v("已开启")]):t._e()]):t._e(),t._v(" "),"现金"==e.paymentName||"银行卡"==e.paymentName?a("div",[0==e.isOpen?a("a",{staticClass:"gray",staticStyle:{width:"100%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.isOpenDetial(i,e)}}},[t._v("已关闭")]):t._e(),t._v(" "),1==e.isOpen?a("a",{staticClass:"yellow",staticStyle:{width:"100%",float:"left"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.isOpenDetial(i,e)}}},[t._v("已开启")]):t._e()]):a("span",{staticClass:"gray editInfo"},[t._v("不可操作")])])]),t._v(" "),a("li",{class:{isBrandColor:"0"==e.isAssign&&0!=t.ischain,isShopColor:"1"==e.isAssign&&0!=t.ischain},staticStyle:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[t._v(t._s(e.paymentName))]),t._v(" "),a("li",["1"==e.isBill?a("span",[t._v("是")]):a("span",[t._v("否")])]),t._v(" "),a("li",[t._v(t._s(e.sort))])])])})],2),t._v(" "),t._m(3)]),t._v(" "),t.showWin?a("payWayWin",{attrs:{detial:t.detial,types:t.types},on:{payWayWin:t.getResult}}):t._e()],1),t._v(" "),t.showZX?a("zxBandWin",{attrs:{config:t.detial.payConfig,types:t.types},on:{zxBandWin:t.newGetResult}}):t._e()],1)};i._withStripped=!0;var n=a("f6ce"),s=a("05dd"),r=a("81a2");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,s){try{var r=e[n](s),o=r.value}catch(t){return void a(t)}if(!r.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}var p={data:function(){return{payNameList:[],num:1,payNameId:"",payName:"",isBill:1,isOperation:!0,merId:"",isIndependent:"",showWin:!1,types:"add",detial:{paymentName:"",isBill:!0,sort:"1"},showZX:!1,userId:"",index:-1,ischain:0}},components:{payWayWin:function(){return a.e("pay_way_win").then(a.bind(null,"c646"))},zxBandWin:function(){return a.e("zx_band_win").then(a.bind(null,"daf2"))}},mounted:function(){var t=n.a.session("userShop");this.ischain=t.currentShop.ischain,this.userId=t.user.id,this.inte()},methods:{getResult:function(t,e){if("ok"==t){if(!this.isOk(e))return void(this.showWin=!0);var a={};a.createUid=this.userId,a.isOpen="1",a.paymentId=e.id,a.paymentName=e.paymentName,"支付宝"==e.paymentName&&3==this.index?(a.alipayrsaPublicKey=e.payConfig.alipayrsaPublicKey,a.rsaPrivateKey=e.payConfig.rsaPrivateKey,a.appId=e.payConfig.appId,a.signType=e.payConfig.signType,this.editPayConfig(a)):"微信"==e.paymentName&&2==this.index?(a.appid=e.payConfig.appid,a.minAppId=e.payConfig.minAppId,a.mchid=e.payConfig.mchid,a.key=e.payConfig.key,a.appSecret=e.payConfig.appSecret,a.apiclient_key=e.payConfig.apiclient_key,a.apiclient_cert=e.payConfig.apiclient_cert,console.log(a),this.editPayConfig(a)):"中信银行"==e.paymentName&&5==this.index?this.showZX=!0:"点佰趣"==e.paymentName&&6==this.index?(a.businessNum=e.payConfig.businessNum,this.editPayConfig(a)):"网易严选支付"==e.paymentName&&7==this.index?(a.appId=e.payConfig.appId,a.productId=e.payConfig.productId,a.key=e.payConfig.key,this.editPayConfig(a)):"农行支付"==e.paymentName&&8==this.index?(a.mid=e.payConfig.mid,a.tid=e.payConfig.tid,a.instMid=e.payConfig.instMid,a.msgSrc=e.payConfig.msgSrc,a.msgSrcId=e.payConfig.msgSrcId,a.md5Key=e.payConfig.md5Key,this.editPayConfig(a)):(a.sort=e.sort,a.isBill=e.isBill?1:0,"add"==this.types?this.addPayment(a):this.editPayment(a)),this.showWin=!1}else this.showWin=!1},newGetResult:function(){this.showWin=!1,this.showZX=!1,this.$store.commit("setPageTools",[]),this.inte()},inte:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.getPaymentList({data:{}});case 2:t.payNameList=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},editPayConfig:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.editPayConfig({data:t});case 2:return a.next=4,r.a.getPaymentList({data:{}});case 4:e.payNameList=a.sent;case 5:case"end":return a.stop()}},a,e)}))()},addPayment:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.addPayment({data:t});case 2:return a.next=4,r.a.getPaymentList({data:{}});case 4:e.payNameList=a.sent;case 5:case"end":return a.stop()}},a,e)}))()},editPayment:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.editPayment({data:t});case 2:return a.next=4,r.a.getPaymentList({data:{}});case 4:e.payNameList=a.sent;case 5:case"end":return a.stop()}},a,e)}))()},addpay:function(){this.types="add",this.detial={paymentName:"",isBill:!0,sort:"1"},this.showWin=!0},modifyBtn:function(t,e){var a=this;return o(regeneratorRuntime.mark(function i(){var n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a.index=t,n={paymentId:e.trueId?e.trueId:e.id},"中信银行"!=e.paymentName||"6"!=e.id||5!=t){i.next=10;break}return i.next=5,r.a.getWeixinAlipay({data:n});case 5:a.detial=i.sent,a.detial.payConfig?a.detial.payConfig.secMerId&&(a.detial.payConfig=a.detial.payConfig):(a.detial.payConfig={},a.detial.payConfig.merId="",a.detial.payConfig.isIndependent=""),a.types="zxBand",i.next=54;break;case 10:if("微信"!=e.paymentName||2!=t){i.next=18;break}return i.next=13,r.a.getWeixinAlipay({data:n});case 13:a.detial=i.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.mchid="",a.detial.payConfig.key="",a.detial.payConfig.appSecret="",a.detial.payConfig.apiclient_key="",a.detial.payConfig.apiclient_cert="",a.detial.payConfig.appid=""),a.types="wx",i.next=54;break;case 18:if("支付宝"!=e.paymentName||3!=t){i.next=26;break}return i.next=21,r.a.getWeixinAlipay({data:n});case 21:a.detial=i.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.alipayrsaPublicKey="",a.detial.payConfig.rsaPrivateKey="",a.detial.payConfig.appId="",a.detial.payConfig.signType="RSA"),a.types="zfb",i.next=54;break;case 26:if("点佰趣"!=e.paymentName||6!=t){i.next=34;break}return i.next=29,r.a.getWeixinAlipay({data:n});case 29:a.detial=i.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.businessNum="",a.detial.payConfig.organizationNum=""),a.types="dbq",i.next=54;break;case 34:if("网易严选支付"!=e.paymentName||7!=t){i.next=42;break}return i.next=37,r.a.getWeixinAlipay({data:n});case 37:a.detial=i.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.appId="",a.detial.payConfig.productId="",a.detial.payConfig.key=""),a.types="wyyx",i.next=54;break;case 42:if("农行支付"!=e.paymentName||8!=t){i.next=50;break}return i.next=45,r.a.getWeixinAlipay({data:n});case 45:a.detial=i.sent,a.detial.payConfig&&0!=a.detial.payConfig.length||(a.detial.payConfig={},a.detial.payConfig.mid="",a.detial.payConfig.tid="",a.detial.payConfig.instMid="",a.detial.payConfig.msgSrc="",a.detial.payConfig.msgSrcId="",a.detial.payConfig.md5Key=""),a.types="nhzf",i.next=54;break;case 50:return i.next=52,r.a.getPaymentById({data:n});case 52:a.detial=i.sent,a.types="edit";case 54:a.showWin=!0;case 55:case"end":return i.stop()}},i,a)}))()},getWeixinAlipay:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i={paymentId:t.id},a.next=3,r.a.getWeixinAlipay({data:i});case 3:e.detial=a.sent;case 4:case"end":return a.stop()}},a,e)}))()},getPaymentById:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i={paymentId:t.id},a.next=3,r.a.getPaymentById({data:i});case 3:e.detial=a.sent;case 4:case"end":return a.stop()}},a,e)}))()},updatePaymentStatus:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i={paymentId:t.trueId?t.trueId:t.id,isOpen:0==t.isOpen?1:0},a.next=3,r.a.updatePaymentStatus({data:i});case 3:if(a.sent){a.next=7;break}return e.$store.commit("setWin",{title:"提示",winType:"alert",content:"请先配置此支付方式信息！"}),a.abrupt("return",!1);case 7:return a.next=9,r.a.getPaymentList({data:{}});case 9:e.payNameList=a.sent;case 10:case"end":return a.stop()}},a,e)}))()},isOpenDetial:function(t,e){var a=this,i=0==e.isOpen?"确认开启":"确认关闭";this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:i,callback:function(t){"ok"==t&&a.updatePaymentStatus(e)}})},isOk:function(t){if("微信"==t.paymentName&&2==this.index){if(!s.a.checkData({appid:"微信APPID不能为空"},t.payConfig))return!1;if(!s.a.checkData({mchid:"商户号不能为空"},t.payConfig))return!1;if(!s.a.checkData({key:"商户支付密钥不能为空"},t.payConfig))return!1;if(!s.a.checkData({appSecret:"微信appSecret不能为空"},t.payConfig))return!1;var e=t.payConfig.apiclient_cert;if(!s.a.checkData({apiclient_cert:"证书（cert）不能为空"},t.payConfig))return!1;if(""!==e&&"BEGIN CERTIFICATE"!=n(e))return this.$store.commit("setWin",{title:"提示",winType:"alert",content:"证书cert传错了"}),!1;var a=t.payConfig.apiclient_key;if(!s.a.checkData({apiclient_key:"证书密钥（key）不能为空"},t.payConfig))return!1;if(""!==a&&("BEGIN PRIVATE KEY"!=n(a)||void 0==n(a)))return this.$store.commit("setWin",{title:"提示",winType:"alert",content:"证书密钥（key）传错了"}),!1}else if("支付宝"==t.paymentName&&3==this.index){if(!s.a.checkData({alipayrsaPublicKey:"支付宝公钥不能为空"},t.payConfig))return!1;if(!s.a.checkData({rsaPrivateKey:"RSA私钥不能为空"},t.payConfig))return!1;if(!s.a.checkData({appId:"支付宝应用ID不能为空"},t.payConfig))return!1}else if("点佰趣"==t.paymentName&&6==this.index){if(!s.a.checkData({businessNum:"商户编号不能为空"},t.payConfig))return!1}else if("网易严选支付"==t.paymentName&&7==this.index){if(!s.a.checkData({appId:"产品appId不能为空"},t.payConfig))return!1;if(!s.a.checkData({productId:"产品号不能为空"},t.payConfig))return!1;if(!s.a.checkData({key:"产品密钥key不能为空"},t.payConfig))return!1}else if("农行支付"==t.paymentName&&8==this.index){if(!s.a.checkData({mid:"商户号不能为空"},t.payConfig))return!1;if(!s.a.checkData({tid:"终端号不能为空"},t.payConfig))return!1;if(!s.a.checkData({instMid:"机构商户号不能为空"},t.payConfig))return!1;if(!s.a.checkData({msgSrc:"消息来源不能为空"},t.payConfig))return!1;if(!s.a.checkData({msgSrcId:"来源编号不能为空"},t.payConfig))return!1;if(!s.a.checkData({md5Key:"MD5密钥不能为空"},t.payConfig))return!1}else{if(!s.a.checkData({paymentName:"支付名称不能为空不能为空"},t))return!1;for(var i=0;i<this.payNameList.length;i++)if("中信银行"==t.paymentName&&5==this.index)return!0}function n(t){if(""!=t&&void 0!=t){for(var e=t.split("-"),a=0;a<e.length;a++)""!=e[a]&&void 0!==e[a]||(e.splice(a,1),a-=1);return e[0]}}return!0}}},c=(a("6e6d"),a("7610")),y=Object(c.a)(p,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("i"),this._v("品牌指派")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("i"),this._v("门店自建")])},function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"paymentWayTittle commonLi"},[e("ul",[e("li",[this._v("操作")]),this._v(" "),e("li",[this._v("支付方式")]),this._v(" "),e("li",[this._v("入实收账")]),this._v(" "),e("li",[this._v("排序")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"paymentWayTittle commonLi"},[e("ul",[e("li",[this._v("支付方式")]),this._v(" "),e("li",[this._v("入实收账")]),this._v(" "),e("li",[this._v("排序")]),this._v(" "),e("li",[this._v("操作")])])])}],!1,null,"af4b7aca",null);y.options.__file="src\\module\\shop_config\\payment_way.vue";e.default=y.exports},"6e6d":function(t,e,a){"use strict";var i=a("3230");a.n(i).a}}]);