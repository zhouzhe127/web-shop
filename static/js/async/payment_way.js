(window.webpackJsonp=window.webpackJsonp||[]).push([["payment_way"],{2709:function(e,a,t){"use strict";var n=t("e155");t.n(n).a},"4fa3":function(e,a,t){"use strict";t.r(a);var n=t("f6ce"),i=t("05dd"),r=t("81a2"),p=t("bbb9");function s(e){return function(){var a=e.apply(this,arguments);return new Promise(function(e,t){return function n(i,r){try{var p=a[i](r),s=p.value}catch(e){return void t(e)}if(!p.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var o={data:function(){return{payNameList:[],num:1,payNameId:"",payName:"",isBill:1,isOperation:!0,merId:"",isIndependent:"",showWin:!1,types:"add",detial:{paymentName:"",isBill:!0,sort:"1"},showZX:!1,userId:"",index:-1,ischain:0,isOpenwx:!1,wxIndex:0,wxpayName:""}},components:{payWayWin:function(){return t.e("pay_way_win").then(t.bind(null,"c646"))},zxBandWin:function(){return t.e("zx_band_win").then(t.bind(null,"daf2"))},selectRadioWin:function(){return t.e("select_radio_win").then(t.bind(null,"4e06"))}},mounted:function(){var e=n.a.session("userShop");this.ischain=e.currentShop.ischain,this.userId=e.user.id,this.inte()},methods:{radioBack:function(e,a){"ok"==e&&(this.wxIndex=a.index,this.wxpayName=a.name),this.isOpenwx=!1},selectwxpay:function(){this.isOpenwx=!0},getResult:function(e,a){if("ok"==e){if(!this.isOk(a))return void(this.showWin=!0);var t={};t.createUid=this.userId,t.isOpen="1",t.paymentId=a.id,t.paymentName=a.paymentName,t.sort=a.sort,"支付宝"==a.paymentName?(t.alipayrsaPublicKey=a.payConfig.alipayrsaPublicKey,t.rsaPrivateKey=a.payConfig.rsaPrivateKey,t.appId=a.payConfig.appId,t.signType=a.payConfig.signType,this.editPayConfig(t)):"微信"==a.paymentName?(t.appid=a.payConfig.appid,t.minAppId=a.payConfig.minAppId,t.mchid=a.payConfig.mchid,t.key=a.payConfig.key,t.appSecret=a.payConfig.appSecret,t.apiclient_key=a.payConfig.apiclient_key,t.apiclient_cert=a.payConfig.apiclient_cert,this.editPayConfig(t)):"中信银行"==a.paymentName?this.showZX=!0:"点佰趣"==a.paymentName?(t.businessNum=a.payConfig.businessNum,this.editPayConfig(t)):"网易严选支付"==a.paymentName?(t.appId=a.payConfig.appId,t.productId=a.payConfig.productId,t.key=a.payConfig.key,this.editPayConfig(t)):"农行支付"==a.paymentName?(t.mid=a.payConfig.mid,t.tid=a.payConfig.tid,t.instMid=a.payConfig.instMid,t.msgSrc=a.payConfig.msgSrc,t.msgSrcId=a.payConfig.msgSrcId,t.md5Key=a.payConfig.md5Key,this.editPayConfig(t)):"中信银行(上海)"==a.paymentName?(t.mchId=a.payConfig.mchId,t.privateRsaKey=a.payConfig.privateRsaKey,t.publicRsaKey=a.payConfig.publicRsaKey,this.editPayConfig(t)):"旺POS支付"==a.paymentName?(t.mcode=a.payConfig.mcode,t.appKey=a.payConfig.appKey,t.appSecret=a.payConfig.appSecret,this.editPayConfig(t)):"收钱吧"==a.paymentName?(t.appId=a.payConfig.appId,t.code=a.payConfig.code,this.editPayConfig(t)):(t.isBill=a.isBill?1:0,"add"==this.types?this.addPayment(t):this.editPayment(t)),this.showWin=!1}else this.showWin=!1},newGetResult:function(){this.showWin=!1,this.showZX=!1,this.$store.commit("setPageTools",[]),this.inte()},inte:function(){var e=this;return s(regeneratorRuntime.mark(function a(){var t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.getPaymentList({data:{}});case 2:t=a.sent,p.a.sortByAll(t,"sort"),e.payNameList=t;case 5:case"end":return a.stop()}},a,e)}))()},editPayConfig:function(e){var a=this;return s(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.editPayConfig({data:e});case 2:a.inte();case 3:case"end":return t.stop()}},t,a)}))()},addPayment:function(e){var a=this;return s(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.addPayment({data:e});case 2:a.inte();case 3:case"end":return t.stop()}},t,a)}))()},editPayment:function(e){var a=this;return s(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.editPayment({data:e});case 2:a.inte();case 3:case"end":return t.stop()}},t,a)}))()},deletePayment:function(e,a){var t=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:'是否删除"'+e.paymentName+'"',callback:function(n){"ok"==n&&t.delPayment(e.id,a)}})},delPayment:function(e,a){var t=this;return s(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.deletePayment({data:{paymentId:e}});case 2:t.payNameList.splice(a,1);case 3:case"end":return n.stop()}},n,t)}))()},addpay:function(){this.types="add",this.detial={paymentName:"",isBill:!0,sort:"1"},this.showWin=!0},modifyBtn:function(e,a){var t=this;return s(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={paymentId:a.trueId?a.trueId:a.id},"中信银行"!=a.paymentName||"6"!=a.id){e.next=9;break}return e.next=4,r.a.getWeixinAlipay({data:n});case 4:t.detial=e.sent,t.detial.payConfig?t.detial.payConfig.secMerId&&(t.detial.payConfig=t.detial.payConfig):(t.detial.payConfig={},t.detial.payConfig.merId="",t.detial.payConfig.isIndependent=""),t.types="zxBand",e.next=85;break;case 9:if("微信"!=a.paymentName||"3"!=a.id){e.next=17;break}return e.next=12,r.a.getWeixinAlipay({data:n});case 12:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.mchid="",t.detial.payConfig.key="",t.detial.payConfig.appSecret="",t.detial.payConfig.apiclient_key="",t.detial.payConfig.apiclient_cert="",t.detial.payConfig.appid=""),t.types="wx",e.next=85;break;case 17:if("支付宝"!=a.paymentName||"4"!=a.id){e.next=25;break}return e.next=20,r.a.getWeixinAlipay({data:n});case 20:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.alipayrsaPublicKey="",t.detial.payConfig.rsaPrivateKey="",t.detial.payConfig.appId="",t.detial.payConfig.signType="RSA"),t.types="zfb",e.next=85;break;case 25:if("收钱吧"!=a.paymentName||"27"!=a.id){e.next=33;break}return e.next=28,r.a.getWeixinAlipay({data:n});case 28:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.appId="",t.detial.payConfig.code=""),t.types="sqb",e.next=85;break;case 33:if("点佰趣"!=a.paymentName||"10"!=a.id){e.next=41;break}return e.next=36,r.a.getWeixinAlipay({data:n});case 36:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.businessNum="",t.detial.payConfig.organizationNum=""),t.types="dbq",e.next=85;break;case 41:if("网易严选支付"!=a.paymentName||"14"!=a.id){e.next=49;break}return e.next=44,r.a.getWeixinAlipay({data:n});case 44:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.appId="",t.detial.payConfig.productId="",t.detial.payConfig.key=""),t.types="wyyx",e.next=85;break;case 49:if("农行支付"!=a.paymentName||"20"!=a.id){e.next=57;break}return e.next=52,r.a.getWeixinAlipay({data:n});case 52:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.mid="",t.detial.payConfig.tid="",t.detial.payConfig.instMid="",t.detial.payConfig.msgSrc="",t.detial.payConfig.msgSrcId="",t.detial.payConfig.md5Key=""),t.types="nhzf",e.next=85;break;case 57:if("中信银行(上海)"!=a.paymentName||"23"!=a.id){e.next=65;break}return e.next=60,r.a.getWeixinAlipay({data:n});case 60:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length?t.detial.payConfig.secMerId&&(t.detial.payConfig=t.detial.payConfig):(t.detial.payConfig={},t.detial.payConfig.mchId="",t.detial.payConfig.privateRsaKey="",t.detial.payConfig.publicRsaKey=""),t.types="SHzxBand",e.next=85;break;case 65:if("旺POS支付"!=a.paymentName||"25"!=a.id){e.next=73;break}return e.next=68,r.a.getWeixinAlipay({data:n});case 68:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.mcode="",t.detial.payConfig.appKey="",t.detial.payConfig.appSecret=""),t.types="wPos",e.next=85;break;case 73:if("收钱吧"!=a.paymentName){e.next=81;break}return e.next=76,r.a.getWeixinAlipay({data:n});case 76:t.detial=e.sent,t.detial.payConfig&&0!=t.detial.payConfig.length||(t.detial.payConfig={},t.detial.payConfig.appId="",t.detial.payConfig.code=""),t.types="sqb",e.next=85;break;case 81:return e.next=83,r.a.getPaymentById({data:n});case 83:t.detial=e.sent,t.types="edit";case 85:t.showWin=!0;case 86:case"end":return e.stop()}},e,t)}))()},getWeixinAlipay:function(e){var a=this;return s(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={paymentId:e.id},t.next=3,r.a.getWeixinAlipay({data:n});case 3:a.detial=t.sent;case 4:case"end":return t.stop()}},t,a)}))()},getPaymentById:function(e){var a=this;return s(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={paymentId:e.id},t.next=3,r.a.getPaymentById({data:n});case 3:a.detial=t.sent;case 4:case"end":return t.stop()}},t,a)}))()},updatePaymentStatus:function(e){var a=this;return s(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={paymentId:e.trueId?e.trueId:e.id,isOpen:0==e.isOpen?1:0},t.next=3,r.a.updatePaymentStatus({data:n});case 3:if(t.sent){t.next=7;break}return a.$store.commit("setWin",{title:"提示",winType:"alert",content:"请先配置此支付方式信息！"}),t.abrupt("return",!1);case 7:a.inte();case 8:case"end":return t.stop()}},t,a)}))()},isOpenDetial:function(e,a){var t=this,n=0==a.isOpen?"确认开启":"确认关闭";this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:n,callback:function(e){"ok"==e&&t.updatePaymentStatus(a)}})},paySort:function(e){return function(a,t){var n=parseInt(a[e]),i=parseInt(t[e]);return n>i?1:n<i?-1:0}},isOk:function(e){if("微信"==e.paymentName&&""!=e.payConfig){if(!i.a.checkData({appid:"微信APPID不能为空"},e.payConfig))return!1;if(!i.a.checkData({mchid:"商户号不能为空"},e.payConfig))return!1;if(!i.a.checkData({key:"商户支付密钥不能为空"},e.payConfig))return!1;if(!i.a.checkData({appSecret:"微信appSecret不能为空"},e.payConfig))return!1;var a=e.payConfig.apiclient_cert;if(!i.a.checkData({apiclient_cert:"证书（cert）不能为空"},e.payConfig))return!1;if(""!==a&&"BEGIN CERTIFICATE"!=r(a))return this.$store.commit("setWin",{title:"提示",winType:"alert",content:"证书cert传错了"}),!1;var t=e.payConfig.apiclient_key;if(!i.a.checkData({apiclient_key:"证书密钥（key）不能为空"},e.payConfig))return!1;if(""!==t&&("BEGIN PRIVATE KEY"!=r(t)||void 0==r(t)))return this.$store.commit("setWin",{title:"提示",winType:"alert",content:"证书密钥（key）传错了"}),!1}else if("支付宝"==e.paymentName&&""!=e.payConfig){if(!i.a.checkData({alipayrsaPublicKey:"支付宝公钥不能为空"},e.payConfig))return!1;if(!i.a.checkData({rsaPrivateKey:"RSA私钥不能为空"},e.payConfig))return!1;if(!i.a.checkData({appId:"支付宝应用ID不能为空"},e.payConfig))return!1}else if("点佰趣"==e.paymentName){if(!i.a.checkData({businessNum:"商户编号不能为空"},e.payConfig))return!1}else if("网易严选支付"==e.paymentName){if(!i.a.checkData({appId:"产品appId不能为空"},e.payConfig))return!1;if(!i.a.checkData({productId:"产品号不能为空"},e.payConfig))return!1;if(!i.a.checkData({key:"产品密钥key不能为空"},e.payConfig))return!1}else if("农行支付"==e.paymentName){if(!i.a.checkData({mid:"商户号不能为空"},e.payConfig))return!1;if(!i.a.checkData({tid:"终端号不能为空"},e.payConfig))return!1;if(!i.a.checkData({instMid:"机构商户号不能为空"},e.payConfig))return!1;if(!i.a.checkData({msgSrc:"消息来源不能为空"},e.payConfig))return!1;if(!i.a.checkData({msgSrcId:"来源编号不能为空"},e.payConfig))return!1;if(!i.a.checkData({md5Key:"MD5密钥不能为空"},e.payConfig))return!1}else if("中信银行(上海)"==e.paymentName){if(!i.a.checkData({mchId:"商户号不能为空"},e.payConfig))return!1;if(!i.a.checkData({privateRsaKey:"客户私钥不能为空"},e.payConfig))return!1;if(!i.a.checkData({publicRsaKey:"中信公钥不能为空"},e.payConfig))return!1}else if("旺POS支付"==e.paymentName){if(!i.a.checkData({mcode:"旺POS门店编号不能为空"},e.payConfig))return!1;if(!i.a.checkData({appKey:"appKey不能为空"},e.payConfig))return!1;if(!i.a.checkData({appSecret:"appSecret不能为空"},e.payConfig))return!1}else if("收钱吧"==e.paymentName){if(!i.a.checkData({appId:"收钱吧appid不能为空"},e.payConfig))return!1;if(!i.a.checkData({code:"收钱吧激活码不能为空"},e.payConfig))return!1}else{if(!i.a.checkData({paymentName:"支付名称不能为空不能为空"},e))return!1;for(var n=0;n<this.payNameList.length;n++)if("中信银行"==e.paymentName)return!0}function r(e){if(""!=e&&void 0!=e){for(var a=e.split("-"),t=0;t<a.length;t++)""!=a[t]&&void 0!==a[t]||(a.splice(t,1),t-=1);return a[0]}}return!0}}},c=(t("2709"),t("d801")),y=Object(c.a)(o,function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{attrs:{num:"app",id:"paymentWay"}},[e.showZX?e._e():t("section",{staticStyle:{"max-width":"1240px"}},[t("section",{staticStyle:{"margin-bottom":"15px"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addpay}},[e._v("添加支付方式")]),e._v(" "),1==e.ischain||2==e.ischain?t("div",{staticClass:"topBox"},[e._m(0),e._v(" "),e._m(1)]):e._e()],1),e._v(" "),t("el-table",{staticStyle:{width:"100%",margin:"20px 0"},attrs:{data:e.payNameList,border:"",stripe:""}},[t("el-table-column",{staticStyle:{"text-aline":"center"},attrs:{label:"操作",align:"center",width:220,fixed:""},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.isOperation?t("div",{staticClass:"btn"},[t("span",{staticClass:"isBrandColor",on:{click:function(t){e.modifyBtn(a.$index,a.row)}}},[e._v("编辑")]),e._v(" "),0==a.row.isOpen?t("span",{staticClass:"line isBrandColor",on:{click:function(t){e.isOpenDetial(a.$index,a.row)}}},[e._v("开启")]):e._e(),e._v(" "),1==a.row.isOpen?t("span",{staticClass:"line isBrandColor",on:{click:function(t){e.isOpenDetial(a.$index,a.row)}}},[e._v("关闭")]):e._e(),e._v(" "),a.row.id>=1e4?t("span",{staticClass:"line",staticStyle:{color:"#F56C6C"},on:{click:function(t){e.deletePayment(a.row,a.$index)}}},[e._v("删除")]):e._e()]):t("section",["会员支付"==a.row.paymentName?t("div",[e._v("不可操作")]):t("div",{staticClass:"btn"},["微信"==a.row.paymentName||"支付宝"==a.row.paymentName||"收钱吧"==a.row.paymentName||"中信银行"==a.row.paymentName||"中信银行(上海)"==a.row.paymentName||"点佰趣"==a.row.paymentName||"农行支付"==a.row.paymentName||"网易严选支付"==a.row.paymentName||"旺POS支付"==a.row.paymentName?[t("span",{staticClass:"isBrandColor",on:{click:function(t){e.modifyBtn(a.$index,a.row)}}},[e._v("编辑")]),e._v(" "),0==a.row.isOpen?t("span",{staticClass:"line isBrandColor",on:{click:function(t){e.isOpenDetial(a.$index,a.row)}}},[e._v("开启")]):e._e(),e._v(" "),1==a.row.isOpen?t("span",{staticClass:"line isBrandColor",on:{click:function(t){e.isOpenDetial(a.$index,a.row)}}},[e._v("关闭")]):e._e()]:e._e(),e._v(" "),"现金"==a.row.paymentName||"银行卡"==a.row.paymentName?[0==a.row.isOpen?t("span",{staticClass:"isBrandColor",on:{click:function(t){e.isOpenDetial(a.$index,a.row)}}},[e._v("开启")]):e._e(),e._v(" "),1==a.row.isOpen?t("span",{staticClass:"isBrandColor",on:{click:function(t){e.isOpenDetial(a.$index,a.row)}}},[e._v("关闭")]):e._e()]:e._e()],2)])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"==a.row.isOpen?t("span",[e._v("已关闭")]):e._e(),e._v(" "),"1"==a.row.isOpen?t("span",[e._v("已开启")]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"支付方式",align:"center",prop:"paymentName"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"==e.ischain?[t("span",[e._v(e._s(a.row.paymentName))])]:e._e(),e._v(" "),"0"!=e.ischain?["1"==a.row.isAssign?t("span",{staticStyle:{color:"#f8931f"}},[e._v(e._s(a.row.paymentName))]):e._e(),e._v(" "),"0"==a.row.isAssign?t("span",{staticStyle:{color:"#2ea7e0"}},[e._v(e._s(a.row.paymentName))]):e._e()]:e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"入实收账",align:"center",prop:"creator"},scopedSlots:e._u([{key:"default",fn:function(a){return["1"==a.row.isBill?t("span",[e._v("是")]):t("span",[e._v("否")])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"排序",align:"center",prop:"sort"}})],1),e._v(" "),e.showWin?t("payWayWin",{attrs:{detial:e.detial,types:e.types},on:{payWayWin:e.getResult}}):e._e()],1),e._v(" "),e.showZX?t("zxBandWin",{attrs:{config:e.detial.payConfig,types:e.types},on:{zxBandWin:e.newGetResult}}):e._e(),e._v(" "),e.isOpenwx?t("selectRadioWin",{attrs:{list:e.payNameList,name:"paymentName",selectIndex:e.wxIndex,title:"选择微信支付使用偏向"},on:{selectRadioWin:e.radioBack}}):e._e()],1)},[function(){var e=this.$createElement,a=this._self._c||e;return a("span",[a("i"),this._v("品牌指派")])},function(){var e=this.$createElement,a=this._self._c||e;return a("span",[a("i"),this._v("门店自建")])}],!1,null,"d785ddc6",null);a.default=y.exports},e155:function(e,a,t){}}]);