(window.webpackJsonp=window.webpackJsonp||[]).push([["clearing_receivable"],{"1c6e":function(t,e,i){},ae5c:function(t,e,i){"use strict";var a=i("1c6e");i.n(a).a},db5e:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{slot:"content"},slot:"content"},[t.detailShow?t._e():i("div",{staticClass:"recMan",attrs:{id:"clear_rec"}},[t.isClearing?t._e():i("div",{staticClass:"oTitle"},t._l(t.typeList,function(e,a){return i("section",{key:a,staticClass:"oLi",class:{active:t.oneType==a},on:{click:function(e){t.changeType(a)}}},[t._v(t._s(e.name))])})),t._v(" "),t.isClearing?i("com-table",{attrs:{listHeight:50,fixed:1,listWidth:700,showHand:!1,introData:t.titleDetial,titleData:t.manDet},scopedSlots:t._u([{key:"con-0",fn:function(e){return i("div",{},[1==e.data.type?i("span",[t._v("个人账户")]):t._e(),t._v(" "),2==e.data.type?i("span",[t._v("企业账户")]):t._e()])}},{key:"con-4",fn:function(e){return i("div",{staticStyle:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[1==e.data.type?i("span",[t._v(t._s(e.data.contactMan))]):t._e(),t._v(" "),2==e.data.type?i("span",{staticStyle:{cursor:"pointer"},on:{click:[function(t){t.stopPropagation()},function(i){t.openMen(e.data.billMen)}]}},[t._v(t._s(e.data.billMen))]):t._e(),t._v(" "),t.isNames?i("div",{staticClass:"detLi",staticStyle:{position:"fixed","z-index":"200",right:"35px"}},[i("div",{staticClass:"detDiv"},[i("i",{staticClass:"detI"}),t._v(" "),i("div",{staticClass:"detH3"},t._l(t.spanList,function(e,a){return i("div",{key:a+"-",staticStyle:{float:"left"}},[t._v(t._s(e)+"\n\t\t\t\t\t\t\t\t"),a!=t.spanList.length-1?i("i",[t._v(";")]):t._e()])}))])]):t._e()])}}])}):t._e(),t._v(" "),i("com-table",{attrs:{listHeight:50,fixed:1,listWidth:700,showHand:!1,introData:t.titleDetial,titleData:t.titleList}}),t._v(" "),i("com-table",{attrs:{listHeight:50,listName:"挂账统计",fixed:1,listWidth:1e3,introData:t.newShowOidList,titleData:t.conList,allTotal:t.newShowOidList.length},scopedSlots:t._u([{key:"title-0",fn:function(e){return i("div",{},[t.isClearing?i("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:t.allSelect}},[t._v("全选")]):t._e(),t._v(" "),t.isClearing?t._e():i("span",[t._v("订单号")])])}},{key:"con-0",fn:function(e){return i("div",{staticClass:"oDian"},[t.isClearing?i("span",{on:{click:function(i){t.doAddCle(e.data)}}},[i("i",{class:{select:e.data.selected}})]):t._e(),t._v(" "),t.isClearing?t._e():i("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:function(i){t.openOid(e.data)}}},[t._v(t._s(e.data.oid))])])}},{key:"con-1",fn:function(e){return i("div",{staticClass:"oDian"},[t.isClearing?i("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:function(i){t.openOid(e.data)}}},[t._v(t._s(e.data.oid))]):t._e(),t._v(" "),t.isClearing?t._e():i("span",[t._v(t._s(e.data.createTime))])])}},{key:"con-2",fn:function(e){return i("div",{},[t.isClearing?t._e():i("span",[0==e.data.isSettle?i("span",[t._v("未结清")]):t._e(),t._v(" "),1==e.data.isSettle?i("span",[t._v("已结清")]):t._e()]),t._v(" "),t.isClearing?i("span",[t._v(t._s(e.data.createTime))]):t._e()])}}])}),t._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[i("pageElement",{attrs:{page:t.currentPage,total:t.totalNum,num:t.num,isNoJump:!0},on:{pageNum:t.pageClick}})],1),t._v(" "),t.isClearing?i("div",{staticClass:"oBottom",staticStyle:{"margin-top":"20px"}},[i("span",[t._v("支付方式")]),t._v(" "),i("selectBtn",{attrs:{name:t.payName,sorts:t.payList.map(function(t){return t.name}),width:150},on:{emit:t.paySelect}})],1):t._e(),t._v(" "),t.isClearing?i("div",[i("a",{staticClass:"blue",staticStyle:{margin:"10px 0",width:"150px"},attrs:{href:"javascript:void(0);"},on:{click:t.clearPay}},[t._v("结算")])]):t._e()],1),t._v(" "),t.detailShow?i("orderDetail",{attrs:{detail:t.oidDetail,isDelete:!0},on:{detailShow:t.getDetailShow}}):t._e()],1)};a._withStripped=!0;var s=i("f6ce"),n=i("81a2");function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(s,n){try{var l=e[s](n),o=l.value}catch(t){return void i(t)}if(!l.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var o={data:function(){return{isNames:!1,shopId:"",typeList:[{name:"未结清",id:1},{name:"已结算",id:2}],payList:[{name:"现金结算",type:1},{name:"银行转账",type:2}],payName:"选择结算方式",payIndex:-1,oneType:0,titleDetial:[],oidList:[],showOidList:[],manDet:[{titleName:"账户类型",conStyle:{color:"#f8941f"},dataName:"type"},{titleName:"账户名称",conStyle:{color:"#f8941f"},dataName:"name"},{titleName:"联系人",conStyle:{color:"#f8941f"},dataName:"contactMan"},{titleName:"手机号",conStyle:{color:"#f8941f"},dataName:"mobile"},{titleName:"挂账人",conStyle:{color:"#f8941f"},dataName:"billMen"}],titleList:[{titleName:"订单数",conStyle:{color:"#f8941f"},dataName:"oidNum"},{titleName:"消费金额",conStyle:{color:"#f8941f"},dataName:"totle"},{titleName:"挂账金额",conStyle:{color:"#f8941f"},dataName:"allmax"}],conList:[],currentPage:1,num:10,ischain:"",spanList:[],detailShow:!1,oidDetail:{},isClearing:!1}},mounted:function(){var t=s.a.session("userShop");this.shopId=t.currentShop.id,this.isClearing=this.isAClearing,this.ischain=t.currentShop.ischain,this.titleDetial=[],this.titleDetial.push(this.manDetial),this.titleDetial[0].billMen="";for(var e="",i=this.titleDetial[0].billPerson,a=0;a<i.length;a++)e+=i[a].name+":"+i[a].mobile+",";this.titleDetial[0].billMen=e,this.oidList=this.manDetial.billOrder,this.showOidList=this.manDetial.billOrder,this.clearDetial(),document.addEventListener("click",this.remove),this.isTatle()},destroyed:function(){document.removeEventListener("click",this.remove)},components:{comTable:function(){return i.e("table").then(i.bind(null,"4360"))},selectBtn:function(){return i.e("select_btn").then(i.bind(null,"3d41"))},pageElement:function(){return i.e("page_element").then(i.bind(null,"5921"))},orderDetail:function(){return i.e("order_detail").then(i.bind(null,"603c"))}},watch:{isClearing:"clearDetial"},props:{manDetial:Object,isAClearing:Boolean},computed:{totalNum:function(){return Math.ceil(this.showOidList.length/this.num)},newShowOidList:function(){var t=(this.currentPage-1)*this.num,e=this.currentPage*this.num;return this.showOidList.slice(t,e)}},methods:{remove:function(){this.isNames=!1},openMen:function(t){this.isNames=!this.isNames,this.spanList=t.split(",")},openOid:function(t){var e=this;return l(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.a.orderBillDelite({data:{trueShopId:t.shopId,oid:t.oid}});case 2:a=i.sent,e.detailShow=!0,e.oidDetail=a;case 5:case"end":return i.stop()}},i,e)}))()},getDetailShow:function(t){this.detailShow=t,this.isTatle()},isTatle:function(){var t=[];t=this.isClearing?[{name:"返回",className:["gray"],fn:this.back}]:[{name:"返回",className:["gray"],fn:this.back},{name:"结算",className:["blue"],fn:this.clearBtn}],this.$store.commit("setPageTools",t)},clearBtn:function(){this.isClearing=!0},back:function(){this.isClearing?this.isClearing=!1:(this.showClearing=!1,this.$emit("clearResult"))},changeType:function(t){this.oneType=t,this.currentPage=1;var e=[];this.titleDetial[0].totle=0,this.titleDetial[0].allmax=0;for(var i=0;i<this.oidList.length;i++)this.$set(this.oidList[i],"selected",!1),this.oneType==this.oidList[i].isSettle&&(this.titleDetial[0].totle+=1*this.oidList[i].originalPrice,this.titleDetial[0].allmax+=1*this.oidList[i].billPrice,e.push(this.oidList[i]));this.showOidList=e,this.titleDetial[0].totle=this.titleDetial[0].totle.toFixed(2),this.titleDetial[0].allmax=this.titleDetial[0].allmax.toFixed(2),this.titleDetial[0].oidNum=e.length,1==this.oneType?(this.titleList[2]&&(this.titleList[2].titleName="实收总额"),this.conList[6]&&(this.conList[6].titleName="实收金额")):(this.titleList[2]&&(this.titleList[2].titleName="挂账总额"),this.conList[6]&&(this.conList[6].titleName="挂账金额"))},pageClick:function(t){this.currentPage=t.page,this.num=t.num},clearDetial:function(){this.currentPage=1,this.isTatle();var t=[];this.isClearing?(t=[{titleName:"全选",titleStyle:{width:"5%"}},{titleName:"订单号",titleStyle:{width:"15%"},dataName:"oid"},{titleName:"挂账时间",titleStyle:{width:"15%"},dataName:"createTime"},{titleName:"消费金额",titleStyle:{width:"10%"},dataName:"originalPrice"},{titleName:"挂账金额",titleStyle:{width:"10%"},dataName:"billPrice"},{titleName:"操作人",titleStyle:{width:"10%"},dataName:"createName"},{titleName:"挂账店铺",titleStyle:{width:"10%"},dataName:"shopName"}],"3"!=this.ischain&&t.splice(6,1)):(t=[{titleName:"订单号",titleStyle:{width:"15%"},dataName:"oid"},{titleName:"挂账时间",titleStyle:{width:"15%"},dataName:"createTime"},{titleName:"状态",titleStyle:{width:"10%"},dataName:"isSettle"},{titleName:"挂账人",titleStyle:{width:"10%"},dataName:"personName"},{titleName:"操作人",titleStyle:{width:"10%"},dataName:"createName"},{titleName:"消费金额",titleStyle:{width:"10%"},dataName:"originalPrice"},{titleName:"挂账金额",titleStyle:{width:"10%"},dataName:"billPrice"},{titleName:"挂账店铺",titleStyle:{width:"10%"},dataName:"shopName"}],"3"!=this.ischain&&t.splice(7,1)),this.conList=t,this.changeType(0)},doAddCle:function(t){t.selected=!t.selected},isSelect:function(){for(var t=0;t<this.oidList.length;t++)if(this.oidList[t]&&0==this.oidList[t].selected)return!1;return!0},allSelect:function(){if(this.isSelect())for(var t=0;t<this.oidList.length;t++)this.oidList[t].selected=!1;else for(var e=0;e<this.oidList.length;e++)this.oidList[e].selected=!0},paySelect:function(t){this.payIndex=t},settleBill:function(t){var e=this;return l(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.a.settleBill({data:t});case 2:i.sent&&(e.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"结算成功"}),e.$emit("clearResult"));case 4:case"end":return i.stop()}},i,e)}))()},clearPay:function(){if(this.payIndex<0)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"请选择结算方式"}),!1;for(var t={},e=0;e<this.showOidList.length;e++)this.showOidList[e].selected&&("3"!=this.ischain?this.shopId in t?t[this.shopId].push(this.showOidList[e].oid):t[this.shopId]=[this.showOidList[e].oid]:this.showOidList[e].shopId in t?t[this.showOidList[e].shopId].push(this.showOidList[e].oid):t[this.showOidList[e].shopId]=[this.showOidList[e].oid]);var i={};if(i.payType=this.payList[this.payIndex].type,t=={})return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"请选择要结账的订单"}),!1;i.billList=t,this.settleBill(i)}}},r=(i("ae5c"),i("7610")),c=Object(r.a)(o,a,[],!1,null,"43f07911",null);c.options.__file="src\\module\\shop_config\\receivable\\clearing_receivable.vue";e.default=c.exports}}]);