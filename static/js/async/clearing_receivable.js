(window.webpackJsonp=window.webpackJsonp||[]).push([["clearing_receivable"],{b217:function(t,e,i){},c9d8:function(t,e,i){"use strict";var l=i("b217");i.n(l).a},db5e:function(t,e,i){"use strict";i.r(e);var l=i("f6ce"),a=i("81a2");function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function l(a,n){try{var s=e[a](n),o=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(o).then(function(t){l("next",t)},function(t){l("throw",t)});t(o)}("next")})}}var s={data:function(){return{isNames:!1,shopId:"",typeList:[{name:"未结清",id:1},{name:"已结算",id:2}],payList:[{name:"现金结算",type:"1"},{name:"银行转账",type:"2"}],payName:"",payIndex:"",oneType:0,titleDetial:[],oidList:[],showOidList:[],selectList:[],currentPage:1,num:10,ischain:"",detailShow:!1,oidDetail:{},isClearing:!1}},mounted:function(){var t=l.a.session("userShop");this.shopId=t.currentShop.id,this.isClearing=this.isAClearing,this.ischain=t.currentShop.ischain,this.titleDetial=[],this.titleDetial.push(this.manDetial),this.$set(this.titleDetial[0],"totle",0),this.$set(this.titleDetial[0],"allmax",0),this.$set(this.titleDetial[0],"billMen","");for(var e="",i=this.titleDetial[0].billPerson,a=0;a<i.length;a++)e+=i[a].name+":"+i[a].mobile+",";this.titleDetial[0].billMen=e,this.oidList=this.manDetial.billOrder,this.showOidList=this.manDetial.billOrder,this.clearDetial(),0==this.showOidList.length&&this.isAClearing&&(this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"没有未结清账单"}),this.isClearing=!1),this.isTatle()},components:{orderDetail:function(){return i.e("order_detail").then(i.bind(null,"603c"))}},watch:{isClearing:"clearDetial"},props:{manDetial:Object,isAClearing:Boolean},computed:{totalNum:function(){return Math.ceil(this.showOidList.length/this.num)},newShowOidList:function(){var t=(this.currentPage-1)*this.num,e=this.currentPage*this.num;return this.showOidList.slice(t,e)}},methods:{handleSelectionChange:function(t){this.selectList=t,console.log(t)},remove:function(){this.isNames=!1},openOid:function(t){var e=this;return n(regeneratorRuntime.mark(function i(){var l;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.a.orderBillDelite({data:{trueShopId:t.shopId,oid:t.oid}});case 2:l=i.sent,e.detailShow=!0,e.oidDetail=l;case 5:case"end":return i.stop()}},i,e)}))()},getDetailShow:function(t){this.detailShow=t,this.isTatle()},isTatle:function(){var t=[];t=this.isClearing?[{name:"返回",className:["gray"],fn:this.back}]:[{name:"返回",className:["gray"],fn:this.back},{name:"结算",className:["blue"],fn:this.clearBtn}],this.$store.commit("setPageTools",t)},clearBtn:function(){for(var t=[],e=0;e<this.oidList.length;e++)"0"==this.oidList[e].isSettle&&t.push(this.oidList[e]);0!=t.length?this.isClearing=!0:this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"没有未结清账单"})},back:function(){this.isClearing?this.isClearing=!1:(this.showClearing=!1,this.$emit("clearResult"))},changeType:function(t){this.oneType=t+"",this.currentPage=1;var e=[];this.titleDetial[0].totle=0,this.titleDetial[0].allmax=0;for(var i=0;i<this.oidList.length;i++)this.oneType==this.oidList[i].isSettle&&(this.titleDetial[0].totle+=1*this.oidList[i].originalPrice,this.titleDetial[0].allmax+=1*this.oidList[i].billPrice,e.push(this.oidList[i]));this.showOidList=e,this.titleDetial[0].totle=this.titleDetial[0].totle.toFixed(2),this.titleDetial[0].allmax=this.titleDetial[0].allmax.toFixed(2),this.titleDetial[0].oidNum=e.length},pageClick:function(t){this.currentPage=t},numChange:function(t){this.num=t,this.currentPage=1},clearDetial:function(){this.currentPage=1,this.isTatle(),this.changeType(0)},settleBill:function(t){var e=this;return n(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.a.settleBill({data:t});case 2:i.sent&&(e.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"结算成功"}),e.$emit("clearResult"));case 4:case"end":return i.stop()}},i,e)}))()},clearPay:function(){if(console.log(this.payIndex),""==this.payIndex)return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"请选择结算方式"}),!1;for(var t={},e=0;e<this.selectList.length;e++)"3"!=this.ischain?this.shopId in t?t[this.shopId].push(this.selectList[e].oid):t[this.shopId]=[this.selectList[e].oid]:this.selectList[e].shopId in t?t[this.selectList[e].shopId].push(this.selectList[e].oid):t[this.selectList[e].shopId]=[this.selectList[e].oid];var i={};if(i.payType=this.payIndex,t=={})return this.$store.commit("setWin",{title:"温馨提示",winType:"alert",content:"请选择要结账的订单"}),!1;i.billList=t,this.settleBill(i)}}},o=(i("c9d8"),i("d801")),r=Object(o.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{slot:"content"},slot:"content"},[t.detailShow?t._e():i("div",{staticClass:"recMan",attrs:{id:"clear_rec"}},[t.isClearing?t._e():i("div",{staticClass:"oTitle"},t._l(t.typeList,function(e,l){return i("section",{key:l,staticClass:"oLi",class:{active:t.oneType==l},on:{click:function(e){t.changeType(l)}}},[t._v(t._s(e.name))])})),t._v(" "),i("section",{staticClass:"oBox"},[t.isClearing?i("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"","row-style":{color:"#f8941f"},"header-cell-style":{"background-color":"#f5f7fa"},data:t.titleDetial}},[i("el-table-column",{attrs:{align:"center",label:"账户类型","row-style":{color:"#f8941f"}},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.type?i("span",[t._v("个人账户")]):t._e(),t._v(" "),2==e.row.type?i("span",[t._v("企业账户")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"name",label:"账户名称"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"contactMan",label:"联系人"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"mobile",label:"手机号"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"挂账人"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.type?i("span",[t._v(t._s(e.row.contactMan))]):t._e(),t._v(" "),2==e.row.type?i("span",[t._v(t._s(e.row.billMen))]):t._e()]}}])})],1):t._e()],1),t._v(" "),i("section",{staticClass:"oBox"},[i("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"","row-style":{color:"#f8941f"},"header-cell-style":{"background-color":"#f5f7fa"},data:t.titleDetial},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-table-column",{attrs:{align:"center",prop:"oidNum",label:"订单数"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"totle",label:"消费金额"}}),t._v(" "),t.oneType+""=="1"?i("el-table-column",{attrs:{align:"center",prop:"allmax",label:"实收金额"}}):t._e(),t._v(" "),t.oneType+""=="0"?i("el-table-column",{attrs:{align:"center",prop:"allmax",label:"挂账金额"}}):t._e()]}}])})],1),t._v(" "),i("section",{staticClass:"oBox"},[i("div",{staticClass:"boxTop",staticStyle:{"background-color":"#f5f7fa"}},[i("div",{staticClass:"oSpan"},[t._v("\n\t\t\t\t\t挂账统计 · 共"),i("em",{staticStyle:{color:"#ff3c04","font-size":"inherit"}},[t._v(t._s(t.showOidList.length))]),t._v("个条目\n\t\t\t\t")])]),t._v(" "),t.isClearing?i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.newShowOidList,fixed:"","header-cell-style":{"background-color":"#f5f7fa"}},on:{"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"default",fn:function(e){return[t.oneType+""=="0"?i("el-table-column",{attrs:{"reserve-selection":"",type:"selection",width:"55"}}):t._e(),t._v(" "),i("el-table-column",{attrs:{fixed:"","min-width":"200",align:"center",label:"订单号"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:function(i){t.openOid(e.row)}}},[t._v(t._s(e.row.oid))])]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"200",align:"center",prop:"createTime",label:"挂账时间"}}),t._v(" "),i("el-table-column",{attrs:{prop:"createName",align:"center",label:"操作人"}}),t._v(" "),i("el-table-column",{attrs:{prop:"originalPrice",align:"center",label:"消费金额"}}),t._v(" "),t.oneType+""=="1"?i("el-table-column",{attrs:{align:"center",prop:"billPrice",label:"实收金额"}}):t._e(),t._v(" "),t.oneType+""=="0"?i("el-table-column",{attrs:{align:"center",prop:"billPrice",label:"挂账金额"}}):t._e(),t._v(" "),"3"==t.ischain?i("el-table-column",{attrs:{prop:"shopName",align:"center",label:"挂账店铺"}}):t._e()]}}])}):t._e(),t._v(" "),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.newShowOidList,fixed:""}},[t.isClearing?t._e():[i("el-table-column",{attrs:{fixed:"","min-width":"200",align:"center",label:"订单号"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"#01AAE5",cursor:"pointer"},on:{click:function(i){t.openOid(e.row)}}},[t._v(t._s(e.row.oid))])]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"200",align:"center",prop:"createTime",label:"挂账时间"}}),t._v(" "),i("el-table-column",{attrs:{prop:"isSettle",align:"center",label:"状态"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"personName",align:"center",label:"挂账人"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"createName",align:"center",label:"操作人"}}),t._v(" "),i("el-table-column",{attrs:{prop:"originalPrice",align:"center",label:"消费金额"}}),t._v(" "),t.oneType+""=="1"?i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"billPrice",label:"实收金额"}}):t._e(),t._v(" "),t.oneType+""=="0"?i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"billPrice",label:"挂账金额"}}):t._e(),t._v(" "),"3"==t.ischain?i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"shopName","min-width":"120",align:"center",label:"挂账店铺"}}):t._e()]],2)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[i("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.num,layout:"sizes, prev, pager, next","page-count":t.totalNum,"page-sizes":[10,20,30]},on:{"size-change":t.numChange,"current-change":t.pageClick}})],1),t._v(" "),t.isClearing?i("div",{staticClass:"oBottom"},[i("span",{staticClass:"ltitle"},[t._v("支付方式")]),t._v(" "),i("el-select",{attrs:{placeholder:"选择结算方式"},model:{value:t.payIndex,callback:function(e){t.payIndex=e},expression:"payIndex"}},t._l(t.payList,function(t){return i("el-option",{key:t.type,attrs:{label:t.name,value:t.type}})}))],1):t._e(),t._v(" "),t.isClearing?i("div",{staticStyle:{width:"300px",margin:"10px"}},[i("el-button",{staticStyle:{width:"150px"},attrs:{type:"primary"},on:{click:t.clearPay}},[t._v("结算")])],1):t._e()]),t._v(" "),t.detailShow?i("orderDetail",{attrs:{detail:t.oidDetail,isDelete:!0},on:{detailShow:t.getDetailShow}}):t._e()],1)},[],!1,null,"bbf7c83e",null);e.default=r.exports}}]);