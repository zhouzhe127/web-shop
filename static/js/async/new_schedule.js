(window.webpackJsonp=window.webpackJsonp||[]).push([["new_schedule"],{c94a:function(t,e,a){},d508:function(t,e,a){t.exports=a.p+"images/evret.dc1bc2da.jpg"},d94d:function(t,e,a){t.exports=a.p+"images/examine.421ae45c.jpg"},dca0:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.slegoods?i(t.componentId,{tag:"component",attrs:{dstShopId:t.detailData.shopId,srcShopId:t.outWare.shopId,shopId:t.outWare.shopId,wid:t.outWare.id,sleCommodity:t.goodsArr,sleSupplies:t.suppliesArr},on:{select:t.selectGoods}}):i("div",{attrs:{id:"shipment"}},[i("div",{staticClass:"topBox"},[i("div",{staticClass:"title"},[i("i"),t._v(" "),i("h3",[t._v("新建调度")]),t._v(" "),t._l(70,function(t){return i("div",{key:t,staticClass:"dian"})})],2),t._v(" "),i("div",{staticClass:"innerBox"},[i("ul",[i("li",[i("span",[t._v("申请单号：")]),t._v(" "),i("span",[t._v(t._s(t.detailData.code))])]),t._v(" "),i("li",[i("span",[t._v("审核状态：")]),t._v(" "),i("span",[t._v(t._s(t.auditStatus[t.detailData.auditStatus-1]))])]),t._v(" "),i("li",[i("span",[t._v("调度状态：")]),t._v(" "),i("span",[t._v(t._s(t.dispatchStatus[t.detailData.dispatchStatus-1]))])]),t._v(" "),i("li",[i("span",[t._v("入货仓库：")]),t._v(" "),i("span",[t._v(t._s(t.detailData.wName))]),t._v(" "),i("img",{attrs:{src:a("d94d"),alt:""},on:{click:function(e){t.examine(!1)}}})]),t._v(" "),i("li",[i("span",[t._v("出货仓库：")]),t._v(" "),i("span",[t._v(t._s(t.outWare.name))]),t._v(" "),t.outWare?i("img",{attrs:{src:a("d94d"),alt:""},on:{click:function(e){t.examine(t.outWare)}}}):t._e(),t._v(" "),i("img",{attrs:{src:a("d508"),alt:""},on:{click:function(e){t.addShow=!0}}})])]),t._v(" "),i("ul",[i("li",[i("span",[t._v("申请人：")]),t._v(" "),i("span",[t._v(t._s(t.detailData.createName||"--"))])]),t._v(" "),i("li",[i("span",[t._v("申请时间：")]),t._v(" "),i("span",[t._v(t._s(t.getTime(t.detailData.createTime)))])]),t._v(" "),i("li",[i("span",[t._v("原因：")]),t._v(" "),i("span",[t._v(t._s(t.detailData.reason||"--"))])]),t._v(" "),i("li",[i("span",[t._v("备注：")]),t._v(" "),i("span",[t._v(t._s(t.detailData.remark||"--"))])])])])]),t._v(" "),i("ul",{staticClass:"tebBox"},[t._l(t.tebData,function(e,a){return i("li",{key:a,class:{active:t.tabactive==a},on:{click:function(e){t.tebClick(a)}}},[t._v(t._s(e))])}),t._v(" "),1==t.tabactive&&t.isBrand?i("div",{staticClass:"piceType"},[i("el-select",{attrs:{placeholder:"分销价格切换"},on:{change:t.picestyleChange},model:{value:t.picestyle,callback:function(e){t.picestyle=e},expression:"picestyle"}},t._l(t.dispiceArr,function(t){return i("el-option",{key:t.distributionId,attrs:{label:t.name,value:Number(t.distributionId)}})}))],1):t._e()],2),t._v(" "),i("com-table",{attrs:{listName:(t.tabactive?"物料":"商品")+"列表",listWidth:1300,listHeight:60,titleData:t.titleList,allTotal:t.introData.length,introData:t.introData},scopedSlots:t._u([{key:"title-1",fn:function(e){return i("span",{},[t._v(t._s(t.tabactive?"物料":"商品")+"名称")])}},{key:"list-4",fn:function(e){return i("span",{staticClass:"detailsBtn",on:{click:t.autoFill}},[t._v("自动填充")])}},{key:"con-0",fn:function(e){return i("div",{},[i("span",{staticClass:"detailsBtn",class:{errbtn:e.data.errResion},staticStyle:{"text-decoration":"none"},on:{click:function(a){t.chooseBatch(e.data)}}},[t._v("批次选择")]),t._v(" "),e.data.noPrev?t._e():i("div",{staticClass:"delBtn"},[i("span",[t._v("|")]),t._v(" \n\t\t\t\t\t"),i("span",{staticClass:"del",on:{click:function(a){t.delData(e.index)}}},[t._v("删除")])])])}},{key:"con-4",fn:function(e){return i("div",{staticClass:"inputBox"},[e.data.errResion?i("div",{staticClass:"errStyle"},[i("span",[t._v("!")]),t._v(t._s(e.data.errResion))]):i("div",{staticClass:"inputBox"},[i("div",{staticClass:"input-num"},[i("el-input",{attrs:{type:"text",placeholder:"",maxlength:"9",disabled:e.data.batchList.length>0&&e.data.outNum>0},on:{input:function(a){t.outNumChange(a,e.data)}},model:{value:e.data.outNum,callback:function(a){t.$set(e.data,"outNum",a)},expression:"props.data.outNum"}})],1),t._v(" "),e.data.unitList&&0==e.data.batchList.length?i("div",{staticStyle:{width:"90px",display:"inline-block"}},[i("el-select",{attrs:{placeholder:e.data.selectName},on:{change:function(a){t.getUnit(e.data)}},model:{value:e.data.sleunitId,callback:function(a){t.$set(e.data,"sleunitId",a)},expression:"props.data.sleunitId"}},t._l(e.data.unitArr,function(t){return i("el-option",{key:t.muId,attrs:{label:t.name,value:t.muId}})}))],1):i("span",{staticClass:"unitBox",class:{active:e.data.batchList.length>0&&e.data.outNum>0}},[t._v(t._s(e.data.selectName))])])])}},{key:"con-3",fn:function(e){return i("div",{staticClass:"surplusBox"},[0===t.tabactive?i("span",[t._v(t._s(e.data.num)+t._s(e.data.selectName))]):i("span",{attrs:{title:t.setUnit(e.data.num,e.data.unitArr)}},[t._v(t._s(t.setUnit(e.data.num,e.data.unitArr,e.data.unitName)))])])}},{key:"con-5",fn:function(e){return t.isBrand&&1==t.tabactive?i("div",{staticClass:"surplusBox"},[i("div",{staticClass:"dispice"},[e.data.piceValue&&e.data.distributionId>=0?i("span",[t._v(t._s(e.data.piceValue))]):t._e(),t._v(" "),-2==e.data.distributionId?i("div",{staticClass:"input-num moveright"},[i("el-input",{attrs:{type:"text",placeholder:"",maxlength:"9"},on:{change:function(t){e.data.piceValue.replace(/[^\d]/g,"")}},model:{value:e.data.piceValue,callback:function(a){t.$set(e.data,"piceValue",a)},expression:"props.data.piceValue"}})],1):t._e(),t._v(" "),i("div",{staticClass:"slebox"},[i("el-select",{attrs:{placeholder:"分销价格切换"},on:{change:function(a){t.piceChange(e.data)}},model:{value:e.data.distributionId,callback:function(a){t.$set(e.data,"distributionId",a)},expression:"props.data.distributionId"}},t._l(e.data.rela,function(t){return i("el-option",{key:t.distributionId,attrs:{label:t.distributionName,value:Number(t.distributionId)}})}))],1)])]):t._e()}},{key:"con-6",fn:function(e){return t.isBrand&&1==t.tabactive?i("div",{staticClass:"boxpice"},[i("el-select",{attrs:{disabled:-2!=e.data.distributionId,placeholder:"单位"},model:{value:e.data.piceUnitid,callback:function(a){t.$set(e.data,"piceUnitid",a)},expression:"props.data.piceUnitid"}},t._l(e.data.unitArr,function(t){return i("el-option",{key:t.muId,attrs:{label:t.name,value:t.muId}})}))],1):t._e()}},{key:t.isBrand&&1===t.tabactive?"con-7":"con-5",fn:function(e){return i("div",{staticClass:"surplusBox"},[0===t.tabactive?i("span",[t._v(t._s(e.data.surplus)+t._s(e.data.selectName))]):i("span",{attrs:{title:t.setUnit(e.data.surplus,e.data.unitArr,e.data.unitName)}},[t._v(t._s(t.setUnit(e.data.surplus,e.data.unitArr,e.data.unitName)))])])}}])}),t._v(" "),i("ul",{staticClass:"bottomBtn"},[i("li",{on:{click:t.back}},[t._v("取消")]),t._v(" "),i("li",{on:{click:t.continued}},[t._v("继续添加调度单")]),t._v(" "),i("li",{on:{click:t.confirm}},[t._v("确定")])]),t._v(" "),t.waremessage?i("waremessage-win",{attrs:{wid:t.sleWid,width:500,height:200,title:"仓库信息"},on:{winEvent:function(e){t.waremessage=!1}}}):t._e(),t._v(" "),t.addShow?i("add-store",{attrs:{pObj:t.comObj},on:{throwWin:t.throwWin}}):t._e(),t._v(" "),t.showgoodswin?i("batchWin",{attrs:{needItem:t.checkList,wid:t.outWare.id,shopId:t.outWare.shopId},on:{throwWin:t.goodsthrowWin}}):t._e(),t._v(" "),t.showsupplieswin?i("clusion-supplies",{attrs:{wid:t.outWare.id,shopId:t.outWare.shopId,needItem:t.checkList},on:{throwWin:t.goodsthrowWin}}):t._e()],1)],1)};i._withStripped=!0;var r=a("81a2"),n=a("f6ce"),s=a("bbb9"),u=a("05dd");function o(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function c(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(r,n){try{var s=e[r](n),u=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(u).then(function(t){i("next",t)},function(t){i("throw",t)});t(u)}("next")})}}var l={data:function(){return{componentId:"",tabactive:0,tebData:["商品","物料"],waremessage:!1,auditStatus:["待审核","已取消","审核未通过","审核通过"],dispatchStatus:["未调度","调度中","未出货","全部取消","带入货","已完成","已完成（异常）"],titleList:[{titleName:"操作"},{titleName:"",dataName:"itemName"},{titleName:"已出数量",dataName:"eliteNum"},{titleName:"需求数量",dataName:"num",sort:!0},{titleName:"出货量",titleStyle:{overflow:"visible",minWidth:"200px"}},{titleName:"库存余量",dataName:"surplus",sort:!0}],shoptitleList:[],introData:"",detailData:"",slegoods:!1,comObj:"",addShow:!1,sleWid:"",outWare:"",goodsArr:[],suppliesArr:[],getGoods:[],getSupplies:[],checkList:"",showgoodswin:!1,showsupplieswin:!1,itemList:{},goodsoutedNum:"",suppliesoutedNum:"",dispiceArr:[],isBrand:!1,picestyle:""}},methods:{init:function(){var t=this;return c(regeneratorRuntime.mark(function e(){var a,i,n,s,u,c,l,d,p,m,h,v,f,b,g,N,_,y,x,w,k,I,S,D,L,A,W,C,B,R,V,O,U,j,G,P,$;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.detailData.itemList){e.next=151;break}return t.getSupplies=[],t.getGoods=[],a=t.detailData.itemList.goods,i=t.detailData.itemList.material,n=[],s=[],e.next=9,r.a.invoic_matchItemListWithOutgoingNum({data:{itemList:t.itemList,srcShopId:t.detailData.shopId,dstShopId:t.outWare.shopId,applyId:t.detailData.id}});case 9:if(!(u=e.sent).goods||!a){e.next=70;break}c=!0,l=!1,d=void 0,e.prev=14,p=a[Symbol.iterator]();case 16:if(c=(m=p.next()).done){e.next=52;break}h=m.value,v=!0,f=!0,b=!1,g=void 0,e.prev=22,N=u.goods[Symbol.iterator]();case 24:if(f=(_=N.next()).done){e.next=34;break}if((y=_.value).importId!=h.itemId){e.next=31;break}return h.id=y.exportId,t.getGoods.push(h),v=!1,e.abrupt("break",34);case 31:f=!0,e.next=24;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(22),b=!0,g=e.t0;case 40:e.prev=40,e.prev=41,!f&&N.return&&N.return();case 43:if(e.prev=43,!b){e.next=46;break}throw g;case 46:return e.finish(43);case 47:return e.finish(40);case 48:v&&(h.errResion="无法匹配",t.setErr(u.goodsError,h,"商品"),n.push(h));case 49:c=!0,e.next=16;break;case 52:e.next=58;break;case 54:e.prev=54,e.t1=e.catch(14),l=!0,d=e.t1;case 58:e.prev=58,e.prev=59,!c&&p.return&&p.return();case 61:if(e.prev=61,!l){e.next=64;break}throw d;case 64:return e.finish(61);case 65:return e.finish(58);case 66:return t.setOutNum(t.getGoods,!1,"itemName"),e.next=69,t.getgoodsSurplus(t.getGoods,1);case 69:t.goodsArr=[].concat(o(t.getGoods),n);case 70:if(!u.material||!i){e.next=151;break}x=!0,w=!1,k=void 0,e.prev=74,I=i[Symbol.iterator]();case 76:if(x=(S=I.next()).done){e.next=133;break}D=S.value,L=!0,D.selectValue=1,A=!0,W=!1,C=void 0,e.prev=83,B=u.material[Symbol.iterator]();case 85:if(A=(R=B.next()).done){e.next=115;break}if((V=R.value).importId!=D.itemId){e.next=112;break}if(D.id=V.exportId,L=!1,!D.unitRelation){e.next=110;break}for(O=!0,U=!1,j=void 0,e.prev=94,G=D.unitRelation[Symbol.iterator]();!(O=(P=G.next()).done);O=!0)$=P.value,D.unitName==$.name&&(D.selectValue=$.value);e.next=102;break;case 98:e.prev=98,e.t2=e.catch(94),U=!0,j=e.t2;case 102:e.prev=102,e.prev=103,!O&&G.return&&G.return();case 105:if(e.prev=105,!U){e.next=108;break}throw j;case 108:return e.finish(105);case 109:return e.finish(102);case 110:return t.getSupplies.push(D),e.abrupt("break",115);case 112:A=!0,e.next=85;break;case 115:e.next=121;break;case 117:e.prev=117,e.t3=e.catch(83),W=!0,C=e.t3;case 121:e.prev=121,e.prev=122,!A&&B.return&&B.return();case 124:if(e.prev=124,!W){e.next=127;break}throw C;case 127:return e.finish(124);case 128:return e.finish(121);case 129:L&&(D.errResion="无法匹配",t.setErr(u.materialError,D,"物料"),s.push(D));case 130:x=!0,e.next=76;break;case 133:e.next=139;break;case 135:e.prev=135,e.t4=e.catch(74),w=!0,k=e.t4;case 139:e.prev=139,e.prev=140,!x&&I.return&&I.return();case 142:if(e.prev=142,!w){e.next=145;break}throw k;case 145:return e.finish(142);case 146:return e.finish(139);case 147:return t.setOutNum(t.getSupplies,!0,"itemName"),e.next=150,t.getgoodsSurplus(t.getSupplies,2);case 150:t.suppliesArr=[].concat(o(t.getSupplies),s);case 151:case"end":return e.stop()}},e,t,[[14,54,58,66],[22,36,40,48],[41,,43,47],[59,,61,65],[74,135,139,147],[83,117,121,129],[94,98,102,110],[103,,105,109],[122,,124,128],[140,,142,146]])}))()},setErr:function(t,e,a){var i="商品"==a?"goodsId":"id",r=function(t,e,a){var r=!0,n=!1,s=void 0;try{for(var u,o=t[Symbol.iterator]();!(r=(u=o.next()).done);r=!0){if(u.value[i]==e.itemId){e.errResion=a;break}}}catch(t){n=!0,s=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw s}}};for(var n in t)switch(n){case"nameError":r(t[n],e,a+"无法匹配");break;case"unitError":r(t[n],e,"单位无法匹配");break;case"typeError":r(t[n],e,a+"类型匹配错误")}},tebClick:function(t){this.tabactive=t,0==t?(this.introData=this.goodsArr,this.isBrand&&(this.titleList=this.shoptitleList)):(this.introData=this.suppliesArr,this.isBrand&&this.brandSettitle())},examine:function(t){this.sleWid=t?t.id:this.detailData.wid,this.waremessage=!0},selectGoods:function(t){this.slegoods=!1,t&&this.setlistData(t),this.titleBtn()},throwWin:function(t,e){this.addShow=!1,"ok"==t&&(e.id==this.detailData.wid?(this.alert("出货仓库不能与入货仓库重复,请重新选择"),this.addShow=!0):(this.comObj.owner=e,this.outWare=e,this.init()))},back:function(){window.history.go(-1)},titleBtn:function(){var t=this;this.$store.commit("setPageTools",[{name:"添加商品",className:["wearhouse handle"],fn:function(){t.outWare?(t.slegoods=!0,t.componentId="selectGoods"):t.alert("请选择出货仓库")}},{name:"添加物料",className:["wearhouse handle"],fn:function(){t.outWare?(t.slegoods=!0,t.componentId="selectSupplies"):t.alert("请选择出货仓库")}}])},chooseBatch:function(t){t.errResion||(0==this.tabactive?this.showgoodswin=!0:this.showsupplieswin=!0,this.checkList=t)},delData:function(t){this.introData.splice(t,1)},getTime:function(t){return s.a.format(1e3*parseInt(t),"yyyy-MM-dd hh:mm")},setlistData:function(t){if("selectGoods"==this.componentId){var e=!0,a=!1,i=void 0;try{for(var r,n=t[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var s=r.value;s.itemName=s.goodsName,s.id=s.gid,s.outNum="",s.num=0,s.selectName=s.unit,s.batchList=[],s.eliteNum=0,s.eNum=0}}catch(t){a=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}this.setOutNum(t,!1,"goodsName"),this.goodsArr=[].concat(o(this.getGoods),o(t)),0==this.tabactive&&(this.introData=this.goodsArr)}else if("selectSupplies"==this.componentId){var u=!0,c=!1,l=void 0;try{for(var d,p=t[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var m=d.value;m.itemName=m.name,m.outNum="",m.num=0,m.unitList=[],m.batchList=[],m.unitArr=m.unit,m.eNum=0,m.itemId=m.id,m.eliteNum=0,m.piceValue=0;var h=[],v=!0,f=!1,b=void 0;try{for(var g,N=m.unitArr[Symbol.iterator]();!(v=(g=N.next()).done);v=!0){var _=g.value;1==_.isDefault?(h.unshift(_),m.unitList.unshift(_.name)):(h.push(_),m.unitList.push(_.name))}}catch(t){f=!0,b=t}finally{try{!v&&N.return&&N.return()}finally{if(f)throw b}}m.unit=h,m.selectName=m.unit[0].name,m.selectValue=m.unit[0].value}}catch(t){c=!0,l=t}finally{try{!u&&p.return&&p.return()}finally{if(c)throw l}}console.log(t),this.setOutNum(t,!0,"name"),this.suppliesArr=[].concat(o(this.getSupplies),o(t)),this.getsuppliespice(),this.picestyle="",1==this.tabactive&&(this.introData=this.suppliesArr)}},getUnit:function(t){this.$set(t,"outNum","");var e=!0,a=!1,i=void 0;try{for(var r,n=t.unitArr[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var s=r.value;t.sleunitId==s.muId&&(t.selectName=s.name,t.selectValue=s.value)}}catch(t){a=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}},goodsthrowWin:function(t,e){var a=this;if(this.showgoodswin=!1,this.showsupplieswin=!1,"ok"==t){var i=0;this.checkList.batchList=[],e.map(function(t){t.outNum&&Number(t.outNum)>0&&(a.checkList.batchList.push(t),i+=Number(t.outNum))}),this.checkList.outNum=i}},autoFill:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=this.introData[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var n=i.value;n.batchList="",Number(n.num)>Number(n.surplus)?(n.outNum<=0||!n.outNum)&&(n.outNum=1==this.tabactive?parseInt((Number(n.surplus)-Number(n.eNum))/Number(n.selectValue)):Number(n.surplus)-Number(n.eNum)):(n.outNum<=0||!n.outNum)&&(n.outNum=1==this.tabactive?parseInt((Number(n.num)-Number(n.eNum))/Number(n.selectValue)):Number(n.num)-Number(n.eNum)),(n.outNum<0||isNaN(n.outNum))&&(n.outNum=0)}}catch(t){e=!0,a=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}},setUnit:function(t,e,a){var i="",r="",n=1,s=!0,o=!1,c=void 0;try{for(var l,d=e[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var p=l.value;1==p.isMin&&(r=p.name),"string"==typeof a||"number"==typeof a?p.name==a&&(i=p.name,n=p.value):1==p.isDefault&&(i=p.name,n=p.value)}}catch(t){o=!0,c=t}finally{try{!s&&d.return&&d.return()}finally{if(o)throw c}}return u.a.comUnit(t,n,i,r)},getgoodsSurplus:function(t,e){var a=this;return c(regeneratorRuntime.mark(function i(){var n,s,u,o,c,l,d,p,m,h,v,f,b,g,N,_,y;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:for(n=1==e?"invent_getGoodsNum":"invoiv_getMaterialNum",s=[],u=!0,o=!1,c=void 0,i.prev=5,l=t[Symbol.iterator]();!(u=(d=l.next()).done);u=!0)p=d.value,s.push(p.id);i.next=13;break;case 9:i.prev=9,i.t0=i.catch(5),o=!0,c=i.t0;case 13:i.prev=13,i.prev=14,!u&&l.return&&l.return();case 16:if(i.prev=16,!o){i.next=19;break}throw c;case 19:return i.finish(16);case 20:return i.finish(13);case 21:if(m=1==e?{gids:s.join(",")}:{mids:s.join(",")},!(s.length>0)){i.next=50;break}return i.next=25,r.a[n]({data:Object.assign(m,{wid:a.outWare.id,shopId:a.outWare.shopId})});case 25:h=i.sent,i.t1=regeneratorRuntime.keys(t);case 27:if((i.t2=i.t1()).done){i.next=50;break}for(v=i.t2.value,f=!0,b=!1,g=void 0,i.prev=32,N=h[Symbol.iterator]();!(f=(_=N.next()).done);f=!0)y=_.value,t[v].id==y.id&&(t[v].surplus=y.surplus,1!=e&&(t[v].unitArr=y.unitData));i.next=40;break;case 36:i.prev=36,i.t3=i.catch(32),b=!0,g=i.t3;case 40:i.prev=40,i.prev=41,!f&&N.return&&N.return();case 43:if(i.prev=43,!b){i.next=46;break}throw g;case 46:return i.finish(43);case 47:return i.finish(40);case 48:i.next=27;break;case 50:return i.abrupt("return",t);case 51:case"end":return i.stop()}},i,a,[[5,9,13,21],[14,,16,20],[32,36,40,48],[41,,43,47]])}))()},getOutedNum:function(){var t=this;return c(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.All([{httpId:"invoic_getItemNum",data:{applyId:t.detailData.id,choose:0}},{httpId:"invoic_getItemNum",data:{applyId:t.detailData.id,choose:1}}]);case 2:a=e.sent,t.goodsoutedNum=a[0].data,t.suppliesoutedNum=a[1].data;case 5:case"end":return e.stop()}},e,t)}))()},setOutNum:function(t,e,a){var i=e?this.suppliesoutedNum:this.goodsoutedNum,r=!0,n=!1,s=void 0;try{for(var u,o=t[Symbol.iterator]();!(r=(u=o.next()).done);r=!0){var c=u.value;i[c[a]]&&(e?(c.eliteNum=this.setUnit(i[c[a]].num,i[c[a]].unitData,c.unitName),c.eNum=i[c[a]].num):(c.eliteNum=""+i[c[a]].num+i[c[a]].unit,c.eNum=i[c[a]].num))}}catch(t){n=!0,s=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw s}}},outNumChange:function(t,e){e.outNum=/^\d*\.?\d+$/.test(e.outNum)?e.outNum:0,""!=e.outNum&&(0==this.tabactive?Number(e.outNum)>Number(e.surplus)&&(e.outNum=e.surplus):Number(e.outNum)*Number(e.selectValue)>Number(e.surplus)&&(e.outNum=parseInt(e.surplus/Number(e.selectValue))),e.noPrev?1==e.type?e.outNum=parseInt(e.outNum):e.outNum=(e.outNum+"").replace(/^(\d*)\.?\d{4}$/g,parseInt(1e3*e.outNum)/1e3):e.unitList||1==e.type?e.outNum=(e.outNum+"").replace(/^(\d*)\.?\d{4}$/g,parseInt(1e3*e.outNum)/1e3):e.outNum=parseInt(e.outNum))},alert:function(t,e){this.$store.commit("setWin",{title:e,winType:"alert",content:t})},continued:function(){var t=this;return c(regeneratorRuntime.mark(function e(){var a,i,r,n,s,u,o,c,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.processingData();case 2:if(!e.sent){e.next=48;break}for(a=!0,i=!1,r=void 0,e.prev=7,n=t.getSupplies[Symbol.iterator]();!(a=(s=n.next()).done);a=!0)s.value.outNum="";e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,r=e.t0;case 15:e.prev=15,e.prev=16,!a&&n.return&&n.return();case 18:if(e.prev=18,!i){e.next=21;break}throw r;case 21:return e.finish(18);case 22:return e.finish(15);case 23:for(u=!0,o=!1,c=void 0,e.prev=26,l=t.getGoods[Symbol.iterator]();!(u=(d=l.next()).done);u=!0)d.value.outNum="";e.next=34;break;case 30:e.prev=30,e.t1=e.catch(26),o=!0,c=e.t1;case 34:e.prev=34,e.prev=35,!u&&l.return&&l.return();case 37:if(e.prev=37,!o){e.next=40;break}throw c;case 40:return e.finish(37);case 41:return e.finish(34);case 42:return t.suppliesArr=t.getSupplies,t.goodsArr=t.getGoods,t.introData=0==t.tabactive?t.goodsArr:t.suppliesArr,e.next=47,t.getOutedNum();case 47:t.init();case 48:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22],[26,30,34,42],[35,,37,41]])}))()},confirm:function(){var t=this;return c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.processingData();case 2:e.sent&&window.history.go(-1);case 4:case"end":return e.stop()}},e,t)}))()},processingData:function(){var t=[],e=[],a=!0,i=!1,r=void 0;try{for(var n,u=this.goodsArr[Symbol.iterator]();!(a=(n=u.next()).done);a=!0){var o=n.value;if(o.outNum&&Number(o.outNum)>0){var c={id:o.id||o.gid};if(o.batchList&&o.batchList.length>0){var l=!0,d=!1,p=void 0;try{for(var m,h=o.batchList[Symbol.iterator]();!(l=(m=h.next()).done);l=!0){var v=m.value;Number(v.outNum)>0&&(Object.assign(c,{batchId:v.batchId,num:v.outNum}),t.push(s.a.deepCopy(c)))}}catch(t){d=!0,p=t}finally{try{!l&&h.return&&h.return()}finally{if(d)throw p}}}else Object.assign(c,{batchId:0,num:o.outNum}),t.push(c)}}}catch(t){i=!0,r=t}finally{try{!a&&u.return&&u.return()}finally{if(i)throw r}}var f=!0,b=!1,g=void 0;try{for(var N,_=this.suppliesArr[Symbol.iterator]();!(f=(N=_.next()).done);f=!0){var y=N.value;if(y.outNum&&Number(y.outNum)>0){if(!y.piceValue&&this.isBrand&&1!==y.isPurchase&&0!==y.piceValue)return void this.$message.error("请选择分销价！");if(!y.piceUnitid&&this.isBrand&&1!==y.isPurchase)return void this.$message.error("请选择分销价单位！");if(!/^([+-]?)\d*\.?\d+$/.test(y.piceValue))return void this.$message({message:"请输入正确的分销价格！",type:"warning"});var x={mid:y.itemId,type:0,selectUnitName:y.selectName};if(this.isBrand&&Object.assign(x,{distributionPrice:y.piceValue,distributionUnit:"等于进价"==y.piceUnitid?0:y.piceUnitid||0,isPurchase:y.isPurchase}),y.batchList&&y.batchList.length>0){var w=!0,k=!1,I=void 0;try{for(var S,D=y.batchList[Symbol.iterator]();!(w=(S=D.next()).done);w=!0){var L=S.value;Number(L.outNum)>0&&(Object.assign(x,{batchId:L.batchId,num:L.outNum*Number(y.selectValue)}),e.push(s.a.deepCopy(x)))}}catch(t){k=!0,I=t}finally{try{!w&&D.return&&D.return()}finally{if(k)throw I}}}else Object.assign(x,{batchId:0,num:y.outNum*Number(y.selectValue)}),e.push(x)}}}catch(t){b=!0,g=t}finally{try{!f&&_.return&&_.return()}finally{if(b)throw g}}if(0==t.length&&0==e.length)return this.alert("请选择调度商品"),!1;var A={receiptNumber:"",reason:this.detailData.reason,remark:this.detailData.remark,outWarehouse:this.outWare.id,intoWarehouse:this.detailData.wid,applyId:this.detailData.id,goodsDetail:t,materialDetail:e};return this.addDispatch(A)},addDispatch:function(t){var e=this;return c(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.invoic_addDispatchOrder({data:t});case 2:return e.alert("调度成功！"),a.abrupt("return",!0);case 4:case"end":return a.stop()}},a,e)}))()},brandSettitle:function(){this.shoptitleList=s.a.deepCopy(this.titleList),this.titleList.splice(5,0,{titleName:"分销价格",titleStyle:{minWidth:"200px"}},{titleName:"价格单位",titleStyle:{minWidth:"200px"}})},getDistr:function(){var t=this;return c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.invoicingGetDistributionConfig();case 2:e.sent.map(function(e){var a={};Object.assign(a,{distributionId:e.id,value:"",name:e.name,unitId:""}),t.dispiceArr.push(a)}),t.dispiceArr=t.dispiceArr.concat([{distributionId:-1,value:0,name:"等于进价",unitId:""},{distributionId:-2,value:0,name:"自定义价格",unitId:""}]);case 5:case"end":return e.stop()}},e,t)}))()},getsuppliespice:function(){var t=this;return c(regeneratorRuntime.mark(function e(){var a,i,n,s,u,o,c,l,d,p,m,h,v,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],t.suppliesArr.map(function(t){a.push(t.itemId)}),e.next=4,r.a.materialGetDistributionByMids({data:{mids:a.join(",")}});case 4:i=e.sent,n=!0,s=!1,u=void 0,e.prev=8,o=i[Symbol.iterator]();case 10:if(n=(c=o.next()).done){e.next=35;break}for((l=c.value).rela=l.rela.concat([{distributionId:-1,value:0,distributionName:"等于进价",unitId:""},{distributionId:-2,value:0,distributionName:"自定义价格",unitId:""}]),d=!0,p=!1,m=void 0,e.prev=16,h=t.suppliesArr[Symbol.iterator]();!(d=(v=h.next()).done);d=!0)f=v.value,l.id==f.itemId&&(f.rela=l.rela);e.next=24;break;case 20:e.prev=20,e.t0=e.catch(16),p=!0,m=e.t0;case 24:e.prev=24,e.prev=25,!d&&h.return&&h.return();case 27:if(e.prev=27,!p){e.next=30;break}throw m;case 30:return e.finish(27);case 31:return e.finish(24);case 32:n=!0,e.next=10;break;case 35:e.next=41;break;case 37:e.prev=37,e.t1=e.catch(8),s=!0,u=e.t1;case 41:e.prev=41,e.prev=42,!n&&o.return&&o.return();case 44:if(e.prev=44,!s){e.next=47;break}throw u;case 47:return e.finish(44);case 48:return e.finish(41);case 49:case"end":return e.stop()}},e,t,[[8,37,41,49],[16,20,24,32],[25,,27,31],[42,,44,48]])}))()},picestyleChange:function(t){console.log(t),this.suppliesArr.map(function(e){var a=!0;e.distributionId=Number(t),e.piceUnitid="",e.piceValue=0,e.isPurchase=0,-1!=t?e.rela.map(function(t){t.distributionId==e.distributionId&&(a=!1,e.piceValue=t.value,e.piceUnitid=t.unitId)}):(a=!1,e.isPurchase=1,e.piceValue=0,e.piceUnitid="等于进价"),a&&(e.distributionId=-2)})},piceChange:function(t){t.piceUnitid="",t.piceValue=0,t.isPurchase=0,-1==t.distributionId?(t.isPurchase=1,t.piceValue=0,t.piceUnitid="等于进价"):(t.isPurchase=0,t.rela.map(function(e){e.distributionId==t.distributionId&&(t.piceValue=e.value,t.piceUnitid=e.unitId)})),console.log(t.piceUnitid),this.introData=s.a.deepCopy(this.introData),this.suppliesArr=this.introData}},mounted:function(){var t=this;return c(regeneratorRuntime.mark(function e(){var a,i,r,s,u,o,c,l,d,p,m,h,v,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.detailData=n.a.session("details"),t.isBrand="3"==n.a.session("userShop").currentShop.ischain,t.isBrand&&t.getDistr(),t.outWare=t.detailData.outWare,t.comObj=t.detailData.comObj,t.itemList.goods=[],t.itemList.material=[],!t.detailData.itemList){e.next=48;break}if(!t.detailData.itemList.goods){e.next=28;break}for(a=!0,i=!1,r=void 0,e.prev=12,s=t.detailData.itemList.goods[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)o=u.value,Object.assign(o,{noPrev:!0,outNum:"",selectName:o.unitName,surplus:0,batchList:[],id:o.itemId,eliteNum:0,eNum:0}),c={goodsId:o.itemId,itemName:o.itemName,unit:o.unitName,type:1==o.type?0:1,barCode:o.barCode},t.itemList.goods.push(c);e.next=20;break;case 16:e.prev=16,e.t0=e.catch(12),i=!0,r=e.t0;case 20:e.prev=20,e.prev=21,!a&&s.return&&s.return();case 23:if(e.prev=23,!i){e.next=26;break}throw r;case 26:return e.finish(23);case 27:return e.finish(20);case 28:if(!t.detailData.itemList.material){e.next=48;break}for(l=!0,d=!1,p=void 0,e.prev=32,m=t.detailData.itemList.material[Symbol.iterator]();!(l=(h=m.next()).done);l=!0)v=h.value,Object.assign(v,{noPrev:!0,outNum:"",selectName:v.unitName,surplus:0,batchList:[],unitArr:v.unitRelation||[],id:v.itemId,eliteNum:0,eNum:0,piceValue:0}),f={id:v.itemId,name:v.itemName},t.itemList.material.push(f);e.next=40;break;case 36:e.prev=36,e.t1=e.catch(32),d=!0,p=e.t1;case 40:e.prev=40,e.prev=41,!l&&m.return&&m.return();case 43:if(e.prev=43,!d){e.next=46;break}throw p;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return t.titleBtn(),e.next=51,t.getOutedNum();case 51:return e.next=53,t.init();case 53:t.goodsArr.length>0?t.introData=t.goodsArr:(t.introData=t.suppliesArr,t.tabactive=1,t.isBrand&&t.brandSettitle()),t.isBrand&&t.getsuppliespice();case 55:case"end":return e.stop()}},e,t,[[12,16,20,28],[21,,23,27],[32,36,40,48],[41,,43,47]])}))()},destroyed:function(){},components:{comTable:function(){return a.e("table").then(a.bind(null,"4360"))},waremessageWin:function(){return a.e("waremessage_win").then(a.bind(null,"39f2"))},batchWin:function(){return a.e("clusion_store_batch_win").then(a.bind(null,"1d28"))},clusionSupplies:function(){return a.e("clusion_supplies").then(a.bind(null,"3676"))},selectGoods:function(){return a.e("output_select_goods_ware").then(a.bind(null,"6dab"))},selectSupplies:function(){return a.e("output_select_supplies_ware").then(a.bind(null,"09f6"))},addStore:function(){return a.e("choose_warehouse_win").then(a.bind(null,"f8b9"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))}}},d=(a("fd54"),a("6ceb")),p=Object(d.a)(l,i,[],!1,null,"9d6d0356",null);p.options.__file="src\\module\\invoicing_system\\conclusion\\new_schedule.vue";e.default=p.exports},fd54:function(t,e,a){"use strict";var i=a("c94a");a.n(i).a}}]);