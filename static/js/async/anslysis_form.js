(window.webpackJsonp=window.webpackJsonp||[]).push([["anslysis_form"],{"273f":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"report-order"}},[i("section",{staticClass:"main",class:{max:1*t.showWidth+450>1350},staticStyle:{height:"auto",position:"relative"}},[i("div",{staticClass:"total"},[i("span",[t._v("收银分析·共\n\t\t\t\t\t"),i("span",{staticStyle:{color:"#FE3D04",padding:"0 5px"}},[t._v(t._s(t.orderList.length))]),t._v("条记录")]),t._v(" "),i("span",{staticClass:"with",on:{click:t.contrast}},[t._v("选择固定对比")])]),t._v(" "),t.orderList.length>0?i("section",[i("div",{staticClass:"aLeft"},[i("div",{staticStyle:{width:"100%",height:"auto"}},[i("ul",{staticClass:"aUl",staticStyle:{"background-color":"#e6e6e6"}},[i("li",{staticClass:"aLi",staticStyle:{width:"50px",color:"#28a8e0",cursor:"pointer"},on:{click:function(e){t.selected()}}},[t._v("全选")]),t._v(" "),i("li",{staticClass:"aLi",staticStyle:{width:"200px"}},[t._v("时间")]),t._v(" "),i("li",{staticClass:"aLi",staticStyle:{width:"150px"}},[t._v("店铺名称")])]),t._v(" "),i("section",{staticStyle:{width:"100%",height:"auto"}},[0==t.orderList.length?i("ul",{staticClass:"aUl",staticStyle:{"background-color":"#f2f2f2"}},[i("li",{staticClass:"aLi",staticStyle:{width:"400px"}})]):t._e(),t._v(" "),t._l(t.orderPageList,function(e,s){return i("ul",{key:s,staticClass:"aUl",staticStyle:{color:"#333333",overflow:"hidden",width:"100%","border-bottom":"1px solid #ccc","background-color":"#fff"},style:{height:50*e.list.length+"px"}},[i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer",width:"50px"},style:{height:50*e.list.length+"px"},on:{click:function(i){t.selected(e,s)}}},[i("div",{staticClass:"circle",class:{active:e.selected}})]),t._v(" "),0===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer",width:"200px"},style:{height:50*e.list.length+"px"}},[i("p",{staticStyle:{"line-height":"30px"}},[t._v(t._s(t.timeTodate(e.time)))]),t._v(" "),i("p",{staticStyle:{"line-height":"10px"}},[t._v(t._s(t.timeToday(e.time)))])]):t._e(),t._v(" "),1===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer",width:"200px"},style:{height:50*e.list.length+"px"}},[i("p",{staticStyle:{"line-height":"30px"}},[t._v(t._s(t.timeToweek(e.time)))]),t._v(" "),i("p",{staticStyle:{"line-height":"10px"}},[t._v(t._s(t.weekTotime(e.time)))])]):t._e(),t._v(" "),2===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer",width:"200px"},style:{height:50*e.list.length+"px"}},[i("p",{staticStyle:{"line-height":"50px"}},[t._v(t._s(t.timeTodate(e.time)))])]):t._e(),t._v(" "),3===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer",width:"200px"},style:{height:50*e.list.length+"px"}},[i("p",{staticStyle:{"line-height":"30px"}},[t._v(t._s(t.timeToquarter(e.time)))])]):t._e(),t._v(" "),4===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer",width:"200px"},style:{height:50*e.list.length+"px"}},[i("p",{staticStyle:{"line-height":"50px"}},[t._v(t._s(t.timeToyear(e.time)))])]):t._e(),t._v(" "),i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer",width:"150px"},style:{height:50*e.list.length+"px"}},t._l(e.list,function(e,s){return i("span",{key:s},t._l(e,function(e,s){return e.name?i("span",{key:s,staticClass:"title",staticStyle:{height:"50px",display:"inline-block",width:"100%","border-bottom":"1px solid #ccc","vertical-align":"bottom"}},[t._v(t._s(e.name))]):t._e()}))}))])})],2),t._v(" "),i("ul",{staticClass:"aUl",staticStyle:{"background-color":"#e6e6e6"}},[i("li",{staticClass:"aLi",staticStyle:{width:"50px"}}),t._v(" "),i("li",{staticClass:"aLi",staticStyle:{width:"200px"}}),t._v(" "),t.backList?t._e():i("li",{staticClass:"aLi",staticStyle:{width:"150px","font-weight":"700"}},[t._v("合计")])])])]),t._v(" "),i("div",{staticClass:"aRight",staticStyle:{width:"100%",height:"auto","padding-left":"400px",overflow:"auto","overflow-x":"scroll"}},[i("section",{style:{width:t.showWidth+"px"}},[i("ul",{staticClass:"first",staticStyle:{color:"#333333",width:"100%",background:"#e6e6e6"},style:{width:t.showWidth+"px"}},t._l(t.selHead,function(e,s){return e.selected?i("li",{key:s,staticClass:"width70 title",staticStyle:{color:"#28A8E0"},attrs:{title:e.name}},[t._v(t._s(e.name))]):t._e()})),t._v(" "),t.orderList.length>0?[t._l(t.orderPageList,function(e){return t._l(e.list,function(e){return i("ul",{key:e.num,staticClass:"order-content-show detialList",staticStyle:{color:"#333333",overflow:"hidden",width:"100%","border-bottom":"1px solid #ccc"},style:{width:t.showWidth+"px"}},[t._l(e,function(e,s){return e.selected&&0===t.flag?i("li",{key:s,staticClass:"width70 title"},[t._v(t._s(e.num))]):t._e()}),t._v(" "),t._l(e,function(e,s){return!e.selected||1!=t.flag&&2!=t.flag?t._e():i("li",{key:s,staticClass:"width70 title"},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.num)+"\n\t\t\t\t\t\t\t\t\t\t"),e.orderNum||e.goodsNum||e.originalPrice?t._e():i("span",[t._v("%")])])}),t._v(" "),t._l(e,function(e,s){return!e.selected||3!=t.flag&&4!=t.flag?t._e():i("li",{key:s,staticClass:"width70 title"},[i("span",{class:{numGreen:e.num[1]<0,numRed:e.num[1]>0},staticStyle:{display:"block",height:"10px","line-height":"30px"}},[t._v(t._s(e.num[1]))]),t._v(" "),i("span",{class:{numRed:e.num[0]>0,numGreen:e.num[0]<0}},[t._v(t._s(e.num[0])+"\n\t\t\t\t\t\t\t\t\t\t\t"),"-"!=e.num[0]?i("span",[t._v("%")]):t._e(),t._v(" "),e.num[0]<0||e.num[1]<0?i("span",[t._v("↓")]):t._e(),t._v(" "),e.num[0]>0||e.num[1]>0?i("span",[t._v("↑")]):t._e()])])})],2)})})]:i("ul",{style:{width:t.showWidth+"px"}},[i("li",{staticStyle:{width:"100%","background-color":"#F2F2F2",color:"#F8931F"}},[t._v("没有订单")])]),t._v(" "),i("ul",{staticClass:"first",staticStyle:{color:"#333333",width:"100%",overflow:"hidden",background:"#e6e6e6"},style:{width:t.showWidth+"px"}},t._l(t.totalList,function(e,s){return!t.backList&&e.selected?i("li",{key:s,staticClass:"width70 title"},[t._v(t._s(e.num))]):t._e()}))],2)])]):i("section",{staticStyle:{"border-top":"1px solid #ccc",height:"200px","text-align":"center","line-height":"200px","font-size":"24px",color:"#B3B3B3"}},[t._v("\n\t\t\t\t-暂无数据-\n\t\t\t")])]),t._v(" "),t.total>1&&t.loading?i("page",{staticStyle:{"margin-top":"20px","margin-bottom":"50px",float:"left",position:"relative",width:"100%"},attrs:{page:t.page,total:t.total,isNoJump:!0,isNoPaging:!0},on:{pageNum:t.pageChange}}):t._e()],1)};s._withStripped=!0;var l=i("81a2"),a=i("bbb9"),r={data:function(){return{totalList:[],selTotalList:[],selOrderList:[],orderList:[],orderPageList:[],total:0,len:0,num:0,page:1,backList:!1,showWidth:0,titleList:[],list:[]}},props:["width","loading","reportList","headList","selShopid","selectedType","selHead","flag","isBack","isChange","exportIndex","shopId"],mounted:function(){this.showWidth=this.width,this.dataList(),this.enterHead(this.selHead,"ok")},watch:{selHead:{handler:function(t){this.enterHead(t)},deep:!0},reportList:function(){this.dataList()},backList:function(){this.$emit("back",this.backList)},isBack:function(){this.backList=!1,this.orderList=a.a.deepCopy(this.selOrderList),this.totalList=a.a.deepCopy(this.selTotalList),this.page=1,this.total=Math.ceil(this.selOrderList.length/this.num),this.pageChange({page:this.page})},exportIndex:function(){this.exportData()}},methods:{dataList:function(){var t=a.a.deepCopy(this.reportList.list),e=this.reportList.list;if(this.loading=!0,!t)return this.orderList=[],void(this.total=0);for(var i=[],s=0;s<this.headList.length;s++)i[s]=this.headList[s].column;for(var l=this.headList,r=0;r<l.length;r++)for(var o in l[r].num=0,this.reportList.total)l[r].column==o&&(l[r].num=this.reportList.total[o]);for(var h=0;h<t.length;h++){t[h].selected=!1;for(var n=0;n<t[h].list.length;n++){t[h].list[n]=[],t[h].list[n].length=i.length;for(var d=0;d<i.length;d++)for(var c in t[h].list[n][d]={},t[h].list[n][d][i[d]]=i[d],t[h].list[n][d].selected=!0,e[h].list[n])c==t[h].list[n][d][i[d]]&&(t[h].list[n][d].num=e[h].list[n][c])}}for(var p=0;p<t.length;p++)for(var g=0;g<t[p].list.length;g++){var u={};u.name=e[p].list[g].shopName,t[p].list[g].push(u)}this.totalList=l,this.selTotalList=a.a.deepCopy(l),this.orderList=t,this.selOrderList=a.a.deepCopy(t),this.$emit("getList",this.selOrderList,this.selTotalList),this.selShopid.length<=3?this.num=8:this.selShopid.length>3&&this.selShopid.length<=5?this.num=5:this.selShopid.length>5&&this.selShopid.length<10?this.num=3:this.selShopid.length>=10&&this.selShopid.length<20?this.num=2:this.num=1,this.page=1,this.total=Math.ceil(t.length/this.num),this.total<10?this.len=this.total:this.len=10,this.page>=this.total?this.page=this.total>=0?this.total:0:this.page=this.page,this.orderPageList=t.slice((this.page-1)*this.num,(this.page-1)*this.num+this.num),this.list=this.orderPageList.list},errorShow:function(t){this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:t})},exportData:function(){for(var t=0,e=0;e<this.orderList.length;e++)this.orderList[e].selected&&t++;if(t<1)return this.errorShow("请选择至少1组数据"),!1;for(var i=a.a.deepCopy(this.orderList),s=a.a.deepCopy(this.headList),r=0;r<i.length;r++)if(i[r].selected)for(var o=0;o<i[r].list.length;o++)for(var h=0;h<i[r].list[o].length;h++)for(t in!i[r].list[o][h].selected&&h<i[r].list[o].length-1&&(i[r].list[o].splice(h,1),h--),i[r].list[o][h])for(var n=0;n<s.length;n++)s[n].column==t&&(i[r].list[o][h].name=s[n].name);else i.splice(r,1),r--;for(var d=a.a.deepCopy(i),c=0;c<i.length;c++){d[c].list=[];for(var p=0;p<i[c].list.length;p++){d[c].list[p]={};for(var g=0;g<i[c].list[p].length;g++)g<i[c].list[p].length-1?(1==this.flag||2==this.flag)&&(1!=this.flag||"订单量"!=i[c].list[p][g].name&&"商品总数"!=i[c].list[p][g].name&&"消费金额"!=i[c].list[p][g].name)&&(2!=this.flag||"销量"!=i[c].list[p][g].name&&"订单量"!=i[c].list[p][g].name&&"商品总数"!=i[c].list[p][g].name&&"消费金额"!=i[c].list[p][g].name)?d[c].list[p][i[c].list[p][g].name]=i[c].list[p][g].num+"%":d[c].list[p][i[c].list[p][g].name]=i[c].list[p][g].num:(d[c].list[p]["时间"]=i[c].time,d[c].list[p]["店铺名称"]=i[c].list[p][g].name)}}for(var u=0;u<d.length;u++)delete d[u].time,delete d[u].selected;this.$emit("exportData",d),l.a.exportAnalysisReport({data:{shopId:this.shopId,analysisInfo:JSON.stringify(d),type:3==this.flag||4==this.flag?1:""}})},enterHead:function(t,e){"ok"!=e&&(t=a.a.deepCopy(this.headList),this.orderList=a.a.deepCopy(this.selOrderList),this.totalList=a.a.deepCopy(this.selTotalList)),this.headTotal=0;for(var i=0;i<this.selHead.length;i++)if(t[i].selected){this.headTotal++;for(var s=0;s<this.totalList.length;s++)t[i].column==this.totalList[s].column&&(this.totalList[s].selected=!0);for(var l=0;l<this.orderPageList.length;l++)for(var r=0;r<this.orderPageList[l].list.length;r++)for(var o=0;o<this.orderPageList[l].list[r].length;o++)t[i].column==this.orderPageList[l].list[r][o][this.selHead[i].column]&&(this.orderPageList[l].list[r][o].selected=!0)}else{for(var h=0;h<this.orderPageList.length;h++)for(var n=0;n<this.orderPageList[h].list.length;n++)for(var d=0;d<this.orderPageList[h].list[n].length;d++)t[i].column==this.orderPageList[h].list[n][d][this.selHead[i].column]&&(this.orderPageList[h].list[n][d].selected=!1);for(var c=0;c<this.totalList.length;c++)t[i].column==this.totalList[c].column&&(this.totalList[c].selected=!1)}this.showWidth=100*this.headTotal,this.formHead=!1,this.titleList=[];var p=!0,g=!1,u=void 0;try{for(var m,f=this.selHead[Symbol.iterator]();!(p=(m=f.next()).done);p=!0){var v=m.value;if(v.selected){var L={titleName:"",dataName:""};L.titleName=v.name,L.dataName=v.column,this.titleList.push(L)}}}catch(t){g=!0,u=t}finally{try{!p&&f.return&&f.return()}finally{if(g)throw u}}this.titleList=[{titleName:"全选",titleStyle:{width:"50px"},dataName:""},{titleName:"时间",dataName:"",titleStyle:{width:"150px"}},{titleName:"店铺名称",dataName:"",titleStyle:{width:"200px"}}].concat(this.titleList)},contrast:function(){for(var t=0,e=0;e<this.orderList.length;e++)this.orderList[e].selected&&t++;if(t<2)return this.errorShow("请选择至少2组对比数据"),!1;this.backList=!0;for(var i=0;i<this.orderList.length;i++)this.orderList[i].selected||(this.orderList.splice(i,1),i--);this.page=1,this.total=Math.ceil(t/this.num),this.pageChange({page:this.page})},isAllsel:function(){for(var t=0;t<this.orderList.length;t++)if(!this.orderList[t].selected)return!1;return!0},selected:function(t,e){if(t){t.selected?this.orderPageList[e].selected=!1:this.orderPageList[e].selected=!0,this.$set(this.orderPageList,e,this.orderPageList[e]);for(var i=0;i<this.orderPageList.length;i++)for(var s=0;s<this.orderList.length;s++)this.orderList[s].time==this.orderPageList[i].time&&(this.orderList[s].selected=this.orderPageList[i].selected)}else if(this.isAllsel())for(var l=0;l<this.orderList.length;l++)this.orderList[l].selected=!1,this.$set(this.orderList,l,this.orderList[l]);else for(var a=0;a<this.orderList.length;a++)this.orderList[a].selected=!0,this.$set(this.orderList,a,this.orderList[a])},pageChange:function(t){var e=t.page;this.page=t.page,this.orderPageList=this.orderList.slice((e-1)*this.num,(e-1)*this.num+this.num)},timeTodate:function(t){return t.replace(/\//g,"-")},timeToweek:function(t){var e=t.split("/");return e[0]+"第"+e[1]+"周"},timeToquarter:function(t){var e=t.split("/");return e[0]+"第"+e[1]+"季度"},timeToyear:function(t){return t+"年度"},weekTotime:function(t){var e=t.split("/"),i="",s="",l="";if(1==new Date(e[0],0,1).getDay())s=(i=new Date(e[0],0,1).setHours(0,0,0,0)+864e5)-864e5+24*e[1]*3600*1e3*7-1e3,l=i+24*(e[1]-1)*3600*1e3*7-1e3;else if(new Date(e[0],0,1).getDay()>1){var r=8-new Date(e[0],0,1).getDay();s=(i=new Date(e[0],0,1).setHours(0,0,0,0)+864e5*r)+24*e[1]*3600*1e3*7-1e3,l=i+24*(e[1]-1)*3600*1e3*7}else new Date(e[0],0,1).getDay()<1&&(s=(i=new Date(e[0],0,1).setHours(0,0,0,0)+864e5)+24*e[1]*3600*1e3*7-1e3,l=i+24*(e[1]-1)*3600*1e3*7);var o=a.a.format(new Date(s),"yyyy.MM.dd");return"("+a.a.format(new Date(l),"yyyy.MM.dd")+"~"+o+")"},timeToday:function(t){var e=t.split("/");return["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][new Date(e[0],e[1]-1,e[2]).getDay()]}},components:{page:function(){return i.e("page_element").then(i.bind(null,"5921"))},comTable:function(){return i.e("table").then(i.bind(null,"4360"))}}},o=(i("6095"),i("7610")),h=Object(o.a)(r,s,[],!1,null,"0b8c64d4",null);h.options.__file="src\\module\\cashier\\anslysis_form.vue";e.default=h.exports},6095:function(t,e,i){"use strict";var s=i("b5ab");i.n(s).a},b5ab:function(t,e,i){}}]);