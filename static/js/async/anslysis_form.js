(window.webpackJsonp=window.webpackJsonp||[]).push([["anslysis_form"],{"12de":function(t,e,i){"use strict";var s=i("f81f");i.n(s).a},"273f":function(t,e,i){"use strict";i.r(e);var s=i("81a2"),a=i("bbb9");var r={data:function(){return{totalList:[],selTotalList:[],orderList:[],orderPageList:[],total:0,len:0,page:1,backList:!1,showWidth:0,titleList:[],list:[],saveReportList:[],selOrderList:[]}},props:["width","loading","reportList","headList","selShopid","selectedType","selHead","flag","isBack","isChange","exportIndex","shopId","num"],mounted:function(){console.log(this.selHead),this.showWidth=this.width;a.a.deepCopy(this.reportList.list)},watch:{reportList:function(){this.saveReportList=a.a.deepCopy(this.reportList.list),this.page=1,this.pageChange(this.page)},backList:function(){this.$emit("back",this.backList)},isBack:function(){this.backList=!1,this.saveReportList=a.a.deepCopy(this.reportList.list),this.page=1,this.pageChange(this.page)},exportIndex:function(){this.exportData()}},methods:{rowClass:function(t){if(0!=t.columnIndex&1!=t.columnIndex&2!=t.columnIndex)return"color: #28a8e0"},renderHeader:function(t,e){var i=e.column;return t("span",{style:"cursor:pointer;color: #28a8e0;",on:{click:this.selected}},i.label)},getSummaries:function(t){var e=this.reportList.total,i=t.columns,s=(t.data,[]);return i.forEach(function(t,i){if(0!==i&&1!==i)if(2!==i)for(var a in e)a==t.property&&(s[i]=e[a]);else s[i]="合计";else s[i]=""}),s},errorShow:function(t){this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:t})},exportData:function(){for(var t=0,e=0;e<this.saveReportList.length;e++)this.saveReportList[e].selected&&t++;if(t<1)return this.errorShow("请选择至少1组数据"),!1;for(var i=this.saveReportList.filter(function(t){if(t.selected)return t}),r=a.a.deepCopy(i),n=0;n<r.length;n++)for(var o=0;o<r[n].list.length;o++){var l=r[n].list[o];if(l.time=r[n].time,1==this.flag||2==this.flag)for(var c in l)"orderNum"!=c&&"goodsNum"!=c&&"originalPrice"!=c&&"shopName"!=c&&"time"!=c&&"vouchersCash"!=c&&"vouchersNum"!=c&&"paidIn"!=c&&(l[c]=l[c]+"%");delete r[n].list[o].shopId}var h=[];this.headList.forEach(function(t){t.selected&&h.push(t.column)}),h=[].concat(function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(h),["shopName","time"]),s.a.exportAnalysisReport({data:{shopId:this.shopId,analysisInfo:JSON.stringify(r),type:3==this.flag||4==this.flag?1:"",titleData:JSON.stringify(h)}})},contrast:function(){for(var t=0,e=0;e<this.saveReportList.length;e++)this.saveReportList[e].selected&&t++;if(t<1)return this.errorShow("请选择至少2组对比数据"),!1;this.backList=!0;for(var i=0;i<this.saveReportList.length;i++)this.saveReportList[i].selected||(this.saveReportList.splice(i,1),i--);this.page=1,this.pageChange(this.page)},isAllsel:function(){for(var t=0;t<this.saveReportList.length;t++)if(!this.saveReportList[t].selected)return!1;return!0},selected:function(t,e){if(void 0!==e){t.selected?this.orderPageList[e].selected=!1:this.orderPageList[e].selected=!0;for(var i=0;i<this.orderPageList.length;i++)for(var s=0;s<this.orderList.length;s++)this.orderList[s].time==this.orderPageList[i].time&&(this.orderList[s].selected=this.orderPageList[i].selected)}else if(this.isAllsel())for(var a=0;a<this.saveReportList.length;a++)this.saveReportList[a].selected=!1;else for(var r=0;r<this.saveReportList.length;r++)this.saveReportList[r].selected=!0},pageChange:function(t){this.orderPageList=this.saveReportList.slice((t-1)*this.num,(t-1)*this.num+this.num),console.log(this.orderPageList),console.log(this.selHead)},timeTodate:function(t){return t.replace(/\//g,"-")},timeToweek:function(t){var e=t.split("/");return e[0]+"第"+e[1]+"周"},timeToquarter:function(t){var e=t.split("/");return e[0]+"第"+e[1]+"季度"},timeToyear:function(t){return t+"年度"},weekTotime:function(t){var e=t.split("/"),i="",s="",r="";if(1==new Date(e[0],0,1).getDay())s=(i=new Date(e[0],0,1).setHours(0,0,0,0)+864e5)-864e5+24*e[1]*3600*1e3*7-1e3,r=i+24*(e[1]-1)*3600*1e3*7-1e3;else if(new Date(e[0],0,1).getDay()>1){var n=8-new Date(e[0],0,1).getDay();s=(i=new Date(e[0],0,1).setHours(0,0,0,0)+864e5*n)+24*e[1]*3600*1e3*7-1e3,r=i+24*(e[1]-1)*3600*1e3*7}else new Date(e[0],0,1).getDay()<1&&(s=(i=new Date(e[0],0,1).setHours(0,0,0,0)+864e5)+24*e[1]*3600*1e3*7-1e3,r=i+24*(e[1]-1)*3600*1e3*7);var o=a.a.format(new Date(s),"yyyy.MM.dd");return"("+a.a.format(new Date(r),"yyyy.MM.dd")+"~"+o+")"},timeToday:function(t){var e=t.split("/");return["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][new Date(e[0],e[1]-1,e[2]).getDay()]}},components:{page:function(){return i.e("page_element").then(i.bind(null,"5921"))},comTable:function(){return i.e("table").then(i.bind(null,"4360"))}}},n=(i("12de"),i("8950"),i("d801")),o=Object(n.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"report-order"}},[i("section",{staticClass:"main",staticStyle:{width:"100%","border-color":"#ebeef5","border-bottom":"none"}},[i("div",{staticClass:"total"},[i("span",[t._v("收银分析·共\n\t\t\t\t"),i("span",{staticStyle:{color:"#FE3D04",padding:"0 5px"}},[t._v(t._s(t.reportList.list.length))]),t._v("条记录")]),t._v(" "),i("span",{staticClass:"with",on:{click:t.contrast}},[t._v("选择固定对比")])])]),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.orderPageList,"header-cell-style":t.rowClass,"summary-method":t.getSummaries,"show-summary":"",border:"","head-align":"center",stripe:""}},[i("el-table-column",{staticStyle:{"text-align":"center"},attrs:{"render-header":t.renderHeader,fixed:"",label:"全选",align:"center","show-overflow-tooltip":!0,width:"50px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("ul",[i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer"},on:{click:function(i){t.selected(e.row,e.$index)}}},[i("div",{staticClass:"circle",class:{active:e.row.selected}})])])]}}])}),t._v(" "),i("el-table-column",{staticStyle:{"text-align":"center"},attrs:{fixed:"",label:"时间",align:"center","show-overflow-tooltip":!0,width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("ul",[0===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer"},style:{height:50*e.row.list.length+"px"}},[i("p",{staticStyle:{"line-height":"30px"}},[t._v(t._s(t.timeTodate(e.row.time)))]),t._v(" "),i("p",{staticStyle:{"line-height":"10px"}},[t._v(t._s(t.timeToday(e.row.time)))])]):t._e(),t._v(" "),1===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer"},style:{height:50*e.row.list.length+"px"}},[i("p",{staticStyle:{"line-height":"30px"}},[t._v(t._s(t.timeToweek(e.row.time)))]),t._v(" "),i("p",{staticStyle:{"line-height":"10px"}},[t._v(t._s(t.weekTotime(e.row.time)))])]):t._e(),t._v(" "),2===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer"},style:{height:50*e.row.list.length+"px"}},[i("p",{staticStyle:{"line-height":"50px"}},[t._v(t._s(t.timeTodate(e.row.time)))])]):t._e(),t._v(" "),3===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer"},style:{height:50*e.row.list.length+"px"}},[i("p",{staticStyle:{"line-height":"30px"}},[t._v(t._s(t.timeToquarter(e.row.time)))])]):t._e(),t._v(" "),4===t.selectedType?i("li",{staticClass:"aLi",staticStyle:{cursor:"pointer"},style:{height:50*e.row.list.length+"px"}},[i("p",{staticStyle:{"line-height":"50px"}},[t._v(t._s(t.timeToyear(e.row.time)))])]):t._e()])]}}])}),t._v(" "),i("el-table-column",{attrs:{fixed:"",align:"center",label:"店铺名称",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.list,function(s,a){return i("span",{key:a},[s.shopName?i("span",{staticClass:"title",class:{line:a!=e.row.list.length-1},staticStyle:{height:"50px","line-height":"50px",display:"inline-block",width:"100%","vertical-align":"bottom"}},[t._v(t._s(s.shopName))]):t._e()])})}}])}),t._v(" "),t._l(t.selHead,function(e,s){return[e.selected?i("el-table-column",{key:s+"list",attrs:{align:"center",width:"120px",prop:e.column,label:e.name},scopedSlots:t._u([{key:"default",fn:function(s){return t._l(s.row.list,function(a,r){return i("span",{key:r},[i("span",{staticClass:"title",class:{line:r!=s.row.list.length-1},staticStyle:{height:"50px","line-height":"50px",display:"inline-block",width:"100%","vertical-align":"bottom"}},[3!=t.flag&&4!=t.flag?i("span",[i("i",[t._v(t._s(a[e.column]))]),t._v(" "),1!=t.flag&&2!=t.flag||"orderNum"==e.column||"goodsNum"==e.column||"originalPrice"==e.column||"vouchersCash"==e.column||"vouchersNum"==e.column||"paidIn"==e.column?t._e():i("i",[t._v("%")])]):i("span",[i("span",{class:{numGreen:a[e.column][1]<0,numRed:a[e.column][1]>0},staticStyle:{display:"block",height:"10px","line-height":"30px"}},[t._v(t._s(a[e.column][1]))]),t._v(" "),i("span",{class:{numRed:a[e.column][0]>0,numGreen:a[e.column][0]<0}},[t._v(t._s(a[e.column][0])+"\n\t\t\t\t\t\t\t\t\t"),"-"!=a[e.column][0]?i("span",[t._v("%")]):t._e(),t._v(" "),a[e.column][0]<0||a[e.column][1]<0?i("span",[t._v("↓")]):t._e(),t._v(" "),a[e.column][0]>0||a[e.column][1]>0?i("span",[t._v("↑")]):t._e()])])])])})}}])}):t._e()]})],2),t._v(" "),i("div",{staticClass:"page-box"},[i("el-pagination",{attrs:{background:"","page-size":t.num,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.saveReportList.length},on:{"current-change":t.pageChange,"update:currentPage":function(e){t.page=e}}})],1)],1)},[],!1,null,"505fed48",null);e.default=o.exports},8950:function(t,e,i){"use strict";var s=i("9ca3");i.n(s).a},"9ca3":function(t,e,i){},f81f:function(t,e,i){}}]);