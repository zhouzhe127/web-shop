(window.webpackJsonp=window.webpackJsonp||[]).push([["storage_win"],{1737:function(t,i,s){"use strict";s.r(i);var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",[s("win",{attrs:{align:"center",width:1300,height:600,ok:t.okstyle},on:{winEvent:t.getData}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))]),t._v(" "),s("div",{attrs:{slot:"content",id:"tan"},slot:"content"},[s("section",{staticClass:"title"},[s("div",[s("span",[t._v("物料名称："+t._s(t.infoList.materialName))]),t._v(" "),s("span",[t._v("保质期："+t._s(t.infoList.validity)+t._s(t.validityType[t.infoList.validityType]))])]),t._v(" "),s("div",[s("span",[t._v("物料单位："+t._s(t.batchInfo.options.join(",")))]),t._v(" "),s("span",[t._v("分类："+t._s(t.infoList.materialCategoryName))])]),t._v(" "),s("div",[s("span",[t._v("默认单位："+t._s(t.infoList.isDefault))]),t._v(" "),s("span",[t._v("最小单位："+t._s(t.infoList.isMin))])])]),t._v(" "),s("section",{staticClass:"menu"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.batchNum,expression:"batchNum"}],attrs:{type:"text",placeholder:"请输入批次编号"},domProps:{value:t.batchNum},on:{input:function(i){i.target.composing||(t.batchNum=i.target.value)}}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.supplyer,expression:"supplyer"}],attrs:{type:"text",placeholder:"请输入供应商"},domProps:{value:t.supplyer},on:{input:function(i){i.target.composing||(t.supplyer=i.target.value)}}}),t._v(" "),s("div",{staticClass:"canMulti"},[s("calendar",{staticClass:"fl",attrs:{pObj:t.startObj},on:{throwTime:t.getStartTime}}),t._v(" "),s("div",{staticClass:"time",staticStyle:{width:"25px"}},[t._v("---")]),t._v(" "),s("calendar",{staticClass:"fl",attrs:{pObj:t.endObj},on:{throwTime:t.getEndTime}})],1),t._v(" "),s("span",{staticClass:"blue btn",on:{click:t.search}},[t._v("筛选")]),t._v(" "),s("span",{staticClass:"gray btn",on:{click:t.reset}},[t._v("重置")]),t._v(" "),s("selectbtn",{staticStyle:{background:"#fff"},attrs:{sorts:t.options,width:180,name:t.unitName},on:{selOn:t.selOn}})],1),t._v(" "),s("section",{staticClass:"content"},[s("div",{staticClass:"top"},[s("ul",[s("li",[t._v("序号")]),t._v(" "),s("li",[t._v("批次编号")]),t._v(" "),s("li",[t._v("生产日期")]),t._v(" "),s("li",[t._v("供应商")]),t._v(" "),s("li",[t._v("所属仓库")]),t._v(" "),s("li",[t._v("领料数量/重量")]),t._v(" "),s("li",[t._v("消耗数量/重量"),s("i",{staticStyle:{color:"#FF3D04",cursor:"pointer"},on:{click:t.allUse}},[t._v("全部消耗")])]),t._v(" "),s("li",[t._v("回库数量/重量"),s("i",{staticStyle:{color:"#27A8E0",cursor:"pointer"},on:{click:t.allBack}},[t._v("剩余回库")])])])]),t._v(" "),t.batchList&&0!=t.batchList.length?s("section",t._l(t.batchList,function(i,e){return s("div",{key:e,staticClass:"list clearfix"},[s("ul",[s("li",[t._v(t._s(e+1))]),t._v(" "),s("li",{attrs:{title:i.batchCode}},[t._v(t._s(i.batchCode))]),t._v(" "),s("li",[t._v(t._s(t.transFormDate(1e3*i.productionTime)))]),t._v(" "),s("li",{attrs:{title:i.supplier}},[i.supplier?s("i",[t._v(t._s(i.supplier))]):s("i",[t._v("--")])]),t._v(" "),s("li",{attrs:{title:i.warehouseName}},[i.warehouseName?s("i",[t._v(t._s(i.warehouseName))]):s("i",[t._v("--")])]),t._v(" "),s("li",{attrs:{title:t.comUnit(i.surplus,t.selUnit.value,t.selUnit.name,t.minUnit.name)}},[t._v(t._s(t.comUnit(i.surplus,t.selUnit.value,t.selUnit.name,t.minUnit.name)))]),t._v(" "),s("li",{staticClass:"end"},[s("input",{directives:[{name:"model",rawName:"v-model",value:i.useNum,expression:"item.useNum"}],attrs:{type:"text",placeholder:"输入数字",onkeyup:t.getmin()},domProps:{value:i.useNum},on:{input:function(s){s.target.composing||t.$set(i,"useNum",s.target.value)}}}),t.selUnit.name?s("span",{attrs:{title:t.selUnit.name}},[t._v(t._s(t.selUnit.name))]):s("span",{attrs:{title:t.infoList.isDefault}},[t._v(t._s(t.infoList.isDefault))]),t._v(" "),1!=t.selUnit.isMin?s("em",[s("i",[t._v("+")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:i.useWeight,expression:"item.useWeight"}],attrs:{type:"text",placeholder:"输入数字",onkeyup:t.getmin()},domProps:{value:i.useWeight},on:{input:function(s){s.target.composing||t.$set(i,"useWeight",s.target.value)}}}),s("span",{attrs:{title:t.infoList.isMin}},[t._v(t._s(t.infoList.isMin))])]):t._e()]),t._v(" "),s("li",{staticClass:"end"},[s("input",{directives:[{name:"model",rawName:"v-model",value:i.backNum,expression:"item.backNum"}],attrs:{type:"text",placeholder:"输入数字",onkeyup:t.getmin("1")},domProps:{value:i.backNum},on:{input:function(s){s.target.composing||t.$set(i,"backNum",s.target.value)}}}),t.selUnit.name?s("span",{attrs:{title:t.selUnit.name}},[t._v(t._s(t.selUnit.name))]):s("span",{attrs:{title:t.infoList.isDefault}},[t._v(t._s(t.infoList.isDefault))]),t._v(" "),1!=t.selUnit.isMin?s("em",[s("i",[t._v("+")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:i.backWeight,expression:"item.backWeight"}],attrs:{type:"text",placeholder:"输入数字",onkeyup:t.getmin("1")},domProps:{value:i.backWeight},on:{input:function(s){s.target.composing||t.$set(i,"backWeight",s.target.value)}}}),s("span",{attrs:{title:t.infoList.isMin}},[t._v(t._s(t.infoList.isMin))])]):t._e()])])])})):s("section",{attrs:{id:"emptyData"}},[t._v("\n\t\t\t\t\t暂无数据\n\t\t\t\t")])])])])],1)};e._withStripped=!0;var a=s("bbb9"),n=s("81a2"),h=s("05dd"),c=function(){return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,i){var s=[],e=!0,a=!1,n=void 0;try{for(var h,c=t[Symbol.iterator]();!(e=(h=c.next()).done)&&(s.push(h.value),!i||s.length!==i);e=!0);}catch(t){a=!0,n=t}finally{try{!e&&c.return&&c.return()}finally{if(a)throw n}}return s}(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function u(t){return function(){var i=t.apply(this,arguments);return new Promise(function(t,s){return function e(a,n){try{var h=i[a](n),c=h.value}catch(t){return void s(t)}if(!h.done)return Promise.resolve(c).then(function(t){e("next",t)},function(t){e("throw",t)});t(c)}("next")})}}var l={data:function(){return{title:"",okstyle:{style:{background:"#F7931E"},content:"确定"},isShowCa:!1,startObj:{time:a.a.getTime({time:new Date}).start,show:!1,detail:!1,width:150},endObj:{time:a.a.getTime({time:new Date}).end,show:!1,detail:!1,width:150},unitName:"单位切换",unitList:["g","kg"],infoList:[],batchNum:"",supplyer:"",batchList:[],list:[],options:[],minUnit:"",selUnit:"",materName:"",validityType:{0:"月",1:"日",2:"年"}}},props:["batchInfo","unitData"],mounted:function(){this.title="批次分配",this.infoList=a.a.deepCopy(this.batchInfo),this.batchList=this.infoList.batch,this.list=a.a.deepCopy(this.infoList.batch),this.options=[],this.infoList.unitList=this.infoList.materialUnit;for(var t=0;t<this.infoList.unitList.length;t++)1==this.infoList.unitList[t].isDefault?(this.options.unshift(this.infoList.unitList[t].name),this.infoList.unitList.unshift(this.infoList.unitList[t]),this.infoList.unitList.splice(t+1,1)):this.options.push(this.infoList.unitList[t].name),1==this.infoList.unitList[t].isMin&&(this.infoList.isMin=this.infoList.unitList[t].name,this.minUnit=this.infoList.unitList[t]),1==this.infoList.unitList[t].isDefault&&(this.infoList.isDefault=this.infoList.unitList[t].name);this.selOn(0)},components:{win:function(){return s.e("win").then(s.bind(null,"f60a"))},selectbtn:function(){return s.e("select_btn").then(s.bind(null,"3d41"))},calendar:function(){return s.e("calendar_result").then(s.bind(null,"9265"))}},methods:{getStartTime:function(t){this.startObj.time=t},getEndTime:function(t){this.endObj.time=t},getMaterialBatch:function(){var t=this;return u(regeneratorRuntime.mark(function i(){var s,e;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.a.getMaterialBatch({data:{mid:371}});case 2:for(s=i.sent,e=0;e<s.list.length;e++)s.list[e].useNum="",s.list[e].useWeight="";t.batchList=s.list,t.infoList=s,t.getMaterialDetail();case 7:case"end":return i.stop()}},i,t)}))()},getMaterialDetail:function(){var t=this;return u(regeneratorRuntime.mark(function i(){var s,e,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.a.getMaterialDetail({data:{mid:t.batchInfo.materialId}});case 2:for(s=i.sent,t.infoList.materialName=s.name,t.infoList.unitList=s.relation,e=0;e<s.category.length;e++)t.infoList.materialCategoryName+=s.category[e].name+",";for(a=0;a<s.uintData.length;a++)1==s.unitData[a].isDefault&&(t.infoList.isDefault=s.unitData[a].name),1==s.unitData[a].isMin&&(t.infoList.isMin=s.unitData[a].name);case 7:case"end":return i.stop()}},i,t)}))()},getData:function(t){if(this.infoList.batch=this.batchList,this.infoList.selUnit=this.selUnit,"ok"==t)for(var i=0;i<this.batchList.length;i++){if(this.batchList[i].usemin>this.batchList[i].surplus)return this.$store.commit("setWin",{winType:"alert",content:"批次编号"+this.batchList[i].batchCode+"消耗数量不能大于领料数量"}),!1;if(this.batchList[i].backmin>1*this.batchList[i].surplus-1*this.batchList[i].usemin)return this.$store.commit("setWin",{winType:"alert",content:"批次编号"+this.batchList[i].batchCode+"回库数量不足"}),!1}this.$emit("getWin",t,this.infoList,this.batchList)},getTime:function(t){this.startTime=t.startTime,this.endTime=t.endTime,this.isShowCa=!1},showCalendar:function(){this.isShowCa=!this.isShowCa},transFormDate:function(t){return a.a.format(new Date(t),"yyyy-MM-dd")},getmin:function(t){for(var i=0;i<this.batchList.length;i++)"1"==t?(""!=this.batchList[i].backNum?this.batchList[i].backNum=(this.batchList[i].backNum+"").replace(/[^\d\.]/g,""):this.batchList[i].backNum="",""!=this.batchList[i].backWeight?this.batchList[i].backWeight=(this.batchList[i].backWeight+"").replace(/[^\d\.]/g,""):this.batchList[i].backWeight="",this.batchList[i].backmin=this.batchList[i].backNum*this.selUnit.value+1*this.batchList[i].backWeight):(""!=this.batchList[i].useNum?this.batchList[i].useNum=(this.batchList[i].useNum+"").replace(/[^\d\.]/g,""):this.batchList[i].useNum="",""!=this.batchList[i].useWeight?this.batchList[i].useWeight=(this.batchList[i].useWeight+"").replace(/[^\d\.]/g,""):this.batchList[i].useWeight="",this.batchList[i].usemin=this.batchList[i].useNum*this.selUnit.value+1*this.batchList[i].useWeight)},selOn:function(t){for(var i=0;i<this.infoList.unitList.length;i++)t==i&&(this.selUnit=this.infoList.unitList[i]);for(var s=0;s<this.batchList.length;s++){var e=this.comUnit(this.batchList[s].usemin,this.selUnit.value,this.selUnit.name,this.minUnit.name,!0),a=this.comUnit(this.batchList[s].backmin,this.selUnit.value,this.selUnit.name,this.minUnit.name,!0);1!=this.selUnit.isMin?(this.batchList[s].useNum=e.oNull,this.batchList[s].useWeight=e.tNull,this.batchList[s].backNum=a.oNull,this.batchList[s].backWeight=a.tNull):(e.oNull?(this.batchList[s].useNum=e.oNull,this.batchList[s].useWeight=e.tNull):(this.batchList[s].useNum=e.tNull,this.batchList[s].useWeight=""),a.oNull?(this.batchList[s].backNum=a.oNull,this.batchList[s].backWeight=a.tNull):(this.batchList[s].backNum=a.tNull,this.batchList[s].backWeight="")),"0.000"==this.batchList[s].useNum?this.batchList[s].useNum="":this.batchList[s].useNum=this.batchList[s].useNum,"0.000"==this.batchList[s].useWeight?this.batchList[s].useWeight="":this.batchList[s].useWeight=this.batchList[s].useWeight,"0.000"==this.batchList[s].backNum?this.batchList[s].backNum="":this.batchList[s].backNum=this.batchList[s].backNum,"0.000"==this.batchList[s].backWeight?this.batchList[s].backWeight="":this.batchList[s].backWeight=this.batchList[s].backWeight}},comUnit:function(){for(var t=arguments.length,i=Array(t),s=0;s<t;s++)i[s]=arguments[s];var e=c(i,5),a=e[0],n=e[1],u=e[2],l=e[3],o=e[4];return h.a.comUnit(a,n,u,l,o)},allUse:function(){for(var t=0;t<this.batchList.length;t++){var i=this.comUnit(this.batchList[t].surplus,this.selUnit.value,this.selUnit.name,this.minUnit.name,!0);1!=this.selUnit.isMin?(this.batchList[t].useNum=i.oNull,this.batchList[t].useWeight=i.tNull):(this.batchList[t].useNum=i.tNull,this.batchList[t].useWeight=""),this.batchList[t].backNum="",this.batchList[t].backWeight="",this.batchList[t].usemin=this.batchList[t].useNum*this.selUnit.value+1*this.batchList[t].useWeight}},allBack:function(){for(var t=0;t<this.batchList.length;t++){var i=1*this.batchList[t].surplus-1*this.batchList[t].usemin,s=this.comUnit(i,this.selUnit.value,this.selUnit.name,this.minUnit.name,!0);1!=this.selUnit.isMin?(this.batchList[t].backNum=s.oNull,this.batchList[t].backWeight=s.tNull):(this.batchList[t].backNum=s.tNull,this.batchList[t].backWeight="")}},search:function(){if(this.batchList=[],this.startObj.time>this.endObj.time)return this.$store.commit("setWin",{winType:"alert",content:"开始时间不能大于结束时间"}),!1;for(var t=0;t<this.list.length;t++)1e3*this.list[t].productionTime<=this.endObj.time&&1e3*this.list[t].productionTime>=this.startObj.time&&this.batchList.push(this.list[t]);for(var i=0;i<this.batchList.length;i++)-1==this.batchList[i].supplier.indexOf(this.supplyer)&&(this.batchList.splice(i,1),i--);for(var s=0;s<this.batchList.length;s++)-1==this.batchList[s].batchCode.indexOf(this.batchNum)&&(this.batchList.splice(s,1),s--)},reset:function(){this.batchNum="",this.supplyer="",this.startObj.time=a.a.getTime({time:new Date}).start,this.endObj.time=a.a.getTime({time:new Date}).end,this.batchList=a.a.deepCopy(this.list)}}},o=(s("44a4"),s("6ceb")),r=Object(o.a)(l,e,[],!1,null,"2a6159c6",null);r.options.__file="src\\module\\invoicing_system\\picking_list\\storage_win.vue";i.default=r.exports},"44a4":function(t,i,s){"use strict";var e=s("d82a");s.n(e).a},d82a:function(t,i,s){}}]);