(window.webpackJsonp=window.webpackJsonp||[]).push([["activity_birth"],{"03aa":function(t,e,i){"use strict";var a=i("3637");i.n(a).a},3637:function(t,e,i){},"54de":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAASCAIAAAAym6IDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjZTQ3ZWMyNi00ZTAxLTYyNDAtOWIzOS0yYmEzODJmZWExOTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODcwNjdBMjdGRTIyMTFFNkIxMDhGMEMzOTA3NzI4NzUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODcwNjdBMjZGRTIyMTFFNkIxMDhGMEMzOTA3NzI4NzUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ODAxYzRkZmItMzVkNi04ZjRhLThkMTctMjRjMzhmMTAxY2U4IiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6N2VjYjdlYjQtMzg4YS0xMTdhLTliNWYtYmQ5MTBiNTk5YzFmIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+EaK0ygAAAdlJREFUeNpi/P//PwOJgAXOevj5z7SrH3Y8/vbrH4opNhKcqZp8ZmIccBFGiD2bHnytOvXmL24rM7X583QEIGwmIN766Gv5SSwacnQEJluLagmyAdnTr37sufgequfFt78lx99gGmwswp6tze8iw5WiyQ8RmXvj07EXP0B6Oi68w+qYs29+7nz87d6n33Ovf4QL1px+C3QNC1ACTTUnC6OjFJcQO9OS25/PvP6BLPX825/jL36woGmwkuDQFmS3l+Q0FmUHci3XP/7w6x+q/T+YkPninMwWYhwr7nx+/eMvkPvtz/8/GAHz8ttfFD2ffv/ru/TBUITdQ5YLyG07/+7L739oev5BwhoOvoON7bQQAZJvf/xde+8LZtgIczAxoQnFqfEKsIEEm89hD08tQXYmA2F2OJ+dmTEXHNknX/0AhmeUKi8vK4qhXCyMDpKcTNVGQnAhNxkuHrAiTmbGfF0BcDCg+KfcQAgYE0w6QmzAtAQRevzlz6Mvf4CJ9fan30B7lt3+jJygHKQ4w5R5EGkUmJaASQNP+neW5ppiI4qSroFgz5NvU69+vPHhF5pqCS6WZA2+GFVe9LwAB0defL/67hcw4f79/1+Uk1mNn81OkhPoB2Q1AAEGALOGxNrDGQSiAAAAAElFTkSuQmCC"},e5b3:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"birth_act"},[t._m(0),t._v(" "),i("div",{staticClass:"box"},[i("label",[i("span",{staticClass:"required"},[t._v("活动标题")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.actName,expression:"actName"}],attrs:{type:"text",maxlength:"20",placeholder:"请输入活动标题"},domProps:{value:t.actName},on:{input:function(e){e.target.composing||(t.actName=e.target.value)}}})])]),t._v(" "),t._m(1),t._v(" "),i("div",{staticClass:"box"},[i("span",{staticClass:"required",staticStyle:{"vertical-align":"top","padding-top":"10px"}},[t._v("关联优惠券")]),t._v(" "),i("div",{staticClass:"btn-concent",staticStyle:{display:"inline-block"}},[i("button",{staticClass:"increase",staticStyle:{width:"200px"},on:{click:t.addCount}},[t._v("选择关联优惠券")])]),t._v(" "),t.selectCoupon.length>0?i("span",[t._v("(已关联"+t._s(t.selectCoupon.length)+"张)")]):t._e()]),t._v(" "),i("div",{staticClass:"content-box"},[i("span",{staticClass:"required"},[t._v("活动期限")]),t._v(" "),i("section",{staticClass:"statisticsList",staticStyle:{display:"inline-block",width:"200px","vertical-align":"middle"}},[i("section",{staticClass:"tableListInp chairFix",on:{click:t.showhighList}},[i("span",{staticStyle:{height:"38px",width:"157px",display:"block",float:"left","text-align":"center","border-right":"1px #B3B3B3 solid"}},[t._v(t._s(t.high))]),t._v(" "),t._m(2)]),t._v(" "),t.highLimit?i("ul",{staticClass:"tableListUl"},t._l(t.timeLimit,function(e,a){return i("li",{key:a,on:{click:function(e){t.costhighShow(a)}}},[t._v(t._s(e.name))])})):t._e()])]),t._v(" "),i("div",{staticClass:"content-box"},[i("span",{staticClass:"required"},[t._v("推送日期")]),t._v(" "),i("section",{staticClass:"statisticsList",staticStyle:{display:"inline-block","vertical-align":"middle","line-height":"40px","font-size":"14px"}},[t._v("\n\t\t\t提前\n\t\t\t"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.pushdateNum,expression:"pushdateNum"}],staticStyle:{display:"inline-block",width:"200px",height:"36px","text-align":"center","line-height":"38px",margin:"0 10px"},attrs:{type:"text",name:"",placeholder:"请输入推送日期"},domProps:{value:t.pushdateNum},on:{input:function(e){e.target.composing||(t.pushdateNum=e.target.value)}}}),t._v("天,发起生日活动推送\n\t\t")])]),t._v(" "),i("div",{staticClass:"content-box clearfix"},[i("span",{staticClass:"required fl"},[t._v("推送时间")]),t._v(" "),i("div",{staticClass:"fl",staticStyle:{height:"40px",display:"flex","align-items":"center"}},[t._v("\n\t\t\t每日\n\t\t\t"),i("section",{staticClass:"statisticsList",staticStyle:{display:"inline-block","vertical-align":"middle",width:"200px",height:"40px",margin:"0 10px"},on:{click:t.showpushList}},[i("section",{staticClass:"tableListInp chairFix"},[i("span",{staticStyle:{height:"38px",width:"157px",display:"block",float:"left","text-align":"center","border-right":"1px #B3B3B3 solid"}},[t._v(t._s(t.pushNum))]),t._v(" "),t._m(3)]),t._v(" "),t.pushtimeStauts?i("ul",{staticClass:"tableListUl"},t._l(t.pushtime,function(e,a){return i("li",{key:a,on:{click:function(e){t.pushutimeShow(a)}}},[t._v(t._s(e.name))])})):t._e()]),t._v("时,发起生日活动推送\n\t\t")])]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),i("div",{staticClass:"content-box",staticStyle:{overflow:"hidden"}},[i("span",{staticClass:" req required-none fl"},[t._v("消息推送渠道")]),t._v(" "),i("span",{staticClass:"fl"},[i("mulSelect",{attrs:{styles:{backgroundColor:"rgb(240,240,240)"},list:t.goodsType,selects:t.goodsSelect,name:"name",keyName:"id"},on:{selOn:t.selOn}})],1),t._v(" "),t._m(6)]),t._v(" "),i("div",{staticClass:"box"},[i("label",{staticStyle:{"margin-left":"90px"}},[i("span",{staticStyle:{"vertical-align":"top","padding-top":"10px","margin-right":"17px",width:"150px","text-align":"right"}},[t._v("内容设置")]),t._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.contentSetting,expression:"contentSetting"}],staticStyle:{width:"350px",height:"100px"},attrs:{placeholder:"请输入内容设置",maxlength:"151"},domProps:{value:t.contentSetting},on:{input:function(e){e.target.composing||(t.contentSetting=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"limit"},[t._m(7),t._v(" "),t.msmStatus?i("p",{staticClass:"fl",staticStyle:{"line-height":"18px"}},[t._v("您已输入\n\t\t\t\t"),i("span",[t._v(t._s(t.contentSetting.length))]),t._v("个字,目前发送\n\t\t\t\t"),i("span",[t._v(t._s(Math.ceil(t.contentSetting.length/60)))]),t._v("条短信")]):t._e()]),t._v(" "),i("div",{staticClass:"limit"},[i("p",[t._v("引用参数:\n\t\t\t\t"),t._l(t.parameter,function(e,a){return i("a",{key:a,staticStyle:{color:"#FF9200"},on:{click:function(e){t.addParameter(a,1)}}},[t._v(t._s(e.name))])})],2)])]),t._v(" "),i("div",{staticClass:"box"},[i("label",[i("span",{staticClass:" req required-none",staticStyle:{"vertical-align":"top"}},[t._v("活动说明")]),t._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.explain,expression:"explain"}],staticStyle:{width:"350px",height:"100px"},attrs:{placeholder:"请输入活动说明",maxlength:"151"},domProps:{value:t.explain},on:{input:function(e){e.target.composing||(t.explain=e.target.value)}}})]),t._v(" "),t._m(8)]),t._v(" "),i("div",{staticClass:"box",staticStyle:{"margin-top":"100px","padding-left":"70px"}},[i("a",{staticClass:"gray",staticStyle:{width:"200px"},attrs:{href:"javascript:void(0);"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),i("a",{staticClass:"gray",staticStyle:{width:"200px",background:"#858585"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.birthSave("0")}}},[t._v("保存")]),t._v(" "),i("a",{directives:[{name:"show",rawName:"v-show",value:t.issue,expression:"issue"}],staticClass:"yellow",staticStyle:{width:"200px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){t.birthSave("1")}}},[t._v("发布")])]),t._v(" "),t.showBirthCoupon?i("birthCoupon",{attrs:{selectCoupon:t.selectCoupon,couponList:t.couponList},on:{winEvent:t.winEvent}}):t._e()],1)},n=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"info-title"},[e("span",{staticClass:"title"},[this._v("生日活动")]),this._v(" "),e("span",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"box"},[e("label",[e("span",{staticClass:"required"},[this._v("活动对象")]),this._v(" "),e("span",{staticStyle:{display:"inline-block",width:"200px",height:"40px",background:"#f8f8f8","line-height":"40px","padding-left":"5px"}},[this._v("全体会员")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fl"},[e("i",{staticClass:"sanjiao"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fl"},[e("i",{staticClass:"sanjiao"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"box"},[e("label",[e("span",{staticClass:"required"},[this._v("获得方式")]),this._v(" "),e("span",{staticStyle:{display:"inline-block",width:"200px",height:"40px",background:"#f8f8f8","line-height":"40px","padding-left":"5px",color:""}},[this._v("自动获得")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"info-title"},[e("span",{staticClass:"title"},[this._v("活动通知")]),this._v(" "),e("span",{staticClass:"line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fl handle-tips"},[e("i"),this._v("\n\t\t\t活动发布后将通过该渠道触发会员\n\t\t")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"fl",staticStyle:{"margin-right":"102px","line-height":"18px"}},[e("img",{staticClass:"icon-i",attrs:{src:i("54de")}}),this._v("限150字以内")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"limit"},[e("img",{staticClass:"icon-i",attrs:{src:i("54de")}}),this._v("限150字以内")])}];a._withStripped=!0;var s=i("f6ce"),c=i("bbb9"),l=i("81a2"),o=i("05dd");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(n,s){try{var c=e[n](s),l=c.value}catch(t){return void i(t)}if(!c.done)return Promise.resolve(l).then(function(t){a("next",t)},function(t){a("throw",t)});t(l)}("next")})}}var u=null,h={data:function(){return{showCanMulti:!1,ischain:null,edit:!1,editId:"",actName:"",sel:0,explain:"",totalSel:0,giveNum:"",total:[{text:"不设限制",value:"0"},{text:"设定总数",value:"1"}],digit:!1,dayGiveLimit:"",num:!0,customName:"",customExplain:"",indexCustom:0,customIds:[],customIds1:[],loginTime:!1,member:0,memfilter:"",startAge:"",endAge:"",sexIndex:["0"],phone:"",atimevip:(new Date).getTime(),btimevip:(new Date).getTime(),isedit:!1,iseditShop:!1,isclick:!1,issue:!0,aid:"",buttonList:[{name:"未发布"},{name:"发布中"},{name:"已发布"},{name:"已下架"},{name:"已结束"}],flag:0,change:0,acti:!0,birth:!1,custom:!1,timeLimit:[{name:"永久",value:"1"},{name:"一年",value:"2"},{name:"二年",value:"0"}],highLimit:!1,high:"永久",pushdateNum:"",pushtime:[{name:"8",value:"1"},{name:"9",value:"2"},{name:"10",value:"3"},{name:"14",value:"4"},{name:"15",value:"5"},{name:"16",value:"6"},{name:"17",value:"7"},{name:"18",value:"8"},{name:"21",value:"9"},{name:"22",value:"10"},{name:"23",value:"11"}],pushtimeStauts:!1,pushNum:"8",customList:[{name:"店内"},{name:"会员"}],goodsType:[{name:"微信",id:"1"}],goodsSelect:[],customSelect:[],msmStatus:!1,marketingStatus:!1,atime:(new Date).getTime(),btime:(new Date).getTime(),atime1:(new Date).getTime(),btime1:(new Date).getTime(),activityList:[],pageNum:10,pageTotal:1,pageCount:0,page:1,micShop:!1,micList:[{name:"选择使用"},{name:"强制使用"}],micsel:[],micselimit:[],miCount:[],indexmic:0,radioCount:!0,compareArr:[],activityDetail:{},shopList:[],brandId:null,contentSetting:"",customActivity:"",parameter:[{name:"【会员姓名】",id:"{memberName}"},{name:"【会员生日】",id:"{memberBirthday}"},{name:"【优惠券名称】",id:"{couponName}"},{name:"【优惠券数量】",id:"{couponNum}"},{name:"【活动名称】",id:"{activityName}"}],customParameter:[{name:"【会员姓名】",id:"{memberName}"},{name:"【优惠券名称】",id:"{couponName}"},{name:"【优惠券数量】",id:"{couponNum}"},{name:"【活动名称】",id:"{activityName}"}],showAdd:!1,showBirthCoupon:!1,couponList:[],selectCoupon:[]}},watch:{goodsSelect:function(){-1!=this.goodsSelect.indexOf("2")?this.msmStatus=!0:this.msmStatus=!1},explain:function(){this.explain.length>150&&(this.$store.commit("setWin",{content:"仅限150个字符"}),this.explain=this.explain.substr(0,150))},contentSetting:function(){this.contentSetting.length>150&&(this.$store.commit("setWin",{content:"仅限150个字符"}),this.contentSetting=this.contentSetting.substr(0,150))}},methods:{addParameter:function(t,e){1==e?this.contentSetting+=this.parameter[t].id:this.customActivity+=this.customParameter[t].id},winEvent:function(t){this.showBirthCoupon=!1,"ok"==t.status&&(this.selectCoupon=t.data.select,this.couponList=t.data.list)},selOn:function(t){this.goodsSelect=t},returnAct:function(){this.$router.push("/admin/activity")},addCount:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var i,a,n,s,c,o,r,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.getGetCouponCondition({data:{flag:1}});case 2:for(i=e.sent,a=[],n=!0,s=!1,c=void 0,e.prev=7,o=i[Symbol.iterator]();!(n=(r=o.next()).done);n=!0)7!=(u=r.value).type&&a.push(u);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),s=!0,c=e.t0;case 15:e.prev=15,e.prev=16,!n&&o.return&&o.return();case 18:if(e.prev=18,!s){e.next=21;break}throw c;case 21:return e.finish(18);case 22:return e.finish(15);case 23:t.couponList=a,t.goodsCom=i,t.goodsCom.forEach(function(t){t.num=1}),t.showBirthCoupon=!0;case 27:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22]])}))()},costhighShow:function(t){0==t&&(this.high="永久",this.highestConsume="",this.sel=0),1==t&&(this.high="一年",this.sel=1),2==t&&(this.high="二年",this.sel=2),this.highLimit=!1},showpushList:function(){this.pushtimeStauts=!this.pushtimeStauts},pushutimeShow:function(t){this.pushNum={0:"8",1:"9",2:"10",3:"14",4:"15",5:"16",6:"17",7:"18",8:"21",9:"22",10:"23"}[t],this.highLimit=!1},showhighList:function(){this.highLimit=!this.highLimit},birthSave:function(t){var e=this;return r(regeneratorRuntime.mark(function i(){var a,n,s,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o.a.checkData({isclick:{cond:"$$!==true",pro:"请勿重复保存"},actName:"活动名称未设置",selectCoupon:{cond:"$$.length!=0",pro:"请关联优惠券"},pushdateNum:{reg:/^([0-9]|(1[0-9])|(2[0-9])|(3[0-1]))$/,pro:"请填写推送日期，推送日期必须为0~31的正整数"}},e)){i.next=2;break}return i.abrupt("return",!1);case 2:if(e.edit){i.next=13;break}return a=[],n={couponIds:e.selectCoupon,pushChannel:e.goodsSelect.toString().replace(/,/g,""),msgContent:e.contentSetting},a.push(n),i.next=8,l.a.addActivity({data:{type:0,mouldType:0,name:e.actName,advanceTime:e.pushdateNum+","+e.pushNum,explain:e.explain,objectType:1,shopIds:e.shopList.toString(),limit:e.sel,getType:0,isAuto:t,rule:JSON.stringify(a)}});case 8:e.isclick=!0,s="0"==t?"保存成功":"发布成功",e.$store.commit("setWin",{content:s,callback:function(){e.returnAct(),e.isclick=!1}}),i.next=27;break;case 13:return e.activityDetail.name=e.actName,e.activityDetail.advanceTime=e.pushdateNum+","+e.pushNum,e.activityDetail.explain=e.explain,e.activityDetail.rule[0].couponIds=e.selectCoupon,e.activityDetail.rule[0].msgContent=e.contentSetting,e.activityDetail.rule[0].pushChannel=e.goodsSelect.toString().replace(/,/g,""),e.activityDetail.limit=e.sel,e.activityDetail.rule=c.a.deepCopy(e.activityDetail.rule),e.activityDetail.isAuto=t,i.next=24,l.a.editActivity({data:{activityId:e.editId,data:JSON.stringify(e.activityDetail)}});case 24:e.isclick=!0,r="0"==t?"保存成功":"发布成功",e.$store.commit("setWin",{content:r,callback:function(){e.returnAct(),e.isclick=!1}});case 27:case"end":return i.stop()}},i,e)}))()},cancel:function(){this.returnAct()},getActivityDetail:function(t){var e=this;return r(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,l.a.getActivityDetail({data:{aid:t.id,type:t.type,mouldType:t.mouldType}});case 2:a=i.sent,e.activityDetail=a,e.actName=a.name,e.explain=a.explain,e.pushdateNum=a.advanceTime.split(",")[0],e.pushNum=a.advanceTime.split(",")[1],e.goodsSelect=a.rule[0].pushChannel.length>1?a.rule[0].pushChannel.split("").toString().split(","):a.rule[0].pushChannel.split(","),e.contentSetting=a.rule[0].msgContent,e.goodsIds=JSON.parse(a.rule[0].couponIds),e.miCount=JSON.parse(a.rule[0].couponIds),e.selectCoupon=JSON.parse(a.rule[0].couponIds),e.sel=a.limit,e.edit=!0,0==e.sel?e.high="永久":1==e.sel?e.high="一年":e.high="二年",e.issue=!1;case 17:case"end":return i.stop()}},i,e)}))()}},beforeCreate:function(){u=s.a.session("userShop").currentShop},components:{mulSelect:function(){return i.e("mul_select").then(i.bind(null,"7d09"))},birthCoupon:function(){return i.e("activity_birth_coupon").then(i.bind(null,"60f1"))}},mounted:function(){var t=this;this.$store.commit("setPageTools",[{name:"<返回活动列表",className:["activity"],fn:function(){t.returnAct()}}]),this.ischain=this.brandId=u.ischain;var e=s.a.session("activityInfo");e&&(this.editId=e.id,this.getActivityDetail(e))},beforeDestroy:function(){s.a.session("activityInfo",null)}},m=(i("03aa"),i("7610")),p=Object(m.a)(h,a,n,!1,null,"c6a67cfa",null);p.options.__file="src\\module\\marketing_tools\\activity_birth.vue";e.default=p.exports}}]);