(window.webpackJsonp=window.webpackJsonp||[]).push([["operation"],{"616f":function(e,t,a){},"6c7a":function(e,t,a){"use strict";a.r(t);var r=a("81a2"),n=a("f6ce"),i=a("bbb9");function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function r(n,i){try{var s=t[n](i),o=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(o).then(function(e){r("next",e)},function(e){r("throw",e)});e(o)}("next")})}}var o={data:function(){return{isShop:"",startTime:(new Date).setHours(0,0,0,0),endTime:(new Date).setHours(23,59,59,0),allType:["全部类型","修改仓库","删除仓库","添加仓库"],typeId:"",typeIndex:0,warehouseName:"",warehouseOwner:[],warehouseOwnerName:"全部",warehouseOwnerId:"",warehouseOperator:"",shopType:"",typeNameArr:[],ownerArr:[],warehouseContent:[],page:1,num:10,total:1,totalPage:0,titleList:[{titleName:"操作",titleStyle:{width:"150px"}},{titleName:"序号",titleStyle:{width:"150px"}},{titleName:"操作类型",dataName:"type"},{titleName:"仓库名称",dataName:"warehouse"},{titleName:"仓库所属",dataName:"ownerShop"},{titleName:"操作时间",dataName:"createTime"},{titleName:"操作人",dataName:"createUser"}]}},methods:{pageClick:function(e){this.num=e.num,this.page=e.page,this.search()},getTypeName:function(e){this.typeId=e>0?e:"",this.typeIndex=e},getStartTime:function(e){this.startTime=new Date(e).setHours(0,0,0,0)},getEndTime:function(e){this.endTime=new Date(e).setHours(23,59,59,0)},search:function(){var e=this;return s(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.startTime>e.endTime)){t.next=3;break}return e.$store.commit("setWin",{title:"操作提示",content:"开始时间不能大于结束时间"}),t.abrupt("return");case 3:return t.next=5,r.a.getOperationSearch({data:{startTime:parseInt(e.startTime/1e3),endTime:parseInt(e.endTime/1e3),type:e.typeId,createUser:e.warehouseOperator,shopType:e.isShop,warehouse:e.warehouseName,ownerId:e.ownerArr,page:e.page,pageSize:e.num}});case 5:a=t.sent,e.warehouseContent=a.list,e.total=a.allPage,e.totalPage=a.pageSize;case 9:case"end":return t.stop()}},t,e)}))()},resetSearch:function(){this.startTime=(new Date).setHours(0,0,0,0),this.endTime=(new Date).setHours(23,59,59,999),this.typeIndex=0,this.typeId="",this.warehouseName="",this.initOwner(),this.page=1,this.num=10,this.search()},warehouseDetail:function(e){e.startTime=this.startTime,e.endTime=this.endTime,n.a.session("warehouseOperationDetail",e.data),this.$router.push({path:"/admin/warehouseList/warehouseOperationDetail",query:this.$route.query})},selectWarehouseOwner:function(){var e=this;return s(regeneratorRuntime.mark(function t(){var a,n,i,s,o,u,l,c,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.invoicing_getOwners();case 2:if(a=t.sent,n=[],!a){t.next=24;break}for(i=!0,s=!1,o=void 0,t.prev=8,u=a[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)c=l.value,h={selected:!0},3==c.ischain?(h.id=c.brandId+",0",h.name=c.brandName):c.brandId?(h.id=c.brandId+","+c.shopId,h.name=c.brandName+"-"+c.shopName):(h.id="0,"+c.shopId,h.name=c.shopName),n.push(h);t.next=16;break;case 12:t.prev=12,t.t0=t.catch(8),s=!0,o=t.t0;case 16:t.prev=16,t.prev=17,!i&&u.return&&u.return();case 19:if(t.prev=19,!s){t.next=22;break}throw o;case 22:return t.finish(19);case 23:return t.finish(16);case 24:e.owner=n,e.initOwner(),e.search();case 27:case"end":return t.stop()}},t,e,[[8,12,16,24],[17,,19,23]])}))()},initOwner:function(){var e=[],t=[];if(this.owner){var a=!0,r=!1,n=void 0;try{for(var i,s=this.owner[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var o=i.value;e.push(o.id),this.ownerArr=JSON.stringify(e);var u={id:o.id,name:o.name,selected:!0};t.push(u)}}catch(e){r=!0,n=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw n}}}this.typeNameArr=t},getWarehouseOwnerName:function(e){var t=[];e.forEach(function(e){1==e.selected&&t.push(e.id)}),this.ownerArr=JSON.stringify(t)},timeConversion:function(e){return i.a.format(new Date(Number(1e3*e)),"yyyy-MM-dd hh:mm:ss")}},mounted:function(){var e=n.a.session("userShop");this.isShop="3"!=e.currentShop.ischain?"0":"1",this.selectWarehouseOwner()},components:{calendar:function(){return a.e("calendar_type").then(a.bind(null,"f2dd"))},selectstore:function(){return a.e("select_store").then(a.bind(null,"cb83"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},pageElement:function(){return a.e("page_element").then(a.bind(null,"5921"))},tableCom:function(){return a.e("table").then(a.bind(null,"4360"))}}},u=(a("c57f"),a("d801")),l=Object(u.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"chooseTime"},[a("div",{staticClass:"oprationTime"},[e._v("操作时间：")]),e._v(" "),a("section",{staticClass:"fl chairFix"},[a("section",{staticClass:"box"},[a("calendar",{staticClass:"calendarTime",attrs:{time:e.startTime,format:"yyyy年MM月dd日"},on:{emit:e.getStartTime}})],1),e._v(" "),a("span",[e._v("-")]),e._v(" "),a("section",{staticClass:"box"},[a("section",{staticClass:"fl"},[a("calendar",{staticClass:"calendarTime",attrs:{time:e.endTime,format:"yyyy年MM月dd日"},on:{emit:e.getEndTime}})],1),e._v(" "),a("span",{staticClass:"order-order-searchA"},[a("span",{staticClass:"order-order-search",attrs:{href:"javascript:void(0)"},on:{click:e.search}})])])])]),e._v(" "),a("div",[a("div",{staticClass:"block-box"},[a("selectBtn",{staticClass:"inline-box",attrs:{sorts:e.allType,index:e.typeIndex},on:{emit:e.getTypeName}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.warehouseName,expression:"warehouseName"}],staticClass:"receipt inline-box",attrs:{type:"text",placeholder:"请输入仓库名称"},domProps:{value:e.warehouseName},on:{input:function(t){t.target.composing||(e.warehouseName=t.target.value)}}})],1),e._v(" "),a("div",{staticClass:"block-box"},[a("div",{staticClass:"inline-box"},[a("span",[e._v("仓库所属：")]),e._v(" "),a("selectstore",{attrs:{sorts:e.typeNameArr,tipName:e.warehouseOwnerName,isConfirm:!0},on:{emit:e.getWarehouseOwnerName}})],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.warehouseOperator,expression:"warehouseOperator"}],staticClass:"operator inline-box",attrs:{type:"text",placeholder:"请输入操作人"},domProps:{value:e.warehouseOperator},on:{input:function(t){t.target.composing||(e.warehouseOperator=t.target.value)}}}),e._v(" "),a("div",{staticClass:"inline-box"},[a("a",{staticClass:"blue buttonBox",attrs:{href:"javascript:void(0);"},on:{click:e.search}},[e._v("筛选")]),e._v(" "),a("a",{staticClass:"gray buttonBox",attrs:{href:"javascript:void(0);"},on:{click:e.resetSearch}},[e._v("重置")])])])]),e._v(" "),a("tableCom",{attrs:{listHeight:60,listName:"仓库操作",introData:e.warehouseContent,titleData:e.titleList,allTotal:e.totalPage,listWidth:1200,fixed:1},scopedSlots:e._u([{key:"con-0",fn:function(t){return a("div",{staticStyle:{color:"#29abe2",cursor:"pointer"},on:{click:function(a){e.warehouseDetail(t)}}},[e._v("查看详情")])}},{key:"con-1",fn:function(t){return a("div",{},[e._v(e._s(t.index+1))])}}])}),e._v(" "),a("pageElement",{attrs:{page:e.page,total:e.total,num:e.num,isNoJump:!0},on:{pageNum:e.pageClick}})],1)},[],!1,null,"5add4a64",null);t.default=l.exports},"7f99":function(e,t,a){"use strict";var r=a("616f");a.n(r).a},b372:function(e,t,a){},bee6:function(e,t,a){"use strict";a.r(t);var r=a("81a2"),n=a("f6ce"),i=a("bbb9");function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function r(n,i){try{var s=t[n](i),o=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(o).then(function(e){r("next",e)},function(e){r("throw",e)});e(o)}("next")})}}var o={data:function(){return{isShop:"",uid:"",timeDate:[new Date(Date.parse(new Date)-2592e6),new Date],startTime:(new Date).setHours(0,0,0,0)-2592e6,endTime:(new Date).setHours(23,59,59,0),receiptNumber:"",createName:"",allStatus:[{value:0,label:"全部调度状态"},{value:1,label:"未出货"},{value:2,label:"待入货"},{value:3,label:"调度中"},{value:4,label:"已取消"},{value:5,label:"已完成"},{value:6,label:"已完成(异常)"}],dynamic:0,OutboundWarehouse:"全部",allWarehouse:[],allWarehouseId:"",allWarehouseData:[],outWarehouse:"",intoWarehouse:"",dispatchingRecord:[],page:1,num:10,total:1,count:0,titleList:[{titleName:"操作",titleStyle:{width:"160px"}},{titleName:"调度状态",titleStyle:{width:"150px"},dataName:"dispatchingRecordType"},{titleName:"调度单号",dataName:"receiptNumber"},{titleName:"出货仓库",dataName:"outWname"},{titleName:"入货仓库",dataName:"intoWname"},{titleName:"操作时间"},{titleName:"操作人",dataName:"createName"}],outWareIndex:0,intoWareIndex:0,disType:1,requestObj:{}}},components:{calendar:function(){return a.e("calendar_type").then(a.bind(null,"f2dd"))},selectStore:function(){return a.e("select_store").then(a.bind(null,"cb83"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},pageElement:function(){return a.e("page_element").then(a.bind(null,"5921"))},tableCom:function(){return a.e("table").then(a.bind(null,"4360"))}},mounted:function(){this.initBtn(),this.getSaveRequest();var e=n.a.session("userShop");this.isShop="3"!=e.currentShop.ischain?"0":"1",this.uid=e.user.id,this.getWarehouse(),this.selectWarehouseOwner()},methods:{initBtn:function(){var e=this,t=[{name:"快速调度",className:"primary",type:5,fn:function(){e.$router.push({path:"warehouseList/outputStore",query:e.$route.query})}}];this.$store.commit("setPageTools",t)},searchClick:function(){this.page=1,this.search()},pageClick:function(e,t){this.allWarehouseData.length&&(t?this.page=e:this.num=e,this.search())},getStatus:function(e){this.dynamic=e},getOutId:function(e){this.outWarehouse=e},getIntoId:function(e){this.intoWarehouse=res},getWarehouse:function(){var e=this;return s(regeneratorRuntime.mark(function t(){var a,n,i,s,o,u,l,c,h,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.warehouseList({data:{}});case 2:for(a=t.sent,e.allWarehouseData=a,n=[],i=[],s=!0,o=!1,u=void 0,t.prev=8,l=a[Symbol.iterator]();!(s=(c=l.next()).done);s=!0)h=c.value,p={label:h.name,value:h.id},n.push(p),i.push(h.id);t.next=16;break;case 12:t.prev=12,t.t0=t.catch(8),o=!0,u=t.t0;case 16:t.prev=16,t.prev=17,!s&&l.return&&l.return();case 19:if(t.prev=19,!o){t.next=22;break}throw u;case 22:return t.finish(19);case 23:return t.finish(16);case 24:e.allWarehouse=n,e.allWarehouseId=i,e.resWareId(),e.totalList=a.length,e.search();case 29:case"end":return t.stop()}},t,e,[[8,12,16,24],[17,,19,23]])}))()},resWareId:function(){this.intoWarehouse=this.allWarehouseId,this.outWarehouse=this.allWarehouseId},timeChange:function(e){this.startTime=new Date(e[0]).setHours(0,0,0,0),this.endTime=new Date(e[1]).setHours(23,59,59,0)},myAlert:function(e){this.$store.commit("setWin",{title:"操作提示",content:e})},search:function(){var e=this;return s(regeneratorRuntime.mark(function t(){var a,n,i,s,o,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.allWarehouseData.length){t.next=3;break}return e.myAlert("您还没有仓库，请先新建仓库"),t.abrupt("return");case 3:if(!(e.startTime>e.endTime)){t.next=6;break}return e.myAlert("开始时间不能大于结束时间"),t.abrupt("return");case 6:if(e.outWarehouse.length){t.next=9;break}return e.myAlert("请选择出货仓库"),t.abrupt("return");case 9:if(e.intoWarehouse.length){t.next=12;break}return e.myAlert("请选择入货仓库"),t.abrupt("return");case 12:return e.requestObj={startTime:parseInt(e.startTime/1e3),endTime:parseInt(e.endTime/1e3),dynamic:e.dynamic,receiptNumber:e.receiptNumber,createName:e.createName,outWarehouse:e.outWarehouse.join(","),intoWarehouse:e.intoWarehouse.join(","),page:e.page,num:e.num},t.next=15,r.a.getDispatchRecordList({data:e.requestObj});case 15:for(a=t.sent,e.dispatchingRecord=a.list,n=!0,i=!1,s=void 0,t.prev=20,o=e.dispatchingRecord[Symbol.iterator]();!(n=(u=o.next()).done);n=!0)(l=u.value).dispatchingRecordType=e.allStatus[Number(l.dynamic)].label;t.next=28;break;case 24:t.prev=24,t.t0=t.catch(20),i=!0,s=t.t0;case 28:t.prev=28,t.prev=29,!n&&o.return&&o.return();case 31:if(t.prev=31,!i){t.next=34;break}throw s;case 34:return t.finish(31);case 35:return t.finish(28);case 36:e.total=a.totalPage,e.count=Number(a.count);case 38:case"end":return t.stop()}},t,e,[[20,24,28,36],[29,,31,35]])}))()},resWareArr:function(){var e=i.a.deepCopy(this.allWarehouse),t=!0,a=!1,r=void 0;try{for(var n,s=this.allWarehouse[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){n.value.selected=!0}}catch(e){a=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw r}}this.allWarehouse=e},resetSearch:function(){this.startTime=(new Date).setHours(0,0,0,0)-2592e6,this.endTime=(new Date).setHours(23,59,59,999),this.timeDate=[new Date(Date.parse(new Date)-2592e6),new Date],this.dynamic=0,this.receiptNumber="",this.createName="",this.resWareArr(),this.resWareId(),this.page=1,this.num=10,this.search()},dispatchingDetail:function(e,t){var a=e;this.$route.query.id=a.id,1==t?(n.a.session("operationRequest",this.requestObj),this.$route.query.id=a.id,this.$router.push({path:"/admin/operation/operationDetail",query:this.$route.query})):(n.a.session("operationRequest",this.requestObj),this.$router.push({path:"/admin/operation/enterGoods",query:this.$route.query}))},getSaveRequest:function(){if(n.a.session("operationRequestDestroy")){for(var e in this.requestObj=n.a.session("operationRequest"),this.requestObj)this[e]="startTime"==e||"endTime"==e?1e3*this.requestObj[e]:this.requestObj[e];n.a.session("operationRequestDestroy",null),n.a.session("operationRequest",null)}},confirmMethod:function(e){var t=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:"是否确认出货？",ok:{content:"是"},cancel:{content:"否"},callback:function(a){"ok"==a&&t.confirmShipment(e)}})},confirmShipment:function(e){var t=this;return s(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.DispatchrecordConfirmShipment({data:{id:e,uid:t.uid}});case 2:a.sent&&t.search();case 4:case"end":return a.stop()}},a,t)}))()},selectWarehouseOwner:function(){var e=this;return s(regeneratorRuntime.mark(function t(){var a,n,i,s,o,u,l,c,h,p,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.invoicing_getOwners();case 2:if(a=t.sent,n=[],!a){t.next=24;break}for(i=!0,s=!1,o=void 0,t.prev=8,u=a[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)c=l.value,h={selected:!0},3==c.ischain?(h.id=c.brandId+",0",h.name=c.brandName):c.brandId?(h.id=c.brandId+","+c.shopId,h.name=c.brandName+"-"+c.shopName):(h.id="0,"+c.shopId,h.name=c.shopName),n.push(h);t.next=16;break;case 12:t.prev=12,t.t0=t.catch(8),s=!0,o=t.t0;case 16:t.prev=16,t.prev=17,!i&&u.return&&u.return();case 19:if(t.prev=19,!s){t.next=22;break}throw o;case 22:return t.finish(19);case 23:return t.finish(16);case 24:e.owner=n,p=[],d=[],e.owner&&e.owner.forEach(function(t){d.push(t.id),e.ownerArr=JSON.stringify(d);var a={id:t.id,name:t.name,selected:!0};p.push(a)}),e.typeNameArr=p;case 29:case"end":return t.stop()}},t,e,[[8,12,16,24],[17,,19,23]])}))()},timeConversion:function(e){return i.a.format(new Date(Number(1e3*e)),"yyyy-MM-dd hh:mm:ss")}}},u=(a("7f99"),a("d801")),l=Object(u.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operation"},[a("div",{staticClass:"chooseTime"},[a("div",{staticClass:"oprationTime"},[e._v("操作时间：")]),e._v(" "),a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:!1},on:{change:e.timeChange},model:{value:e.timeDate,callback:function(t){e.timeDate=t},expression:"timeDate"}})],1),e._v(" "),a("div",[a("div",{staticClass:"block-box"},[a("div",{staticClass:"inline-box"},[a("el-select",{attrs:{placeholder:"请选择调度状态"},on:{change:e.getStatus},model:{value:e.dynamic,callback:function(t){e.dynamic=t},expression:"dynamic"}},e._l(e.allStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("el-input",{attrs:{placeholder:"请输入调度单号"},model:{value:e.receiptNumber,callback:function(t){e.receiptNumber=t},expression:"receiptNumber"}})],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("el-input",{attrs:{placeholder:"请输入操作人"},model:{value:e.createName,callback:function(t){e.createName=t},expression:"createName"}})],1)]),e._v(" "),a("div",{staticClass:"block-box"},[a("div",{staticClass:"inline-box"},[a("span",[e._v("出货仓库：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择仓库",multiple:"","collapse-tags":""},on:{change:e.getOutId},model:{value:e.outWarehouse,callback:function(t){e.outWarehouse=t},expression:"outWarehouse"}},e._l(e.allWarehouse,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("span",[e._v("入货仓库：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择仓库",multiple:"","collapse-tags":""},on:{change:e.getIntoId},model:{value:e.intoWarehouse,callback:function(t){e.intoWarehouse=t},expression:"intoWarehouse"}},e._l(e.allWarehouse,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"inline-box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.searchClick}},[e._v("筛选")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.resetSearch}},[e._v("重置")])],1)])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dispatchingRecord,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"dispatchingRecordType",label:"调度状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"receiptNumber",label:"调度单号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"outWname",label:"出货仓库"}}),e._v(" "),a("el-table-column",{attrs:{prop:"intoWname",label:"入货仓库"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t        \t"+e._s(e.timeConversion(t.row.createTime))+"\n\t\t      \t")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createName",label:"操作人"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!=t.row.dynamic?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.dispatchingDetail(t.row,1)}}},[e._v("查看详情")]):e._e(),e._v(" "),2==t.row.dynamic?a("el-button",{staticStyle:{color:"#D34A2B"},attrs:{type:"text",size:"small"},on:{click:function(a){e.dispatchingDetail(t.row,2)}}},[e._v("入货")]):e._e(),e._v(" "),1==t.row.dynamic?a("el-button",{staticStyle:{color:"#D34A2B"},attrs:{type:"text",size:"small"},on:{click:function(a){e.dispatchingDetail(t.row,1)}}},[e._v("确认出货")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"page-box"},[a("el-pagination",{attrs:{"current-page":e.page,background:"",layout:"sizes,total,prev, pager, next","page-sizes":[10,20,50],total:e.count},on:{"current-change":function(t){e.pageClick(t,1)},"size-change":e.pageClick}})],1)],1)},[],!1,null,"126e75e2",null);t.default=l.exports},c57f:function(e,t,a){"use strict";var r=a("b372");a.n(r).a}}]);