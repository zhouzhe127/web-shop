(window.webpackJsonp=window.webpackJsonp||[]).push([["table_manage"],{5852:function(t,e,a){},"5a64":function(t,e,a){"use strict";a.r(e);var n=a("81a2"),i=a("f6ce"),r=a("bbb9"),s=a("05dd");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function n(i,r){try{var s=e[i](r),o=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}("next")})}}var l={data:function(){return{host:s.a.host.shop,Area:[],tableList:[],userData:Object,isAdd:!0,showWin:!1,tableId:"",tableDetial:null,num:10,total:0,page:1,showTableList:[]}},created:function(){var t=this,e=[{name:"新建桌台",className:"pick",fn:function(){t.add()}}];this.$store.commit("setPageTools",e),this.userData=i.a.session("userShop"),this.init(),this.getArea()},methods:{del:function(t){var e=this;this.$store.commit("setWin",{title:"操作提示",winType:"confirm",content:"确定删除桌台"+t.tableName+"?",callback:function(a){"ok"==a&&e.deleteTable(t)}})},deleteTable:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.a.deleteTable({data:{shopId:e.userData.currentShop.id,id:t.id}});case 2:if(!a.sent){a.next=13;break}i=0;case 5:if(!(i<e.tableList.length)){a.next=12;break}if(e.tableList[i].id!=t.id){a.next=9;break}return e.tableList.splice(i,1),a.abrupt("break",12);case 9:i++,a.next=5;break;case 12:e.paging();case 13:case"end":return a.stop()}},a,e)}))()},paging:function(){this.total=Math.ceil(this.tableList.length/this.num),this.showTableList=this.tableList.slice((this.page-1)*this.num,(this.page-1)*this.num+this.num)},numChange:function(t){this.num=t,this.paging()},pageClick:function(t){this.page=t,this.paging()},init:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.getTableList({data:{shopId:t.userData.currentShop.id}});case 2:(a=e.sent)&&(t.tableList=a,t.sortList(),t.paging());case 4:case"end":return e.stop()}},e,t)}))()},getArea:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.getArea({data:{shopId:t.userData.currentShop.id}});case 2:(a=e.sent)&&(t.Area=a);case 4:case"end":return e.stop()}},e,t)}))()},add:function(){this.isAdd=!0,this.showWin=!0},edit:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:console.log(t),e.isAdd=!1,e.tableId=t.id,e.tableDetial=r.a.deepCopy(t),e.tableDetial.id=e.tableDetial.id+"",e.showWin=!0;case 6:case"end":return a.stop()}},a,e)}))()},doThrowWinResult:function(t,e){if(console.log(e),"ok"==t){if(this.isAdd)for(var a=0;a<e.length;a++)this.tableList.push(e[a]);else for(var n=0;n<this.tableList.length;n++)if(this.tableList[n].id==this.tableId){this.tableList.splice(n,1,e);break}this.sortList(),this.paging(),this.showWin=!1}else if("cancel"==t){if(!this.isAdd){for(var i=0;i<this.tableList.length;i++)if(this.tableList[i].id==e){this.tableList.splice(i,1);break}this.paging()}this.showWin=!1}else"close"==t&&(this.showWin=!1)},sortList:function(){this.tableList=r.a.sortByAll(this.tableList,["sort","id"],!0)}},components:{tableWin:function(){return a.e("table_manage_win").then(a.bind(null,"9503"))}}},c=(a("b38c"),a("d801")),u=Object(c.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"table-show"}},[a("section",[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"20px"},attrs:{stripe:"","header-cell-style":{"background-color":"#f5f7fa"},data:t.showTableList,border:""}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#FE8D2C",cursor:"pointer"},on:{click:function(a){t.edit(e.row)}}},[t._v("编辑")]),t._v(" "),a("span",{staticStyle:{padding:"0 5px",color:"#D2D2D2"}},[t._v("|")]),t._v(" "),a("span",{staticStyle:{color:"#FD3F1F",cursor:"pointer"},on:{click:function(a){t.del(e.row)}}},[t._v("删除")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"80",align:"center",prop:"sort",label:"排序"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"tableName",label:"桌台名称"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"120",align:"center",prop:"areaName",label:"区域名称"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"80",align:"center",prop:"normalSeat",label:"默认席位"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"80",align:"center",prop:"minSeat",label:"最少容纳(位)"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"80",align:"center",prop:"maxSeat",label:"最多容纳(位)"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"80",align:"center",label:"二维码"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"table-code"},[a("a",{attrs:{href:t.host+"table/createTableCode?format=json&tableId="+e.row.id+"&shopId="+t.userData.currentShop.id+"&areaName="+e.row.areaName+"&tableName="+e.row.tableName+"&token="+t.userData.accessToken}})])]}}])})],1)],1),t._v(" "),a("section",{staticStyle:{"margin-top":"10px"}},[a("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.num,layout:"sizes, prev, pager, next","page-count":t.total,"page-sizes":[10,20,30]},on:{"size-change":t.numChange,"current-change":t.pageClick}})],1),t._v(" "),t.showWin?a("tableWin",{attrs:{isAdd:t.isAdd,tableId:t.tableId,userData:t.userData,tableDetial:t.tableDetial,Area:t.Area},on:{throwWinResult:t.doThrowWinResult}}):t._e()],1)},[],!1,null,"0e1c688c",null);e.default=u.exports},b38c:function(t,e,a){"use strict";var n=a("5852");a.n(n).a}}]);