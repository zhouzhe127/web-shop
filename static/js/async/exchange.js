(window.webpackJsonp=window.webpackJsonp||[]).push([["exchange"],{6539:function(t,e,s){"use strict";var a=s("7916");s.n(a).a},"6cf9":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"user"}},[s("div",{staticClass:"firstFun"},[s("div",{staticClass:"firstTitle fl",staticStyle:{width:"450px"}},[s("p",{staticClass:"fl"},[t._v("状态：")]),t._v(" "),t._l(t.statusList,function(e,a){return s("span",{key:a,staticClass:"fl mar",class:{ons:1==e.status},on:{click:function(s){t.staTooge(e.id)}}},[t._v(t._s(e.name))])})],2)]),t._v(" "),s("div",{staticClass:"integralInfo"},[s("span",{staticClass:"fl"},[t._v("已消费："+t._s(t.usedNum)+"份")]),t._v(" "),s("span",{staticClass:"fl"},[t._v("未消费："+t._s(t.useNum)+"份")])]),t._v(" "),s("com-table",{attrs:{listHeight:80,showHand:!1,showTitle:2,listWidth:1400,introData:t.useLists,titleData:t.titleList},scopedSlots:t._u([{key:"con-2",fn:function(e){return s("div",{staticClass:"imgshow"},[s("img",{attrs:{src:t.imgHost+e.data.gimage}})])}},{key:"con-10",fn:function(e){return s("div",{staticClass:"imgshow"},[t._v("\n        \t\t"+t._s(t.getshopName(e.data.shopId))+"\n        \t")])}},{key:"con-11",fn:function(e){return s("div",{staticClass:"imgshow"},[t._v("\n        \t\t"+t._s(t.staffList[e.data.updateUid])+"\n        \t")])}}])}),t._v(" "),t.total>1?s("page",{staticStyle:{float:"left","margin-bottom":"100px"},attrs:{page:t.pages,total:t.total,isNoJump:!0,isNoPaging:!0},on:{pageNum:t.getListByShopId,"update:page":function(e){t.pages=e},"update:total":function(e){t.total=e}}}):t._e(),t._v(" "),t.isWin?s("changewin",{on:{getWin:t.code}}):t._e()],1)};a._withStripped=!0;var i=s("81a2"),n=s("bbb9"),o=s("f6ce");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,s){return function a(i,n){try{var o=e[i](n),r=o.value}catch(t){return void s(t)}if(!o.done)return Promise.resolve(r).then(function(t){a("next",t)},function(t){a("throw",t)});t(r)}("next")})}}var u={data:function(){return{useLists:[],useInitial:[],useNum:null,usedNum:null,total:null,pages:1,len:null,statusList:[{id:"1",name:"全部",status:"1"},{id:"2",name:"未消费",status:"0"},{id:"3",name:"已消费",status:"0"}],types:"all",exportUrl:"",isWin:!1,titleList:[{titleName:"序号",titleStyle:{width:"100px",flex:"none"},dataName:"id"},{titleName:"商品名称",dataName:"gname"},{titleName:"展示图片"},{titleName:"创建时间",dataName:"createTime"},{titleName:"消费时间",dataName:"updateTime"},{titleName:"兑换积分",dataName:"point"},{titleName:"兑换金额",dataName:"price"},{titleName:"兑换人",dataName:"mname"},{titleName:"状态",dataName:"state"},{titleName:"劵码",dataName:"code"},{titleName:"领取门店",dataName:"code"},{titleName:"核销人",dataName:"code"}],allTotal:0,staffList:{},shopsList:[]}},props:["ischain","imgHost","shopId"],mounted:function(){this.userShop=o.a.session("userShop"),this.currentShop=this.userShop.currentShop,this.getListByShopId({page:this.pages}),"1"!=this.ischain&&"2"!=this.ischain&&this.initBtn(),this.getShopList()},methods:{initBtn:function(){var t=this,e={openCode:function(){t.openCodeWin()},leadOut:function(){t.changeExport()}};this.$store.commit("setPageTools",e)},getListByShopId:function(t){var e=this;return r(regeneratorRuntime.mark(function s(){var a,o,r;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e.pages=t.page,s.next=3,i.a.getListByShopId({data:{page:e.pages,num:10,type:e.types}});case 3:for(a=s.sent,e.useNum=a.numList.useNum,e.usedNum=a.numList.usedNum,e.useLists=a.list,e.staffList=a.staffList,e.total=a.total,e.total<10?e.len=e.total:e.len=10,o=e.useLists,r=0;r<o.length;r++)"0"!=o[r].createTime&&(o[r].createTime=n.a.getTime({time:o[r].createTime,type:!0,format:"yyyy.MM.dd"}).format,o[r].state=0==o[r].status?"未消费":"已消费"),1==o[r].status&&"0"!=o[r].updateTime&&(o[r].updateTime=n.a.getTime({time:o[r].updateTime,type:!0,format:"yyyy.MM.dd"}).format);e.useInitial=n.a.deepCopy(e.useLists);case 13:case"end":return s.stop()}},s,e)}))()},changeExport:function(){var t=this;return r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.changeExport({data:{shopId:t.shopId}});case 2:case"end":return e.stop()}},e,t)}))()},openCodeWin:function(){this.isWin=!0},staTooge:function(t){var e=void 0;for(e=0;e<this.statusList.length;e++)this.statusList[e].status="0",this.statusList[e].id==t&&(this.statusList[e].status="1");this.pages=1,2==t?(this.types="use",this.getListByShopId({page:1})):3==t?(this.types="used",this.getListByShopId({page:1})):(this.types="all",this.getListByShopId({page:1}))},verifyCode:function(t){var e=this;return r(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,i.a.verifyCode({data:{code:t}});case 2:e.getListByShopId({page:e.pages});case 3:case"end":return s.stop()}},s,e)}))()},code:function(t,e){"ok"==t&&this.verifyCode(e),this.isWin=!1},getShopList:function(){if("3"==this.ischain){this.shopsList=o.a.session("shopList");var t=!0,e=!1,s=void 0;try{for(var a,i=this.shopsList[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var n=a.value;n.name=n.shopName}}catch(t){e=!0,s=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw s}}}else this.shopsList.push(o.a.session("userShop").currentShop)},getshopName:function(t){var e="所有门店",s=!0,a=!1,i=void 0;try{for(var n,o=this.shopsList[Symbol.iterator]();!(s=(n=o.next()).done);s=!0){var r=n.value;r.id==t&&(e=r.name?r.name:r.shopName)}}catch(t){a=!0,i=t}finally{try{!s&&o.return&&o.return()}finally{if(a)throw i}}return e}},components:{page:function(){return s.e("page_element").then(s.bind(null,"5921"))},changewin:function(){return s.e("exchange_win").then(s.bind(null,"6dbd"))},comTable:function(){return s.e("table").then(s.bind(null,"4360"))}},destroyed:function(){this.$store.commit("setPageTools",{})}},c=(s("6539"),s("6ceb")),l=Object(c.a)(u,a,[],!1,null,"67b631e2",null);l.options.__file="src\\module\\marketing_tools\\integral\\exchange.vue";e.default=l.exports},7916:function(t,e,s){}}]);