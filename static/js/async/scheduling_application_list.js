(window.webpackJsonp=window.webpackJsonp||[]).push([["scheduling_application_list"],{"0109":function(t,e,a){"use strict";a.r(e);var i=a("cd48"),n=a("81a2"),s=(a("bbb9"),a("f6ce")),r=a("05dd"),u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t};function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,s){try{var r=e[n](s),u=r.value}catch(t){return void a(t)}if(!r.done)return Promise.resolve(u).then(function(t){i("next",t)},function(t){i("throw",t)});t(u)}("next")})}}var l={data:function(){return{titleData:[{titleName:"操作"},{titleName:"序号"},{titleName:"操作类型",dataName:"opeartionType"},{titleName:"审核状态",dataName:"auditStatusType"},{titleName:"调度状态",dataName:"dispatchType"},{titleName:"申请单号",dataName:"code"},{titleName:"申请人",dataName:"createName"},{titleName:"申请时间",dataName:"submitTime"},{titleName:"入货仓库",dataName:"wName"}],pageObj:{page:1,total:0,num:10,listNum:0},startTime:{time:"",show:!0,detail:!0,width:160},endTime:{time:"",show:!0,detail:!0,width:160},applicationType:[{id:"1",name:"入货申请"},{id:"2",name:"出货申请"}],auditStatus:[{id:1,name:"审核中"},{id:2,name:"已取消"},{id:3,name:"审核未通过"},{id:4,name:"审核通过"}],dispatchStatus:[{id:1,name:"未调度"},{id:2,name:"调度中"},{id:3,name:"未出货"},{id:4,name:"全部取消"},{id:5,name:"待入货"},{id:6,name:"已完成"},{id:7,name:"已完成（异常)"},{id:8,name:"配货完成"}],warehouseList:[],applicationList:[],subObj:{},toggle:!0,showCom:"",isBrand:"",shopId:"",brandId:!1}},methods:u({},Object(i.b)(["setWin","setPageTools"]),{getTime:function(t,e){this[t].time=e},clickBtn:function(t,e){var a=this;return o(regeneratorRuntime.mark(function i(){var n,s,r,u,o,l;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if("filter"!=t){i.next=16;break}return e&&(a.pageObj.page=1),n=a.getSubObj(),i.next=5,a.getHttp("dispatchSearchApplications",n);case 5:s=i.sent,r=s.list,u=void 0===r?[]:r,o=s.rows,l=void 0===o?0:o,u.forEach(function(t,e){t.opeartionType=a.itera(a.applicationType,t.type),t.auditStatusType=a.itera(a.auditStatus,t.auditStatus),t.dispatchType=a.itera(a.dispatchStatus,t.dispatchStatus),t.submitTime=a.transFormTime(t.createTime);var i=(a.pageObj.page-1)*a.pageObj.num+e+1;t.itemIndex=i>=10?i:"0"+i}),a.applicationList=u,a.pageObj.listNum=l,a.pageObj.total=Math.ceil(a.pageObj.listNum/a.pageObj.num),i.next=18;break;case 16:a.resetData(),a.clickBtn("filter",null);case 18:case"end":return i.stop()}},i,a)}))()},getSubObj:function(){var t={page:this.pageObj.page,num:this.pageObj.num,applyStartTime:parseInt(this.startTime.time/1e3),applyEndTime:parseInt(this.endTime.time/1e3),auditTimeStart:"",auditTimeEnd:"",isAuditor:"",auditor:""},e=!0,a=!1,i=void 0;try{for(var n,s=["type","isAuditor","auditStatus","dispatchStatus","wid","uName","code"][Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;t[r]=this.subObj[r]}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}return t},getPageNum:function(t){this.pageObj.page=t.page,this.pageObj.num=t.num,this.pageObj.total=Math.ceil(this.pageObj.listNum/this.pageObj.num),this.clickBtn("filter",null)},chanageRouter:function(t){var e=this.$route.query;e.id=t.id,e.auditStatus=t.auditStatus,this.$router.push({path:"schedulingApplication/purchaseRequisitionDetail",query:e})},initBtn:function(){var t=this;this.setPageTools([{name:"申请入货",style:{color:"#fff"},fn:function(){var e=t.$route.query;t.$router.push({path:"schedulingApplication/purchaseRequisition",query:e})}}])},initData:function(){var t=s.a.session("userShop");switch(this.isBrand=3==t.currentShop.ischain,this.shopId=t.currentShop.id,t.currentShop.ischain+""){case"0":case"3":this.brandId=t.currentShop.id;break;case"1":case"2":this.brandId=!1}},toggleTab:function(){this.toggle?(this.showCom="",s.a.session("tab",1)):(this.showCom="templateList",s.a.session("tab",2))},getStorageSubObj:function(){var t=s.a.session("subObj");t&&(this.startTime.time=t.sTime,this.endTime.time=t.eTime,this.pageObj.page=t.page,this.subObj=u({},t),delete this.subObj.sTime,delete this.subObj.eTime)},filterStore:function(t,e,a){return t.filter(function(t){return"brandId"==a&&0==t.shopId?t[a]==e:"shopId"==a&&0!=t.shopId?t[a]==e:void 0})},resetData:function(){this.subObj={type:1,isAuditor:0,auditStatus:"",dispatchStatus:"",wid:"",uName:"",code:""},this.endTime.time=Date.now(),this.startTime.time=this.endTime.time-r.a.timeConst.ONEMONTH,this.pageObj.page=1},itera:function(t,e){var a=!0,i=!1,n=void 0;try{for(var s,r=t[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var u=s.value;if(u.id==e)return u.name}}catch(t){i=!0,n=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw n}}},transFormTime:function(t){t=parseInt(1e3*t);var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()},getHttp:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(regeneratorRuntime.mark(function i(){var s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a[t]({data:a});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}},i,e)}))()}}),mounted:function(){var t=this;return o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.initBtn(),t.initData(),t.resetData(),2==s.a.session("tab")&&(t.toggle=!1,t.toggleTab()),e.next=6,t.getHttp("warehouseList");case 6:t.warehouseList=e.sent,a=t.isBrand?"brandId":"shopId",t.warehouseList=t.filterStore(t.warehouseList,t.shopId,a),t.getStorageSubObj(),t.clickBtn("filter",null);case 11:case"end":return e.stop()}},e,t)}))()},watch:{toggle:function(){this.toggleTab()}},beforeRouteLeave:function(t,e,a){if(s.a.session("tab",null),"/admin/schedulingApplication/purchaseRequisitionDetail"==t.path){var i={sTime:this.startTime.time,eTime:this.endTime.time,auditStatus:this.subObj.auditStatus,dispatchStatus:this.subObj.dispatchStatus,uName:this.subObj.uName,code:this.subObj.code,wid:this.subObj.wid,page:this.pageObj.page,num:this.pageObj.num,type:this.subObj.type,isAuditor:this.subObj.isAuditor};s.a.session("subObj",i)}else s.a.session("subObj",null);a()},components:{calendar:function(){return a.e("calendar_result").then(a.bind(null,"9265"))},comTable:function(){return a.e("table").then(a.bind(null,"4360"))},selectBtn:function(){return a.e("select_btn").then(a.bind(null,"3d41"))},pageElement:function(){return a.e("page_element").then(a.bind(null,"5921"))},templateList:function(){return a.e("template_list").then(a.bind(null,"59f9"))}}},c=(a("12d3"),a("d801")),d=Object(c.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"scheduling-application-list"}},[a("div",{staticClass:"tab-div"},[a("el-button-group",[a("el-button",{attrs:{type:t.toggle?"primary":""},on:{click:function(e){t.toggle=!0}}},[t._v("调度申请")]),t._v(" "),a("el-button",{attrs:{type:t.toggle?"":"primary"},on:{click:function(e){t.toggle=!1}}},[t._v("模板列表")])],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.toggle,expression:"toggle"}]},[a("div",{staticClass:"search-div"},[a("span",{staticClass:"submit-time"},[t._v("提交时间 : ")]),t._v(" "),a("div",{staticClass:"in-block"},[a("calendar",{attrs:{pObj:t.startTime},on:{throwTime:function(e){t.getTime("startTime",e)}}}),t._v(" "),a("span",{staticClass:"line"}),t._v(" "),a("calendar",{attrs:{pObj:t.endTime},on:{throwTime:function(e){t.getTime("endTime",e)}}})],1)]),t._v(" "),a("div",{staticClass:"search-div"},[a("div",{staticClass:"in-block"},[a("el-select",{attrs:{placeholder:"请选择审核状态",clearable:""},model:{value:t.subObj.auditStatus,callback:function(e){t.$set(t.subObj,"auditStatus",e)},expression:"subObj.auditStatus"}},t._l(t.auditStatus,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-select",{attrs:{placeholder:"请选择调度状态",clearable:""},model:{value:t.subObj.dispatchStatus,callback:function(e){t.$set(t.subObj,"dispatchStatus",e)},expression:"subObj.dispatchStatus"}},t._l(t.dispatchStatus,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"in-block"},[a("el-input",{staticStyle:{width:"180px"},attrs:{maxlength:"30",clearable:"",placeholder:"请输入提交人"},model:{value:t.subObj.uName,callback:function(e){t.$set(t.subObj,"uName",e)},expression:"subObj.uName"}}),t._v(" "),a("el-input",{staticStyle:{width:"180px"},attrs:{maxlength:"30",clearable:"",placeholder:"请输入申请单号"},model:{value:t.subObj.code,callback:function(e){t.$set(t.subObj,"code",e)},expression:"subObj.code"}})],1),t._v(" "),a("div",{staticClass:"in-block"},[a("span",{staticClass:"font"},[t._v("入货仓库 : ")]),t._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"请选择仓库"},model:{value:t.subObj.wid,callback:function(e){t.$set(t.subObj,"wid",e)},expression:"subObj.wid"}},t._l(t.warehouseList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"in-block"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.clickBtn("filter",!0)}}},[t._v("筛选")]),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.clickBtn("reset",null)}}},[t._v("重置")])],1)]),t._v(" "),a("div",{staticClass:"content-body"},[a("com-table",{attrs:{showHand:!0,listName:"调度申请",listHeight:70,showTitle:1,titleData:t.titleData,introData:t.applicationList,allTotal:t.pageObj.listNum,fixed:0,bannerStyle:{color:"#43414a",fontSize:"16px"},widthType:!0,listWidth:1435,contentStyle:{color:"#666",fontSize:"14px"}},scopedSlots:t._u([{key:"con-0",fn:function(e){return a("div",{},[4==e.data.auditStatus&&5==e.data.dispatchStatus?a("span",{staticClass:"operation",staticStyle:{color:"#ff8d01"},on:{click:function(a){t.chanageRouter(e.data,"import")}}},[t._v("确认入货")]):a("span",{staticClass:"operation",on:{click:function(a){t.chanageRouter(e.data,"detai")}}},[t._v("查看详情")])])}},{key:"con-1",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(e.data.itemIndex)+"\n\t\t\t\t")]}}])})],1),t._v(" "),a("div",[a("page-element",{attrs:{page:t.pageObj.page,total:t.pageObj.total},on:{pageNum:t.getPageNum}})],1)]),t._v(" "),a("keep-alive",{attrs:{include:["templateList"]}},[a(t.showCom,{tag:"component"})],1)],1)},[],!1,null,"39cf0ec4",null);e.default=d.exports},"12d3":function(t,e,a){"use strict";var i=a("eccf");a.n(i).a},eccf:function(t,e,a){}}]);