(window.webpackJsonp=window.webpackJsonp||[]).push([["check_material~goods_count_batch_win"],{"12ca":function(e,t,i){},"7e58":function(e,t,i){"use strict";var a=i("12ca");i.n(a).a},bd16:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bom-order"},[i("div",{staticClass:"filter"},[i("div",{staticClass:"inline-box"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.goodsName,expression:"goodsName"}],attrs:{type:"text",placeholder:"请输入商品名"},domProps:{value:e.goodsName},on:{input:function(t){t.target.composing||(e.goodsName=t.target.value)}}}),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.barCode,expression:"barCode"}],attrs:{type:"text",placeholder:"请输入条形码"},domProps:{value:e.barCode},on:{input:function(t){t.target.composing||(e.barCode=t.target.value)}}})]),e._v(" "),i("div",{staticClass:"inline-box"},[i("selectBtn",{attrs:{sorts:e.options,index:e.bomTypeIndex},on:{emit:e.dropBomType}})],1),e._v(" "),i("div",{staticClass:"inline-box"},[i("select-store",{attrs:{sorts:e.wareList,tipName:"请选择仓库"},on:{emit:e.selWare}})],1),e._v(" "),i("div",{staticClass:"inline-box",on:{click:e.checkSelect}},[i("select-store",{ref:"areaDom",attrs:{sorts:e.areaList,tipName:"请选择区域"},on:{emit:e.selArea}})],1),e._v(" "),i("div",{staticClass:"inline-box"},[i("div",{staticClass:"button-box"},[i("span",{staticClass:"blue",on:{click:e.filter}},[e._v("筛选")]),e._v(" "),i("span",{staticClass:"gray",on:{click:e.reset}},[e._v("重置")])])])]),e._v(" "),i("com-table",{attrs:{listName:"商品列表",titleData:e.titleList,allTotal:e.listLength,introData:e.list,listHeight:70,listWidth:1200},scopedSlots:e._u([{key:"title-0",fn:function(t){return i("div",{staticClass:"select-all select-ban"},[i("span",{on:{click:function(t){e.radioAll("store")}}},[e._v(e._s(e.storeAll?"取消全选":"全选"))]),e._v(" "),i("i",[e._v("|")]),e._v(" "),i("span",{staticClass:"page-all",class:{ban:e.storeAll},on:{click:function(t){e.radioAll("page")}}},[e._v(e._s(e.pageAll?"取消本页":"全选本页"))])])}},{key:"con-0",fn:function(t){return i("span",{staticClass:"detail select-ban",on:{click:function(i){e.listHandle(t.index)}}},[i("i",{class:{"sel-active":t.data.selected,storeAll:e.storeAll}})])}},{key:"con-1",fn:function(t){return i("span",{},[e._v(e._s((e.page-1)*e.pageShow+t.index>=9?(e.page-1)*e.pageShow+t.index+1:"0"+((e.page-1)*e.pageShow+t.index+1)))])}},{key:"con-4",fn:function(t){return i("span",{},[e._v(e._s(t.data.warehouse)+" / "+e._s(t.data.warehouseArea))])}},{key:"con-5",fn:function(t){return i("span",{},[e._v(e._s(t.data.price)+e._s(t.data.unit?"/"+t.data.unit:""))])}},{key:"con-6",fn:function(t){return i("span",{},[e._v(e._s(e.goodsTypeObj[t.data.type]))])}},{key:"con-7",fn:function(t){return i("span",{},[e._v(e._s(t.data.surplus)+e._s(t.data.unit))])}}])}),e._v(" "),i("div",{staticClass:"page-box"},[i("pageBtn",{attrs:{total:e.pageTotal,page:e.page,isNoJump:!0},on:{pageNum:e.pageChange}})],1),e._v(" "),e.nameWinShow?i("model-name",{attrs:{name:e.modelName,title:e.modelTitle},on:{emit:e.nameWinEmit}}):e._e()],1)};a._withStripped=!0;var r=i("f6ce"),s=i("bbb9"),n=i("81a2");function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function a(r,s){try{var n=t[r](s),o=n.value}catch(e){return void i(e)}if(!n.done)return Promise.resolve(o).then(function(e){a("next",e)},function(e){a("throw",e)});e(o)}("next")})}}var l={data:function(){return{userName:"",tempId:"",shopId:"",isBrand:0,options:["全部商品类型","普通商品","称重商品"],bomTypeList:["",0,1],type:"",bomTypeIndex:0,page:1,pageShow:10,pageTotal:1,list:[],listLength:0,userData:"",goodsName:"",barCode:"",secBarCode:"",wid:"",areaId:"",modelName:"",modelTitle:"保存模板",nameWinShow:!1,titleList:[{titleName:"操作",titleStyle:{width:"200px"}},{titleName:"序号"},{titleName:"商品名",dataName:"name"},{titleName:"条形码",dataName:"barCode"},{titleName:"所属仓库"},{titleName:"售价"},{titleName:"商品类型"},{titleName:"库存数量/重量"},{titleName:"批次数量",dataName:"batch"}],goodsTypeObj:{0:"普通商品",1:"称重商品"},storeAll:!1,pageAll:!1,savePage:[],selectItem:[],selNum:0,wareList:[],areaList:[],selList:[],searchObj:{},isEdit:!1}},props:["selObj"],components:{pageBtn:function(){return i.e("page_element").then(i.bind(null,"5921"))},selectBtn:function(){return i.e("select_btn").then(i.bind(null,"3d41"))},selectStore:function(){return i.e("win").then(i.bind(null,"cb83"))},calendar:function(){return i.e("calendar_type").then(i.bind(null,"f2dd"))},comTable:function(){return i.e("table").then(i.bind(null,"4360"))},modelName:function(){return i.e("model_name_win").then(i.bind(null,"5338"))}},created:function(){this.userData=r.a.session("userShop"),this.userName=this.userData.user.name,this.shopId=this.userData.currentShop.id},mounted:function(){this.tempId=this.$route.query.id,this.isEdit=!!this.tempId,this.initBtn(),this.isEdit?this.editTemplate():(this.setDefault(),this.getData(),this.getWarehouseList())},methods:{initBtn:function(){var e=this,t=[{name:"确定",style:"background: #fe8d01;border: 1px solid #fe8d01;color: #fff;",fn:function(){e.confirmClick()}},{name:"保存模板",style:"background: none;border: 1px solid #fe8d01;color: #fe8d01;",fn:function(){e.saveModel()}},{name:"取消",style:"background: #b3b3b3;border: 1px solid #b3b3b3;color: #fff;",fn:function(){e.isEdit?window.history.go(-1):e.$emit("emit",!1)}}];this.isEdit&&(t.splice(0,1),t[0].style="background: #fe8d01;border: 1px solid #fe8d01;color: #fff;"),this.$store.commit("setPageTools",t)},confirmClick:function(){if(this.selList.length||this.storeAll){var e={list:this.selList,search:this.searchObj,storeAll:this.storeAll};this.$emit("emit",e)}else this.myAlert("请选择商品")},editTemplate:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.templateGetInventoryGoodsTemplate({data:{id:e.tempId}});case 2:i=t.sent,e.modelName=i.name,e.type=i.content.type,e.wid=i.content.wids?i.content.wids.join(","):"",e.areaId=i.content.wids?i.content.aids.join(","):"",e.selectItem=i.content.items,e.selectItem.length||(e.storeAll=!0),e.getData(),e.getWarehouseList();case 11:case"end":return t.stop()}},t,e)}))()},setDefault:function(){for(var e in this.selObj.search)this[e]=this.selObj.search[e];this.storeAll=this.selObj.storeAll,this.selList=this.selObj.list,this.selectItem=this.selList.map(function(e){return{gid:e.gid,aid:e.areaId}})},dropBomType:function(e){this.type=this.bomTypeList[e],this.bomTypeIndex=e},formatTime:function(e){return s.a.format(new Date(1e3*e),"yyyy-MM-dd hh:mm:ss")},filter:function(){this.page=1,this.getData()},nameWinEmit:function(e,t){this.nameWinShow=!1,"ok"==e&&(this.modelName=t,this.tempId?this.editModel():this.addModel())},getWarehouseList:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i,a,r,s,o,l,d,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.warehouseWarehouseList();case 2:for(i=t.sent,a=[],r=!0,s=!1,o=void 0,t.prev=7,l=i[Symbol.iterator]();!(r=(d=l.next()).done);r=!0)(c=d.value).shopId?e.shopId==c.shopId&&a.push(c):e.shopId==c.brandId&&a.push(c);t.next=15;break;case 11:t.prev=11,t.t0=t.catch(7),s=!0,o=t.t0;case 15:t.prev=15,t.prev=16,!r&&l.return&&l.return();case 18:if(t.prev=18,!s){t.next=21;break}throw o;case 21:return t.finish(18);case 22:return t.finish(15);case 23:e.wareList=a;case 24:case"end":return t.stop()}},t,e,[[7,11,15,23],[16,,18,22]])}))()},selWare:function(e,t){var i=this;this.wid="",t||(this.areaId=""),this.areaList=[];var a=[],r=function(e){if(1==e.selected){var t;a.push(e.id);var r=e.area.map(function(t){return{id:t.id,name:e.name+" / "+t.areaName}});(t=i.areaList).push.apply(t,function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(r))}},s=!0,n=!1,o=void 0;try{for(var l,d=e[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){r(l.value)}}catch(e){n=!0,o=e}finally{try{!s&&d.return&&d.return()}finally{if(n)throw o}}this.wid=a.join(","),this.setWareDefault()},selArea:function(e){this.areaId="";var t=[],i=!0,a=!1,r=void 0;try{for(var s,n=e[Symbol.iterator]();!(i=(s=n.next()).done);i=!0){var o=s.value;1==o.selected&&t.push(o.id)}}catch(e){a=!0,r=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw r}}this.areaId=t.join(",")},setWareDefault:function(){if(this.wid){var e=this.wid.split(","),t=s.a.deepCopy(this.wareList),i=!0,a=!1,r=void 0;try{for(var n,o=t[Symbol.iterator]();!(i=(n=o.next()).done);i=!0){var l=n.value,d=!0,c=!1,h=void 0;try{for(var u,f=e[Symbol.iterator]();!(d=(u=f.next()).done);d=!0){var m=u.value;l.id==m&&(l.selected=!0)}}catch(e){c=!0,h=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw h}}}}catch(e){a=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}this.wareList=t,this.selWare(this.wareList,!0)}if(this.areaId){var p=this.areaId.split(","),v=s.a.deepCopy(this.areaList),y=!0,g=!1,b=void 0;try{for(var w,I=v[Symbol.iterator]();!(y=(w=I.next()).done);y=!0){var x=w.value,N=!0,A=!1,_=void 0;try{for(var S,L=p[Symbol.iterator]();!(N=(S=L.next()).done);N=!0){var k=S.value;x.id==k&&(x.selected=!0)}}catch(e){A=!0,_=e}finally{try{!N&&L.return&&L.return()}finally{if(A)throw _}}}}catch(e){g=!0,b=e}finally{try{!y&&I.return&&I.return()}finally{if(g)throw b}}this.areaList=v,this.selArea(this.areaList)}},checkSelect:function(){this.areaList.length||(this.$refs.areaDom.sortShow=!1,this.myAlert("请选择仓库"))},myAlert:function(e){this.$store.commit("setWin",{title:"操作提示",content:e})},setSendObj:function(e){this.storeAll&&(this.selectItem=[]);var t={name:this.modelName,userName:this.userName,type:this.type,wids:this.wid?this.wid.split(","):"",aids:this.areaId?this.areaId.split(","):"",items:this.selectItem};return e&&(t.id=this.tempId),t},saveModel:function(){this.selectItem.length||this.storeAll?(this.nameWinShow=!0,this.modelName?this.modelTitle="修改模板":this.modelTitle="新建模板"):this.myAlert("模板内容不能为空")},addModel:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.setSendObj(),t.next=3,n.a.addInventoryGoodsTemplate({data:i});case 3:(a=t.sent)&&(e.tempId=a,e.myAlert("模板保存成功！"));case 5:case"end":return t.stop()}},t,e)}))()},editModel:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.setSendObj(!0),t.next=3,n.a.editInventoryGoodsTemplate({data:i});case 3:t.sent&&(e.myAlert("模板修改成功！"),e.isEdit&&(delete e.$route.query.id,e.$router.push({path:"/admin/goodsCountTemplate",query:e.$route.query})));case 5:case"end":return t.stop()}},t,e)}))()},getData:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.GoodsinventoryGetGoodsInventoryList({data:{page:e.page,num:e.pageShow,goodsName:e.goodsName,barCode:e.barCode,secBarCode:e.secBarCode,type:e.type?e.type+1:"",wid:e.wid,areaId:e.areaId}});case 2:i=t.sent,e.searchObj={type:e.type?e.type+1:"",wid:e.wid,areaId:e.areaId},e.list=e.setAlready(i.list),e.listLength=i.count,e.pageTotal=i.total,e.setSelNum();case 8:case"end":return t.stop()}},t,e)}))()},setAlready:function(e){var t=!1,i=!0,a=!1,r=void 0;try{for(var s,n=e[Symbol.iterator]();!(i=(s=n.next()).done);i=!0){var o=s.value;if(this.storeAll)o.selected=!0;else{var l=!0,d=!1,c=void 0;try{for(var h,u=this.savePage[Symbol.iterator]();!(l=(h=u.next()).done);l=!0){if(h.value==this.page){t=!0;break}}}catch(e){d=!0,c=e}finally{try{!l&&u.return&&u.return()}finally{if(d)throw c}}if(t)o.selected=!0;else{var f=!1,m=!0,p=!1,v=void 0;try{for(var y,g=this.selectItem[Symbol.iterator]();!(m=(y=g.next()).done);m=!0){var b=y.value;if(b.gid==o.gid&&b.aid==o.areaId){f=!0;break}}}catch(e){p=!0,v=e}finally{try{!m&&g.return&&g.return()}finally{if(p)throw v}}o.selected=!!f}}}}catch(e){a=!0,r=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw r}}return this.pageAll=!!t,e},setSelNum:function(){var e=!0,t=!1,i=void 0;try{for(var a,r=this.list[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){1==a.value.selected&&this.selNum++}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}},reset:function(){var e=!0,t=!1,i=void 0;try{for(var a,r=["goodsName","barCode","wid","areaId"][Symbol.iterator]();!(e=(a=r.next()).done);e=!0){this[a.value]=""}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}this.page=1,this.bomTypeIndex=0,this.pageShow=10,this.type=0;var n=s.a.deepCopy(this.wareList),o=!0,l=!1,d=void 0;try{for(var c,h=n[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){c.value.selected=!1}}catch(e){l=!0,d=e}finally{try{!o&&h.return&&h.return()}finally{if(l)throw d}}this.wareList=n,this.areaList=[],this.getData()},pageChange:function(e){this.page=Number(e.page),this.pageShow=Number(e.num),this.getData()},listHandle:function(e){var t=this.list[e];if(!this.storeAll)if(t.selected=!t.selected,t.selected)this.selectItem.push({gid:t.gid,aid:t.areaId}),this.selList.push(t),this.selNum++,this.selNum==this.list.length&&(this.savePage.push(this.page),this.pageAll=!0);else{this.selNum--;for(var i=0;i<this.selectItem.length;i++){var a=this.selectItem[i].gid,r=this.selectItem[i].aid;if(a==t.gid&&r==t.areaId){this.selectItem.splice(i,1),this.selList.splice(i,1),i--;break}}this.pageAll&&(this.removePageNum(),this.pageAll=!1)}},radioAll:function(e){if(this.list.length)if("store"==e)this.storeAll=!this.storeAll,this.pageAll=!1,this.setSelAll(this.storeAll),this.selList=[],this.selectItem=[];else if("page"==e){if(this.storeAll)return;this.pageAll=!this.pageAll,this.pageAll?(this.savePage.push(this.page),this.pageSetId("add")):(this.removePageNum(),this.pageSetId("cancel"))}},removePageNum:function(){for(var e=0;e<this.savePage.length;e++)this.savePage[e]==this.page&&(this.savePage.splice(e,1),e--)},pageSetId:function(e){if("add"==e){var t=!0,i=!1,a=void 0;try{for(var r,s=this.list[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var n=r.value,o=!1,l=!0,d=!1,c=void 0;try{for(var h,u=this.selectItem[Symbol.iterator]();!(l=(h=u.next()).done);l=!0){var f=h.value;if(n.gid==f.gid&&n.areaId==f.aid){o=!0;break}}}catch(e){d=!0,c=e}finally{try{!l&&u.return&&u.return()}finally{if(d)throw c}}o||(this.selectItem.push({gid:n.gid,aid:n.areaId}),this.selList.push(n),n.selected=!0)}}catch(e){i=!0,a=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw a}}}else if("cancel"==e){var m=!0,p=!1,v=void 0;try{for(var y,g=this.list[Symbol.iterator]();!(m=(y=g.next()).done);m=!0)for(var b=y.value,w=0;w<this.selectItem.length;w++){var I=this.selectItem[w].gid,x=this.selectItem[w].aid;if(I==b.gid&&x==b.areaId){this.selectItem.splice(w,1),this.selList.splice(w,1),b.selected=!1,w--;break}}}catch(e){p=!0,v=e}finally{try{!m&&g.return&&g.return()}finally{if(p)throw v}}}},setSelAll:function(e){if(e){var t=!0,i=!1,a=void 0;try{for(var r,s=this.list[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){r.value.selected=!0}}catch(e){i=!0,a=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw a}}}else{var n=!0,o=!1,l=void 0;try{for(var d,c=this.list[Symbol.iterator]();!(n=(d=c.next()).done);n=!0){d.value.selected=!1}}catch(e){o=!0,l=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw l}}this.selectItem=[]}}}},d=(i("7e58"),i("7610")),c=Object(d.a)(l,a,[],!1,null,"448b6ed8",null);c.options.__file="src\\module\\invoicing_system\\invoicing\\check_warehouse\\add_goods.vue";t.default=c.exports}}]);