(window.webpackJsonp=window.webpackJsonp||[]).push([["staff_config"],{9968:function(t,s,e){"use strict";var i=e("dc4c");e.n(i).a},a536:function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("section",{attrs:{id:"employlist"}},[e("section",{directives:[{name:"show",rawName:"v-show",value:!t.isBatch,expression:"!isBatch"}],staticClass:"top"},[e("section",{staticClass:"detLi",attrs:{title:t.selectedJob}},[e("div",{staticClass:"select-body-btn select-btn",on:{click:[function(t){t.stopPropagation()},function(s){t.jobOrShop("job")}]}},[e("span",[t._v(t._s(t.selectedJob))]),t._v(" "),t._m(0)]),t._v(" "),"job"==t.showJob?e("div",{staticClass:"detDiv",staticStyle:{width:"600px",top:"52px",left:"0px"}},[e("i",{staticClass:"detI",staticStyle:{left:"160px"}}),t._v(" "),e("div",{staticClass:"detH3",staticStyle:{"text-align":"left","max-height":"500px",overflow:"auto"},on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"jobBtn"},[e("a",{staticClass:"job",class:{selectbtn:"brand"==t.brandType},attrs:{href:"javascript:void(0)"},on:{click:function(s){t.chooseJob("brand")}}},[t._v("品牌职位")]),t._v(" "),e("a",{staticClass:"job",class:{selectbtn:"shop"==t.brandType},attrs:{href:"javascript:void(0)"},on:{click:function(s){t.chooseJob("shop")}}},[t._v("门店职位")])]),t._v(" "),e("ul",[e("li",{staticClass:"all",class:{active:t.allJob},on:{click:function(s){t.selJob("job")}}},[t._v("全部")]),t._v(" "),t._l(t.showJobList,function(s,i){return e("li",{key:i,class:{active:s.selected},on:{click:function(e){t.selJob("job",s)}}},[t._v(t._s(s.name))])})],2)]),t._v(" "),e("div",{staticClass:"detLiBtn"},[e("span",{staticClass:"gray",on:{click:function(s){t.cancel("job")}}},[t._v("取消")]),t._v(" "),e("span",{staticClass:"yellow",on:{click:function(s){t.ensure("job")}}},[t._v("确定")])])]):t._e()]),t._v(" "),e("section",{staticClass:"detLi"},[e("div",{staticClass:"select-body-btn select-btn",on:{click:[function(t){t.stopPropagation()},function(s){t.jobOrShop("shop")}]}},[e("span",[t._v(t._s(t.selectedShop))]),t._v(" "),t._m(1)]),t._v(" "),"shop"==t.showJob?e("div",{staticClass:"detDiv",staticStyle:{width:"600px",top:"52px",left:"-215px"}},[e("i",{staticClass:"detI",staticStyle:{left:"370px"}}),t._v(" "),e("div",{staticClass:"detH3",staticStyle:{"text-align":"left","max-height":"500px",overflow:"auto"},on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"jobBtn"},[e("a",{staticClass:"job",class:{selectbtn:"all"==t.shopType},attrs:{href:"javascript:void(0)"},on:{click:function(s){t.chooseShop("all")}}},[t._v("全部")]),t._v(" "),e("a",{staticClass:"job",class:{selectbtn:"brand"==t.shopType},attrs:{href:"javascript:void(0)"},on:{click:function(s){t.chooseShop("brand")}}},[t._v("直营店")]),t._v(" "),e("a",{staticClass:"job",class:{selectbtn:"shop"==t.shopType},attrs:{href:"javascript:void(0)"},on:{click:function(s){t.chooseShop("shop")}}},[t._v("加盟店")])]),t._v(" "),e("ul",[e("li",{staticClass:"all",class:{active:t.allShop},on:{click:function(s){t.selJob("shop")}}},[t._v("全部")]),t._v(" "),t._l(t.showShopList,function(s,i){return e("li",{key:i,class:{active:s.selected},on:{click:function(e){t.selJob("shop",s)}}},[t._v(t._s(s.shopName))])})],2)]),t._v(" "),e("div",{staticClass:"detLiBtn"},[e("span",{staticClass:"gray",on:{click:function(s){t.cancel("shop")}}},[t._v("取消")]),t._v(" "),e("span",{staticClass:"yellow",on:{click:function(s){t.ensure("shop")}}},[t._v("确定")])])]):t._e()]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.staffOrJob,expression:"staffOrJob"}],staticClass:"jobName",attrs:{type:"text",placeholder:"请输入员工名称/手机号码"},domProps:{value:t.staffOrJob},on:{input:function(s){s.target.composing||(t.staffOrJob=s.target.value)}}}),t._v(" "),e("a",{staticClass:"blue btn",attrs:{href:"javascript:void(0);"},on:{click:t.search}},[t._v("筛选")]),t._v(" "),e("a",{staticClass:"gray btn",attrs:{href:"javascript:void(0);"},on:{click:t.reset}},[t._v("重置")])]),t._v(" "),e("section",{staticClass:"list"},[e("comTable",{attrs:{fixed:0,listHeight:60,titleData:t.titleData,introData:t.activityPageList},scopedSlots:t._u([{key:"con-0",fn:function(s){return e("span",{staticClass:"operate content",staticStyle:{display:"inline-block"}},[t.isBatch?e("span",{staticStyle:{cursor:"pointer"}},[e("em",{staticClass:"circle",class:{on:s.data.selected},on:{click:function(e){t.selected(s.data,s.index)}}})]):e("span",[e("em",{staticClass:"under-line edit",on:{click:function(e){t.checkDetail(s.data)}}},[t._v("编辑")]),t._v(" "),e("em",{staticClass:"line"}),t._v(" "),e("em",{staticClass:"under-line del",on:{click:function(e){t.delStaff(s.data.userId)}}},[t._v("删除")])])])}},{key:"con-1",fn:function(s){return e("span",{},[t._v(t._s(s.index+1+10*(t.page-1)))])}},{key:"con-3",fn:function(s){return e("span",{},[s.data.brandRole.roleId?e("span",[t._v(t._s(s.data.brandRole.roleName))]):e("span",[t._v("--")])])}},{key:"con-4",fn:function(s){return e("span",{},[s.data.brandRole.shopCount?e("span",[t._v(t._s(s.data.brandRole.shopCount)+"家门店")]):e("span",[t._v("0家门店")])])}},{key:"con-5",fn:function(s){return e("span",{},[0!=s.data.shopRole.length?e("span",{staticStyle:{cursor:"pointer"},on:{click:[function(t){t.stopPropagation()},function(e){t.showNames(s.index)}]}},t._l(s.data.shopRole,function(i,o){return e("i",{key:o+"-"},[e("i",{class:{brand:i.roleId>=1e5,shop:i.roleId<1e5}},[t._v(t._s(i.roleName))]),t._v(" "),o!=s.data.shopRole.length-1?e("i",[t._v("、")]):t._e()])})):e("span",[t._v("--")]),t._v(" "),t.isNames===s.index?e("div",{staticClass:"detLi",staticStyle:{position:"fixed","z-index":"200"}},[e("div",{staticClass:"detDiv",staticStyle:{width:"300px",top:"52px",right:"-50px"}},[e("i",{staticClass:"detI",staticStyle:{left:"160px"}}),t._v(" "),e("div",{staticClass:"detH3",staticStyle:{"text-align":"left",overflow:"auto","min-height":"35px",height:"50px"}},t._l(s.data.shopRole,function(i,o){return e("i",{key:o+"-"},[e("i",{class:{brand:i.roleId>=1e5,shop:i.roleId<1e5}},[t._v(t._s(i.roleName))]),t._v(" "),o!=s.data.shopRole.length-1?e("i",[t._v("、")]):t._e()])}))])]):t._e()])}},{key:"con-6",fn:function(s){return e("span",{},[t._v(t._s(s.data.shopCount)+"家门店")])}}])},[e("div",{attrs:{slot:"title"},slot:"title"},[e("span",{directives:[{name:"show",rawName:"v-show",value:!t.isBatch,expression:"!isBatch"}]},[t._v("员工管理列表 · 共\n\t\t\t\t\t\t"),e("em",[t._v(t._s(t.activityList.length))]),t._v("个条目")]),t._v(" "),e("span",[e("i"),t._v("品牌指派")]),t._v(" "),e("span",[e("i"),t._v("门店自建")])]),t._v(" "),t.isBatch?e("div",{attrs:{slot:"title-0"},slot:"title-0"},[e("em",{staticClass:"under-line edit",staticStyle:{"margin-right":"30px",color:"#F8931F"},on:{click:function(s){t.editBatch()}}},[t._v("编辑")]),t._v(" "),e("em",{staticClass:"under-line del",staticStyle:{color:"#FD3E1F"},on:{click:function(s){t.delBatch()}}},[t._v("删除")])]):t._e()])],1),t._v(" "),t.total>1&&!t.isBatch?e("page",{staticStyle:{"margin-top":"20px"},attrs:{page:t.page,total:t.total,isNoJump:!0,isNoPaging:!0},on:{pageNum:t.pageChange}}):t._e(),t._v(" "),t.isStaff?e("addWin",{attrs:{edit:t.edit,jobInfo:t.info},on:{getStaff:t.getStaff}}):t._e(),t._v(" "),t.showBatch?e("addjob",{attrs:{batch:!0},on:{addJob:t.getJob}}):t._e()],1)};i._withStripped=!0;var o=e("f6ce"),n=e("81a2"),a=e("bbb9");function h(t){return function(){var s=t.apply(this,arguments);return new Promise(function(t,e){return function i(o,n){try{var a=s[o](n),h=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(h).then(function(t){i("next",t)},function(t){i("throw",t)});t(h)}("next")})}}var l={data:function(){return{optionsJob:[],selectedJob:"全部职位",optionsShop:[],selectedShop:"全部门店",activityList:[],activityPageList:[],isStaff:!1,showJob:null,brandType:"brand",shopType:"all",jobList:[],showJobList:[],allJob:!1,edit:!1,info:null,jobIds:{brand:[],shop:[]},shopIds:[],shopList:[],showShopList:"",allShop:!1,isBatch:!1,total:0,num:10,page:1,showBatch:!1,staffOrJob:"",newList:[],isNames:-1,titleData:[{titleName:"操作",dataName:""},{titleName:"序号",dataName:""},{titleName:"员工名称",dataName:"userName"},{titleName:"品牌职位",dataName:"brandRole"},{titleName:"适用门店",dataName:"brandRole"},{titleName:"门店职位",dataName:"shopRole"},{titleName:"适用门店",dataName:"shopCount"}]}},mounted:function(){this.initBtn(),this.getUserList(),document.addEventListener("click",this.remove),this.getShopList()},destroyed:function(){document.removeEventListener("click",this.remove),this.$store.commit("setPageTools",{})},methods:{remove:function(){this.isNames=-1,this.showJob=null},initBtn:function(){var t=this,s={addStaff:function(){t.isStaff=!0,t.edit=!1},batchOperation:function(){t.isBatch=!0,t.completeBtn();for(var s=0;s<t.activityPageList.length;s++)t.activityPageList[s].selected=!1}};this.$store.commit("setPageTools",s)},completeBtn:function(){var t=this,s={completeBatchOperation:function(){t.isBatch=!1,t.initBtn()}};this.$store.commit("setPageTools",s)},selected:function(t){t.selected=!t.selected},pageChange:function(t){var s=t.page;this.page=s,0!=this.newList.length?this.activityPageList=this.newList.slice((s-1)*this.num,(s-1)*this.num+this.num):this.activityPageList=this.activityList.slice((s-1)*this.num,(s-1)*this.num+this.num)},userDel:function(t){var s=this;return h(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.userDel({data:{userId:t}});case 2:s.getUserList();case 3:case"end":return e.stop()}},e,s)}))()},getUserList:function(){var t=this;return h(regeneratorRuntime.mark(function s(){var e,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,n.a.getUserList({data:{}});case 2:for(e=s.sent,i=0;i<e.length;i++)e[i].selected=!1;t.total=Math.ceil(e.length/t.num),t.activityList=e,t.activityPageList=e.slice((t.page-1)*t.num,(t.page-1)*t.num+t.num),t.search();case 8:case"end":return s.stop()}},s,t)}))()},getShopList:function(){for(var t=o.a.session("shopList"),s=0;s<t.length;s++)t[s].selected=!1;this.shopList=t,this.showShopList=t},newGetJobInfoList:function(){var t=this;return h(regeneratorRuntime.mark(function s(){var e,i,o,a;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,n.a.newGetJobInfoList();case 2:for(e=s.sent,i=[],o=[],a=0;a<e.length;a++)e[a].selected=!1,"1"===e[a].type?o.push(e[a]):i.push(e[a]);o.unshift({id:"0",name:"超级管理员",type:"1",selected:!1}),i.unshift({id:"0",name:"超级管理员",type:"0",selected:!1}),i.push({id:"-1",name:"门店自建",type:"0",selected:!1}),t.showJobList=o,t.jobList=o.concat(i);case 11:case"end":return s.stop()}},s,t)}))()},userEditBrandUsers:function(t,s){var e=this;return h(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.a.userEditBrandUsers({data:{userIds:e.userIds,brandRole:t,shopRole:s}});case 2:e.getUserList();case 3:case"end":return i.stop()}},i,e)}))()},showNames:function(t){this.isNames=t},delStaff:function(t){var s=this;this.$store.commit("setWin",{title:"提示信息",winType:"confirm",content:"确认删除？",callback:function(e){"ok"==e&&s.userDel(t)}})},isSelected:function(t,s){for(var e=0;e<s.length;e++){s[e].selected=!1;for(var i=0;i<t.length;i++)t[i].id==s[e].id&&t[i].type==s[e].type&&(s[e].selected=!0)}},isAll:function(t){for(var s=0;s<t.length;s++)if(!t[s].selected)return!1;return!0},selJob:function(t,s){var e=0;if("shop"!=t||s)if("shop"==t&&s){s.selected=!s.selected;for(var i=0;i<this.showShopList.length;i++)this.showShopList[i].selected&&e++;e==this.showShopList.length?this.allShop=!0:this.allShop=!1}else if("job"!=t||s){if("job"==t&&s){s.selected=!s.selected;for(var o=0;o<this.showJobList.length;o++)this.showJobList[o].selected&&e++;e==this.showJobList.length?this.allJob=!0:this.allJob=!1}}else if(this.isAll(this.showJobList))for(var n=0;n<this.showJobList.length;n++)this.showJobList[n].selected=!1,this.allJob=!1;else for(var a=0;a<this.showJobList.length;a++)this.showJobList[a].selected=!0,this.allJob=!0;else if(this.isAll(this.showShopList))for(var h=0;h<this.showShopList.length;h++)this.showShopList[h].selected=!1,this.allShop=!1;else for(var l=0;l<this.showShopList.length;l++)this.showShopList[l].selected=!0,this.allShop=!0},jobOrShop:function(t){if(this.showJob=t,"job"==t&&0==this.jobList.length)this.newGetJobInfoList();else if("shop"!=t||this.shopList)if("job"==t&&0!=this.jobList.length){var s=this.jobIds.brand.concat(this.jobIds.shop);this.isSelected(s,this.jobList),this.isAll(this.showJobList)?this.allJob=!0:this.allJob=!1}else"shop"==t&&0!=this.shopList.length&&(this.isSelected(this.shopIds,this.shopList),this.isAll(this.showShopList)?this.allShop=!0:this.allShop=!1);else{for(var e=o.a.session("shopList"),i=0;i<e.length;i++)e[i].selected=!1;this.shopList=e,this.showShopList=e}},chooseJob:function(t){this.brandType=t,this.showJobList=[];for(var s=0;s<this.jobList.length;s++)"brand"==t&&"1"===this.jobList[s].type?this.showJobList.push(this.jobList[s]):"shop"==t&&"0"===this.jobList[s].type&&this.showJobList.push(this.jobList[s]);this.isAll(this.showJobList)?this.allJob=!0:this.allJob=!1},chooseShop:function(t){if(this.shopType=t,this.showShopList=[],"all"===t)this.showShopList=this.shopList;else if("brand"===t)for(var s=0;s<this.shopList.length;s++)"1"==this.shopList[s].ischain&&this.showShopList.push(this.shopList[s]);else if("shop"===t)for(var e=0;e<this.shopList.length;e++)"2"==this.shopList[e].ischain&&this.showShopList.push(this.shopList[e]);this.isAll(this.showShopList)?this.allShop=!0:this.allShop=!1},ensure:function(t){if(this.showJob=null,"job"==t){this.selectedJob="",this.jobIds.brand=[],this.jobIds.shop=[];for(var s=0;s<this.jobList.length;s++)this.jobList[s].selected&&(this.selectedJob+=this.jobList[s].name+",","1"===this.jobList[s].type?this.jobIds.brand.push(this.jobList[s]):this.jobIds.shop.push(this.jobList[s]));this.selectedJob=this.selectedJob.slice(0,this.selectedJob.length-1),this.selectedJob||(this.selectedJob="全部职位")}else if("shop"==t){this.selectedShop="",this.shopIds=[];for(var e=0;e<this.shopList.length;e++)this.shopList[e].selected&&(this.selectedShop+=this.shopList[e].shopName+",",this.shopIds.push(this.shopList[e].id));this.selectedShop=this.selectedShop.slice(0,this.selectedShop.length-1),this.selectedShop||(this.selectedShop="全部门店")}},cancel:function(){this.showJob=null},checkDetail:function(t){this.isStaff=!0,this.edit=!0,this.info=t},staff:function(){this.userIds="";for(var t=0;t<this.activityPageList.length;t++)this.activityPageList[t].selected&&(this.userIds+=this.activityPageList[t].userId+",")},editBatch:function(){if(this.staff(),""==this.userIds)return this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"请选择员工"}),!1;this.userIds=this.userIds.slice(0,this.userIds.length-1),this.showBatch=!0},delBatch:function(){var t=this;if(this.staff(),""==this.userIds)return this.$store.commit("setWin",{title:"提示信息",winType:"alert",content:"请选择员工"}),!1;this.userIds=this.userIds.slice(0,this.userIds.length-1),this.$store.commit("setWin",{title:"提示信息",winType:"confirm",content:"确认删除？",callback:function(s){"ok"==s&&t.userDel(t.userIds)}})},getJob:function(t,s,e){if(s&&"ok"==t){var i={},o=[];"admin"==s?(this.showBatch=!1,1===e?(i.roleId="0",i.name="超级管理员",i.shopIds=[]):o.push({roleId:"0",name:"超级管理员",shopIds:[]})):(this.showBatch=!1,1===e?i=s.jobInfo:o.push(s.jobInfo)),this.userEditBrandUsers(i,o)}"cancel"==t&&(this.showBatch=!1)},getStaff:function(t){"ok"==t?(this.isStaff=!1,this.getUserList()):"closeMask"!=t&&(this.isStaff=!1)},isTrue:function(t,s){for(var e=0;e<t.length;e++)if(t[e]==s)return!0;return!1},search:function(){var t=this,s=[];if(s=""!=this.staffOrJob?this.activityList.filter(function(s){return!(!s.userName||!s.mobile)&&(s.userName.indexOf(t.staffOrJob)>=0||s.mobile.indexOf(t.staffOrJob)>=0)}):a.a.deepCopy(this.activityList),0!=this.shopIds.length)for(var e=0;e<s.length;e++){var i=!1;if(s[e].brandRole.shopIds)for(var o=0;o<s[e].brandRole.shopIds.length;o++)if(-1!=this.shopIds.indexOf(s[e].brandRole.shopIds[o])){i=!0;break}if(!i)for(var n=0;n<s[e].shopRole.length;n++)if(s[e].shopRole[n].shopIds)for(var h=0;h<s[e].shopRole[n].shopIds.length;h++)if(-1!=this.shopIds.indexOf(s[e].shopRole[n].shopIds[h])){i=!0;break}i||(s.splice(e,1),e--)}for(var l=[],c=[],r=0;r<this.jobIds.brand.length;r++)l.push(this.jobIds.brand[r].id);for(var d=0;d<this.jobIds.shop.length;d++)c.push(this.jobIds.shop[d].id);if(0!=l.length||0!=c.length)for(var p=0;p<s.length;p++){var f=!1;if(-1!=l.indexOf(s[p].brandRole.roleId)&&(f=!0),!f){for(var u=0;u<s[p].shopRole.length;u++)if(-1!=c.indexOf(s[p].shopRole[u].roleId)){f=!0;break}if(!f&&-1!=c.indexOf("-1"))for(var v=0;v<s[p].shopRole.length;v++)if(s[p].shopRole[v].roleId<1e5){f=!0;break}}f||(s.splice(p,1),p--)}this.newList=s,this.total=Math.ceil(s.length/this.num),this.activityPageList=s.slice(0*this.num,0*this.num+this.num)},reset:function(){for(var t=0;t<this.jobList.length;t++)this.jobList[t].selected=!1;for(var s=0;s<this.shopList.length;s++)this.shopList[s].selected=!1;this.selectedJob="全部职位",this.selectedShop="全部门店",this.shopIds=[],this.jobIds.brand=[],this.jobIds.shop=[],this.staffOrJob="",this.search()}},components:{addWin:function(){return e.e("addstaff_win").then(e.bind(null,"3af0"))},page:function(){return e.e("page_element").then(e.bind(null,"5921"))},addjob:function(){return e.e("addjob_win").then(e.bind(null,"f431"))},comTable:function(){return e.e("table").then(e.bind(null,"4360"))}}},c=(e("9968"),e("7610")),r=Object(c.a)(l,i,[function(){var t=this.$createElement,s=this._self._c||t;return s("em",[s("i")])},function(){var t=this.$createElement,s=this._self._c||t;return s("em",[s("i")])}],!1,null,"12a56439",null);r.options.__file="src\\module\\brand_configuration\\staff_config.vue";s.default=r.exports},dc4c:function(t,s,e){}}]);