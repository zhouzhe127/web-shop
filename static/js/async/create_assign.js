(window.webpackJsonp=window.webpackJsonp||[]).push([["create_assign"],{"844a":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"create-assign"}},[t.isSelBom?t._e():[a("div",{staticClass:"create"},[t._m(0),t._v(" "),a("div",{staticClass:"form"},[a("div",{staticClass:"block"},[a("div",{staticClass:"name required"},[t._v("方案名称")]),t._v(" "),a("div",{staticClass:"cell"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempName,expression:"tempName"}],attrs:{type:"text",placeholder:"请输入方案名称",maxlength:"20"},domProps:{value:t.tempName},on:{input:function(e){e.target.composing||(t.tempName=e.target.value)}}}),t._v(" "),t._m(1)])]),t._v(" "),t._l(t.formList,function(e,r){return a("div",{key:r,staticClass:"block"},[a("div",{staticClass:"name",class:{required:e.required}},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"cell"},[a("div",{staticClass:"add-btn",on:{click:function(a){t.openWin(e.param)}}},[a("em",{staticClass:"img-span"}),t._v("选择指派内容\n\t\t\t\t\t\t")]),t._v(" "),e.selStr?a("span",{staticClass:"word"},[t._v("已选择："+t._s(e.selStr))]):t._e(),t._v(" "),e.tips?a("div",{staticClass:"tips"},[a("i"),t._v(t._s(e.tips))]):t._e()])])})],2)]),t._v(" "),a("div",{staticClass:"create store"},[t._m(2),t._v(" "),a("div",{staticClass:"form"},[a("div",{staticClass:"block"},[a("div",{staticClass:"name required"},[t._v("适用店铺")]),t._v(" "),a("div",{staticClass:"cell"},[a("div",{staticClass:"add-btn",on:{click:function(e){t.openWin("store")}}},[a("em",{staticClass:"img-span"}),t._v("选择店铺\n\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"store-tips"},[a("em",[t._v("直营店：")]),t._v(" "),t._l(t.storeSel,function(e,r){return 1==e.ischain?a("span",{key:r},[t._v(t._s(e.name)+",")]):t._e()})],2),t._v(" "),a("div",{staticClass:"store-tips"},[a("em",[t._v("加盟店：")]),t._v(" "),t._l(t.storeSel,function(e,r){return 2==e.ischain?a("span",{key:r},[t._v(t._s(e.name)+",")]):t._e()})],2)])])])]),t._v(" "),a("div",{staticClass:"create mode"},[t._m(3),t._v(" "),a("div",{staticClass:"form"},[a("div",{staticClass:"block"},[a("div",{staticClass:"name required"},[t._v("适用店铺")]),t._v(" "),a("div",{staticClass:"cell"},[a("div",{staticClass:"radio-box"},t._l(t.tabList,function(e,r){return a("span",{key:r,class:{active:t.assignType==r+1},on:{click:function(e){t.assignType=r+1}}},[t._v(t._s(e))])}))])])]),t._v(" "),a("div",{staticClass:"table"},[t._m(4),t._v(" "),t._l(t.tableList,function(e,r){return a("div",{key:r,staticClass:"content"},[a("div",{staticClass:"name"},[a("div",{staticClass:"item"},[a("span",[t._v(t._s(e.name))]),t._v(" "),e.tips?a("span",{staticClass:"tips"},[t._v("（"+t._s(e.tips)+"）")]):t._e()])]),t._v(" "),a("div",{staticClass:"word"},[a("ul",t._l(e.list,function(e,r){return a("li",{key:r},[t._v(t._s(e.word)),e.tips?a("em",[t._v("（"+t._s(e.tips)+"）")]):t._e()])}))])])})],2)]),t._v(" "),a(t.showWin,{tag:"component",attrs:{pSelGoods:t.matListSel,pGoodsList:t.matList,pCategory:t.matCate,pSelCategory:t.matCateSel,pSelBtn:t.matBtnSel,showMenus:t.comMenus,title:t.comTitle,list:t.comList,fieldName:"name",relAttr:"ischain",selectList:t.comSel},on:{selGoods:t.selMaterialWin,throwCommonWin:t.comWin}})],t._v(" "),t.isSelBom?a("sel-bom",{attrs:{isAll:t.bomStore,selBom:t.selectBom},on:{emit:t.getSelBom}}):t._e()],2)};r._withStripped=!0;var n=a("81a2"),i=a("f6ce"),s=a("44e7"),o=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var a=[],r=!0,n=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(a.push(s.value),!e||a.length!==e);r=!0);}catch(t){n=!0,i=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}return a}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function r(n,i){try{var s=e[n](i),o=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(o).then(function(t){r("next",t)},function(t){r("throw",t)});t(o)}("next")})}}var c={data:function(){return{tempId:"",tempName:"",userName:"",isSelBom:!1,selectBom:[],bomStore:!1,assignType:1,showWin:null,isSearch:!1,winParam:"",matList:[],matListSel:[],matPage:1,matCid:"",matName:"",matCate:[],matCateSel:[],matBtnSel:"",comTitle:"",comList:[],comMenus:!1,comSel:[],storeSel:[],isSaveClick:!1,taskId:"",checkAlert:!1,timeId:"",cateList:"",formList:[{name:"物料指派",param:"material",selStr:""},{name:"供应商指派",param:"supplier",selStr:""},{name:"BOM单指派",param:"bom",tips:"指派BOM单未匹配消耗仓库",selStr:""},{name:"物料单位指派",param:"unit",selStr:""},{name:"物料分类指派",param:"cate",selStr:""},{name:"商品品牌指派",param:"brand",selStr:""}],tabList:["只新增指派","覆盖指派（请慎重选择）","更新指派（请慎重选择）"],tableList:[{name:"只新增指派",list:[{word:"1.以重名的被指派内容（品牌、分类、单位、供应商、BOM单商品名、物料）为比较依据："},{word:"A、待指派的内容中有，被指派的店铺没有的内容：新增到店铺内。"},{word:"B、待指派内容中有，被指派的店铺也有的内容：保留原内容不变。"},{word:"C、待指派内容中没有，被指派的店铺有的内容：保留原内容不变。"},{word:"2.指派物料到店铺中时，若该店铺中没有该物料的分类或单位或商品品牌时，则该条目指派失败。"},{word:"3.指派BOM单到店铺中时，若该店铺中没有该BOM单的物料时，则该条目指派失败。若被指派店铺中没有这个BOM单中的商品，则该条目指派失败。"},{word:"4.指派BOM单时，若果所选物料跟单店物料的单位不一样，则指派失败。"}]},{name:"覆盖指派",tips:"请慎重选择",list:[{word:"1.以重名的被指派内容（品牌、分类、单位、供应商、BOM单商品名、物料）为比较依据："},{word:"A、待指派的内容中有，被指派的店铺没有的内容：新增到店铺内。"},{word:"B、待指派内容中有，被指派的店铺也有的内容：覆盖掉原内容。",tips:"库存数据和销售数据全部删除"},{word:"C、待指派内容中没有，被指派的店铺有的内容：保留原内容不变。"},{word:"2.指派物料到店铺中时，若该店铺中没有该物料的分类或单位或商品品牌时，则指派失败。"},{word:"3.指派BOM单到店铺中时，若该店铺中没有该BOM单的物料时，则该条目指派失败。若被指派店铺中没有这个BOM单中的商品，则该条目指派失败。"},{word:"4.指派BOM单时，若果所选物料跟单店物料的单位不一样，则指派失败。"}]},{name:"更新指派",tips:"请慎重选择",list:[{word:"1.以重名的被指派内容（品牌、分类、单位、供应商、BOM单商品名、物料）为比较依据："},{word:"A、待指派的内容中有，被指派的店铺没有的内容：新增到店铺内。"},{word:"B、待指派内容中有，被指派的店铺也有的内容：覆盖掉原内容。",tips:"库存数据和销售数据全部删除"},{word:"C、待指派内容中没有，被指派的店铺有的内容：删除掉原内容。",tips:"库存数据和销售数据全部删除"},{word:"2.指派物料到店铺中时，若该店铺中没有该物料的分类或单位或商品品牌时，则指派失败。"},{word:"3.指派BOM单到店铺中时，若该店铺中没有该BOM单的物料时，则该条目指派失败。若被指派店铺中没有这个BOM单中的商品，则该条目指派失败。"},{word:"4.指派BOM单时，若果所选物料跟单店物料的单位不一样，则指派失败。"}]}],_shopList:[],_sendObj:{mids:[],mType:1,supplierIds:[],bomIds:[],bType:1,muIds:[],mcIds:[],brandIds:[],shopIds:""},_selList:{material:[],supplier:[],bom:[],unit:[],cate:[],brand:[],store:[]},_reqData:{unit:[],cate:[],brand:[]},_relationParam:[{sel:"cate",send:"mcIds"},{sel:"unit",send:"muIds"},{sel:"brand",send:"brandIds"}],_defRelParam:[{sel:"material",send:"mids"},{sel:"supplier",send:"supplierIds"},{sel:"bom",send:"bomIds"},{sel:"cate",send:"mcIds"},{sel:"unit",send:"muIds"},{sel:"brand",send:"brandIds"}]}},created:function(){this.$data._shopList=i.a.session("shopList")},mounted:function(){console.log("2"),this.initBtn(),this.requiredData(),this.userName=i.a.session("userShop").user.name,this.tempId=i.a.session("brandAssignId"),this.tempId&&this.setDefault()},destroyed:function(){i.a.session("brandAssignId",null)},components:{onOff:function(){return a.e("on_off").then(a.bind(null,"034b"))},selBom:function(){return a.e("select_bom_assign").then(a.bind(null,"3b0c"))},selMaterial:function(){return a.e("page_select_all").then(a.bind(null,"40e9"))},selWin:function(){return a.e("assign_list_win").then(a.bind(null,"38b2"))},selCate:function(){return a.e("add_category_com").then(a.bind(null,"16ef"))}},methods:{initBtn:function(){var t=this,e=[{name:"返回",style:"background: none;border: 1px solid #b3b3b3;color: #b3b3b3;",fn:function(){window.history.go(-1)}},{name:"保存",style:"background: none;border: 1px solid #fe8d01;color: #fe8d01;",fn:function(){t.tempId?t.editTemplate():t.addTemplate()}},{name:"指派",style:"background: #fe8d01;border: 1px solid #fe8d01;color: #fff;",fn:function(){t.brandAssign()}}];this.$store.commit("setPageTools",e)},setDefault:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,r,i,s,o,l,c,d,m,u,h,f,v,p,b,y,_,w,S,g,k;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.InventorgetPowerTemplate({data:{id:t.tempId}});case 2:for(r in a=e.sent,t.assignType=a.content.assignType,t.userName=a.createUName,t.tempName=a.name,t.$data._sendObj)"shopIds"==r?t.$data._sendObj.shopIds=a.content.shopIds.join(","):t.$data._sendObj[r]=a.content[r];a.content.mType>1?t.matBtnSel=a.content.mType-1:t.matBtnSel="",t.bomStore=2==a.content.bType,i=[],s=!0,o=!1,l=void 0,e.prev=13,c=a.content.shopIds[Symbol.iterator]();case 15:if(s=(d=c.next()).done){e.next=47;break}m=d.value,u=!0,h=!1,f=void 0,e.prev=20,v=t.$data._shopList[Symbol.iterator]();case 22:if(u=(p=v.next()).done){e.next=30;break}if((b=p.value).id!=m){e.next=27;break}return i.push({id:b.id,name:b.shopName,ischain:b.ischain}),e.abrupt("break",30);case 27:u=!0,e.next=22;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(20),h=!0,f=e.t0;case 36:e.prev=36,e.prev=37,!u&&v.return&&v.return();case 39:if(e.prev=39,!h){e.next=42;break}throw f;case 42:return e.finish(39);case 43:return e.finish(36);case 44:s=!0,e.next=15;break;case 47:e.next=53;break;case 49:e.prev=49,e.t1=e.catch(13),o=!0,l=e.t1;case 53:e.prev=53,e.prev=54,!s&&c.return&&c.return();case 56:if(e.prev=56,!o){e.next=59;break}throw l;case 59:return e.finish(56);case 60:return e.finish(53);case 61:for(t.storeSel=i,t.$data._selList.store=i,y=!0,_=!1,w=void 0,e.prev=66,S=t.$data._defRelParam[Symbol.iterator]();!(y=(g=S.next()).done);y=!0)"bom"==(k=g.value).sel&&(t.selectBom=t.$data._sendObj.bomIds),t.$data._selList[k.sel]=t.$data._sendObj[k.send];e.next=74;break;case 70:e.prev=70,e.t2=e.catch(66),_=!0,w=e.t2;case 74:e.prev=74,e.prev=75,!y&&S.return&&S.return();case 77:if(e.prev=77,!_){e.next=80;break}throw w;case 80:return e.finish(77);case 81:return e.finish(74);case 82:2==a.content.mType?t.matCateSel=t.$data._selList.material:t.matListSel=t.$data._selList.material,t.setSelTips(),t.setNotAllow();case 85:case"end":return e.stop()}},e,t,[[13,49,53,61],[20,32,36,44],[37,,39,43],[54,,56,60],[66,70,74,82],[75,,77,81]])}))()},setSelTips:function(){var t=this.$data._sendObj;2==t.mType?this.formList[0].selStr=t.mids[0].name+"(分类)":3==t.mType?this.formList[0].selStr="全部":this.formList[0].selStr=t.mids.length?t.mids.length+"个":"",2==t.bType?this.formList[2].selStr="全部":1==t.bType&&(this.formList[2].selStr=t.bomIds.length?t.bomIds.length+"个":"");var e=!0,a=!1,r=void 0;try{for(var n,i=this.formList[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var s=n.value;if("material"!=s.param&&"bom"!=s.param){var o=this.$data._selList;s.selStr=o[s.param].length?o[s.param].length+"个":""}}}catch(t){a=!0,r=t}finally{try{!e&&i.return&&i.return()}finally{if(a)throw r}}},setNotAllow:function(){var t=!0,e=!1,a=void 0;try{for(var r,n=["cate","unit","brand"][Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var i=r.value,s=!0,o=!1,l=void 0;try{for(var c,d=this.$data._selList[i][Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var m=c.value,u=!0,h=!1,f=void 0;try{for(var v,p=this.$data._reqData[i][Symbol.iterator]();!(u=(v=p.next()).done);u=!0){var b=v.value;if(m.id==b.id&&m.notAllow){b.notAllow=!0;break}}}catch(t){h=!0,f=t}finally{try{!u&&p.return&&p.return()}finally{if(h)throw f}}}}catch(t){o=!0,l=t}finally{try{!s&&d.return&&d.return()}finally{if(o)throw l}}}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}},saveVeri:function(){return this.tempName.trim()?!!this.$data._sendObj.shopIds||(this.myAlert("请选择适用店铺"),!1):(this.myAlert("请填写方案名称"),!1)},setSendParam:function(t){var e=this.$data._sendObj,a={name:this.tempName,userName:this.userName,shopIds:e.shopIds,type:this.assignType,mids:e.mids,mType:e.mType,supplierIds:e.supplierIds,bomIds:e.bomIds,bType:e.bType,muIds:e.muIds,mcIds:e.mcIds,brandIds:e.brandIds};return t&&(a.id=this.tempId?this.tempId:0),a},addTemplate:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.saveVeri()){e.next=2;break}return e.abrupt("return");case 2:if(!t.isSaveClick){e.next=5;break}return t.myAlert("请勿重复点击"),e.abrupt("return");case 5:return t.isSaveClick=!0,a=null,r=t.setSendParam(),e.prev=8,e.next=11,n.a.addAssignTemplate({data:r},!0);case 11:a=e.sent,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),t.$store.commit("setWin",{title:"错误提示",content:e.t0.error.message}),t.isSaveClick=!1;case 18:a&&(t.myAlert("模板保存成功"),t.isSaveClick=!1,t.tempId=a);case 19:case"end":return e.stop()}},e,t,[[8,14]])}))()},editTemplate:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.saveVeri()){e.next=2;break}return e.abrupt("return");case 2:return a=t.setSendParam(!0),e.next=5,n.a.editAssignTemplate({data:a});case 5:e.sent&&t.myAlert("模板修改成功");case 7:case"end":return e.stop()}},e,t)}))()},brandAssign:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.saveVeri()){e.next=2;break}return e.abrupt("return");case 2:return a=t.setSendParam(!0),e.next=5,n.a.InventoryassignAssignStart({data:a});case 5:(r=e.sent)&&(t.taskId=r.taskId,t.timeId=s.a.add(t.checkUp,2e3,200),t.$store.commit("setWin",{title:"提示",winType:"alert",content:"正在指派....",maskShow:!1,callback:function(e){"ok"!=e?s.a.clear(t.timeId):t.checkAlert=!0}}));case 7:case"end":return e.stop()}},e,t)}))()},checkUp:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.invoicing_taskInfo({data:{taskId:t.taskId}});case 2:3==(a=e.sent).status&&(r="品牌指派成功！请前往指派日志查看结果。",t.checkAlert?(t.myAlert(r),t.checkAlert=!1):t.$store.commit("setWinContent",r),s.a.clear(t.timeId)),2==a.status&&(i="品牌指派失败！请前往指派日志查看结果。",t.checkAlert?(t.myAlert(i),t.checkAlert=!1):t.$store.commit("setWinContent",i),s.a.clear(t.timeId));case 5:case"end":return e.stop()}},e,t)}))()},requiredData:function(){var t=this;n.a.MaterialGetUnitList().then(function(e){t.$data._reqData.unit=e}),n.a.MaterialGetCategoryList().then(function(e){t.$data._reqData.cate=e}),n.a.InvoicingBrandList().then(function(e){t.$data._reqData.brand=e})},openMatWin:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.MaterialGetCategoryList();case 2:a=e.sent,t.matCate=a,t.showWin="selMaterial";case 5:case"end":return e.stop()}},e,t)}))()},openSupWin:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.showWin="selWin",t.comTitle="选择供应商",e.next=4,n.a.suppierList();case 4:(a=e.sent)&&(t.comList=a);case 6:case"end":return e.stop()}},e,t)}))()},openBomWin:function(){this.isSelBom=!0},openStoreWin:function(){var t=this;return l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.showWin="selWin",t.comTitle="选择店铺",t.comList=t.$data._shopList.map(function(t){return{id:t.id,name:t.shopName,ischain:t.ischain}});case 3:case"end":return e.stop()}},e,t)}))()},openReqWin:function(t,e){for(var a in this.showWin="选择分类"==t?"selCate":"selWin",this.comTitle=t,this.$data._reqData)e==a&&(this.comList=this.$data._reqData[e])},openWin:function(t){switch(this.winParam=t,this.comSel=this.$data._selList[t],t){case"material":this.openMatWin();break;case"supplier":this.comMenus=!1,this.openSupWin();break;case"bom":this.openBomWin();break;case"unit":this.comMenus=!1,this.openReqWin("选择单位","unit");break;case"cate":this.comMenus=!1,this.openReqWin("选择分类","cate");break;case"brand":this.comMenus=!1,this.openReqWin("选择品牌","brand");break;case"store":this.comMenus=!0,this.openStoreWin()}},selMaterialWin:function(t,e){if("ok"==t){if(this.matListSel=e.pSelGoods,2==e.pSelBtn.id)this.$data._sendObj.mids=[],this.$data._sendObj.mType=3,this.matBtnSel=e.pSelBtn.id,this.formList[0].selStr="全部",this.relationList(3),this.matCateSel=[];else if(1==e.pSelBtn.id){this.$data._sendObj.mType=2,this.matBtnSel=e.pSelBtn.id;var a=[],r={};e.parent.length&&(r={id:e.parent[0].id,name:e.parent[0].name},a.push(r)),e.child.length&&(r={id:e.child[0].id,name:e.child[0].name},a.push(r)),this.$data._sendObj.mids=[r],this.matCateSel=[r],this.formList[0].selStr=r.name+"(分类)",this.relationList(2,a)}else{this.$data._sendObj.mType=1;var n=[],i=!0,s=!1,o=void 0;try{for(var l,c=e.pSelGoods[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value;n.push({id:d.id,name:d.name})}}catch(t){s=!0,o=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw o}}this.matBtnSel=-1,this.$data._sendObj.mids=n,this.formList[0].selStr=this.$data._sendObj.mids.length+"个",this.relationList(1,"",e.pSelGoods),this.matCateSel=[]}this.showWin=null}else this.showWin=null},relationList:function(t,e,a){var r=this;if(this.clearAllow(),3==t){var i=!0,s=!1,o=void 0;try{for(var l,c=this.$data._relationParam[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value,m=this.$data._reqData[d.sel].map(function(t){return{id:t.id,name:t.name,notAllow:!0}});this.$data._selList[d.sel]=m,this.$data._sendObj[d.send]=m}}catch(t){s=!0,o=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw o}}this.setSelTips(),this.setNotAllow()}else if(2==t){var u=[],h=!0,f=!1,v=void 0;try{for(var p,b=e[Symbol.iterator]();!(h=(p=b.next()).done);h=!0){var y=p.value;u.push({id:y.id,name:y.name,notAllow:!0})}}catch(t){f=!0,v=t}finally{try{!h&&b.return&&b.return()}finally{if(f)throw v}}this.notRepeatContact(this.$data._selList.cate,u);var _=e.length>1?e[1].id:e[0].id,w=n.a.MaterialGetUnitidsBycid({data:{cids:_+""}}).then(function(t){var e=[],a=!0,n=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value,c=!0,d=!1,m=void 0;try{for(var u,h=r.$data._reqData.unit[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var f=u.value;if(l.id==f.id){e.push({id:l.id,name:l.name,notAllow:!0});break}}}catch(t){d=!0,m=t}finally{try{!c&&h.return&&h.return()}finally{if(d)throw m}}}}catch(t){n=!0,i=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}r.notRepeatContact(r.$data._selList.unit,e)}),S=n.a.MaterialGetBrandIdByCids({data:{cids:e[0].id+""}}).then(function(t){var e=[],a=!0,n=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value,c=!0,d=!1,m=void 0;try{for(var u,h=r.$data._reqData.brand[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var f=u.value;if(l==f.id){e.push({id:f.id,name:f.name,notAllow:!0});break}}}catch(t){d=!0,m=t}finally{try{!c&&h.return&&h.return()}finally{if(d)throw m}}}}catch(t){n=!0,i=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}r.notRepeatContact(r.$data._selList.brand,e)});Promise.all([w,S]).then(function(){r.setSelTips(),r.setNotAllow()})}else{var g={cate:[],unit:[],brand:[]},k=!0,I=!1,C=void 0;try{for(var $,x=a[Symbol.iterator]();!(k=($=x.next()).done);k=!0){var L=$.value,A=!0,B=!1,O=void 0;try{for(var W,T=L.cate[Symbol.iterator]();!(A=(W=T.next()).done);A=!0){var M=W.value,j=this.isArrayItem(g.cate,M.cid),R=!0,N=!1,P=void 0;try{for(var q,D=this.$data._reqData.cate[Symbol.iterator]();!(R=(q=D.next()).done);R=!0){var G=q.value;if(M.cid==G.id&&!j){g.cate.push({id:G.id,name:G.name,notAllow:!0});break}}}catch(t){N=!0,P=t}finally{try{!R&&D.return&&D.return()}finally{if(N)throw P}}}}catch(t){B=!0,O=t}finally{try{!A&&T.return&&T.return()}finally{if(B)throw O}}var E=!0,U=!1,V=void 0;try{for(var J,z=L.unit[Symbol.iterator]();!(E=(J=z.next()).done);E=!0){var F=J.value,H=(j=this.isArrayItem(g.unit,F.muId),!0),K=!1,Q=void 0;try{for(var X,Y=this.$data._reqData.unit[Symbol.iterator]();!(H=(X=Y.next()).done);H=!0){var Z=X.value;if(F.muId==Z.id&&!j){g.unit.push({id:Z.id,name:Z.name,notAllow:!0});break}}}catch(t){K=!0,Q=t}finally{try{!H&&Y.return&&Y.return()}finally{if(K)throw Q}}}}catch(t){U=!0,V=t}finally{try{!E&&z.return&&z.return()}finally{if(U)throw V}}var tt=!0,et=!1,at=void 0;try{for(var rt,nt=this.$data._reqData.brand[Symbol.iterator]();!(tt=(rt=nt.next()).done);tt=!0){var it=rt.value;j=this.isArrayItem(g.brand,it.id);if(L.brandId==it.id&&!j){g.brand.push({id:it.id,name:it.name,notAllow:!0});break}}}catch(t){et=!0,at=t}finally{try{!tt&&nt.return&&nt.return()}finally{if(et)throw at}}}}catch(t){I=!0,C=t}finally{try{!k&&x.return&&x.return()}finally{if(I)throw C}}var st=!0,ot=!1,lt=void 0;try{for(var ct,dt=this.$data._relationParam[Symbol.iterator]();!(st=(ct=dt.next()).done);st=!0){var mt=ct.value;this.notRepeatContact(this.$data._selList[mt.sel],g[mt.sel]);var ut=g[mt.sel].map(function(t){return{id:t.id,name:t.name,notAllow:!0}});this.notRepeatContact(this.$data._sendObj[mt.send],ut)}}catch(t){ot=!0,lt=t}finally{try{!st&&dt.return&&dt.return()}finally{if(ot)throw lt}}this.setSelTips(),this.setNotAllow()}},notRepeatContact:function(t,e){var a=!0,r=!1,n=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var o=i.value,l=!1,c=!0,d=!1,m=void 0;try{for(var u,h=t[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var f=u.value;if(o.id==f.id){l=!0,f.notAllow=!0;break}}}catch(t){d=!0,m=t}finally{try{!c&&h.return&&h.return()}finally{if(d)throw m}}l||t.push(o)}}catch(t){r=!0,n=t}finally{try{!a&&s.return&&s.return()}finally{if(r)throw n}}},isArrayItem:function(t,e){var a=!0,r=!1,n=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){if(i.value.id==e)return!0}}catch(t){r=!0,n=t}finally{try{!a&&s.return&&s.return()}finally{if(r)throw n}}return!1},clearAllow:function(){var t=!0,e=!1,a=void 0;try{for(var r,n=this.$data._relationParam[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var i=r.value,s=this.$data._selList[i.sel],o=this.$data._sendObj[i.send],l=!0,c=!1,d=void 0;try{for(var m,u=this.$data._reqData[i.sel][Symbol.iterator]();!(l=(m=u.next()).done);l=!0){delete m.value.notAllow}}catch(t){c=!0,d=t}finally{try{!l&&u.return&&u.return()}finally{if(c)throw d}}for(var h=0;h<s.length;h++)s[h].notAllow&&(s.splice(h,1),h--);for(var f=0;f<o.length;f++)o[f].notAllow&&(o.splice(f,1),f--)}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}},closeSupWin:function(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];var r=o(e,4),n=r[0],i=r[1],s=r[2],l=r[3];"ok"==i&&(this.$data._selList[l]=n,this.$data._sendObj[s]=n.map(function(t){return t.notAllow?{id:t.id,name:t.name,notAllow:t.notAllow}:{id:t.id,name:t.name}}),this.setSelTips()),this.showWin=null},getSelBom:function(t,e){this.isSelBom=!1,this.initBtn(),t&&(this.bomStore=e,this.bomStore?(this.selectBom=[],this.$data._sendObj.bomIds=[],this.$data._sendObj.bType=2,this.formList[2].selStr="全部"):(this.selectBom=t,this.$data._sendObj.bomIds=t.map(function(t){return{id:t.id,name:t.name}}),this.$data._sendObj.bType=1,this.$data._sendObj.bomIds.length?this.formList[2].selStr=this.$data._sendObj.bomIds.length+"个":this.formList[2].selStr=""))},closeStoreWin:function(t,e){if("ok"==e){this.storeSel=t,this.$data._selList.store=t;var a=t.map(function(t){return t.id});this.$data._sendObj.shopIds=a.join(","),this.showWin=null}else"close"!=e&&"cancel"!=e||(this.showWin=null)},comWin:function(t,e){switch(this.comList=[],this.winParam){case"supplier":this.closeSupWin(t,e,"supplierIds",this.winParam);break;case"unit":this.closeSupWin(t,e,"muIds",this.winParam);break;case"cate":this.closeSupWin(t,e,"mcIds",this.winParam);break;case"brand":this.closeSupWin(t,e,"brandIds",this.winParam);break;case"store":this.closeStoreWin(t,e)}},myAlert:function(t){this.$store.commit("setWin",{title:"操作提示",content:t})},getMaterialList:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.getMaterialList({data:{page:t.matPage,name:t.matName,cid:t.matCid,num:50}});case 2:a=e.sent,t.matList=a.list,t.matPageObj={totalNum:a.total};case 5:case"end":return e.stop()}},e,t)}))()}}},d=(a("ec4f"),a("6ceb")),m=Object(d.a)(c,r,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"line-title"},[this._v("\n\t\t\t\t新建指派"),e("p")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tips"},[e("i"),this._v("限20字以内")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"line-title"},[this._v("\n\t\t\t\t适用店铺"),e("p")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"line-title"},[this._v("\n\t\t\t\t指派方式"),e("p")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",{staticClass:"name"},[this._v("指派类型")]),this._v(" "),e("span",{staticClass:"word"},[this._v("指派规则")])])}],!1,null,"3d652aab",null);m.options.__file="src\\module\\invoicing_system\\brand_assign\\create_assign.vue";e.default=m.exports},cc7b:function(t,e,a){},ec4f:function(t,e,a){"use strict";var r=a("cc7b");a.n(r).a}}]);