(window.webpackJsonp=window.webpackJsonp||[]).push([["category_charts"],{"04ab":function(e,t,s){"use strict";var i=s("8b5d");s.n(i).a},"6d03":function(e,t,s){"use strict";s.r(t);var i=s("bbb9");var h=null,a={data:function(){return{goods:!1,classification:[],selGood:{id:"",type:"",name:"",shopList:[]},chartsTitle:{flag:0,list:[]},series:[],ChartShopName:[],ChartSelShop:[],yellowShopList:[],blueShopList:[],greenShopList:[],yellow:{id:"",name:""},blue:{id:"",name:""},green:{id:"",name:""}}},props:["formData","headList","flag","shopName","buttonFlag","shopList","changeCharts","chooseShopList"],watch:{buttonFlag:function(){this.chartsTitle.flag=0,this.changeTitlechart(this.chartsTitle.flag,this.headList[this.chartsTitle.flag])},changeCharts:function(){this.init(),this.chartsTitle.list=this.selGood,this.changeTitlechart(this.chartsTitle.flag,this.headList[this.chartsTitle.flag])}},created:function(){this.getShopname()},mounted:function(){var e,t=this;return(e=regeneratorRuntime.mark(function e(){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.e("echarts").then(function(){var e=s("375c");return"object"==typeof e&&e&&e.__esModule?e:Object.assign({},"object"==typeof e&&e,{default:e})});case 2:h=e.sent,t.init(),a=i.a.deepCopy(t.classification[0].shop[0]),o=0;case 6:if(!(o<a.length)){e.next=16;break}if(!(a[o].categoryId&&a[o].categoryId<1e5)){e.next=13;break}return t.selGood.id=a[o].categoryId,t.selGood.type="cate",t.selGood.name=a[o].categoryName,t.selGood.cate="cate",e.abrupt("break",16);case 13:o++,e.next=6;break;case 16:t.chartsTitle.list=t.selGood,t.changeTitlechart(t.chartsTitle.flag,t.headList[t.chartsTitle.flag]);case 18:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,s){return function i(h,a){try{var o=t[h](a),r=o.value}catch(e){return void s(e)}if(!o.done)return Promise.resolve(r).then(function(e){i("next",e)},function(e){i("throw",e)});e(r)}("next")})})()},methods:{init:function(){var e={shopId:"a",shopName:"b",goodsNum:"c",num:"d",attrPrice:"e",freeNum:"f",freePrice:"g",returnNum:"h",returnPrice:"i",discountPrice:"j",price:"k",totalPrice:"l",barCode:"m",secBarCode:"n",specifications:"o",unitPrice:"p",child:"q",goods:"r",categoryName:"t",categoryId:"u",gid:"v",goodName:"w"};this.classification=i.a.deepCopy(this.formData);for(var t=0;t<this.classification.length;t++){this.classification[t].shop=Object.values(this.classification[t].shop);for(var s=this.classification[t].shop,h=0;h<s.length;h++){s[h]=Object.values(s[h]);for(var a=s[h],o=0;o<a.length;o++){for(var r in a[o].q=Object.values(a[o].q),a[o].r=Object.values(a[o].r),e)"gid"!=r&&"goodsName"!=r&&(a[o][r]=a[o][e[r]],delete a[o][e[r]]);for(var l=a[o].goods,n=a[o].child,c=0;c<n.length;c++){for(var p in n[c].r=Object.values(n[c].r),e)"gid"!=p&&"goodsName"!=p&&(n[c][p]=n[c][e[p]],delete n[c][e[p]]);for(var g=n[c].goods,m=0;m<g.length;m++)for(var d in e)"gid"!=d&&"goodsName"!=d&&"categoryId"!=d&&"categoryName"!=d&&"child"!=d&&"goods"!=d&&(g[m][d]=g[m][e[d]],delete g[m][e[d]])}for(var f=0;f<l.length;f++)for(var S in l[f].goods=Object.values(l[f]),e)l[f][S]=l[f][e[S]],delete l[f][e[S]]}}}},chooseGoods:function(){this.goods=!this.goods},getShopList:function(){this.yellowShopList=this.ChartShopName.filter(function(e){return"chblue"!=e.className&&"chgreen"!=e.className}),this.blueShopList=this.ChartShopName.filter(function(e){return"chyellow"!=e.className&&"chgreen"!=e.className}),this.greenShopList=this.ChartShopName.filter(function(e){return"chblue"!=e.className&&"chyellow"!=e.className})},getYellow:function(e){for(var t={},s=0;s<this.chooseShopList.length;s++)if(e.includes(this.chooseShopList[s].id)){t.name=this.chooseShopList[s].shopName,t.id=this.chooseShopList[s].id,t.className="chyellow";break}this.yellowShopList.forEach(function(e){e.className="",e.name==t.name&&(e.className="chyellow")}),this.yellow.name=t.name,this.yellow.id=t.id,this.getShopList(),this.chartShops(t,"chyellow")},getBlue:function(e){for(var t={},s=0;s<this.chooseShopList.length;s++)if(e.includes(this.chooseShopList[s].id)){t.name=this.chooseShopList[s].shopName,t.id=this.chooseShopList[s].id,t.className="chblue";break}this.blueShopList.forEach(function(e){e.className="",e.name==t.name&&(e.className="chblue")}),this.blue.name=t.name,this.blue.id=t.id,this.getShopList(),this.chartShops(t,"chblue")},getGreen:function(e){for(var t={},s=0;s<this.chooseShopList.length;s++)if(e.includes(this.chooseShopList[s].id)){t.name=this.chooseShopList[s].shopName,t.id=this.chooseShopList[s].id,t.className="chgreen";break}this.greenShopList.forEach(function(e){e.className="",e.name==t.name&&(e.className="chgreen")}),this.green.name=t.name,this.green.id=t.id,this.getShopList(),this.chartShops(t,"chgreen")},chartShops:function(e,t){console.log(t);for(var s=0;s<this.ChartSelShop.length;s++)this.ChartSelShop[s].className!=t&&""!=this.ChartSelShop[s].className||this.ChartSelShop.splice(s,1);this.ChartSelShop.push(e),console.log(this.ChartSelShop),this.selSeries=[];for(var i=0;i<this.ChartSelShop.length;i++)for(var h=0;h<this.series.length;h++)this.ChartSelShop[i].name==this.series[h].name&&this.selSeries.push(this.series[h]);0===this.flag?this.showEchart():this.showPercent()},getShopname:function(){if(console.log(this.shopName),console.log(this.chooseShopList),"请选择店铺"!=this.shopName){for(var e=[],t=0;t<this.chooseShopList.length;t++){var s={};s.name=this.chooseShopList[t].shopName,s.id=this.chooseShopList[t].id,s.ischain=this.chooseShopList[t].ischain,s.storeAreaId=this.chooseShopList[t].storeAreaId,s.shopName=this.chooseShopList[t].shopName,0===t?(s.className="chyellow",this.yellow.name=this.chooseShopList[t].shopName,this.yellow.id=this.chooseShopList[t].id):1===t?(s.className="chblue",this.blue.name=this.chooseShopList[t].shopName,this.blue.id=this.chooseShopList[t].id):2===t?(s.className="chgreen",this.green.name=this.chooseShopList[t].shopName,this.green.id=this.chooseShopList[t].id):s.className="",e.push(s)}this.ChartShopName=e,this.ChartSelShop=e.slice(0,3)}else this.shopName="请选择店铺";this.getShopList()},getColor:function(e,t){for(var s=0;s<e.length;s++)if(e[s].className==t)return!1;return!0},chartColor:function(e,t){for(var s=0;s<this.series.length;s++)if(this.series[s].name==e){this.selSeries.push(this.series[s]);for(var i=0;i<this.ChartShopName.length;i++)e==this.ChartShopName[i].name&&this.ChartSelShop.push(this.ChartShopName[i])}for(var h=0;h<this.ChartShopName.length;h++)e==this.ChartShopName[h].name&&(this.ChartShopName[h].className=t)},chartShop:function(e){if(e.className){for(var t=0;t<this.selSeries.length;t++)this.selSeries[t].name==e.name&&this.selSeries.splice(t,1);for(var s=0;s<this.ChartSelShop.length;s++)this.ChartSelShop[s].name==e.name&&this.ChartSelShop.splice(s,1);for(var h=0;h<this.ChartShopName.length;h++)e.name==this.ChartShopName[h].name&&(this.ChartShopName[h].className="")}else if(3==this.selSeries.length){for(var a=i.a.deepCopy(this.ChartShopName),o=i.a.deepCopy(this.ChartSelShop),r=o[0].className,l=0;l<a.length;l++)o[0].name===a[l].name&&(a[l].className="");for(var n=0;n<a.length;n++)e.name===a[n].name&&(a[n].className=r,(o=o.splice(1,3)).push(a[n]));this.ChartSelShop=o,this.ChartShopName=a,this.selSeries=[];for(var c=0;c<this.ChartSelShop.length;c++)for(var p=0;p<this.series.length;p++)this.ChartSelShop[c].name==this.series[p].name&&this.selSeries.push(this.series[p])}else this.getColor(this.ChartShopName,"chyellow")?this.chartColor(e.name,"chyellow"):this.getColor(this.ChartShopName,"chblue")?this.chartColor(e.name,"chblue"):this.getColor(this.ChartShopName,"chgreen")&&this.chartColor(e.name,"chgreen");0===this.flag?this.showEchart():this.showPercent()},changeTitlechart:function(e,t){this.chartsTitle.flag=e,this.getCharts(t.type),this.dataTime=this.dataTime.reverse(),0===this.flag?this.showEchart():this.showPercent()},judgeShop:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];for(var i=t[0],h=t[1],a=t[2],o=0;o<i.length;o++)if("cate"==h.type){if(i[o].categoryName==h.name)return i[o][a];for(var r=0;r<i[o].child.length;r++)if(i[o].child[r].categoryName==h.name)return i[o].child[r][a]}else if("goods"==h.type){for(var l=0;l<i[o].goods.length;l++)if(i[o].goods[l].goodName==h.name)return i[o].goods[l][a];for(var n=0;n<i[o].child.length;n++)for(var c=0;c<i[o].child[n].goods.length;c++)if(i[o].child[n].goods[c].goodName==h.name)return i[o].child[n].goods[c][a]}else if("package"==h.type)for(var p=0;p<i[o].goods.length;p++)if(i[o].goods[p].goodName==h.name)return i[o].goods[p][a]},isShopData:function(e,t){for(var s=0;s<t.length;s++)if(e==t[s][0].shopName)return!0;return!1},chartDatas:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];for(var i=t[0],h=t[1],a=t[2],o=t[3],r=t[4],l=t[5],n=0;n<h.length;n++){a[h[n].name]=[];for(var c=0;c<i.length;c++){o[c]=i[c].time;for(var p=0;p<i[c].shop.length;p++)this.isShopData(h[n].name,i[c].shop)?h[n].name==i[c].shop[p][0].shopName&&(a[h[n].name][c]=this.judgeShop(i[c].shop[p],r,l)):a[h[n].name][c]=0}}},getCharts:function(e){var t=this.ChartShopName,s={};this.dataTime=[],this.chartDatas(this.classification,t,s,this.dataTime,this.selGood,e),this.series=[];for(var i=0;i<t.length;i++)for(var h in this.series[i]={},s)t[i].name==h&&(this.series[i].name=t[i].name,this.series[i].data=s[h],0===this.flag?this.series[i].type="line":this.series[i].type="bar");if(3==this.flag||4==this.flag)for(var a=0;a<this.series.length;a++)for(var o=0;o<this.series[a].data.length;o++)"-"==this.series[a].data[o][0]?this.series[a].data[o]=0:0==this.series[a].data[o]?this.series[a].data[o]=0:this.series[a].data[o]=this.series[a].data[o][0];this.selSeries=[];for(var r=0;r<this.series.length;r++)this.series[r].data.reverse();for(var l=0;l<this.ChartSelShop.length;l++)for(var n=0;n<this.series.length;n++)this.ChartSelShop[l].name==this.series[n].name&&this.selSeries.push(this.series[n])},changeColor:function(){console.log(this.selSeries),console.log(this.ChartSelShop);for(var e=0;e<this.selSeries.length;e++){this.selSeries[e].itemStyle={normal:{lineStyle:{color:"#00FF00"}}};for(var t=0;t<this.ChartShopName.length;t++)this.selSeries[e].name==this.ChartShopName[t].name&&("chyellow"==this.ChartShopName[t].className?(this.selSeries[e].itemStyle.normal.lineStyle.color="#ffc801",this.selSeries[e].itemStyle.normal.color="#ffc801"):"chblue"==this.ChartShopName[t].className?(this.selSeries[e].itemStyle.normal.lineStyle.color="#1b88ee",this.selSeries[e].itemStyle.normal.color="#1b88ee"):"chgreen"==this.ChartShopName[t].className&&(this.selSeries[e].itemStyle.normal.lineStyle.color="#5eb71c",this.selSeries[e].itemStyle.normal.color="#5eb71c"))}},showEchart:function(){for(var e={},t=0;t<this.ChartShopName.length;t++)e[this.ChartShopName[t].name]=!1;for(var s=0;s<this.selSeries.length;s++)e[this.selSeries[s].name]=!0;for(var i=h.init(this.$refs.myflow),a=0;a<this.selSeries.length;a++)for(var o=0;o<this.selSeries[a].data.length;o++)void 0===this.selSeries[a].data[o]&&(this.selSeries[a].data[o]=0);this.changeColor();var r={tooltip:{trigger:"axis",textStyle:{align:"left"}},legend:{selected:e},toolbox:{show:!0,x:"1100",feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:this.dataTime}],yAxis:[{type:"value"}],series:this.selSeries};i.setOption(r,!0)},showPercent:function(){for(var e={},t=0;t<this.ChartShopName.length;t++)e[this.ChartShopName[t].name]=!1;for(var s=0;s<this.selSeries.length;s++)e[this.selSeries[s].name]=!0;for(var i=0;i<this.selSeries.length;i++)for(var a=0;a<this.selSeries[i].data.length;a++)this.isString(this.selSeries[i].data[a])&&(this.selSeries[i].data[a]=this.selSeries[i].data[a].replace("%",""));for(var o=h.init(this.$refs.percent),r=0;r<this.selSeries.length;r++)this.selSeries[r].barGap="1%";var l="",n=this.chartsTitle.list;1!=this.flag&&2!=this.flag||"orderNum"===n[this.chartsTitle.flag].name&&(l="isok");for(var c=0;c<this.selSeries.length;c++)for(var p=0;p<this.selSeries[c].data.length;p++)void 0===this.selSeries[c].data[p]&&(this.selSeries[c].data[p]=0);var g={tooltip:{trigger:"axis",formatter:l?"":function(e){var t=e[0].name+"<br/>";return 1==e.length?t+=e[0].seriesName+" : "+e[0].value+"%":2==e.length?(t+=e[0].seriesName+" : "+e[0].value+"%<br/>",t+=e[1].seriesName+" : "+e[1].value+"%"):(t+=e[0].seriesName+" : "+e[0].value+"%<br/>",t+=e[1].seriesName+" : "+e[1].value+"%<br/>",t+=e[2].seriesName+" : "+e[2].value+"%"),t}},legend:{selected:e},toolbox:{show:!0,x:"1100",feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",data:this.dataTime}],yAxis:[{type:"value",name:l?"":"单位: %"}],series:this.selSeries};o.setOption(g,!0)},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},getWin:function(e,t,s){this.goods=!1,"ok"==e&&(t.id>=1e5&&-1==t.name.indexOf(s.shopName)&&(t.name+="("+s.shopName+")"),this.selGood=t,this.selGood.shopList=s,this.changeTitlechart(this.chartsTitle.flag,this.headList[this.chartsTitle.flag]))}},destroyed:function(){},components:{addwin:function(){return s.e("category_win").then(s.bind(null,"0f64"))},selectBtn:function(){return s.e("select_btn").then(s.bind(null,"3d41"))},elShopList:function(){return s.e("el_shopList").then(s.bind(null,"60ff"))}}},o=(s("04ab"),s("d801")),r=Object(o.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"category-charts"}},[s("section",[s("span",{staticClass:"sel",staticStyle:{"background-color":"#FF9801",color:"#fff"},on:{click:e.chooseGoods}},[e._v("选择样本数据")]),e._v(" "),e.selGood.name?s("span",{staticStyle:{"margin-left":"10px","font-size":"16px"}},[e._v("已选择："+e._s(e.selGood.name))]):e._e()]),e._v(" "),s("section",{staticStyle:{"text-align":"center"}},[s("div",{staticStyle:{height:"50px","border-bottom":"2px solid #ccc"}},[s("div",{staticStyle:{margin:"0 auto"}},e._l(e.headList,function(t,i){return s("span",{key:i,staticClass:"titleChart",style:{width:100/e.headList.length+"%"}},[s("span",{class:{one:i==e.chartsTitle.flag},staticStyle:{cursor:"pointer",display:"inline-block"},on:{click:function(s){e.changeTitlechart(i,t)}}},[e._v(e._s(t.name))])])}))]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.flag||2==e.flag||3==e.flag||4==e.flag,expression:"flag == 1 || flag == 2 || flag == 3 || flag == 4"}],ref:"percent",staticStyle:{height:"400px",width:"100%"},attrs:{id:"chart"}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===e.flag,expression:"flag === 0"}],ref:"myflow",staticStyle:{height:"400px",width:"100%"},attrs:{id:"chart"}}),e._v(" "),0!=e.ChartShopName.length?s("div",{staticClass:"shops"},[s("div",[e.ChartShopName.length>=1?s("div",{staticClass:"shops_list"},[s("span",{staticClass:"yellowSign shops_sign"}),e._v(" "),s("elShopList",{attrs:{shopIds:e.yellow.id.split(","),isSingle:!0,delShopId:e.yellowShopList},on:{chooseShop:e.getYellow}})],1):e._e(),e._v(" "),e.ChartShopName.length>=2?s("div",{staticClass:"shops_list"},[s("span",{staticClass:"blueSign shops_sign"}),e._v(" "),s("elShopList",{attrs:{shopIds:e.blue.id.split(","),isSingle:!0,delShopId:e.blueShopList},on:{chooseShop:e.getBlue}})],1):e._e(),e._v(" "),e.ChartShopName.length>=3?s("div",{staticClass:"shops_list"},[s("span",{staticClass:"greenSign shops_sign"}),e._v(" "),s("elShopList",{attrs:{shopIds:e.green.id.split(","),isSingle:!0,delShopId:e.greenShopList},on:{chooseShop:e.getGreen}})],1):e._e()])]):e._e()]),e._v(" "),e.goods?s("addwin",{attrs:{goods:e.selGood,shop:e.shopList,chooseShopList:e.chooseShopList},on:{choose:e.getWin}}):e._e()],1)},[],!1,null,"06a19f2a",null);t.default=r.exports},"8b5d":function(e,t,s){}}]);