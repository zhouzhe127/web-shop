(window.webpackJsonp=window.webpackJsonp||[]).push([["bound_public_number"],{"1b7c":function(t,e,r){"use strict";var n=r("5518");r.n(n).a},5518:function(t,e,r){},d5e1:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"weChatBinding"}},[t.isAuth?[r("div",{staticClass:"wx-showBox"},[r("span",[t._v("微信公众号")]),t._v(" "),r("a",{staticClass:"blue addnumber",attrs:{href:"javascript:void(0);"},on:{click:t.addWeChat}},[t._v("重新授权")]),t._v(" "),r("a",{staticClass:"gray addnumber fl",attrs:{href:"javascript:void(0)"},on:{click:t.deleteAuth}},[t._v("解除授权")])]),t._v(" "),r("div",{staticClass:"wx-showBox"},[r("span",[t._v("公众号昵称")]),t._v(" "),r("p",[t._v(t._s(t.authMiniAppName))])])]:r("div",{staticClass:"wx-showBox"},[r("span"),t._v(" "),r("a",{staticClass:"blue addnumber",attrs:{href:"javascript:void(0);"},on:{click:t.addWeChat}},[t._v("添加微信公众号")])]),t._v(" "),r("div",{staticClass:"wx-showBox"},[r("span",{staticClass:"required"},[t._v("AppId")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.appIds,expression:"appIds"}],attrs:{type:"text",placeholder:"请输入AppId",maxlength:"32"},domProps:{value:t.appIds},on:{input:function(e){e.target.composing||(t.appIds=e.target.value)}}})]),t._v(" "),r("div",{staticClass:"wx-showBox"},[r("span",{staticClass:"required"},[t._v("AppSecret")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.appSecrets,expression:"appSecrets"}],attrs:{type:"text",id:"id",oncopy:"return false;",oncut:"return false;",placeholder:"请输入AppSecret",maxlength:"32"},domProps:{value:t.appSecrets},on:{input:function(e){e.target.composing||(t.appSecrets=e.target.value)}}})]),t._v(" "),r("a",{staticClass:"yellow btn",attrs:{href:"javascript:void(0)"},on:{click:t.setConfig}},[t._v("保存")])],2)};n._withStripped=!0;var a=r("81a2"),i=r("f6ce");function s(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){return function n(a,i){try{var s=e[a](i),o=s.value}catch(t){return void r(t)}if(!s.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}("next")})}}var o={data:function(){return{appId:"",appSecret:"",userData:Object,isAuth:!1,authMiniAppName:""}},mounted:function(){this.userData=i.a.session("userShop"),this.getConfig();var t=this.GetQueryString("auth_code");console.log(t),t&&null!=t&&this.setAuth(t)},methods:{getConfig:function(){var t=this;return s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getWechatConfig({data:{shopId:t.userData.currentShop.id}});case 2:(r=e.sent)&&(t.appId=r.appId,t.appSecret=r.appSecret,t.isAuth=!1,""!=r.authorizerAppId&&(t.isAuth=!0,t.authMiniAppName=r.authorizerAppName));case 4:case"end":return e.stop()}},e,t)}))()},setConfig:function(){var t=this;return s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(""==t.appId||t.appId.length<=0)){e.next=3;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"AppId不能为空！"}),e.abrupt("return",!1);case 3:if(!(""==t.appSecret||t.appSecret.length<=0)){e.next=6;break}return t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"appSecret不能为空！"}),e.abrupt("return",!1);case 6:return e.next=8,a.a.updateWechatConfig({data:{shopId:t.userData.currentShop.id,appId:t.appId,appSecret:t.appSecret}});case 8:(r=e.sent)&&(t.appId=r.appId,t.appSecret=r.appSecret,t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"保存成功"}));case 10:case"end":return e.stop()}},e,t)}))()},addWeChat:function(){var t=this;return s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getAuthUrl({data:{shopId:t.userData.currentShop.id,redirect_uri:document.location.toString(),auth_type:1}});case 2:(r=e.sent)&&(window.location.href=r);case 4:case"end":return e.stop()}},e,t)}))()},GetQueryString:function(t){var e=document.location.toString().split("?");if(e.length>1){for(var r=e[1].split("&"),n=[],a=0;a<r.length;a++)if(null!=(n=r[a].split("="))&&n[0]==t)return unescape(n[1]);return""}return""},setAuth:function(t){var e=this;return s(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a.a.setAuth({data:{auth_code:t}});case 2:r.sent&&e.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"授权成功"});case 4:case"end":return r.stop()}},r,e)}))()},deleteAuth:function(){var t=this;return s(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.deleteAuth({data:{type:1}});case 2:e.sent&&(t.$store.commit("setWin",{title:"温馨提示",winType:"alter",content:"解除授权成功"}),t.getConfig());case 4:case"end":return e.stop()}},e,t)}))()}},computed:{appIds:{get:function(){return this.appId},set:function(t){this.appId=t.replace(/[^a-zA-Z\d]/g,"")}},appSecrets:{get:function(){return this.appSecret},set:function(t){this.appSecret=t.replace(/[^a-zA-Z\d]/g,"")}}}},p=(r("1b7c"),r("6ceb")),u=Object(p.a)(o,n,[],!1,null,"b8f3e3a4",null);u.options.__file="src\\module\\public_number_configuration\\bound_public_number.vue";e.default=u.exports}}]);