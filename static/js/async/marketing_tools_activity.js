(window.webpackJsonp=window.webpackJsonp||[]).push([["marketing_tools_activity"],{"9f6e":function(t,e,a){"use strict";var i=a("ebb4");a.n(i).a},ebb4:function(t,e,a){},f354:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{attrs:{id:"activity"}},[a("section",{directives:[{name:"show",rawName:"v-show",value:t.acti,expression:"acti"}]},[1==t.ischain||2==t.ischain?a("div",{staticStyle:{"margin-bottom":"20px",float:"right"}}):a("div",{staticStyle:{"margin-bottom":"20px",float:"right"}},[a("a",{staticClass:"yellow",staticStyle:{width:"150px",height:"40px","line-height":"40px"},attrs:{href:"javascript:void(0);"},on:{click:t.addActivity}},[t._v("新增活动")])]),t._v(" "),a("div",{attrs:{id:"test"}},[a("div",[a("div",{staticClass:"oClickBox fl",on:{click:t.showCalendarSearch}},[a("span",{staticClass:"oSpan"},[t._v(t._s(t.start1)+" ---- "+t._s(t.end1))]),t._v(" "),a("span",{staticClass:"down"})]),t._v(" "),a("a",{staticClass:"fl",staticStyle:{"background-color":"#29A7E1"},attrs:{href:"javascript:void(0)"},on:{click:function(e){t.light(t.flag)}}},[a("span",{staticClass:"search"})])]),t._v(" "),t.showCanMulti?a("can-multi",{staticStyle:{float:"left","text-align":"center","margin-left":"5px"},attrs:{sideStart:t.atime1,sideEnd:t.btime1},on:{closeCan:t.closeCan,castTime:t.castTime}}):t._e()],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"20px"}},t._l(t.buttonList,function(e,i){return a("span",{key:i,staticClass:"sel",class:{on:t.flag==i},on:{click:function(e){t.light(i)}}},[t._v(t._s(e.name))])})),t._v(" "),a("com-table",{key:t.index,attrs:{listHeight:80,showHand:!1,showTitle:2,listWidth:1440,introData:t.activityList,titleData:t.titleList},scopedSlots:t._u([{key:"con-0",fn:function(e){return a("div",{},[t._v("\n\t\t\t\t"+t._s(t.setType(e.data.type))+"\n\t\t\t")])}},{key:"con-2",fn:function(e){return a("div",{},[t._v("\n\t\t\t\t"+t._s(t.transFormData(e.data.createTime))+"\n\t\t\t")])}},{key:"con-3",fn:function(e){return a("div",{},["0"==e.data.type?a("div",[t._v(t._s(t.timeLimit[e.data.limit].name))]):a("div",[t._v(t._s(t.setEndTime(e.data.createTime,e.data.endTime)))])])}},{key:"con-4",fn:function(e){return a("div",{},["0"==e.data.giveNum?a("div",[t._v("无限制")]):a("div",[t._v(t._s(e.data.giveNum))])])}},{key:"con-5",fn:function(e){return a("div",{},["0"==e.data.dayGiveNum?a("div",[t._v("无限制")]):a("div",[t._v(t._s(e.data.giveNum))])])}},{key:"con-6",fn:function(e){return a("div",{},["1"==e.data.type&&"0"==e.data.objectType?a("div",[t._v("\n\t\t\t\t\t店内\n\t\t\t\t")]):a("div",[t._v("会员")])])}},{key:"con-7",fn:function(e){return a("div",{},[1==t.ischain||2==t.ischain?a("div",{staticStyle:{"text-align":"center"}},[t._v("\n\t\t\t\t\t不可操作\n\t\t\t\t")]):a("div",{staticStyle:{"text-align":"center"}},[1==t.flag?a("a",{staticClass:"yellow",staticStyle:{width:"33.3%"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.close(e.data)}}},[t._v("关闭")]):t._e(),t._v(" "),0==t.flag?a("a",{staticClass:"yellow",staticStyle:{width:"33.3%"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.publish(e.data)}}},[t._v("发布")]):t._e(),t._v(" "),2==t.flag?a("a",{staticClass:"yellow",staticStyle:{width:"100%"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.off(e.data)}}},[t._v("下架")]):t._e(),t._v(" "),3==t.flag?a("a",{staticClass:"yellow",staticStyle:{width:"33.3%"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.on(e.data)}}},[t._v("上架")]):t._e(),t._v(" "),0==t.flag||1==t.flag||3==t.flag?a("a",{staticClass:"gray",staticStyle:{width:"33.3%",background:"#858585"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.modfycoupons(e.data)}}},[t._v("编辑")]):t._e(),t._v(" "),2!=t.flag?a("a",{staticClass:"gray",staticStyle:{background:"#a7a7a7"},style:{width:4==t.flag?"100%":"33.3%"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.deletecoupons(e.data)}}},[t._v("删除")]):t._e()])])}}])}),t._v(" "),t.pageTotal>1?a("page",{staticStyle:{float:"left","margin-top":"30px"},attrs:{isNoPaging:!0,len:t.pageNum,page:t.page,total:t.pageTotal},on:{pageNum:t.funGetPageNum}}):t._e()],1),t._v(" "),t.showAdd?a("activityAdd",{on:{winEvent:t.winEvent}}):t._e()],1)};i._withStripped=!0;var n=a("f6ce"),s=a("bbb9"),o=a("81a2");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,s){try{var o=e[n](s),r=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}var c=null,u={0:"生日活动",1:"自定义活动",2:"新会员开卡礼",3:"消费额激励",4:"裂变活动",5:"会员日",6:"满减活动"},d={data:function(){return{index:"",showCanMulti:!1,ischain:null,edit:!1,editId:"",actName:"",sel:0,explain:"",totalSel:0,giveNum:"",total:[{text:"不设限制",value:"0"},{text:"设定总数",value:"1"}],digit:!1,dayGiveLimit:"",num:!0,customName:"",customExplain:"",indexCustom:0,goodsIds:[],customIds:[],customIds1:[],loginTime:!1,member:0,memfilter:"",startAge:"",endAge:"",sexIndex:["0"],phone:"",atimevip:(new Date).getTime(),btimevip:(new Date).getTime(),isedit:!1,iseditShop:!1,isclick:!1,issue:!0,aid:"",buttonList:[{name:"未发布"},{name:"发布中"},{name:"已发布"},{name:"已下架"},{name:"已结束"}],flag:0,change:0,acti:!0,birth:!1,custom:!1,timeLimit:[{name:"永久",value:"1"},{name:"一年",value:"2"},{name:"二年",value:"0"}],highLimit:!1,high:"永久",pushdateNum:"",pushtime:[{name:"8",value:"1"},{name:"9",value:"2"},{name:"10",value:"3"},{name:"14",value:"4"},{name:"15",value:"5"},{name:"16",value:"6"},{name:"17",value:"7"},{name:"18",value:"8"},{name:"21",value:"9"},{name:"22",value:"10"},{name:"23",value:"11"}],pushtimeStauts:!1,pushNum:"8",customList:[{name:"店内"},{name:"会员"}],goodsType:[{name:"微信",id:"1"},{name:"短信",id:"2"}],goodsSelect:[],customSelect:[],msmStatus:!1,marketingStatus:!1,atime:(new Date).getTime(),btime:(new Date).getTime(),atime1:(new Date).getTime(),btime1:(new Date).getTime(),activityList:[],pageNum:10,pageTotal:1,pageCount:0,page:1,micShop:!1,micList:[{name:"选择使用"},{name:"强制使用"}],micsel:[],micselimit:[],miCount:[],indexmic:0,radioCount:!0,compareArr:[],activityDetail:{},shopList:[],brandId:null,contentSetting:"",customActivity:"",parameter:[{name:"【会员姓名】",id:"{memberName}"},{name:"【会员生日】",id:"{memberBirthday}"},{name:"【优惠券名称】",id:"{couponName}"},{name:"【优惠券数量】",id:"{couponNum}"},{name:"【活动名称】",id:"{activityName}"}],customParameter:[{name:"【会员姓名】",id:"{memberName}"},{name:"【优惠券名称】",id:"{couponName}"},{name:"【优惠券数量】",id:"{couponNum}"},{name:"【活动名称】",id:"{activityName}"}],showAdd:!1,titleList:[{titleName:"活动类型",titleStyle:{width:"100px",flex:"none"},dataName:"id"},{titleName:"活动名称",dataName:"name"},{titleName:"创建时间",dataName:"createTime"},{titleName:"活动期限"},{titleName:"券发放数量"},{titleName:"每日发放上限"},{titleName:"对象"},{titleName:"操作"}],allTotal:0}},computed:{start:{get:function(){return s.a.format(this.atime,"yyyy-MM-dd")}},end:{get:function(){return s.a.format(this.btime,"yyyy-MM-dd")}},start1:{get:function(){return s.a.format(this.atime1,"yyyy-MM-dd")}},end1:{get:function(){return s.a.format(this.btime1,"yyyy-MM-dd")}},day:{get:function(){var t=s.a.format(this.btime,"yyyy,MM,dd"),e=s.a.format(this.atime,"yyyy,MM,dd");return this.getDays(t,e)+"天"}}},methods:{closeCan:function(){this.showCanMulti=!1},winEvent:function(t){var e=t.module,a=t.status,i=t.type;this.showAdd=!1;var n=void 0==t.type?e.name:e.children[i].name;if("ok"==a)switch(n){case"新会员开卡礼":this.$router.push("/admin/activity/agift");break;case"消费额激励":this.$router.push("/admin/activity/encourage");break;case"自定义活动":this.$router.push("/admin/activity/custom");break;case"生日活动":this.$router.push("/admin/activity/birth");break;case"裂变活动":this.$router.push("/admin/activity/fission");break;case"会员日":this.$router.push("/admin/activity/member");break;case"满减活动":this.$router.push("/admin/activity/fullreduce")}},castTime:function(t){var e=t.startTime,a=t.endTime;this.atime1=e,this.btime1=a,this.showCanMulti=!1},funGetPageNum:function(t){this.page=t.page,this.addpage()},setEndTime:function(t,e){return t=s.a.format(t,"yyyy,MM,dd"),"0"==(e=s.a.format(e,"yyyy,MM,dd"))&&"0"==t?"无限期":this.getDays(t,e)+"天"},getDays:function(t,e){var a,i;a=t.split(","),i=e.split(",");var n=new Date(a[0],a[1]-1,a[2]),s=new Date(i[0],i[1]-1,i[2]);return parseInt(Math.abs(n-s)/1e3/60/60/24)+1},transFormData:function(t){return s.a.format(t,"yyyy-MM-dd")},setType:function(t){return u[t]},addpage:function(){this.light(this.flag)},addActivity:function(){this.showAdd=!0},showCalendarSearch:function(){this.showCanMulti=!this.showCanMulti},sendData:function(t){var e,a=this,i=t.urlType,n=t.data,s=t.str;this.$store.commit("setWin",{type:"confirm",content:s,callback:(e=r(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("ok"!=e){t.next=4;break}return t.next=3,o.a[i]({data:n});case 3:a.light(a.flag);case 4:case"end":return t.stop()}},t,a)})),function(t){return e.apply(this,arguments)})})},deletecoupons:function(t){this.sendData({urlType:"deleteActivity",data:{aid:t.id},str:"确认要删除吗？"})},off:function(t){this.sendData({urlType:"releaseOrDownActivity",data:{activityId:t.id,type:t.type,mouldType:t.mouldType,isRelease:0},str:"确定要下架吗?"})},on:function(t){this.sendData({urlType:"releaseOrDownActivity",data:{activityId:t.id,type:t.type,mouldType:t.mouldType,isRelease:1},str:"确认要上架吗?"})},publish:function(t){this.sendData({urlType:"releaseOrDownActivity",data:{activityId:t.id,type:t.type,mouldType:t.mouldType,isRelease:1},str:"确定要发布吗?"})},close:function(t){var e=this;return r(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.sendData({urlType:"closeActivity",data:{aid:t.id,type:t.type,mouldType:t.mouldType},str:"确定要关闭吗?"});case 1:case"end":return a.stop()}},a,e)}))()},light:function(t){var e=this;return r(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.flag=t,e.change!=e.flag&&(e.change=e.flag,e.page=1),3==t&&(t=-1),4==t&&(t=-2),a.next=6,o.a.getActivityList({data:{page:e.page,num:e.pageNum,fromDate:parseInt(e.atime1/1e3),toDate:parseInt(e.btime1/1e3),status:t}});case 6:i=a.sent,e.activityList=i.list,e.allTotal=e.activityList.length,e.pageTotal=i.total,e.pageCount=i.list.length;case 11:case"end":return a.stop()}},a,e)}))()},getCouponId:function(t,e){var a=void 0,i=[];for(t=1!=e?JSON.parse(t):t,a=0;a<t.length;a++)i.push(t[a].id);return i},getShopList:function(){var t=this;return r(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.couGetShopList({data:{}});case 2:a=e.sent,"3"==t.brandId?t.shopList=t.getCouponId(a,"1"):t.shopList.push(n.a.session("shopId"));case 4:case"end":return e.stop()}},e,t)}))()},modfycoupons:function(t){n.a.session("activityInfo",t),this.winEvent({status:"ok",module:{name:u[t.type]}})}},components:{page:function(){return a.e("page_element").then(a.bind(null,"5921"))},canMulti:function(){return a.e("can_multi").then(a.bind(null,"742e"))},activityAdd:function(){return a.e("activity_add").then(a.bind(null,"93c8"))},comTable:function(){return a.e("table").then(a.bind(null,"4360"))}},beforeCreate:function(){c=n.a.session("userShop").currentShop},mounted:function(){this.ischain=this.brandId=c.ischain,this.addpage(),this.getShopList()}},l=(a("9f6e"),a("7610")),m=Object(l.a)(d,i,[],!1,null,"7c6b4603",null);m.options.__file="src\\module\\marketing_tools\\activity.vue";e.default=m.exports}}]);